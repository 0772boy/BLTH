// ==UserScript==
// @namespace      https://github.com/andywang425
// @name           B站直播间挂机助手
// @name:en        B站直播间挂机助手
// @author         andywang425
// @description    自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章，快捷购买粉丝勋章
// @description:en 自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章，快捷购买粉丝勋章
// @updateURL      https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @homepageURL    https://github.com/andywang425/BLTH/
// @supportURL     https://github.com/andywang425/BLTH/issues
// @icon           https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright      2020, andywang425 (https://github.com/andywang425)
// @license        MIT
// @compatible     chrome 80 or later
// @compatible     firefox 77 or later
// @compatible     opera 69 or later
// @version        4.4
// @include       /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at        document-start
// @connect       passport.bilibili.com
// @connect       api.live.bilibili.com
// @connect       live-trace.bilibili.com
// @require       https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/BilibiliAPI_Mod.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/OCRAD.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/layer.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/libBilibiliToken.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/libWasmHash.js
// @grant        unsafeWindow
// @grant        GM_xmlhttpRequest
// ==/UserScript==
'use strict';var _Mathceil=Math.ceil,_Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function I(T,f){try{var O=l[T](f),E=O.value}catch(N){return void u(N)}return O.done?void _(E):Promise.resolve(E).then(function(N){I('next',N)},function(N){I('throw',N)})}return I('next')})}}(function(){var E=this,N='IGIFTMSG',A=BilibiliAPI,G=navigator.userAgent,D=new Date().getTimezoneOffset()+480,R=function ts_ms(){return Date.now()},M=function ts_s(){return _Mathround(R()/1e3)},S=function runUntilSucceed(de){var le=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,_e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){de()||S(de,_e,_e)},le)},L=function delayCall(de){var le=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,_e=$.Deferred();return setTimeout(function(){var ge=de();ge&&ge.then?ge.then(function(ue,ce,pe,Ie,Te,fe){return _e.resolve(ue,ce,pe,Ie,Te,fe)}):_e.resolve()},le),_e},F=function MYDEBUG(de){for(var le=arguments.length,_e=Array(1<le?le-1:0),ge=1;ge<le;ge++)_e[ge-1]=arguments[ge];var ue=new Date;return ue='['+N+']['+ue.getHours()+':'+ue.getMinutes()+':'+ue.getSeconds()+':'+ue.getMilliseconds()+']',1===_e.length?void console.log(ue,de+':',_e[0]):void console.log(ue,de+':',_e)},U=function runMidnight(de,le){var _e=new Date;_e.setMinutes(_e.getMinutes()+D),_e.setDate(_e.getDate()+1),_e.setHours(0,1,0,0),_e.setMinutes(_e.getMinutes()-D),setTimeout(de,_e-R()),F('runMidnight',(le||' ')+' '+_e.toString())},w=function runExactMidnight(de,le){var _e=new Date;_e.setMinutes(_e.getMinutes()+D),_e.setDate(_e.getDate()+1),_e.setHours(0,0,0,0),_e.setMinutes(_e.getMinutes()-D),setTimeout(de,_e-R()),F('runExactMidnight',(le||' ')+' '+_e.toString())},k=function runTomorrow(de,le,_e,ge){var ue=new Date;ue.setMinutes(ue.getMinutes()+D),ue.setDate(ue.getDate()+1),ue.setHours(le,_e,0,0),ue.setMinutes(ue.getMinutes()-D),setTimeout(de,ue-R()),F('runTomorrow',(ge||' ')+' '+ue.toString())},H=new BilibiliToken,B='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',P=function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function le(){return regeneratorRuntime.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!(ne.time>M())){ge.next=4;break}ae=ne,ge.next=10;break;case 4:return ge.next=6,H.getToken();case 6:ne=ge.sent,ne.time=M()+ne.expires_in,localStorage.setItem(N+'_Token',JSON.stringify(ne)),ae=ne;case 10:;return F(N+'_Token',ne),ge.abrupt('return','OK');case 13:case'end':return ge.stop();}},le,E)}));return function setToken(){return de.apply(this,arguments)}}(),Y={init:function init(){return Y.Toast.init().then(function(){})},Toast:{init:function init(){try{var de=[];return window.toast=function(le){var _e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',ge=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(_e){case'success':case'info':break;case'caution':break;case'error':break;default:_e='info';}var ue=$('<div class="link-toast '+_e+' fixed"><span class="toast-text">'+le+'</span></div>')[0];document.body.appendChild(ue),ue.style.top=document.body.scrollTop+40*de.length+10+'px',ue.style.left=document.body.offsetWidth+document.body.scrollLeft-ue.offsetWidth-5+'px','hide'==X&&$('.link-toast').hide(),de.push(ue),setTimeout(function(){ue.className+=' out',setTimeout(function(){de.shift(),de.forEach(function(ce){ce.style.top=parseInt(ce.style.top,10)-40+'px'}),$(ue).remove()},200)},ge)},$.Deferred().resolve()}catch(de){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',de),$.Deferred().reject()}}}},V=function addStyle(){$('head').append('\n            <style>\n                .igiftMsg_input{\n                    outline: none;\n                    border: 1px solid #e9eaec;\n                    background-color: #fff;\n                    border-radius: 4px;\n                    padding: 1px 0 0;\n                    overflow: hidden;\n                    font-size: 12px;\n                    line-height: 19px;\n                    width: 30px;\n                    z-index: \'10001\';\n                }\n                .igiftMsg_btn{\n                    background-color: #23ade5;\n                    color: #fff;\n                    border-radius: 4px;\n                    border: none;\n                    padding: 5px;\n                    cursor: pointer;\n                    box-shadow: 0 0 2px #00000075;\n                    line-height: 10px;\n                    z-index: 10001;\n                }\n                .igiftMsg_fs{\n                    border: 2px solid #d4d4d4;\n                    z-index: 10001;\n                }\n            </style>\n            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sentsin/layer@v3.1.1/dist/theme/default/layer.css" id="layuicss-layer">\n                ')},X=localStorage.getItem(N+'_msgHide')||'hide',K=0,Q=0,z=0,Z=!1,J=!1,ee=!1,te=!0,ie={room_id:void 0,uid:void 0,ruid:void 0,tid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},ae=void 0,ne=JSON.parse(localStorage.getItem(N+'_Token'))||{};function o(){var le,de=this,_e={CONFIG_DEFAULT:{AUTO_DANMU:!1,AUTO_GIFT:!1,AUTO_GIFT_ROOMID:['0'],AUTO_GROUP_SIGN:!0,AUTO_TREASUREBOX:!0,CHECK_HOUR_ROOM:!1,CHECK_HOUR_ROOM_INTERVAL:600,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,DANMU_CONTENT:['\u8FD9\u662F\u4E00\u6761\u5F39\u5E55'],DANMU_ROOMID:['22474988'],DANMU_INTERVAL_TIME:['10'],EXCLUDE_ROOMID:'0',FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_SEND_TIME',GIFT_SORT:'high',IN_TIME_RELOAD_DISABLE:!1,LOTTERY:!0,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!0,LIGHT_MEDALS:['0'],LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,NOSLEEP:!0,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_activity:!1,REMOVE_ELEMENT_rank:!0,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:!1,TIME_RELOAD_MINUTE:120,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_SEND_DANMU_TS:[],AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{A.setCommonArgs(ie.bili_jct)}catch(ue){return void console.error('['+N+']',ue)}var ge=$.Deferred();try{_e.loadConfig().then(function(){_e.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),ge.resolve()})}catch(ue){console.error('API\u521D\u59CB\u5316\u51FA\u9519',ue),_e.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),ge.reject()}try{_e.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),ge.resolve()})}catch(ue){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',ue),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),ge.reject()}return setTimeout(_e.TreasureBox.init,5750),ge},loadConfig:function loadConfig(){var ge=$.Deferred();try{var ue=JSON.parse(localStorage.getItem(N+'_CONFIG'));for(var ce in $.extend(!0,_e.CONFIG,_e.CONFIG_DEFAULT),_e.CONFIG)_e.CONFIG.hasOwnProperty(ce)&&void 0!==ue[ce]&&null!==ue[ce]&&(_e.CONFIG[ce]=ue[ce]);_e.loadGiftCount(),ge.resolve()}catch(ue){F('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',ue),_e.setDefaults(),ge.reject()}return ge},loadCache:function loadCache(){var ge=$.Deferred();try{var ue=JSON.parse(localStorage.getItem(N+'_CACHE'));for(var ce in $.extend(!0,_e.CACHE,_e.CACHE_DEFAULT),_e.CACHE)_e.CACHE.hasOwnProperty(ce)&&void 0!==ue[ce]&&null!==ue[ce]&&(_e.CACHE[ce]=ue[ce]);ge.resolve()}catch(ue){F('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',ue),_e.setDefaults(),ge.reject()}return ge},newMessage:function newMessage(ge){try{var ue=localStorage.getItem(N+'_NEWMSG_CACHE');if((ue==void 0||null==ue||'4.4'!=ue)&&'4.4'==ge){var ce=function linkMsg(pe,Ie){return'<a href="'+Ie+'"target="_blank">'+pe+'</a>'};layer.open({title:ge+'\u66F4\u65B0\u63D0\u793A',content:'<strong>1.\u65B0\u589E\u81EA\u52A8\u53D1\u5F39\u5E55\u529F\u80FD</strong><br>\n                            '+ce('\u4F7F\u7528\u524D\u5EFA\u8BAE\u5148\u770B\u4E0B\u8BF4\u660E(\u70B9\u6211\u524D\u5F80\u5BF9\u5E94\u8BF4\u660E\u5904)','https://github.com/andywang425/BLTH/blob/master/README.md#\u5F39\u5E55\u8BBE\u7F6E')+'<br><hr>\n                            <em style="color:grey;">\n                            \u5982\u679C\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u9047\u5230\u95EE\u9898\uFF0C\u6B22\u8FCE\u53BB'+ce('github','https://github.com/andywang425/BLTH/issues')+'\n                            \uFF08\u6216\u8005\u8FDBqq\u7FA4'+ce('1106094437','https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O')+'\uFF09\u53CD\u9988\u3002\n                            </em>'}),localStorage.setItem(N+'_NEWMSG_CACHE',ge)}}catch(ue){F('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u5931\u8D25',ue)}},saveConfig:function saveConfig(){try{return localStorage.setItem(N+'_CONFIG',JSON.stringify(_e.CONFIG)),_e.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),F('MY_API.CONFIG',_e.CONFIG),!0}catch(ge){return F('API\u4FDD\u5B58\u51FA\u9519',ge),!1}},saveCache:function saveCache(){var ge=0<arguments.length&&arguments[0]!==void 0?arguments[0]:!0;try{return localStorage.setItem(N+'_CACHE',JSON.stringify(_e.CACHE)),ge&&F('CACHE\u5DF2\u4FDD\u5B58',_e.CACHE),!0}catch(ue){return F('CACHE\u4FDD\u5B58\u51FA\u9519',ue),!1}},setDefaults:function setDefaults(){_e.CONFIG=_e.CONFIG_DEFAULT,_e.CACHE=_e.CACHE_DEFAULT,_e.saveConfig(),_e.saveCache(),_e.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1','info'),setTimeout(function(){_e.CACHE=_e.CACHE_DEFAULT,_e.GroupSign.run(),_e.DailyReward.run(),_e.LiveReward.run(),_e.Exchange.runS2C(),_e.TreasureBox.run(),_e.Gift.run(),_e.LITTLE_HEART.run(),_e.AUTO_DANMU.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var ge=JSON.parse(localStorage.getItem(N+'_GIFT_COUNT'));for(var ue in _e.GIFT_COUNT)_e.GIFT_COUNT.hasOwnProperty(ue)&&void 0!==ge[ue]&&null!==ge[ue]&&(_e.GIFT_COUNT[ue]=ge[ue]);F('MY_API.GIFT_COUNT',_e.GIFT_COUNT)}catch(ge){F('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',ge)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(N+'_GIFT_COUNT',JSON.stringify(_e.GIFT_COUNT)),F('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',_e.GIFT_COUNT),!0}catch(ge){return F('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',ge),!1}},addGift:function addGift(ge){_e.GIFT_COUNT.COUNT+=ge,$('#giftCount span:eq(0)').text(_e.GIFT_COUNT.COUNT),_e.saveGiftCount()},addSilver:function addSilver(ge){_e.GIFT_COUNT.SILVER_COUNT+=ge,$('#giftCount span:eq(1)').text(_e.GIFT_COUNT.SILVER_COUNT),_e.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){for(var ge=['#my-dear-haruna-vm','.activity-entry','.activity-rank'],ue=['REMOVE_ELEMENT_2233','REMOVE_ELEMENT_activity','REMOVE_ELEMENT_rank'],ce=function removeUntiSucceed(pe){_e.CONFIG[ue[pe]]&&setInterval(function(){0<$(ge[pe]).length&&$(ge[pe]).remove()},200)},pe=0;pe<ge.length;pe++)ce(pe);_e.CONFIG.NOSLEEP&&setInterval(function(){return document.dispatchEvent(new Event('visibilitychange'))},600000)},creatSetBox:function creatSetBox(){var ge=['.chat-history-list','.attention-btn-ctnr','.live-player-mounter'],ue=!0,ce=!1,pe=void 0;try{for(var Te,Ge,Ie=ge[Symbol.iterator]();!(ue=(Te=Ie.next()).done);ue=!0)if(Ge=Te.value,0===$(Ge).length)return L(function(){return _e.creatSetBox()},200)}catch(Ge){ce=!0,pe=Ge}finally{try{!ue&&Ie.return&&Ie.return()}finally{if(ce)throw pe}}var fe='hide'==X?'\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F':'\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F',me=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">'+fe+'<br></button>'),Oe='#allsettings',Ee=$('.chat-history-list'),ve,xe=$('.live-player-mounter').height(),he=$('.live-player-mounter').offset(),Ne='"float:left"';-1<G.toLowerCase().indexOf('firefox')&&(Ne='""');var Ce='\n                <div id=\'allsettings\' class = "igiftMsg_main">\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n                    <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n                        \u8FA3\u6761&nbsp;<span>'+_e.GIFT_COUNT.COUNT+'</span>\n                        \u94F6\u74DC\u5B50&nbsp;<span>'+_e.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n                    </div>\n                </fieldset>\n                <div id="left_fieldset" style='+Ne+'>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u62BD\u5956\u8BBE\u7F6E</legend>\n                    <div data-toggle="LOTTERY">\n                        <label style="margin: 5px auto; color: purple;line-height:30px";>\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u53C2\u4E0E\u62BD\u5956\n                        </label>\n                    </div>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u542F\u7528\n                                <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                                <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_GIFT">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u68C0\u67E5\u5C0F\u65F6\u699C\uFF08\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\uFF09\n                            </label>\n                        </div>\n                        <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n                        <label style="margin: 5px auto; color: red;">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n                        </label>\n                    </div>\n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs" style ="line-height:16px;">\n                        <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u767B\u9646\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u89C2\u770B\u89C6\u9891\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                            </label>\n                        </div>\n                        <div data-toggle="COIN_TYPE" style=" color: black">\n                            <div data-toggle="COIN_UID">\n                            <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                            \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                            \u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                            <div data-toggle="COIN_DYN">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5206\u4EAB\u89C6\u9891\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u76F4\u64AD\u533A\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5E94\u63F4\u56E2\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9001\u793C\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            \u4F18\u5148\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                            \u4E0D\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n                        <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u95F4\u9694\n                            <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                            \u5206\u949F\u9001\u793C\n                        </div>\n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u5B9A\u65F6\u9001\u793C<br>&nbsp;&nbsp;&nbsp;&nbsp;\n                            \u9001\u793C\u65F6\u95F4\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n                        </div>\n                        \n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            \u793C\u7269\u5230\u671F\u65F6\u95F4\n                            <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                            \u5929\n                        </div>\n                        <div data-toggle="GIFT_SORT_HIGH" style=" color: black;line-height: 20px;">\n                        \u7C89\u4E1D\u724C\u9001\u793C\u4F18\u5148\u7EA7<br>\n                        &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name = "GIFT_SORT">\n                            \u4F18\u5148<strong style="color: purple">\u9AD8</strong>\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="GIFT_SORT_LOW" style=" color: black">\n                        &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name = "GIFT_SORT">\n                        \u4F18\u5148<strong style="color: purple">\u4F4E</strong>\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style="color: #ff5200;line-height:15px;">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u65E0\u89C6\u793C\u7269\u7C7B\u578B\u548C\u5230\u671F\u65F6\u95F4\u9650\u5236\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style="color: black;line-height:20px;">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            \u6BEB\u79D2\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style='+Ne+'>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8D2D\u4E70\u7C89\u4E1D\u52CB\u7AE0</legend>\n                        <div data-toggle="BUY_MEDAL" style="color: black; line-height: 15px">\n                        \u8F93\u5165\u7C89\u4E1D\u52CB\u7AE0\u5BF9\u5E94\u623F\u95F4\u53F7\uFF1A<input class="num igiftMsg_input" type="text" value = '+ie.room_id+' onclick="select();" style="width: 70px">\n                        <button  class="igiftMsg_btn" data-action="buy_medal">\u70B9\u51FB\u8D2D\u4E70\u52CB\u7AE0</button>\n                        \uFF08\u82B1\u8D3920\u786C\u5E01\uFF09\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n                        <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                            </label>\n                        </div>\n                        <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                            \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n                        <input class="num igiftMsg_input" style="width: 300px;" type="text">\n                    </div>\n                    <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n                        \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n                        <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u767D\u540D\u5355\n                        </div>\n                        <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                            &nbsp;\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u9ED1\u540D\u5355\n                        </div>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="lightMedalNow">\u7ACB\u523B\u70B9\u4EAE\u52CB\u7AE0</button>\n                    </div>\n                    <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n                    <label style="margin: 5px auto; color: black">\n                        <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n                    </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n                        <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u79FB\u96642233\u6A21\u578B\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_activity" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u79FB\u9664\u6D3B\u52A8\u5165\u53E3\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_rank" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u79FB\u9664\u6392\u884C\u699C\n                        </label>\n                    </div>\n                        <div data-toggle="NOSLEEP">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5C4F\u853D\u6302\u673A\u68C0\u6D4B\n                        </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 25px">\n                        <legend style="color: black">\u5F39\u5E55\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_DANMU">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5B9A\u65F6\u5F39\u5E55<br>\n                            \u5F39\u5E55\u5185\u5BB9\n                            <input class="Danmu igiftMsg_input" style="width: 330px;" type="text"><br>\n                            \u623F\u95F4\u53F7\n                            <input class="Roomid igiftMsg_input" style="width: 330px;" type="text"><br>\n                            \u95F4\u9694\u65F6\u95F4\n                            <input class="Time igiftMsg_input" style="width: 330px;" type="text">\u5206\n                        </div>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="sendDanmuNow">\u7ACB\u523B\u53D1\u9001\u5F39\u5E55</button>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="clearDanmuCache">\u6E05\u9664\u5F39\u5E55\u7F13\u5B58</button>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 15px">\n                        <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n                        <div data-toggle="TIME_RELOAD" style="color: black">\n                        <input style="vertical-align: text-top;" type="checkbox">\n                            \u6BCF\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\n                            \u5206\u949F\u5237\u65B0\u4E00\u6B21\u9875\u9762\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u5237\u65B0\u76F4\u64AD\u95F4\n                            </label>\n                        </div>\n            \n                        <div id="resetArea">\n                            <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                            <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1</button>\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n                        </div>\n            \n                    </fieldset>\n                    <label style="color: darkblue; font-size:large;">\n                         <a href="https://github.com/andywang425/BLTH"\n                            target="_blank">v'+GM_info.script.version+'&nbsp;\u66F4\u591A\u4FE1\u606F\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n                    </label>\n                </div>\n            </div>\n    ',Ae=function getScrollPosition(){var Ge=0<arguments.length&&arguments[0]!==void 0?arguments[0]:window;return{x:Ge.pageXOffset===void 0?Ge.scrollLeft:Ge.pageXOffset,y:Ge.pageYOffset===void 0?Ge.scrollTop:Ge.pageYOffset}},ye=function openMainWindow(){ve=layer.open({type:1,title:!1,offset:[he.top-Ae().y+''+'px',he.left+''+'px'],closeBtn:0,shade:0,zIndex:9999,fixed:!1,area:[,xe+''+'px'],content:Ce,success:function success(){function Ge(){var we,ke,He=parseInt($(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),Be=parseInt($(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Pe=parseInt($(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),je=parseInt($(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(24<=He||24<=Be||60<=Pe||60<=je||0>He||0>Be||0>Pe||0>je)return void _e.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(_e.CONFIG.TIME_AREA_START_H0UR=He,_e.CONFIG.TIME_AREA_END_H0UR=Be,_e.CONFIG.TIME_AREA_START_MINUTE=Pe,_e.CONFIG.TIME_AREA_END_MINUTE=je,we=parseFloat($(Oe).find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>we||100<we)return void _e.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(_e.CONFIG.RANDOM_SKIP=we,we=parseFloat($(Oe).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<we)return void _e.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>we)return void _e.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(_e.CONFIG.RANDOM_SEND_DANMU=we,we=parseInt($(Oe).find('div[data-toggle="MAX_GIFT"] .num').val()),_e.CONFIG.MAX_GIFT=we,we=parseInt($(Oe).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=we||1e4<we)return void _e.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(_e.CONFIG.TIME_RELOAD_MINUTE=we,we=parseFloat($(Oe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),Be=parseFloat($(Oe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>we||100<Be)return void _e.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Be<=we)return void _e.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(_e.CONFIG.RND_DELAY_START=we,_e.CONFIG.RND_DELAY_END=Be,we=parseInt($(Oe).find('div[data-toggle="COIN"] .coin_number').val()),0>we||5<we)return void _e.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(_e.CONFIG.COIN_NUMBER=we,we=parseInt($(Oe).find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=we)return void _e.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');_e.CONFIG.CHECK_HOUR_ROOM_INTERVAL=we,we=$(Oe).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),ke=we.split(',');for(var Ye=0;Ye<ke.length;Ye++)''===ke[Ye]&&(ke[Ye]=22474988);_e.CONFIG.AUTO_GIFT_ROOMID=ke,we=$(Oe).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),ke=we.split(',');for(var Ye=0;Ye<ke.length;Ye++)''===ke[Ye]&&(ke[Ye]=0);if(_e.CONFIG.EXCLUDE_ROOMID=ke,we=parseInt($(Oe).find('div[data-toggle="GIFT_LIMIT"] .num').val()),_e.CONFIG.GIFT_LIMIT=we,He=parseInt($(Oe).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),Be=parseInt($(Oe).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>He||0>Be)return void _e.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=He||60<=Be)return void _e.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning');_e.CONFIG.GIFT_SEND_HOUR=He,_e.CONFIG.GIFT_SEND_MINUTE=Be,we=$(Oe).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),_e.CONFIG.SPARE_GIFT_ROOM=we,we=parseInt($(Oe).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),_e.CONFIG.STORM_QUEUE_SIZE=we,we=parseInt($(Oe).find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),_e.CONFIG.STORM_MAX_COUNT=we,we=parseInt($(Oe).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),_e.CONFIG.STORM_ONE_LIMIT=we,we=parseInt($(Oe).find('div[data-toggle="COIN_UID"] .num').val()),_e.CONFIG.COIN_UID=we,we=$(Oe).find('div[data-toggle="LIGHT_MEDALS"] .num').val(),ke=we.split(',');for(var Ye=0;Ye<ke.length;Ye++)''===ke[Ye]&&(ke[Ye]=0);_e.CONFIG.LIGHT_MEDALS=ke,we=parseInt($(Oe).find('div[data-toggle="MAX_TAB"] .num').val()),_e.CONFIG.MAX_TAB=we,He=$(Oe).find('div[data-toggle="AUTO_DANMU"] .Danmu').val(),ke=He.split(',');for(var Ye=0;Ye<ke.length;Ye++)''===ke[Ye]&&(ke[Ye]='\u8FD9\u662F\u4E00\u6761\u5F39\u5E55');He=ke,Be=$(Oe).find('div[data-toggle="AUTO_DANMU"] .Roomid').val(),ke=Be.split(',');for(var Ye=0;Ye<ke.length;Ye++)''===ke[Ye]&&(ke[Ye]='22474988');Be=ke,Pe=$(Oe).find('div[data-toggle="AUTO_DANMU"] .Time').val(),ke=Pe.split(',');for(var Ye=0;Ye<ke.length;Ye++)''===ke[Ye]&&(ke[Ye]='10');return Pe=ke,0>=parseFloat(Pe)?void _e.chatLog('[\u5F39\u5E55\u8BBE\u7F6E]\u95F4\u9694\u65F6\u95F4\u5FC5\u987B\u5927\u4E8E0','warning'):void(_e.CONFIG.DANMU_CONTENT=He,_e.CONFIG.DANMU_ROOMID=Be,_e.CONFIG.DANMU_INTERVAL_TIME=Pe,_e.saveConfig())}function De(we){return A.live_user.get_anchor_in_room(we).then(function(ke){F('API.live_user.get_anchor_in_room response',ke),0!==ke.code||!ke.data.info?0===ke.code&&ke.data.info===void 0?layer.msg('\u623F\u95F4\u4E0D\u5B58\u5728',{time:2500}):layer.msg('\u68C0\u67E5\u623F\u95F4\u51FA\u9519 '+ke.message,{time:2500}):layer.confirm('\u662F\u5426\u6D88\u801720\u786C\u5E01\u8D2D\u4E70UP\u4E3B\u3010'+ke.data.info.uname+'\u3011\u7684\u7C89\u4E1D\u52CB\u7AE0\uFF1F',{title:'\u8D2D\u4E70\u52CB\u7AE0',btn:['\u662F','\u5426']},function(){return A.link_group.buy_medal(ke.data.info.uid).then(function(He){F('API.link_group.buy_medal re',He),0===He.code?layer.msg('\u8D2D\u4E70\u6210\u529F',{time:2e3,icon:1}):layer.msg('\u8D2D\u4E70\u5931\u8D25 '+He.message,{time:2500,icon:2})})},function(){layer.msg('\u5DF2\u53D6\u6D88\u8D2D\u4E70',{time:2e3})})})}$(Oe).find('div[data-toggle="AUTO_DANMU"] .Time').val(_e.CONFIG.DANMU_INTERVAL_TIME.toString()),$(Oe).find('div[data-toggle="AUTO_DANMU"] .Roomid').val(_e.CONFIG.DANMU_ROOMID.toString()),$(Oe).find('div[data-toggle="AUTO_DANMU"] .Danmu').val(_e.CONFIG.DANMU_CONTENT.toString()),$(Oe).find('div[data-toggle="MAX_TAB"] .num').val(parseInt(_e.CONFIG.MAX_TAB).toString()),$(Oe).find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(_e.CONFIG.GIFT_INTERVAL).toString()),$(Oe).find('div[data-toggle="LIGHT_MEDALS"] .num').val(_e.CONFIG.LIGHT_MEDALS.toString()),$(Oe).find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(_e.CONFIG.STORM_MAX_COUNT).toString()),$(Oe).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(_e.CONFIG.STORM_ONE_LIMIT).toString()),$(Oe).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(_e.CONFIG.STORM_QUEUE_SIZE).toString()),$(Oe).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(_e.CONFIG.SPARE_GIFT_ROOM.toString()),$(Oe).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(_e.CONFIG.TIME_RELOAD_MINUTE).toString()),$(Oe).find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(_e.CONFIG.RANDOM_SKIP).toString()),$(Oe).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(_e.CONFIG.RANDOM_SEND_DANMU).toString()),$(Oe).find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(_e.CONFIG.MAX_GIFT).toString()),$(Oe).find('div[data-toggle="COIN"] .coin_number').val(parseInt(_e.CONFIG.COIN_NUMBER).toString()),$(Oe).find('div[data-toggle="COIN_UID"] .num').val(parseInt(_e.CONFIG.COIN_UID).toString()),$(Oe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(_e.CONFIG.RND_DELAY_START).toString()),$(Oe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(_e.CONFIG.RND_DELAY_END).toString()),$(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(_e.CONFIG.TIME_AREA_START_H0UR).toString()),$(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(_e.CONFIG.TIME_AREA_END_H0UR).toString()),$(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(_e.CONFIG.TIME_AREA_START_MINUTE).toString()),$(Oe).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(_e.CONFIG.TIME_AREA_END_MINUTE).toString()),$(Oe).find('div[data-toggle="CHECK_HOUR_ROOM"] .num').val(parseInt(_e.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),$(Oe).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(_e.CONFIG.AUTO_GIFT_ROOMID.toString()),$(Oe).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(_e.CONFIG.EXCLUDE_ROOMID.toString()),$(Oe).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(_e.CONFIG.GIFT_SEND_HOUR.toString()),$(Oe).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(_e.CONFIG.GIFT_SEND_MINUTE.toString()),$(Oe).find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(_e.CONFIG.GIFT_LIMIT).toString());$(Oe).find('div[id="giftCount"] [data-action="save"]').click(function(){Ge()}),$(Oe).find('div[data-toggle="BUY_MEDAL"] [data-action="buy_medal"]').click(function(){var we=parseInt($(Oe).find('div[data-toggle="BUY_MEDAL"] .num').val());De(we)}),$(Oe).find('button[data-action="reset"]').click(function(){_e.setDefaults()}),$(Oe).find('button[data-action="checkUpdate"]').click(function(){_e.checkUpdate()}),$(Oe).find('button[data-action="redo_dailyTasks"]').click(function(){_e.ReDoDailyTasks()}),$(Oe).find('#resetArea [data-action="countReset"]').click(function(){_e.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},_e.saveGiftCount(),$('#giftCount span:eq(0)').text(_e.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(_e.GIFT_COUNT.SILVER_COUNT),_e.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),$(Oe).find('button[data-action="sendGiftNow"]').click(function(){Z=!0,_e.Gift.run()}),$(Oe).find('button[data-action="lightMedalNow"]').click(function(){ee=!0,_e.Gift.run()}),$(Oe).find('button[data-action="sendDanmuNow"]').click(function(){J=!0,_e.AUTO_DANMU.run()}),$(Oe).find('button[data-action="clearDanmuCache"]').click(function(){_e.CACHE.AUTO_SEND_DANMU_TS=[],_e.saveCache()&&_e.chatLog('\u6E05\u9664\u5F39\u5E55\u7F13\u5B58\u6210\u529F','success')});var Re=['AUTO_DANMU','RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','TIME_RELOAD','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','SEND_ALL_GIFT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_activity','REMOVE_ELEMENT_rank','FORCE_LIGHT','LOTTERY','CHECK_HOUR_ROOM','NOSLEEP'],Me=!0,be=!1,Se=void 0;try{for(var Ue,Le=function _loop(){var we=Ue.value,ke=$(Oe).find('div[data-toggle="'+we+'"] input:checkbox');_e.CONFIG[we]&&ke.attr('checked',''),ke.change(function(){_e.CONFIG[we]=$(this).prop('checked'),_e.saveConfig()})},Fe=Re[Symbol.iterator]();!(Me=(Ue=Fe.next()).done);Me=!0)Le()}catch(we){be=!0,Se=we}finally{try{!Me&&Fe.return&&Fe.return()}finally{if(be)throw Se}}$('input:text').bind('keydown',function(we){'13'==we.keyCode&&Ge()}),'COIN_DYN'==_e.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==_e.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==_e.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');'high'==_e.CONFIG.GIFT_SORT?$('div[data-toggle=\'GIFT_SORT_HIGH\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SORT_LOW\'] input:radio').attr('checked',''),$('input:radio[name=\'COIN_TYPE\']').change(function(){_e.CONFIG.COIN_TYPE=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked')?'COIN_DYN':'COIN_UID',_e.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){_e.CONFIG.LIGHT_METHOD=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked')?'LIGHT_WHITE':'LIGHT_BLACK',_e.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){_e.CONFIG.GIFT_METHOD=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked')?'GIFT_INTERVAL':'GIFT_SEND_TIME',_e.saveConfig()}),$('input:radio[name=\'GIFT_SORT\']').change(function(){_e.CONFIG.GIFT_SORT=$('div[data-toggle=\'GIFT_SORT_HIGH\'] input:radio').is(':checked')?'high':'low',_e.saveConfig()})},end:function end(){X='hide',localStorage.setItem(N+'_msgHide',X),$('.igiftMsg').hide(),$('.link-toast').hide(),Ee.animate({scrollTop:0},0),setTimeout(function(){Ee.animate({scrollTop:Ee.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'}})};me.click(function(){te&&(te=!1,setTimeout(function(){te=!0},200),'show'==X?(X='hide',localStorage.setItem(N+'_msgHide',X),$('.igiftMsg').hide(),$('.link-toast').hide(),layer.close(ve),Ee.animate({scrollTop:0},0),setTimeout(function(){Ee.animate({scrollTop:Ee.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'):(X='show',localStorage.setItem(N+'_msgHide',X),$('.igiftMsg').show(),$('.link-toast').show(),ye(),Ee.animate({scrollTop:Ee.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'))}),$('.attention-btn-ctnr').append(me),_e.CACHE.DailyReward_TS||layer.tips('\u70B9\u6211\u9690\u85CF/\u663E\u793A\u63A7\u5236\u9762\u677F','#hiderbtn',{tips:1}),'show'==X&&ye()},chatLog:function chatLog(ge){var ue=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',ce=$('<div class=\'igiftMsg\'>'),pe=$('<div>'),Ie=$('#chat-history-list'),Te=new Date;pe.text(ge),ce.text(Te.toLocaleString()),ce.append(pe),ce.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),pe.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===ue?ce.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===ue?ce.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===ue?ce.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):ce.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});'show'==X?Ie.find('#chat-items').append(ce):Ie.find('#chat-items').append(ce.hide()),Ie.scrollTop(Ie.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(ge,ue){var ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';A.room.getConf(ge).then(function(pe){F('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+ce,pe);var Ie=new A.DanmuWebSocket(ue,ge,pe.data.host_server_list,pe.data.token);Ie.bind(function(Te){Ie=Te,_e.chatLog(ce+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){_e.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+ge+' \u5206\u533A: '+ce,'success')},function(){(_e.blocked||_e.stormBlack)&&(Ie.close(),_e.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ce,'warning')),_e.max_blocked&&!_e.CONFIG.STORM&&(Ie.close(),_e.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ce,'warning'))},function(Te){if(!(I(_e.CONFIG.TIME_AREA_START_H0UR,_e.CONFIG.TIME_AREA_END_H0UR,_e.CONFIG.TIME_AREA_START_MINUTE,_e.CONFIG.TIME_AREA_END_MINUTE)&&_e.CONFIG.TIME_AREA_DISABLE))switch(F('\u5F39\u5E55\u516C\u544A'+ce,Te),Te.cmd){case'GUARD_MSG':Te.roomid===Te.real_roomid?_e.checkRoom(Te.roomid,ce):(_e.checkRoom(Te.roomid,ce),_e.checkRoom(Te.real_roomid,ce));break;case'PK_BATTLE_SETTLE_USER':Te.data.winner?_e.checkRoom(Te.data.winner.room_id,ce):_e.checkRoom(Te.data.my_info.room_id,ce),_e.checkRoom(Te.data.winner.room_id,ce);break;case'NOTICE_MSG':switch(Te.msg_type){case 1:break;case 2:case 3:case 4:case 8:Te.roomid===Te.real_roomid?_e.checkRoom(Te.roomid,ce):(_e.checkRoom(Te.roomid,ce),_e.checkRoom(Te.real_roomid,ce));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+Te.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),_e.Storm.run(Te.roomid);}break;case'SPECIAL_GIFT':if(Te.data[39])switch(Te.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+Te.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),_e.Storm.run(Te.roomid);case'end':};break;default:}})},function(){_e.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(ge){var ue=[];try{var ce=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));ue=[].concat(ce.list),ue.push(ge),100<ue.length&&ue.splice(0,50),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:ue})),F(N+'_EntryRoom_list_add',ue)}catch(ce){ue.push(ge),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:ue}))}},isIn:function isIn(ge){var ue=[];try{var ce=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));return ue=null===ce?[]:[].concat(ce.list),F(N+'_EntryRoom_list_read',ce),-1<ue.indexOf(ge)}catch(ce){return localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:ue})),F('\u8BFB\u53D6'+(N+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ue.indexOf(ge)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(ge){var ue=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';_e.blocked||_e.max_blocked||0<=_e.RoomId_list.indexOf(ge)||(_e.RoomId_list.push(ge),_e.EntryRoom_list_history.isIn(ge)||(A.room.room_entry_action(ge),_e.EntryRoom_list_history.add(ge)),f(_e.CONFIG.RANDOM_SEND_DANMU)&&A.sendLiveDanmu(_e.auto_danmu_list[_Mathfloor(12*Math.random())],ge).then(function(ce){F('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',ce)}),A.xlive.lottery.check(ge).then(function(ce){_e.RoomId_list.remove(ge),F('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',ce);var pe=ce.data;if(0===ce.code){var Ie;if(pe.gift)for(var Te in Ie=pe.gift,Ie)Ie.hasOwnProperty(Te)&&_e.creat_join(ge,Ie[Te],'gift',ue);if(pe.guard)for(var Te in Ie=pe.guard,Ie)Ie.hasOwnProperty(Te)&&_e.creat_join(ge,Ie[Te],'guard',ue);if(pe.pk)for(var Te in Ie=pe.pk,Ie)Ie.hasOwnProperty(Te)&&_e.creat_join(ge,Ie[Te],'pk',ue)}else _e.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<_e.err_roomId.indexOf(ge)?F('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+ge+ce.message):(_e.err_roomId.push(ge),_e.checkRoom(ge,ue),F('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+ge+ce.message))}))},Id_list_history:{add:function add(ge,ue){var ce=[];try{var pe=JSON.parse(localStorage.getItem(N+'_'+ue+'Id_list'));ce=[].concat(pe.list),ce.push(ge),200<ce.length&&ce.splice(0,50),localStorage.setItem(N+'_'+ue+'Id_list',JSON.stringify({list:ce})),F(N+'_'+ue+'Id_list_add',ce)}catch(pe){ce.push(ge),localStorage.setItem(N+'_'+ue+'Id_list',JSON.stringify({list:ce}))}},isIn:function isIn(ge,ue){var ce=[];try{var pe=JSON.parse(localStorage.getItem(N+'_'+ue+'Id_list'));return ce=null===pe?[]:[].concat(pe.list),F(N+'_'+ue+'Id_list_read',pe),-1<ce.indexOf(ge)}catch(pe){return localStorage.setItem(N+'_'+ue+'Id_list',JSON.stringify({list:ce})),F('\u8BFB\u53D6'+(N+'_'+ue+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ce.indexOf(ge)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(ge,ue,ce){var pe=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(F('\u793C\u7269\u4FE1\u606F',ue),_e.GIFT_COUNT.COUNT>=_e.CONFIG.MAX_GIFT)return F('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(_e.max_blocked=!0);switch(ce){case'gift':if(_e.Id_list_history.isIn(ue.raffleId,'raffle'))return void F('\u793C\u7269\u91CD\u590D','raffleId '+ue.raffleId);_e.raffleId_list.push(ue.raffleId),_e.Id_list_history.add(ue.raffleId,'raffle');break;case'guard':if(_e.Id_list_history.isIn(ue.id,'guard'))return void F('\u8230\u957F\u91CD\u590D','id '+ue.id);_e.guardId_list.push(ue.id),_e.Id_list_history.add(ue.id,'guard');break;case'pk':if(_e.Id_list_history.isIn(ue.id,'pk'))return void F('pk\u91CD\u590D','id '+ue.id);_e.pkId_list.push(ue.id),_e.Id_list_history.add(ue.id,'pk');}var Ie=ue.time_wait||0;_e.CONFIG.RANDOM_DELAY&&(Ie+=_Mathfloor(Math.random()*(_e.CONFIG.RND_DELAY_END-_e.CONFIG.RND_DELAY_START+1))+_e.CONFIG.RND_DELAY_START);var Te=$('<div class=\'igiftMsg\'>'),fe=$('<div>'),me=$('<div>'),Oe=$('#chat-history-list'),Ee=new Date;fe.text('['+pe+']'+ue.thank_text.split('<%')[1].split('%>')[0]+ue.thank_text.split('%>')[1]),Te.text(Ee.toLocaleString()),Te.append(fe),me.css('color','red'),me.text('\u7B49\u5F85\u62BD\u5956'),fe.append(me),Te.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),fe.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),Te.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),'show'==X?Oe.find('#chat-items').append(Te):Oe.find('#chat-items').append(Te.hide()),Oe.scrollTop(Oe.prop('scrollHeight'));var ve=setInterval(function(){me.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+Ie+'\u79D2'),0>=Ie&&(f(_e.CONFIG.RANDOM_SKIP)?me.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(me.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===ce?_e.gift_join(ge,ue.raffleId,ue.type).then(function(xe,he){me.text(xe),he&&(-1<xe.indexOf('\u8FA3\u6761')?_e.addGift(he):-1<xe.indexOf('\u94F6\u74DC\u5B50')&&_e.addSilver(he)),_e.raffleId_list.remove(ue.raffleId)}):'guard'===ce?_e.guard_join(ge,ue.id).then(function(xe,he){me.text(xe),he&&(-1<xe.indexOf('\u8FA3\u6761')?_e.addGift(he):-1<xe.indexOf('\u94F6\u74DC\u5B50')&&_e.addSilver(he)),_e.guardId_list.remove(ue.id)}):'pk'===ce?_e.pk_join(ge,ue.id).then(function(xe,he){me.text(xe),he&&(-1<xe.indexOf('\u8FA3\u6761')?_e.addGift(he):-1<xe.indexOf('\u94F6\u74DC\u5B50')&&_e.addSilver(he)),_e.pkId_list.remove(ue.id)}):void 0),me.css('color','green'),clearInterval(ve)),Ie--},1e3)},gift_join:function gift_join(ge,ue,ce){var pe=$.Deferred();return A.Lottery.Gift.join(ge,ue,ce).then(function(Ie){switch(F('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',Ie),Ie.code){case 0:Ie.data.award_text?pe.resolve(Ie.data.award_text,Ie.data.award_num):pe.resolve(Ie.data.award_name+'X'+Ie.data.award_num.toString(),Ie.data.award_num);break;default:-1<Ie.msg.indexOf('\u62D2\u7EDD')?!1==_e.CONFIG.FORCE_LOTTERY?(_e.blocked=!0,pe.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++K?_e.gift_join(ge,ue,ce):(K=0,pe.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ge+',id='+ue+',type='+ce+')'+Ie.msg)):pe.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ge+',id='+ue+',type='+ce+')'+Ie.msg);}}),pe},guard_join:function guard_join(ge,ue){var ce=$.Deferred();return A.Lottery.Guard.join(ge,ue).then(function(pe){switch(F('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',pe),pe.code){case 0:pe.data.award_text?ce.resolve(pe.data.award_text,pe.data.award_num):ce.resolve(pe.data.award_name+'X'+pe.data.award_num.toString(),pe.data.award_num);break;default:-1<pe.msg.indexOf('\u62D2\u7EDD')?!1==_e.CONFIG.FORCE_LOTTERY?(_e.blocked=!0,ce.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++Q?_e.guard_join(ge,id):(Q=0,ce.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ge+',id='+raffleId+',type='+type+')'+pe.msg)):ce.resolve('[\u4E0A\u8239](roomid='+ge+',id='+ue+')'+pe.msg);}}),ce},pk_join:function pk_join(ge,ue){var ce=$.Deferred();return A.Lottery.Pk.join(ge,ue).then(function(pe){switch(F('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',pe),pe.code){case 0:pe.data.award_text?ce.resolve(pe.data.award_text,pe.data.award_num):ce.resolve(pe.data.award_name+'X'+pe.data.award_num.toString(),pe.data.award_num);break;default:-1<pe.msg.indexOf('\u62D2\u7EDD')?!1==_e.CONFIG.FORCE_LOTTERY?(_e.blocked=!0,ce.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++z?_e.pk_join(ge,id):(z=0,ce.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ge+',id='+raffleId+',type='+type+')'+pe.msg)):ce.resolve('[PK](roomid='+ge+',id='+ue+')'+pe.msg);}}),ce},GroupSign:{getGroups:function getGroups(){return A.Group.my_groups().then(function(ge){return(F('GroupSign.getGroups: API.Group.my_groups',ge),0===ge.code)?$.Deferred().resolve(ge.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+ge.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.GroupSign.getGroups()})})},signInList:function signInList(ge){var ue=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(ue>=ge.length)return $.Deferred().resolve();var ce=ge[ue];return ce.owner_uid==ie.uid?GroupSign.signInList(ge,ue+1):A.Group.sign_in(ce.group_id,ce.owner_uid).then(function(pe){F('GroupSign.signInList: API.Group.sign_in',pe);var Ie=$.Deferred();if(0===pe.code)0<pe.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ce.group_id+',owner_uid='+ce.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+pe.data.add_num,'success'),Ie.resolve()):0==pe.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ce.group_id+',owner_uid='+ce.owner_uid+')\u5DF2\u7B7E\u5230','caution'),Ie.resolve()):Ie.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+pe.msg,'caution'),$.Deferred().reject();return $.when(_e.GroupSign.signInList(ge,ue+1),Ie)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ce.group_id+',owner_uid='+ce.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.GroupSign.signInList(ge,ue)})})},run:function run(){try{return _e.CONFIG.AUTO_GROUP_SIGN?se(_e.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=_e.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(_e.GroupSign.run,_(8,0)),$.Deferred().resolve()):_e.GroupSign.getGroups().then(function(ge){return _e.GroupSign.signInList(ge).then(function(){return _e.CACHE.AUTO_GROUP_SIGH_TS=R(),_e.saveCache(),k(_e.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return L(function(){return _e.GroupSign.run()})})},function(){return L(function(){return _e.GroupSign.run()})}):(k(_e.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(ge){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',ge),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return A.DailyReward.login().then(function(){F('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.DailyReward.login()})})},watch:function watch(ge,ue){return _e.CONFIG.WATCH?A.DailyReward.watch(ge,ue,ie.uid,M()).then(function(ce){F('DailyReward.watch: API.DailyReward.watch',ce),0===ce.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+ge+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+ce.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.DailyReward.watch(ge,ue)})}):$.Deferred().resolve()},coin:function coin(ge,ue){var ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,pe=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!_e.CONFIG.COIN)return $.Deferred().resolve();if(_e.DailyReward.coin_exp>=10*_e.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(ce>=ge.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var Ie=JSON.parse(ge[ce].card),Te=_Mathmin(2,ue);pe&&(Te=1),A.x.getCoinInfo('','jsonp',Ie.aid,R()).then(function(fe){return 2===fe.data.multiply?(F('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+Ie.aid),_e.DailyReward.coin(vlist,ue,ce+1)):A.DailyReward.coin(Ie.aid,Te).then(function(me){return(F('DailyReward.coin: API.DailyReward.coin',me),0===me.code)?(_e.DailyReward.coin_exp+=10*Te,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+Ie.aid+',num='+Te+')','success'),_e.DailyReward.coin(ge,ue-Te,ce+1)):-110===me.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===me.code?pe?_e.DailyReward.coin(ge,ue,ce+1):_e.DailyReward.coin(ge,ue,ce,!0):34005===me.code?_e.DailyReward.coin(ge,ue,ce+1):-104===me.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+me.msg,'caution'),_e.DailyReward.coin(ge,ue,ce+1))},function(){return L(function(){return _e.DailyReward.coin(ge,ue,ce)})})})},coin_uid:function coin_uid(ge,ue,ce,pe){var Ie=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,Te=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!_e.CONFIG.COIN)return $.Deferred().resolve();if(_e.DailyReward.coin_exp>=10*_e.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();Ie>=ge.length&&_e.DailyReward.UserSpace(_e.CONFIG.COIN_UID,30,0,ce++,'','pubdate','jsonp');var fe=ge[Ie];if(1===fe.is_union_video||fe.mid!=pe)return F('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+fe.aid),_e.DailyReward.coin_uid(ge,ue,ce,pe,Ie+1);var me=_Mathmin(2,ue);Te&&(me=1),A.x.getCoinInfo('','jsonp',fe.aid,R()).then(function(Oe){return 2===Oe.data.multiply?(F('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+fe.aid),_e.DailyReward.coin_uid(ge,ue,ce,pe,Ie+1)):A.DailyReward.coin(fe.aid,me).then(function(Ee){return(F('DailyReward.coin_uid: API.DailyReward.coin_uid',Ee),0===Ee.code)?(_e.DailyReward.coin_exp+=10*me,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+fe.aid+',num='+me+')','success'),_e.DailyReward.coin_uid(ge,ue-me,ce,pe,Ie+1)):-110===Ee.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===Ee.code?Te?_e.DailyReward.coin_uid(ge,ue,ce,pe,Ie+1):_e.DailyReward.coin_uid(ge,ue,Ie,ce,pe,!0):34005===Ee.code?_e.DailyReward.coin_uid(ge,ue,ce,pe,Ie+1):-104===Ee.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+Ee.msg,'caution'),_e.DailyReward.coin_uid(ge,ue,ce,pe,Ie+1))},function(){return L(function(){return _e.DailyReward.coin_uid(ge,ue,ce,pe,Ie)})})})},share:function share(ge){return _e.CONFIG.SHARE?A.DailyReward.share(ge).then(function(ue){F('DailyReward.share: API.DailyReward.share',ue),0===ue.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+ge+')','success'):71000===ue.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+ue.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.DailyReward.share(ge)})}):$.Deferred().resolve()},dynamic:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce,pe;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return ce=void 0,pe=_e.CONFIG.COIN_NUMBER-_e.DailyReward.coin_exp/10,Te.next=4,A.getuserinfo().then(function(fe){return F('DailyReward.dynamic: API.getuserinfo',fe),fe.data.biliCoin<pe?fe.data.biliCoin:pe});case 4:return ce=Te.sent,ce<pe&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+ce+'\u4E2A\u5E01','warning'),Te.abrupt('return',A.dynamic_svr.dynamic_new(ie.uid,8).then(function(fe){if(F('DailyReward.dynamic: API.dynamic_svr.dynamic_new',fe),0===fe.code){if(!!fe.data.cards){var Ee,me=JSON.parse(fe.data.cards[0].card),Oe=_e.DailyReward.watch(me.aid,me.cid);Ee=0==_e.CONFIG.COIN_UID||'COIN_DYN'==_e.CONFIG.COIN_TYPE?_e.DailyReward.coin(fe.data.cards,_Mathmax(ce,0)):_e.DailyReward.UserSpace(_e.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var ve=_e.DailyReward.share(me.aid);return $.when(Oe,Ee,ve)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+fe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.DailyReward.dynamic()})}));case 7:case'end':return Te.stop();}},ue,de)}));return function dynamic(){return ge.apply(this,arguments)}}(),UserSpace:function UserSpace(ge,ue,ce,pe,Ie,Te,fe){return A.x.getUserSpace(ge,ue,ce,pe,Ie,Te,fe).then(function(me){if(F('DailyReward.UserSpace: API.dynamic_svr.UserSpace',me),0===me.code){if(!!me.data.list.vlist){var Oe=_e.CONFIG.COIN_NUMBER-_e.DailyReward.coin_exp/10,Ee=_e.DailyReward.coin_uid(me.data.list.vlist,_Mathmax(Oe,0),pe,ge);return Ee}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+me.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.DailyReward.UserSpace(ge,ue,ce,pe,Ie,Te,fe)})})},run:function run(){try{return se(_e.CACHE.DailyReward_TS)?A.DailyReward.exp().then(function(ge){return F('DailyReward.run: API.DailyReward.exp',ge),0===ge.code?(_e.DailyReward.coin_exp=ge.number,_e.DailyReward.login(),_e.DailyReward.dynamic().then(function(){_e.CACHE.DailyReward_TS=R(),_e.saveCache(),U(_e.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+ge.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.DailyReward.run()})}):(U(_e.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(ge){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',ge),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return A.xlive.dosign().then(function(ge){F('LiveReward.dailySignIn: API.xlive.dosign',ge),0===ge.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===ge.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+ge.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.LiveReward.dailySignIn()})})},run:function run(){try{if(!_e.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!se(_e.CACHE.LiveReward_TS))return U(_e.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();_e.LiveReward.dailySignIn(),_e.CACHE.LiveReward_TS=R(),_e.saveCache(),U(_e.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(ge){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',ge),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return A.Exchange.silver2coin().then(function(ge){F('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',ge),0===ge.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+ge.msg,'success'):403===ge.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+ge.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+ge.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return _e.CONFIG.SILVER2COIN?se(_e.CACHE.Silver2Coin_TS)?_e.Exchange.silver2coin().then(function(){_e.CACHE.Silver2Coin_TS=R(),_e.saveCache(),U(_e.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return L(function(){return _e.Exchange.runS2C()})}):(U(_e.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(ge){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',ge),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!_e.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var ge=$.Deferred();return S(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),ge.resolve(),!0;var ue=$('#gift-control-vm div.treasure-box.p-relative');if(!ue.length)return!1;ue=ue.first(),ue.attr('id','old_treasure_box'),ue.hide();var ce=$('<div id="'+N+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');_e.TreasureBox.DOM.div_tip=$('<div id="'+N+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),_e.TreasureBox.DOM.div_timer=$('<div id="'+N+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),_e.TreasureBox.DOM.image=$('<img id="'+N+'_treasure_image" style="display:none">'),_e.TreasureBox.DOM.canvas=$('<canvas id="'+N+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var pe='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';_e.TreasureBox.DOM.div_tip[0].style=pe,_e.TreasureBox.DOM.div_timer[0].style=pe,ce.append(_e.TreasureBox.DOM.div_tip),ce.append(_e.TreasureBox.DOM.image),ce.append(_e.TreasureBox.DOM.canvas),_e.TreasureBox.DOM.div_tip.after(_e.TreasureBox.DOM.div_timer),ue.after(ce);try{if(OCRAD);}catch(Ie){return _e.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+N+']',Ie),ge.resolve(),!0}return _e.TreasureBox.timer=setInterval(function(){var Ie=parseInt(_e.TreasureBox.DOM.div_timer.text(),10);isNaN(Ie)&&(Ie=0),0<Ie?_e.TreasureBox.DOM.div_timer.text(Ie-1+'s'):_e.TreasureBox.DOM.div_timer.hide()},1e3),_e.TreasureBox.DOM.image[0].onload=function(){var Ie=_e.TreasureBox.DOM.canvas[0].getContext('2d');Ie.font='40px agencyfbbold',Ie.textBaseline='top',Ie.clearRect(0,0,_e.TreasureBox.DOM.canvas[0].width,_e.TreasureBox.DOM.canvas[0].height),Ie.drawImage(_e.TreasureBox.DOM.image[0],0,0);var Te=_e.TreasureBox.captcha.OCR.getGrayscaleMap(Ie),fe=_e.TreasureBox.captcha.OCR.orderFilter2In3x3(Te);Ie.clearRect(0,0,120,40);for(var Oe,me=0;me<fe.length;++me)Oe=fe[me],Ie.fillStyle='rgb('+Oe+', '+Oe+', '+Oe+')',Ie.fillRect(me%120,_Mathround(me/120),1,1);try{var me=_e.TreasureBox.captcha.correctQuestion(OCRAD(Ie.getImageData(0,0,120,40)));F('TreasureBox.DOM.image.load','question =',me);var Oe=_e.TreasureBox.captcha.eval(me);F('TreasureBox.DOM.image.load','answer =',Oe),void 0!==Oe&&(console.info('['+N+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+me+' = '+Oe),_e.TreasureBox.promise.calc.resolve(Oe))}catch(me){_e.TreasureBox.promise.calc.reject()}},ge.resolve(),!0}catch(ue){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',ue),ge.reject(),!0}}),ge},run:function run(){try{if(!_e.CONFIG.AUTO_TREASUREBOX||!_e.TreasureBox.timer)return;if(ie.blocked)return _e.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!se(_e.CACHE.TreasureBox_TS))return _e.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void U(_e.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');_e.TreasureBox.getCurrentTask().then(function(ge){if(F('TreasureBox.run: TreasureBox.getCurrentTask().then',ge),0===ge.code){_e.TreasureBox.promise.timer=$.Deferred(),_e.TreasureBox.promise.timer.then(function(){_e.TreasureBox.captcha.calc().then(function(ce){_e.TreasureBox.getAward(ce).then(function(){return _e.TreasureBox.run()},function(){return _e.TreasureBox.run()})},function(){return TreasureBox.run()})}),_e.TreasureBox.time_end=ge.data.time_end,_e.TreasureBox.time_start=ge.data.time_start;var ue=_e.TreasureBox.time_end-M()+1;0>ue&&(ue=0),setTimeout(function(){_e.TreasureBox.promise.timer&&_e.TreasureBox.promise.timer.resolve()},1e3*ue),_e.TreasureBox.DOM.div_timer.text(ue+'s'),_e.TreasureBox.DOM.div_timer.show(),_e.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+ge.data.times+'/'+ge.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+ge.data.silver)}else if(-10017===ge.code)_e.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),_e.CACHE.TreasureBox_TS=R(),_e.saveCache(),U(_e.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===ge.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ge.msg,'caution'),_e.TreasureBox.run()})}catch(ge){_e.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',ge)}},setMsg:function setMsg(ge){_e.CONFIG.AUTO_TREASUREBOX&&(_e.TreasureBox.promise.timer&&(_e.TreasureBox.promise.timer.reject(),_e.TreasureBox.promise.timer=void 0),_e.TreasureBox.DOM.div_timer&&_e.TreasureBox.DOM.div_timer.hide(),_e.TreasureBox.DOM.div_tip&&_e.TreasureBox.DOM.div_tip.html(ge))},getAward:function getAward(ge){var ue=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return _e.CONFIG.AUTO_TREASUREBOX?3<ue?$.Deferred().resolve():A.TreasureBox.getAward(_e.TreasureBox.time_start,_e.TreasureBox.time_end,ge).then(function(){var ce=_asyncToGenerator(regeneratorRuntime.mark(function pe(Ie){var Te;return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:F('TreasureBox.getAward: getAward',Ie),me.t0=Ie.code,me.next=0===me.t0?4:-903===me.t0?5:-902===me.t0?6:-901===me.t0?6:-10017===me.t0?6:-800===me.t0?9:-500===me.t0?12:400===me.t0?15:22;break;case 4:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+Ie.data.awardSilver+' \u94F6\u74DC\u5B50','success');case 5:return me.abrupt('return',$.Deferred().resolve());case 6:return me.next=8,T(150);case 8:return me.abrupt('return',_e.TreasureBox.captcha.calc().then(function(Oe){return _e.TreasureBox.getAward(Oe,ue)}));case 9:return _e.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),me.abrupt('return',$.Deferred().reject());case 12:return Te=$.Deferred(),setTimeout(function(){_e.TreasureBox.captcha.calc().then(function(Oe){_e.TreasureBox.getAward(Oe,ue+1).then(function(){return Te.resolve()},function(){return Te.reject()})},function(){return Te.reject()})},3e3),me.abrupt('return',Te);case 15:if(!(-1<Ie.msg.indexOf('\u62D2\u7EDD'))){me.next=20;break}return ie.blocked=!0,_e.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),me.abrupt('return',$.Deferred().reject());case 20:return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Ie.msg,'caution'),me.abrupt('return',$.Deferred().resolve());case 22:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Ie.msg,'caution');case 23:case'end':return me.stop();}},pe,de)}));return function(){return ce.apply(this,arguments)}}(),function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.TreasureBox.getAward(ge,ue)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return _e.CONFIG.AUTO_TREASUREBOX?A.TreasureBox.getCurrentTask().then(function(ge){return F('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',ge),$.Deferred().resolve(ge)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return _e.CONFIG.AUTO_TREASUREBOX?20<_e.TreasureBox.captcha.cnt?(_e.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):A.TreasureBox.getCaptcha(R()).then(function(ge){if(F('TreasureBox.captcha.calc: getCaptcha',ge),0===ge.code){_e.TreasureBox.captcha.cnt++;var ue=$.Deferred();return _e.TreasureBox.promise.calc=$.Deferred(),_e.TreasureBox.promise.calc.then(function(ce){_e.TreasureBox.captcha.cnt=0,ue.resolve(ce)},function(){_e.TreasureBox.captcha.calc().then(function(ce){ue.resolve(ce)},function(){ue.reject()})}),_e.TreasureBox.DOM.image.attr('src',ge.data.img),ue}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ge.msg,'caution'),L(function(){return _e.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.TreasureBox.captcha.calc()})}):(_e.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(ge){for(var ue=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,pe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,Ie=ge.getImageData(0,0,ce,pe).data,Te=[],fe=0;fe<pe;fe++)for(var me=0;me<ce;me++){var Oe=4*(fe*ce+me),Ee=Ie.slice(Oe,Oe+4),ve=Ee?77*Ee[0]+150*Ee[1]+29*Ee[2]+128>>8:0;Te.push(ve>ue?ve:0)}return Te},orderFilter2In3x3:function orderFilter2In3x3(ge){for(var ue=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,pe=function gray(ve,xe){return 0<=ve+xe*ce?ge[ve+xe*ce]:255},Ie=[],Te=ge.length,ve=0;ve<Te;++ve){var me=[ve%ce,_Mathfloor(ve/ce)],Oe=me[0],Ee=me[1],xe=Array(9);xe[0]=pe(Oe-1,Ee-1),xe[1]=pe(Oe+0,Ee-1),xe[2]=pe(Oe+1,Ee-1),xe[3]=pe(Oe-1,Ee+0),xe[4]=pe(Oe+0,Ee+0),xe[5]=pe(Oe+1,Ee+0),xe[6]=pe(Oe-1,Ee+1),xe[7]=pe(Oe+0,Ee+1),xe[8]=pe(Oe+1,Ee+1),xe.sort(function(he,Ne){return he-Ne}),Ie.push(xe[ue-1])}return Ie}},eval:function _eval(ge){var ue=Function;return new ue('return '+ge)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(ge){var ue='';for(var ce in ge=ge.trim(),ge){var pe=_e.TreasureBox.captcha.correctStr[ge[ce]];ue+=void 0===pe?ge[ce]:pe}'4'===ue[2]&&(ue[2]='+');for(var ce=0;ce<=parseInt(ue.length-2);ce++)'\''===ue[ce]&&'1'===ue[ce+1]&&(ue[ce]='7',ue.splice(ce+1,1));return ue}}},Gift:(le={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(le,'run_timer',void 0),_defineProperty(le,'sendGiftList',[1,6,30607]),_defineProperty(le,'getMedalList',function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return 1===ce&&(_e.Gift.medal_list=[]),Ie.next=3,A.i.medal(ce,25).then(function(Te){if(F('Gift.getMedalList: API.i.medal',Te),_e.Gift.medal_list=_e.Gift.medal_list.concat(Te.data.fansMedalList),Te.data.pageinfo.curPage<Te.data.pageinfo.totalpages)return _e.Gift.getMedalList(ce+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.Gift.getMedalList()})});case 3:return Ie.abrupt('return',Ie.sent);case 4:case'end':return Ie.stop();}},ue,de)}));return function getMedalList(){return ge.apply(this,arguments)}}()),_defineProperty(le,'getBagList',function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,A.gift.bag_list().then(function(Ie){F('Gift.getBagList: API.gift.bag_list',Ie),_e.Gift.bag_list=Ie.data.list,_e.Gift.time=Ie.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.Gift.getBagList()})});case 2:return pe.abrupt('return',pe.sent);case 3:case'end':return pe.stop();}},ue,de)}));return function getBagList(){return ge.apply(this,arguments)}}()),_defineProperty(le,'getFeedByGiftID',function getFeedByGiftID(ge){if(30607===ge)return 50;for(var ue=ie.gift_list.length-1;0<=ue;--ue)if(ie.gift_list[ue].id===ge)return _Mathceil(ie.gift_list[ue].price/100);return 0}),_defineProperty(le,'sort_medals',function sort_medals(ge){if('high'==_e.CONFIG.GIFT_SORT?ge.sort(function(me,Oe){return 0==Oe.level-me.level?Oe.intimacy-me.intimacy:Oe.level-me.level}):ge.sort(function(me,Oe){return 0==me.level-Oe.level?me.intimacy-Oe.intimacy:me.level-Oe.level}),_e.CONFIG.AUTO_GIFT_ROOMID&&0<_e.CONFIG.AUTO_GIFT_ROOMID.length){var me=_e.CONFIG.AUTO_GIFT_ROOMID;me.reverse();var ue=!0,ce=!1,pe=void 0;try{for(var fe,Ie=function _loop2(){var Oe=fe.value,Ee=ge.findIndex(function(ve){return ve.roomid==Oe});if(-1!=Ee){var ve=ge[Ee];ge.splice(Ee,1),ge.unshift(ve)}},Te=me[Symbol.iterator]();!(ue=(fe=Te.next()).done);ue=!0)Ie()}catch(Oe){ce=!0,pe=Oe}finally{try{!ue&&Te.return&&Te.return()}finally{if(ce)throw pe}}}return ge}),_defineProperty(le,'auto_light',function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(ce){var pe,Ie,Te,fe,me,Oe,Ee,ve,xe,he,Ne,Ce,Ae,ye,Ge,De;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:Me.prev=0,pe=_e.Gift.getFeedByGiftID(30607),Ie=_e.CONFIG.LIGHT_MEDALS,Te=void 0,Te='LIGHT_WHITE'==_e.CONFIG.LIGHT_METHOD?ce.filter(function(be){return 0==be.is_lighted&&be.day_limit-be.today_feed>=pe&&0<=Ie.findIndex(function(Se){return Se==be.roomid})}):ce.filter(function(be){return 0==be.is_lighted&&be.day_limit-be.today_feed>=pe&&-1==Ie.findIndex(function(Se){return Se==be.roomid})});;if(F('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',Te),!(Te&&0<Te.length)){Me.next=52;break}return Te=_e.Gift.sort_medals(Te),Me.next=11,_e.Gift.getBagList();case 11:if(fe=_e.Gift.bag_list.filter(function(be){return 30607==be.gift_id}),!(fe&&0<fe.length)){Me.next=52;break}me=!0,Oe=!1,Ee=void 0,Me.prev=16,ve=Te[Symbol.iterator]();case 18:if(me=(xe=ve.next()).done){Me.next=38;break}if(he=xe.value,Ne=fe.find(function(be){return 30607==be.gift_id&&0<be.gift_num}),!Ne){Me.next=34;break}if(Ce=he.day_limit-he.today_feed,!(0<=Ce-pe||_e.CONFIG.FORCE_LIGHT)){Me.next=33;break}return Me.next=26,A.room.room_init(parseInt(he.roomid,10));case 26:return Ae=Me.sent,ye=parseInt(Ae.data.room_id,10),Ge=1,Me.next=31,A.gift.bag_send(ie.uid,30607,he.target_id,Ge,Ne.bag_id,ye,ie.rnd);case 31:De=Me.sent,0===De.code?(Ne.gift_num-=Ge,he.today_feed+=Ge*pe,Ce-=Ge*pe,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+he.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Ge+'\u4E2A'+Ne.gift_name+'\uFF0C['+he.today_feed+'/'+he.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+Ce+']','success'),F('Gift.auto_light','\u52CB\u7AE0['+he.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Ge+'\u4E2A'+Ne.gift_name+'\uFF0C['+he.today_feed+'/'+he.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+he.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+De.msg+'\u3011','caution');case 33:return Me.abrupt('continue',35);case 34:return Me.abrupt('break',38);case 35:me=!0,Me.next=18;break;case 38:Me.next=44;break;case 40:Me.prev=40,Me.t0=Me['catch'](16),Oe=!0,Ee=Me.t0;case 44:Me.prev=44,Me.prev=45,!me&&ve.return&&ve.return();case 47:if(Me.prev=47,!Oe){Me.next=50;break}throw Ee;case 50:return Me.finish(47);case 51:return Me.finish(44);case 52:Me.next=58;break;case 54:Me.prev=54,Me.t1=Me['catch'](0),console.error(Me.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+Me.t1,'error');case 58:case'end':return Me.stop();}},ue,de,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return ge.apply(this,arguments)}}()),_defineProperty(le,'run',function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce,pe,Ie,Te,fe,me,Oe,Ee,ve,xe,he,Ne,Ce,Ae,ye,Ge;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(ce=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.Gift.run()})},pe=function nextTimeDebug(){if('GIFT_SEND_TIME'==_e.CONFIG.GIFT_METHOD){var Me=_(_e.CONFIG.GIFT_SEND_HOUR,_e.CONFIG.GIFT_SEND_MINUTE);_e.Gift.run_timer=setTimeout(_e.Gift.run,Me);var be=new Date(R()+Me).toLocaleString();F('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+be+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),_e.CACHE.Gift_TS=R(),_e.saveCache()}else F('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+_e.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),_e.CACHE.GiftInterval_TS=R(),_e.saveCache()},Re.prev=2,_e.CONFIG.AUTO_GIFT){Re.next=5;break}return Re.abrupt('return',$.Deferred().resolve());case 5:if(_e.Gift.run_timer&&clearTimeout(_e.Gift.run_timer),'GIFT_SEND_TIME'!=_e.CONFIG.GIFT_METHOD||u(_e.CONFIG.GIFT_SEND_HOUR,_e.CONFIG.GIFT_SEND_MINUTE)||Z||ee){Re.next=14;break}return Ie=_(_e.CONFIG.GIFT_SEND_HOUR,_e.CONFIG.GIFT_SEND_MINUTE),_e.Gift.run_timer=setTimeout(_e.Gift.run,Ie),Te=new Date(R()+Ie).toLocaleString(),F('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Te+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Re.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=_e.CONFIG.GIFT_METHOD||Z||ee){Re.next=27;break}if(fe=6e4*_e.CONFIG.GIFT_INTERVAL,!_e.CACHE.GiftInterval_TS){Re.next=25;break}if(me=R()-_e.CACHE.GiftInterval_TS,!(me<fe)){Re.next=23;break}return Oe=fe-me,_e.Gift.run_timer=setTimeout(_e.Gift.run,Oe),F('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Oe+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Re.abrupt('return');case 23:Re.next=27;break;case 25:_e.CACHE.GiftInterval_TS=R(),_e.saveCache();case 27:return _e.Gift.over=!1,Re.next=30,_e.Gift.getMedalList();case 30:if(Ee=_e.Gift.medal_list,F('Gift.run: Gift.getMedalList().then: Gift.medal_list',Ee),!(Ee&&0<Ee.length)){Re.next=84;break}Ee=Ee.filter(function(Me){return 0<Me.day_limit-Me.today_feed&&20>Me.level}),Ee=_e.Gift.sort_medals(Ee),_e.CONFIG.EXCLUDE_ROOMID&&0<_e.CONFIG.EXCLUDE_ROOMID.length&&(ve=_e.CONFIG.EXCLUDE_ROOMID,Ee=Ee.filter(function(Me){return-1==ve.findIndex(function(be){return be==Me.roomid})}));;return Re.next=39,_e.Gift.auto_light(Ee);case 39:if(!ee){Re.next=42;break}return ee=!1,Re.abrupt('return',$.Deferred().resolve());case 42:xe=!0,he=!1,Ne=void 0,Re.prev=45,Ce=Ee[Symbol.iterator]();case 47:if(xe=(Ae=Ce.next()).done){Re.next=70;break}if(ye=Ae.value,!_e.Gift.over){Re.next=51;break}return Re.abrupt('break',70);case 51:return Re.next=53,A.room.room_init(parseInt(ye.roomid,10));case 53:if(Ge=Re.sent,_e.Gift.room_id=parseInt(Ge.data.room_id,10),_e.Gift.ruid=ye.target_id,_e.Gift.remain_feed=ye.day_limit-ye.today_feed,!(0<_e.Gift.remain_feed)){Re.next=67;break}return Re.next=60,_e.Gift.getBagList();case 60:if(!(0<_e.Gift.remain_feed)){Re.next=66;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ye.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+ye.today_feed+'/'+ye.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+_e.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Re.next=64,_e.Gift.sendGift(ye);case 64:Re.next=67;break;case 66:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ye.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 67:xe=!0,Re.next=47;break;case 70:Re.next=76;break;case 72:Re.prev=72,Re.t0=Re['catch'](45),he=!0,Ne=Re.t0;case 76:Re.prev=76,Re.prev=77,!xe&&Ce.return&&Ce.return();case 79:if(Re.prev=79,!he){Re.next=82;break}throw Ne;case 82:return Re.finish(79);case 83:return Re.finish(76);case 84:return Re.next=86,_e.Gift.sendRemainGift(_e.CONFIG.SPARE_GIFT_ROOM);case 86:Re.next=94;break;case 88:return Re.prev=88,Re.t1=Re['catch'](2),ce(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Re.t1),Re.abrupt('return',$.Deferred().reject());case 94:return Z=!1,pe(),Re.abrupt('return',$.Deferred().resolve());case 97:case'end':return Re.stop();}},ue,de,[[2,88],[45,72,76,84],[77,,79,83]])}));return function run(){return ge.apply(this,arguments)}}()),_defineProperty(le,'sendGift',function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(ce){var pe,Ie,Te,fe,me,Oe,Ee,ve,xe,he;return regeneratorRuntime.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.next=2,_e.Gift.getBagList();case 2:if(pe=void 0,!(0>=_e.Gift.remain_feed)){Ce.next=6;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ce.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+ce.today_feed+'/'+ce.day_limit+']','info'),Ce.abrupt('return',$.Deferred().resolve());case 6:if(0>=_e.Gift.time&&(_e.Gift.time=M()),_e.CONFIG.SEND_ALL_GIFT){Ce.next=18;break}if(Ie=_e.Gift.bag_list.filter(function(Ae){return _e.Gift.sendGiftList.includes(Ae.gift_id)&&0<Ae.gift_num&&Ae.corner_mark.substring(0,Ae.corner_mark.indexOf('\u5929'))<=_e.CONFIG.GIFT_LIMIT}),F('pass',Ie),0!=Ie.length){Ce.next=15;break}return _e.Gift.over=!0,Ce.abrupt('return');case 15:pe=Ie;case 16:Ce.next=25;break;case 18:if(Te=_e.Gift.bag_list.filter(function(Ae){return 0<Ae.gift_num&&'\u6C38\u4E45'!=Ae.corner_mark}),0!=Te.length){Ce.next=24;break}return _e.Gift.over=!0,Ce.abrupt('return');case 24:pe=Te;case 25:F('bag_list',pe),fe=!0,me=!1,Oe=void 0,Ce.prev=29,Ee=regeneratorRuntime.mark(function(){var Ae,ye,Ge;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(Ae=xe.value,!(0>=ce.day_limit-ce.today_feed)){Re.next=4;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ce.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+ce.today_feed+'/'+ce.day_limit+']','info'),Re.abrupt('return',{v:void 0});case 4:if(ye=_e.Gift.getFeedByGiftID(Ae.gift_id),!(0<ye)){Re.next=12;break}if(Ge=_Mathfloor(_e.Gift.remain_feed/ye),Ge>Ae.gift_num&&(Ge=Ae.gift_num),!(0<Ge)){Re.next=12;break}return F('[\u81EA\u52A8\u9001\u793C]\u9001\u51FA\u793C\u7269\u7C7B\u578B',Ae.gift_name),Re.next=12,A.gift.bag_send(ie.uid,Ae.gift_id,_e.Gift.ruid,Ge,Ae.bag_id,_e.Gift.room_id,ie.rnd).then(function(Me){F('Gift.sendGift: API.gift.bag_send',Me),0===Me.code?(Ae.gift_num-=Ge,ce.today_feed+=Ge*ye,_e.Gift.remain_feed-=Ge*ye,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ce.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ge+'\u4E2A'+Ae.gift_name+'\uFF0C['+ce.today_feed+'/'+ce.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+_e.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ce.medalName+'] \u9001\u793C\u5F02\u5E38:'+Me.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.Gift.sendGift(ce)})});case 12:case'end':return Re.stop();}},Ee,de)}),ve=pe[Symbol.iterator]();case 32:if(fe=(xe=ve.next()).done){Ce.next=40;break}return Ce.delegateYield(Ee(),'t0',34);case 34:if(he=Ce.t0,'object'!==('undefined'==typeof he?'undefined':_typeof(he))){Ce.next=37;break}return Ce.abrupt('return',he.v);case 37:fe=!0,Ce.next=32;break;case 40:Ce.next=46;break;case 42:Ce.prev=42,Ce.t1=Ce['catch'](29),me=!0,Oe=Ce.t1;case 46:Ce.prev=46,Ce.prev=47,!fe&&ve.return&&ve.return();case 49:if(Ce.prev=49,!me){Ce.next=52;break}throw Oe;case 52:return Ce.finish(49);case 53:return Ce.finish(46);case 54:case'end':return Ce.stop();}},ue,de,[[29,42,46,54],[47,,49,53]])}));return function sendGift(){return ge.apply(this,arguments)}}()),_defineProperty(le,'sendRemainGift',function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(ce){var pe,Ie,Te,fe,me,Oe,Ee,ve,xe,he;return regeneratorRuntime.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(0!=ce){Ce.next=2;break}return Ce.abrupt('return',$.Deferred().resolve());case 2:return pe=void 0,Ce.next=5,A.live_user.get_anchor_in_room(ce).then(function(Ae){return F('API.live_user.get_anchor_in_room',Ae),Ae.data.info.uid?void(pe=Ae.data.info.uid):(window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u68C0\u67E5\u623F\u95F4\u51FA\u9519'),$.Deferred().reject())});case 5:return Ce.next=7,_e.Gift.getBagList();case 7:if(Ie=void 0,0>=_e.Gift.time&&(_e.Gift.time=M()),_e.CONFIG.SEND_ALL_GIFT){Ce.next=19;break}if(Te=_e.Gift.bag_list.filter(function(Ae){return _e.Gift.sendGiftList.includes(Ae.gift_id)&&0<Ae.gift_num&&'1\u5929'==Ae.corner_mark}),0!=Te.length){Ce.next=16;break}return _e.Gift.over=!0,Ce.abrupt('return');case 16:Ie=Te;case 17:Ce.next=26;break;case 19:if(fe=_e.Gift.bag_list.filter(function(Ae){return 0<Ae.gift_num&&'\u6C38\u4E45'!=Ae.corner_mark}),0!=fe.length){Ce.next=25;break}return _e.Gift.over=!0,Ce.abrupt('return');case 25:Ie=fe;case 26:F('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011bag_list',Ie),me=!0,Oe=!1,Ee=void 0,Ce.prev=30,ve=regeneratorRuntime.mark(function(){var Ae,ye,Ge;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(Ae=he.value,ye=_e.Gift.getFeedByGiftID(Ae.gift_id),!(0<ye)){Re.next=7;break}if(Ge=Ae.gift_num,!(0<Ge)){Re.next=7;break}return Re.next=7,A.gift.bag_send(ie.uid,Ae.gift_id,pe,Ge,Ae.bag_id,ce,ie.rnd).then(function(Me){F('Gift.sendGift: API.gift.bag_send',Me),0===Me.code?(Ae.gift_num-=Ge,window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+ce+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ge+'\u4E2A'+Ae.gift_name,'success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+ce+'] \u9001\u793C\u5F02\u5E38:'+Me.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),L(function(){return _e.Gift.sendGift(medal)})});case 7:case'end':return Re.stop();}},ve,de)}),xe=Ie[Symbol.iterator]();case 33:if(me=(he=xe.next()).done){Ce.next=38;break}return Ce.delegateYield(ve(),'t0',35);case 35:me=!0,Ce.next=33;break;case 38:Ce.next=44;break;case 40:Ce.prev=40,Ce.t1=Ce['catch'](30),Oe=!0,Ee=Ce.t1;case 44:Ce.prev=44,Ce.prev=45,!me&&xe.return&&xe.return();case 47:if(Ce.prev=47,!Oe){Ce.next=50;break}throw Ee;case 50:return Ce.finish(47);case 51:return Ce.finish(44);case 52:case'end':return Ce.stop();}},ue,de,[[30,40,44,52],[45,,47,51]])}));return function sendRemainGift(){return ge.apply(this,arguments)}}()),le),stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(ge){var ue=[];try{var ce=JSON.parse(localStorage.getItem(N+'stormIdSet'));ue=[].concat(ce.list),ue.push(ge),50<ue.length&&ue.splice(0,10),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:ue})),F(N+'storm_Id_list_add',ue)}catch(ce){ue.push(ge),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:ue}))}},isIn:function isIn(ge){var ue=[];try{var ce=JSON.parse(localStorage.getItem(N+'stormIdSet'));return ue=null===ce?[]:[].concat(ce.list),F(N+'storm_Id_list_read',ce),-1<ue.indexOf(ge)}catch(ce){return localStorage.setItem(N+'stormIdSet',JSON.stringify({list:ue})),F('\u8BFB\u53D6'+(N+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ue.indexOf(ge)}}},Storm:{check:function check(ge){return-1<_e.stormQueue.indexOf(ge)},append:function append(ge){_e.stormQueue.push(ge),_e.stormQueue.length>_e.CONFIG.STORM_QUEUE_SIZE&&_e.stormQueue.shift()},over:function over(ge){var ue=_e.stormQueue.indexOf(ge);-1<ue&&_e.stormQueue.splice(ge,1)},run:function run(ge){try{return _e.CONFIG.STORM?_e.stormBlack?$.Deferred().resolve():I(_e.CONFIG.TIME_AREA_START_H0UR,_e.CONFIG.TIME_AREA_END_H0UR,_e.CONFIG.TIME_AREA_START_MINUTE,_e.CONFIG.TIME_AREA_END_MINUTE)&&_e.CONFIG.TIME_AREA_DISABLE?(F('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+ge),$.Deferred().resolve()):A.Storm.check(ge).then(function(ue){if(F('MY_API.Storm.run: MY_API.API.Storm.check',ue),0===ue.code){var ce=ue.data;return _e.Storm.join(ce.id,ce.roomid,_Mathround(new Date().getTime()/1e3)+ce.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+ge+')'+ue.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+ge+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(ue){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',ue),$.Deferred().reject()}},join:function join(ge,ue,ce){var pe=function(){var me=_asyncToGenerator(regeneratorRuntime.mark(function Oe(){var Ee,ve;return regeneratorRuntime.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if(he.prev=0,_e.Storm.check(ge)){he.next=4;break}return clearInterval(Te),he.abrupt('return');case 4:if(Ee=_Mathround(new Date().getTime()/1e3),!(Ee>ce&&0<ce)){he.next=9;break}return _e.Storm.over(ge),clearInterval(Te),he.abrupt('return');case 9:if(fe++,!(fe>_e.CONFIG.STORM_MAX_COUNT&&0<_e.CONFIG.STORM_MAX_COUNT)){he.next=15;break}return _e.Storm.over(ge),clearInterval(Te),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ue+',id='+ge+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+fe+',\u8DDD\u79BB\u5230\u671F:'+(ce-Ee)+'s','caution'),he.abrupt('return');case 15:if(ve=void 0,he.prev=16,!(ae&&H&&ne.access_token)){he.next=23;break}return he.next=20,A.Storm.join_ex(ge,ue,ne.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:ve=he.sent,he.next=26;break;case 23:return he.next=25,A.Storm.join(ge,captcha_token='',captcha_phrase='',ue);case 25:ve=he.sent;case 26:if(F('MY_API.Storm.join: MY_API.API.Storm.join',ve),!ve.code){he.next=51;break}if(-1==ve.msg.indexOf('\u9886\u53D6')){he.next=33;break}return _e.Storm.over(ge),clearInterval(Te),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+ue+',id='+ge+')\u6210\u529F,'+ve.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+fe,'success'),he.abrupt('return');case 33:if(-1==ve.msg.indexOf('\u9A8C\u8BC1\u7801')){he.next=39;break}return _e.Storm.over(ge),clearInterval(Te),_e.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ue+',id='+ge+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+ve.msg,'caution'),he.abrupt('return');case 39:if(!(ve.data&&0==ve.data.length&&-1!=ve.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){he.next=46;break}return _e.Storm.over(ge),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ue+',id='+ge+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(Te),_e.stormBlack=!0,setTimeout(function(){_e.stormBlack=!1},3600000),he.abrupt('return');case 46:if(-1!=ve.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){he.next=49;break}return clearInterval(Te),he.abrupt('return');case 49:he.next=56;break;case 51:return _e.Storm.over(ge),Statistics.appendGift(ve.data.gift_name,ve.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+ue+',id='+ge+')\u6210\u529F,'+(ve.data.gift_name+'x'+ve.data.gift_num)+'\r\n'+ve.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+fe,'success'),clearInterval(Te),he.abrupt('return');case 56:he.next=65;break;case 58:return he.prev=58,he.t0=he['catch'](16),_e.Storm.over(ge),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ue+',id='+ge+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+fe,'error'),console.error(he.t0),clearInterval(Te),he.abrupt('return');case 65:he.next=74;break;case 67:return he.prev=67,he.t1=he['catch'](0),_e.Storm.over(ge),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ue+',id='+ge+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(he.t1),clearInterval(Te),he.abrupt('return');case 74:case'end':return he.stop();}},Oe,this,[[0,67],[16,58]])}));return function(){return me.apply(this,arguments)}}();if(ue=parseInt(ue,10),ge=parseInt(ge,10),isNaN(ue)||isNaN(ge))return $.Deferred().reject();var Ie=_Mathround(ge/1e6);if(_e.stormIdSet.isIn(Ie))return $.Deferred().resolve();if(_e.stormIdSet.add(Ie),!_e.Storm.check(ge)){_e.Storm.append(ge);var Te=0;0>=ce&&(ce=_Mathround(new Date().getTime()/1e3)+90);var fe=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+ue+',id='+ge+')','success'),Te=setInterval(function(){return pe()},_e.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{getInfo:function getInfo(){return O({GM:!0,anonymous:!0,method:'GET',url:'https://passport.bilibili.com/x/passport-login/oauth2/info?'+H.signLoginQuery('access_key='+ne.access_token),responseType:'json',headers:H.headers})},mobileOnline:function mobileOnline(){return O({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+ne.access_token+'&'+B),data:'room_id='+ie.room_id+'&scale=xxhdpi',responseType:'json',headers:H.headers})},RandomHex:function RandomHex(ge){var ue='0123456789abcdef',ce='';ce+=ue[_Mathfloor(15*Math.random())+1];for(var pe=0;pe<ge-1;pe++)ce+=ue[_Mathfloor(16*Math.random())];return ce},uuid:function uuid(){return _e.LITTLE_HEART.RandomHex(32).replace(/(\w{8})(\w{4})\w(\w{3})\w(\w{3})(\w{12})/,'$1-$2-4$3-'+'89ab'[_Mathfloor(4*Math.random())]+'$4-$5')},getFansMedal:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce;return regeneratorRuntime.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,O({GM:!0,anonymous:!0,method:'GET',url:'https://api.live.bilibili.com/fans_medal/v1/FansMedal/get_list_in_room?'+BilibiliToken.signQuery('access_key='+ne.access_token+'&target_id='+ie.tid+'&uid='+ie.uid+'&'+B),responseType:'json',headers:H.headers});case 2:if(ce=Ie.sent,void 0===ce||200!==ce.response.status){Ie.next=7;break}if(0!==ce.body.code){Ie.next=7;break}if(!(0<ce.body.data.length)){Ie.next=7;break}return Ie.abrupt('return',ce.body.data);case 7:case'end':return Ie.stop();}},ue,de)}));return function getFansMedal(){return ge.apply(this,arguments)}}(),getGiftNum:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce;return regeneratorRuntime.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return ce=0,Ie.next=3,A.gift.bag_list().then(function(Te){F('[\u5C0F\u5FC3\u5FC3]\u68C0\u67E5\u5305\u88F9',Te);var fe=Te.data.list.filter(function(he){return 30607==he.gift_id&&'7\u5929'==he.corner_mark}),me=!0,Oe=!1,Ee=void 0;try{for(var xe,he,ve=fe[Symbol.iterator]();!(me=(xe=ve.next()).done);me=!0)he=xe.value,ce+=he.gift_num}catch(he){Oe=!0,Ee=he}finally{try{!me&&ve.return&&ve.return()}finally{if(Oe)throw Ee}}});case 3:return F('[\u5C0F\u5FC3\u5FC3]\u68C0\u6D4B\u5230\u5305\u88F9\u51857\u5929\u5C0F\u5FC3\u5FC3\u6570\u91CF',ce),Ie.abrupt('return',ce);case 5:case'end':return Ie.stop();}},ue,de)}));return function getGiftNum(){return ge.apply(this,arguments)}}(),mobileHeartBeat:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(ce){var pe,Ie,Te,fe,me,Oe;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return pe=new WasmHash,ve.next=3,pe.init();case 3:for(me in Ie=function clientSign(xe){return pe.hash('BLAKE2b512',pe.hash('SHA3-384',pe.hash('SHA384',pe.hash('SHA3-512',pe.hash('SHA512',JSON.stringify(xe))))))},Te=Ie(ce),fe='',ce)fe+=me+'='+encodeURIComponent(ce[me])+'&';return fe+='client_sign='+Te,ve.next=10,O({GM:!0,anonymous:!0,method:'POST',url:'https://live-trace.bilibili.com/xlive/data-interface/v1/heartbeat/mobileHeartBeat',data:BilibiliToken.signQuery('access_key='+ne.access_token+'&'+fe+'&'+B),responseType:'json',headers:H.headers});case 10:if(Oe=ve.sent,void 0===Oe||200!==Oe.response.status){ve.next=14;break}if(0!==Oe.body.code){ve.next=14;break}return ve.abrupt('return',!0);case 14:return ve.abrupt('return',!1);case 15:case'end':return ve.stop();}},ue,de)}));return function mobileHeartBeat(){return ge.apply(this,arguments)}}(),run:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce,pe,Ie,Te,fe,me,Oe,Ee,ve,xe,he,Ne,Ce,Ae,ye,Ge,De;return regeneratorRuntime.wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(_e.CONFIG.LITTLE_HEART){Me.next=2;break}return Me.abrupt('return',$.Deferred().resolve());case 2:if(se(_e.CACHE.LittleHeart_TS)){Me.next=5;break}return U(_e.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3'),Me.abrupt('return',$.Deferred().resolve());case 5:if(ce={platform:'android',uuid:_e.LITTLE_HEART.uuid(),buvid:H.buvid,seq_id:'1',room_id:'{room_id}',parent_id:'6',area_id:'283',timestamp:'{timestamp}',secret_key:'axoaadsffcazxksectbbb',watch_time:'300',up_id:'{target_id}',up_level:'40',jump_from:'30000',gu_id:_e.LITTLE_HEART.RandomHex(43),play_type:'0',play_url:'',s_time:'0',data_behavior_id:'',data_source_id:'',up_session:'l:one:live:record:{room_id}:{last_wear_time}',visit_id:_e.LITTLE_HEART.RandomHex(32),watch_status:'%7B%22pk_id%22%3A0%2C%22screen_status%22%3A1%7D',click_id:_e.LITTLE_HEART.uuid(),session_id:'',player_type:'0',client_ts:'{client_ts}'},pe=function endFunc(){window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6','success'),clearInterval(Te),_e.CACHE.LittleHeart_TS=R(),_e.saveCache(),U(_e.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3')},Me.t0=void 0===ne.access_token,!Me.t0){Me.next=14;break}return Me.next=11,P();case 11:Me.t1=Me.sent,Me.t2=void 0,Me.t0=Me.t1===Me.t2;case 14:if(!Me.t0){Me.next=18;break}return Me.abrupt('return');case 18:if(ne.access_token||ne.mid||ne.refresh_token){Me.next=45;break}return Me.next=21,_e.LITTLE_HEART.getInfo();case 21:if(Ie=Me.sent,F('[\u5C0F\u5FC3\u5FC3]userInfo',Ie),void 0!==Ie){Me.next=25;break}return Me.abrupt('return',console.error(GM_info.script.name,'\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u9519\u8BEF'));case 25:if(Me.t3=0!==Ie.body.code,!Me.t3){Me.next=32;break}return Me.next=29,P();case 29:Me.t4=Me.sent,Me.t5=void 0,Me.t3=Me.t4===Me.t5;case 32:if(!Me.t3){Me.next=36;break}return Me.abrupt('return');case 36:if(Me.t6=Ie.body.data.mid!==ie.uid,!Me.t6){Me.next=43;break}return Me.next=40,P();case 40:Me.t7=Me.sent,Me.t8=void 0,Me.t6=Me.t7===Me.t8;case 43:if(!Me.t6){Me.next=45;break}return Me.abrupt('return');case 45:return F('[\u5C0F\u5FC3\u5FC3]','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),_e.LITTLE_HEART.mobileOnline(),Te=setInterval(function(){return _e.LITTLE_HEART.mobileOnline()},300000),Me.next=50,_e.LITTLE_HEART.getGiftNum();case 50:if(fe=Me.sent,!(24>fe)){Me.next=103;break}return Me.next=54,_e.LITTLE_HEART.getFansMedal();case 54:if(me=Me.sent,void 0===me){Me.next=101;break}Oe=24-fe,Ee=_Mathceil(Oe/me.length),ve=0,xe=0;case 60:if(!(xe<Ee)){Me.next=101;break}he=!0,Ne=!1,Ce=void 0,Me.prev=64,Ae=me[Symbol.iterator]();case 66:if(he=(ye=Ae.next()).done){Me.next=77;break}if(Ge=ye.value,!(ve>=Oe)){Me.next=70;break}return Me.abrupt('break',77);case 70:return De=Object.assign({},ce,{room_id:Ge.room_id.toString(),timestamp:(BilibiliToken.TS-300).toString(),up_id:Ge.target_id.toString(),up_session:'l:one:live:record:'+Ge.room_id+':'+Ge.last_wear_time,client_ts:BilibiliToken.TS.toString()}),Me.next=73,_e.LITTLE_HEART.mobileHeartBeat(De);case 73:ve++;case 74:he=!0,Me.next=66;break;case 77:Me.next=83;break;case 79:Me.prev=79,Me.t9=Me['catch'](64),Ne=!0,Ce=Me.t9;case 83:Me.prev=83,Me.prev=84,!he&&Ae.return&&Ae.return();case 86:if(Me.prev=86,!Ne){Me.next=89;break}throw Ce;case 89:return Me.finish(86);case 90:return Me.finish(83);case 91:if(!(ve>=Oe)){Me.next=96;break}return pe(),Me.abrupt('break',101);case 96:return Me.next=98,T(300000);case 98:xe++,Me.next=60;break;case 101:Me.next=104;break;case 103:pe();case 104:return Me.abrupt('return',$.Deferred().resolve());case 105:case'end':return Me.stop();}},ue,de,[[64,79,83,91],[84,,86,90]])}));return function run(){return ge.apply(this,arguments)}}()},AUTO_DANMU:{setValue:function setValue(ge,ue){return void 0===_e.CONFIG[ge][ue]&&0<ue?_e.AUTO_DANMU.setValue(ge,ue-1):_e.CONFIG[ge][ue]},sendDanmu:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(ce,pe){return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return console.log('sendDanmu',ce,pe),Te.next=3,A.sendLiveDanmu(ce,pe).then(function(fe){F('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+ce+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+pe+'\u3011',fe),0!==fe.code||fe.msg?window.toast('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u3010'+ce+'\u3011\uFF08\u623F\u95F4\u53F7\u3010'+pe+'\u3011\uFF09\u51FA\u9519 '+fe.msg,'caution'):window.toast('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u3010'+ce+'\u3011\uFF08\u623F\u95F4\u53F7\u3010'+pe+'\u3011\uFF09\u53D1\u9001\u6210\u529F','success')},function(){window.toast('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u3010'+ce+'\u3011\uFF08\u623F\u95F4\u53F7\u3010'+pe+'\u3011\uFF09\u53D1\u9001\u5931\u8D25','error')});case 3:return Te.abrupt('return',Te.sent);case 4:case'end':return Te.stop();}},ue,de)}));return function sendDanmu(){return ge.apply(this,arguments)}}(),getMaxLength:function getMaxLength(){var ge;return ge=_e.CONFIG.DANMU_CONTENT.length>=_e.CONFIG.DANMU_ROOMID.length?_e.CONFIG.DANMU_CONTENT.length:_e.CONFIG.DANMU_ROOMID.length,ge<_e.CONFIG.DANMU_INTERVAL_TIME.length&&(ge=_e.CONFIG.DANMU_INTERVAL_TIME.length),ge},run:function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var ce,pe,Ie;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(_e.CONFIG.AUTO_DANMU){fe.next=2;break}return fe.abrupt('return',$.Deferred().resolve());case 2:ce=_e.AUTO_DANMU.getMaxLength(),pe=regeneratorRuntime.mark(function(){var Oe,Ee,ve,xe,he,Ne,Ce,Ae,ye,Ge,De,Re,Me,be,Se,Le;return regeneratorRuntime.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:Oe=_e.AUTO_DANMU.setValue('DANMU_CONTENT',me),Ee=parseInt(_e.AUTO_DANMU.setValue('DANMU_ROOMID',me)),ve=parseFloat(_e.AUTO_DANMU.setValue('DANMU_INTERVAL_TIME',me)),xe=void 0,he=_e.CACHE.AUTO_SEND_DANMU_TS,Ne=void 0,Ce=void 0,Ae=6e4*ve,F('[\u81EA\u52A8\u53D1\u5F39\u5E55]MY_API.CACHE.AUTO_SEND_DANMU_TS => jsoncache',he),ye=!0,Ge=!1,De=void 0,Ue.prev=6,Re=he[Symbol.iterator]();case 8:if(ye=(Me=Re.next()).done){Ue.next=17;break}if(be=Me.value,be.roomid!==Ee||be.content!=Oe){Ue.next=14;break}return xe=be.sendTs,Ne=he.indexOf(be),Ue.abrupt('break',17);case 14:ye=!0,Ue.next=8;break;case 17:Ue.next=23;break;case 19:Ue.prev=19,Ue.t0=Ue['catch'](6),Ge=!0,De=Ue.t0;case 23:Ue.prev=23,Ue.prev=24,!ye&&Re.return&&Re.return();case 26:if(Ue.prev=26,!Ge){Ue.next=29;break}throw De;case 29:return Ue.finish(26);case 30:return Ue.finish(23);case 31:if(Ce=xe?R()-xe:R(),Se=function setCache(){var we={roomid:Ee,content:Oe,sendTs:R()};xe?he[Ne].sendTs=R():he.push(we),_e.CACHE.AUTO_SEND_DANMU_TS=he,_e.saveCache(!1)},Le=function sendNextDanmu(){Se(),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function we(){return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.next=2,_e.AUTO_DANMU.sendDanmu(Oe,Ee);case 2:Se(),Le();case 4:case'end':return He.stop();}},we,de)})),Ae)},!(Ce>=Ae||J)){Ue.next=42;break}return J=!1,Ue.next=38,_e.AUTO_DANMU.sendDanmu(Oe,Ee);case 38:F('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+Oe+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+Ee+'\u3011\uFF0C\u8DDD\u4E0B\u6B21\u53D1\u9001\u8FD8\u6709',ve+'\u5206\u949F'),Le(),Ue.next=44;break;case 42:F('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+Oe+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+Ee+'\u3011\uFF0C\u8DDD\u4E0B\u6B21\u53D1\u9001\u8FD8\u6709',ve-Ce/6e4+'\u5206\u949F'),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function we(){return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return He.next=2,_e.AUTO_DANMU.sendDanmu(Oe,Ee);case 2:Le();case 3:case'end':return He.stop();}},we,de)})),Ae-Ce);case 44:return Ue.next=46,T(1100);case 46:case'end':return Ue.stop();}},pe,de,[[6,19,23,31],[24,,26,30]])}),Ie=0;case 5:if(!(Ie<ce)){fe.next=10;break}return fe.delegateYield(pe(Ie),'t0',7);case 7:Ie++,fe.next=5;break;case 10:case'end':return fe.stop();}},ue,de)}));return function run(){return ge.apply(this,arguments)}}()}};_e.init().then(function(){try{var ge=$.Deferred();(function uniqueCheck(){var ce=R();return 0<=ce-_e.CACHE.UNIQUE_CHECK&&15e3>=ce-_e.CACHE.UNIQUE_CHECK?($('.link-toast').remove(),$('.igiftMsg').remove(),_e.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),ge.reject()):ge.resolve()})().then(function(){var ce,pe=function uniqueMark(){ce=setTimeout(pe,1e4),_e.CACHE.UNIQUE_CHECK=Date.now(),_e.saveCache(!1)};return(window.addEventListener('unload',function(){ce&&(clearTimeout(ce),_e.CACHE.UNIQUE_CHECK=0,_e.saveCache())}),pe(),0===parseInt(ie.uid)||isNaN(parseInt(ie.uid)))?void _e.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(_e.newMessage(GM_info.script.version),F('MY_API.CONFIG',_e.CONFIG),l(_e))})}catch(ge){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',ge)}})}function l(de){'use strict';var le=function clearStat(){de.GIFT_COUNT.COUNT=0,de.GIFT_COUNT.CLEAR_TS=oe(),de.saveGiftCount(),F('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};if(se(de.GIFT_COUNT.CLEAR_TS)&&le(),w(le,'\u91CD\u7F6E\u7EDF\u8BA1'),de.creatSetBox(),de.removeUnnecessary(),setTimeout(function(){de.AUTO_DANMU.run(),de.LITTLE_HEART.run(),de.GroupSign.run(),de.DailyReward.run(),de.LiveReward.run(),de.Exchange.runS2C(),de.TreasureBox.run(),de.Gift.run()},6e3),de.CONFIG.LOTTERY&&(A.room.getList().then(function(ge){F('\u76F4\u64AD\u95F4\u5217\u8868',ge);var ue=!0,ce=!1,pe=void 0;try{for(var fe,Ie=function _loop6(){var me=fe.value;A.room.getRoomList(me.id,0,0,1,1).then(function(Oe){F('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',Oe);for(var Ee=0;Ee<Oe.data.length;++Ee)de.listen(Oe.data[Ee].roomid,ie.uid,me.name+'\u533A')})},Te=ge.data[Symbol.iterator]();!(ue=(fe=Te.next()).done);ue=!0)Ie()}catch(me){ce=!0,pe=me}finally{try{!ue&&Te.return&&Te.return()}finally{if(ce)throw pe}}}),de.CONFIG.CHECK_HOUR_ROOM)){var ge=function check_top_room(){if(de.GIFT_COUNT.COUNT>=de.CONFIG.MAX_GIFT&&(F('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),de.max_blocked=!0),de.blocked||de.max_blocked)return de.blocked?(de.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(ue)):void de.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(I(de.CONFIG.TIME_AREA_START_H0UR,de.CONFIG.TIME_AREA_END_H0UR,de.CONFIG.TIME_AREA_START_MINUTE,de.CONFIG.TIME_AREA_END_MINUTE)&&de.CONFIG.TIME_AREA_DISABLE)return void de.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var ce=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],pe=1,Ie=function checkHourRank(fe){A.rankdb.getTopRealTimeHour(fe).then(function(me){var Oe=me.data.list;de.chatLog('\u68C0\u67E5'+ce[fe]+'\u623F\u95F4\u7684\u793C\u7269','warning'),F(ce[fe]+'\u623F\u95F4\u5217\u8868',Oe);var Ee=!0,ve=!1,xe=void 0;try{for(var Ne,Ce,he=Oe[Symbol.iterator]();!(Ee=(Ne=he.next()).done);Ee=!0)Ce=Ne.value,de.checkRoom(Ce.roomid,'\u5C0F\u65F6\u699C-'+Ce.area_v2_parent_name+'\u533A')}catch(Ce){ve=!0,xe=Ce}finally{try{!Ee&&he.return&&he.return()}finally{if(ve)throw xe}}})},Te=setInterval(function(){pe<=ce.length-1?(Ie(pe),pe++):clearInterval(Te)},1e3)};setTimeout(ge,6e3);var ue=setInterval(ge,parseInt(1e3*de.CONFIG.CHECK_HOUR_ROOM_INTERVAL))}var _e=function reset(ge){var ue=setTimeout(function(){if(0<de.raffleId_list.length||0<de.guardId_list.length||0<de.pkId_list.length)return F('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void _e(15000);if(se(de.CACHE.LittleHeart_TS))return F('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(ue),void _e(6e5);if(I(de.CONFIG.TIME_AREA_START_H0UR,de.CONFIG.TIME_AREA_END_H0UR,de.CONFIG.TIME_AREA_START_MINUTE,de.CONFIG.TIME_AREA_END_MINUTE)&&de.CONFIG.IN_TIME_RELOAD_DISABLE){var ce=_(de.CONFIG.TIME_AREA_START_MINUTE,de.CONFIG.TIME_AREA_END_MINUTE)+6e4;return _e(ce),void F('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+ce+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},ge)};de.CONFIG.TIME_RELOAD&&_e(6e4*de.CONFIG.TIME_RELOAD_MINUTE)}function _(de,le){var _e=new Date,ge=_e.getHours(),ue=_e.getMinutes(),ce=_e.getSeconds(),Te=1e3*(3600*de)+1e3*(60*le)-(1e3*(3600*ge)+1e3*(60*ue)+1e3*ce),fe=new Date(Te);return F('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',fe.getHours()+'\u65F6'+fe.getMinutes()+'\u5206'),0>Te?86400000+Te:Te}function u(de,le){var _e=new Date,ge=_e.getHours(),ue=_e.getMinutes();return ge==de&&ue==le||(F('isTime \u9519\u8BEF\u65F6\u95F4','\u76EE\u6807\u65F6\u95F4'+de+'\u65F6'+le+'\u5206\uFF0C\u5F53\u524D\u65F6\u95F4'+ge+'\u65F6'+ue+'\u5206'),!1)}function I(de,le,_e,ge){if(23<de||24<le||0>de||1>le||59<_e||0>_e||59<ge||0>ge)return!1;var ue=new Date,ce=ue.getHours(),pe=ue.getMinutes();if(de<le)return ce>=de&&ce<le||ce==le&&pe>=_e&&pe<ge;return de>le?ce>=de||ce<le||ce==le&&pe>=_e&&pe<ge:de==le?ce==de&&_e<=ge&&pe>=_e&&pe<ge||ce==de&&_e>ge&&pe<=ge&&pe>_e:void 0}function T(de){return new Promise(function(le){setTimeout(function(){le()},de)})}function f(de){if(0>=de)return!1;var le=Math.random();return de/100>=le}function O(de){return new Promise(function(le){var _e=function onerror(ge){console.error(GM_info.script.name,ge),le(void 0)};if(de.GM)'POST'===de.method&&(void 0===de.headers&&(de.headers={}),void 0===de.headers['Content-Type']&&(de.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),de.timeout=30000,de.onload=function(ge){return le({response:ge,body:ge.response})},de.onerror=_e,de.ontimeout=_e,GM_xmlhttpRequest(de);else{var ge=new XMLHttpRequest;ge.open(de.method,de.url),'POST'===de.method&&null===ge.getResponseHeader('Content-Type')&&ge.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),de.cookie&&(ge.withCredentials=!0),de.responseType!==void 0&&(ge.responseType=de.responseType),ge.timeout=30000,ge.onload=function(ue){var ce=ue.target;le({response:ce,body:ce.response})},ge.onerror=_e,ge.ontimeout=_e,ge.send(de.data)}})}Y.init(),$(function(){var de=function loadInfo(le){setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function _e(){var ge;return regeneratorRuntime.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(ge='undefined'==typeof unsafeWindow?window:unsafeWindow,!(void 0===ge.BilibiliLive||0===parseInt(ge.BilibiliLive.UID)||isNaN(parseInt(ge.BilibiliLive.UID)))){ce.next=5;break}return ce.abrupt('return',de(1e3));case 5:return ie.room_id=ge.BilibiliLive.ROOMID,ie.uid=ge.BilibiliLive.UID,ie.tid=ge.BilibiliLive.ANCHOR_UID,ce.next=10,A.live_user.get_info_in_room(ie.room_id).then(function(pe){F('InitData: API.live_user.get_info_in_room',pe),ie.mobile_verify=pe.data.info.mobile_verify,ie.identification=pe.data.info.identification});case 10:return ce.next=12,A.gift.gift_config().then(function(pe){F('InitData: API.gift.gift_config',pe),!!pe.data&&$.isArray(pe.data)?ie.gift_list=pe.data:!!pe.data.list&&$.isArray(pe.data.list)?ie.gift_list=pe.data.list:(ie.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))});case 12:ie.bili_jct=A.getCookie('bili_jct'),ie.ruid=ge.BilibiliLive.ANCHOR_UID,ie.rnd=ge.BilibiliLive.RND,ie.visit_id=ge.__statisObserver?ge.__statisObserver.__visitId:'',F('Live_info',ie),o();case 18:case'end':return ce.stop();}},_e,E)})),le)};de(1e3),V()}),Array.prototype.remove=function(de){var le=this.indexOf(de);-1<le&&this.splice(le,1)};var oe=function dateNow(){return Date.now()},se=function checkNewDay(de){if(0===de)return!0;var le=new Date(de),_e=new Date,ge=le.getDate(),ue=_e.getDate();return ue!==ge}})();
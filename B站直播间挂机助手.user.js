// ==UserScript==
// @namespace      https://github.com/andywang425
// @name           B站直播间挂机助手
// @name:en        B站直播间挂机助手
// @author         andywang425
// @description    自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章，快捷购买粉丝勋章
// @description:en 自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章，快捷购买粉丝勋章
// @updateURL      https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @homepageURL    https://github.com/andywang425/BLTH/
// @supportURL     https://github.com/andywang425/BLTH/issues
// @icon           https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright      2020, andywang425 (https://github.com/andywang425)
// @license        MIT
// @compatible     chrome 80 or later
// @compatible     firefox 77 or later
// @compatible     opera 69 or later
// @version        4.2.1.1
// @include       /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at        document-start
// @connect       passport.bilibili.com
// @connect       api.live.bilibili.com
// @connect       live-trace.bilibili.com
// @require       https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@56149b5a33cf4b1318a6806d7edb06a4fbefcf4a/BilibiliAPI_Mod.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@56149b5a33cf4b1318a6806d7edb06a4fbefcf4a/OCRAD.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@56149b5a33cf4b1318a6806d7edb06a4fbefcf4a/libBilibiliToken.user.js
// @require       https://cdn.jsdelivr.net/gh/sentsin/layer@0018e1a54fbfb455d7b30d5a2901294dd0ab52c5/dist/layer.js
// @grant        unsafeWindow
// @grant        GM_xmlhttpRequest
// ==/UserScript==
'use strict';var _Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function I(T,f){try{var E=l[T](f),O=E.value}catch(C){return void u(C)}return E.done?void _(O):Promise.resolve(O).then(function(C){I('next',C)},function(C){I('throw',C)})}return I('next')})}}(function(){var A=this,N='IGIFTMSG',D=localStorage.getItem(N+'_block_live')||'pass';function o(){$('head').append('\n        <style>\n            .igiftMsg_input{\n                outline: none;\n                border: 1px solid #e9eaec;\n                background-color: #fff;\n                border-radius: 4px;\n                padding: 1px 0 0;\n                overflow: hidden;\n                font-size: 12px;\n                line-height: 19px;\n                width: 30px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_btn{\n                background-color: #23ade5;\n                color: #fff;\n                border-radius: 4px;\n                border: none;\n                padding: 5px;\n                cursor: pointer;\n                box-shadow: 0 0 2px #00000075;\n                line-height: 10px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_fs{\n                border: 2px solid #d4d4d4;\n                \'z-index\': \'10001\';\n            }\n        </style>\n            '),$('head').append('<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/sentsin/layer@v3.1.1/dist/theme/default/layer.css">')}function l(){var ce,ge=this,ue={CONFIG_DEFAULT:{AUTO_GIFT:!1,AUTO_GIFT_ROOMID:'0',AUTO_GROUP_SIGN:!0,AUTO_TREASUREBOX:!0,BLOCK_LIVE_VIDEO:!0,CHECK_HOUR_ROOM_INTERVAL:600,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,EXCLUDE_ROOMID:'0',FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_SEND_TIME',GIFT_SORT:!1,IN_TIME_RELOAD_DISABLE:!1,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!1,LIGHT_MEDALS:'0',LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,MAX_TAB:5,MOBILE_HEARTBEAT:!1,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_activity:!1,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',SPARE_GIFT_UID:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:120,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,MobileHeartBeat_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{S.setCommonArgs(P.bili_jct)}catch(Ie){return void console.error('['+N+']',Ie)}var pe=$.Deferred();try{ue.loadConfig().then(function(){ue.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),pe.resolve()})}catch(Ie){console.error('API\u521D\u59CB\u5316\u51FA\u9519',Ie),ue.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),pe.reject()}try{ue.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),pe.resolve()})}catch(Ie){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',Ie),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),pe.reject()}return setTimeout(function(){ue.TreasureBox.init()},5750),pe},loadConfig:function loadConfig(){var pe=$.Deferred();try{var Ie=JSON.parse(localStorage.getItem(N+'_CONFIG'));for(var Te in $.extend(!0,ue.CONFIG,ue.CONFIG_DEFAULT),ue.CONFIG)ue.CONFIG.hasOwnProperty(Te)&&void 0!==Ie[Te]&&null!==Ie[Te]&&(ue.CONFIG[Te]=Ie[Te]);ue.loadGiftCount(),pe.resolve()}catch(Ie){Z('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',Ie),ue.setDefaults(),pe.reject()}return pe},loadCache:function loadCache(){var pe=$.Deferred();try{var Ie=JSON.parse(localStorage.getItem(N+'_CACHE'));for(var Te in $.extend(!0,ue.CACHE,ue.CACHE_DEFAULT),ue.CACHE)ue.CACHE.hasOwnProperty(Te)&&void 0!==Ie[Te]&&null!==Ie[Te]&&(ue.CACHE[Te]=Ie[Te]);pe.resolve()}catch(Ie){Z('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',Ie),ue.setDefaults(),pe.reject()}return pe},newMessage:function newMessage(pe){try{var Ie=localStorage.getItem(N+'_NEWMSG_CACHE');if((Ie==void 0||null==Ie||'4.2'!=Ie)&&'4.2'==pe){var Te=function linkMsg(fe,me){return'<a href="'+me+'"target="_blank">'+fe+'</a>'};layer.open({title:pe+'\u66F4\u65B0\u63D0\u793A',content:'1.\u4FEE\u590D\u4E86\u5C0F\u5FC3\u5FC3\u6A21\u5757 2.\u7F8E\u5316\u4E86\u63A7\u5236\u9762\u677F<br>\n                            \u5982\u679C\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u9047\u5230\u95EE\u9898\uFF0C\u6B22\u8FCE\u53BB'+Te('github','https://github.com/andywang425/BLTH/issues')+'\n                            \uFF08\u6216\u8005\u8FDBqq\u7FA4'+Te('1106094437','https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O')+'\uFF09\u53CD\u9988\u3002'}),localStorage.setItem(N+'_NEWMSG_CACHE',pe)}}catch(Ie){Z('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u5931\u8D25',Ie)}},saveConfig:function saveConfig(){try{return localStorage.setItem(N+'_CONFIG',JSON.stringify(ue.CONFIG)),ue.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),Z('MY_API.CONFIG',ue.CONFIG),!0}catch(pe){return Z('API\u4FDD\u5B58\u51FA\u9519',pe),!1}},saveCache:function saveCache(pe){try{return localStorage.setItem(N+'_CACHE',JSON.stringify(ue.CACHE)),!1!=pe&&Z('CACHE\u5DF2\u4FDD\u5B58',ue.CACHE),!0}catch(Ie){return Z('CACHE\u4FDD\u5B58\u51FA\u9519',Ie),!1}},setDefaults:function setDefaults(){ue.CONFIG=ue.CONFIG_DEFAULT,ue.CACHE=ue.CACHE_DEFAULT,ue.saveConfig(),ue.saveCache(),ue.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1','info'),setTimeout(function(){ue.CACHE=ue.CACHE_DEFAULT,ue.GroupSign.run(),ue.DailyReward.run(),ue.LiveReward.run(),ue.Exchange.runS2C(),ue.TreasureBox.run(),ue.Gift.run(),ue.LITTLE_HEART.run(),ue.MobileHeartBeat.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var pe=JSON.parse(localStorage.getItem(N+'_GIFT_COUNT'));for(var Ie in ue.GIFT_COUNT)ue.GIFT_COUNT.hasOwnProperty(Ie)&&void 0!==pe[Ie]&&null!==pe[Ie]&&(ue.GIFT_COUNT[Ie]=pe[Ie]);Z('MY_API.GIFT_COUNT',ue.GIFT_COUNT)}catch(pe){Z('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',pe)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(N+'_GIFT_COUNT',JSON.stringify(ue.GIFT_COUNT)),Z('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',ue.GIFT_COUNT),!0}catch(pe){return Z('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',pe),!1}},addGift:function addGift(pe){ue.GIFT_COUNT.COUNT+=pe,$('#giftCount span:eq(0)').text(ue.GIFT_COUNT.COUNT),ue.saveGiftCount()},addSilver:function addSilver(pe){ue.GIFT_COUNT.SILVER_COUNT+=pe,$('#giftCount span:eq(1)').text(ue.GIFT_COUNT.SILVER_COUNT),ue.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){var pe=['#my-dear-haruna-vm','.activity-entry','.bilibili-live-player'],Ie=function removeUntiSucceed(Te,fe){!0===ue.CONFIG[Te]&&setInterval(function(){0<$(pe[fe]).length&&$(pe[fe]).remove()},200)};Ie('REMOVE_ELEMENT_2233',0),Ie('REMOVE_ELEMENT_activity',1),Ie('REMOVE_ELEMENT_player',2)},creatSetBox:function creatSetBox(){var pe=['.chat-history-list','.attention-btn-ctnr','.live-player-mounter'],Ie=!0,Te=!1,fe=void 0;try{for(var Ee,be,me=pe[Symbol.iterator]();!(Ie=(Ee=me.next()).done);Ie=!0)if(be=Ee.value,0==$(be).length)return z(function(){return ue.creatSetBox()},200)}catch(be){Te=!0,fe=be}finally{try{!Ie&&me.return&&me.return()}finally{if(Te)throw fe}}var ve='hide'==L?'\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F':'\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F',Oe=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">'+ve+'<br></button>'),xe='#allsettings',he=$('.chat-history-list'),Ce,Ge=$('.live-player-mounter').height(),Re=$('.live-player-mounter').offset(),Ae='"float:left"';-1<Y.toLowerCase().indexOf('firefox')&&(Ae='""');var Ne='\n                <div id=\'allsettings\' class = "igiftMsg_main">\n    <fieldset class="igiftMsg_fs">\n        <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n        <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n            \u8FA3\u6761&nbsp;<span>'+ue.GIFT_COUNT.COUNT+'</span>\n            \u94F6\u74DC\u5B50&nbsp;<span>'+ue.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n            <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n        </div>\n    </fieldset>\n    <div id="left_fieldset" style='+Ae+'>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u62BD\u5956\u8BBE\u7F6E</legend>\n            <div data-toggle="RANDOM_DELAY">\n                <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                    <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                    <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                </label>\n            </div>\n            <div data-toggle="TIME_AREA_DISABLE">\n                <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\u542F\u7528\n                    <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                    <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                    <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                    <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                </label>\n            </div>\n            <div data-toggle="RANDOM_SKIP">\n                <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                    \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                </label>\n            </div>\n            <div data-toggle="MAX_GIFT">\n                <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                    \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                </label>\n            </div>\n            <div data-toggle="RANDOM_SEND_DANMU">\n                <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                    \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                </label>\n            </div>\n            <div data-toggle="CHECK_HOUR_ROOM_INTERVAL">\n                <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                    \u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\n                </label>\n            </div>\n            <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n            <label style="margin: 5px auto; color: red;">\n                <input style="vertical-align: text-top;" type="checkbox">\u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n            </label>\n        </div>\n        </fieldset>\n\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n            <div data-toggle="LOGIN" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u767B\u9646\n            </div>\n            <div data-toggle="WATCH" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u89C2\u770B\u89C6\u9891\n            </div>\n            <div data-toggle="COIN" style=" color: black">\n                <label style="cursor: pointer">\n                    <input style="cursor: pointer; vertical-align: text-top;" type="checkbox">\n                    \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                </label>\n            </div>\n            <div data-toggle="COIN_TYPE" style=" color: black">\n                <div data-toggle="COIN_UID">\n                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                \u7684\u89C6\u9891\u6295\u5E01\n                </div>\n                <div data-toggle="COIN_DYN">\n                    <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                    \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                </div>\n            </div>\n            <div data-toggle="SHARE" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u5206\u4EAB\u89C6\u9891\n            </div>\n            <div data-toggle="SILVER2COIN" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n            </div>\n            <div data-toggle="LIVE_SIGN" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u76F4\u64AD\u533A\u7B7E\u5230\n            </div>\n            <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u5E94\u63F4\u56E2\u7B7E\u5230\n            </div>\n            <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n            </div>\n            <div data-toggle="MOBILE_HEARTBEAT" style=" color: gray">\n            <input style="vertical-align: text-top;" type="checkbox">\n            \u6A21\u62DF\u79FB\u52A8\u7AEF\u5FC3\u8DF3\n            </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n            <div data-toggle="AUTO_GIFT" style=" color: purple">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u81EA\u52A8\u9001\u793C\n            </div>\n\n            <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                \u4F18\u5148\u9001\u793C\u623F\u95F4\n                <input class="num igiftMsg_input" style="width: 150px;" type="text">\n            </div>\n\n            <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                \u4E0D\u9001\u793C\u623F\u95F4\n                <input class="num igiftMsg_input" style="width: 150px;" type="text">\n            </div>\n            <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                \u95F4\u9694\n                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                \u5206\u949F\u9001\u793C\n            </div>\n            <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                \u5B9A\u65F6\u9001\u793C<br>\n                \u9001\u793C\u65F6\u95F4\n                <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n            </div>\n            \n            <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                \u793C\u7269\u5230\u671F\u65F6\u95F4\n                <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                \u5929\n            </div>\n            <div data-toggle="GIFT_SORT" style=" color: purple">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u9001\u793C\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\n            </div>\n            <div data-toggle="SEND_ALL_GIFT" style=" color: purple">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\n            </div>\n            <div data-toggle="SPARE_GIFT_ROOM" style=" color: black">\n                \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 100px;">\n            </div>\n            <div data-toggle="SPARE_GIFT_UID" style=" color: black">\n                \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\u62E5\u6709\u8005UID\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 100px;">\n            </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n            <div data-toggle="STORM" style="line-height: 15px">\n                <label style="margin: 5px auto; color: #ff5200">\n                    <input style="vertical-align: text-top;" type="checkbox">\u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                </label>\n            </div>\n            <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n            </div>\n            <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n            </div>\n            <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                \u6BEB\u79D2\n            </div>\n        </fieldset>\n    </div>\n\n\n\n    <div id="right_fieldset" style='+Ae+'>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u8D2D\u4E70\u7C89\u4E1D\u52CB\u7AE0</legend>\n            <div data-toggle="BUY_MEDAL" style="color: black; line-height: 15px">\n            \u8F93\u5165\u7C89\u4E1D\u52CB\u7AE0\u5BF9\u5E94\u623F\u95F4\u53F7\uFF1A<input class="num igiftMsg_input" type="text" value = '+P.room_id+' onclick="select();" style="width: 70px">\n            <button  class="igiftMsg_btn" data-action="buy_medal">\u70B9\u51FB\u8D2D\u4E70\u52CB\u7AE0</button>\n            \uFF08\u82B1\u8D3920\u786C\u5E01\uFF09\n        </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n            <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                <label style="margin: 5px auto; color: black">\n                    <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                </label>\n            </div>\n            <div data-toggle="MAX_TAB" style="line-height: 15px">\n            <label style="margin: 5px auto; color: black">\n                \u6253\u5F00\u7A97\u53E3\u6570\u91CF\u4E0A\u9650\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n            </label>\n        </div>\n            <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n            <input class="num igiftMsg_input" style="width: 300px;" type="text">\n        </div>\n        <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n            \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n            <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                \u767D\u540D\u5355\n            </div>\n            <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                &nbsp;\n                <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                \u9ED1\u540D\u5355\n            </div>\n        </div>\n        <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n        <label style="margin: 5px auto; color: black">\n            <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n        </label>\n        </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n            <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                <label style="margin: 5px auto; color: black">\n                    <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u96642233\u6A21\u578B\n                </label>\n            </div>\n            <div data-toggle="REMOVE_ELEMENT_activity" style="line-height: 15px">\n                <label style="margin: 5px auto; color: black">\n                    <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u6D3B\u52A8\u5165\u53E3\n                </label>\n            </div>\n            <div data-toggle="BLOCK_LIVE_VIDEO" style="line-height: 15px">\n            <label style="margin: 5px auto; color: black">\n                <input style="vertical-align: text-top;" type="checkbox"> \u62E6\u622A\u6302\u5C0F\u5FC3\u5FC3\u6253\u5F00\u7A97\u53E3\u7684\u76F4\u64AD\u6D41\n            </label>\n        </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs" style="line-height: 15px">\n            <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n            <div data-toggle="TIME_RELOAD" style="color: black">\n                \u672C\u76F4\u64AD\u95F4\u5237\u65B0\u65F6\u95F4\uFF1A\n                <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\u5206\n            </div>\n            <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 15px">\n                <label style="margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u5237\u65B0\u76F4\u64AD\u95F4\n                </label>\n            </div>\n            <div id="resetArea">\n                <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1</button>\n                <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n            </div>\n\n        </fieldset>\n        <label style="color: darkblue; font-size:large;">\n            v'+GM_info.script.version+' <a href="https://github.com/andywang425/BLTH"\n                target="_blank">\u66F4\u591A\u8BF4\u660E\u548C\u66F4\u65B0\u65E5\u5FD7\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n        </label>\n    </div>\n</div>\n    ',ye=function getScrollPosition(){var be=0<arguments.length&&arguments[0]!==void 0?arguments[0]:window;return{x:be.pageXOffset===void 0?be.scrollLeft:be.pageXOffset,y:be.pageYOffset===void 0?be.scrollTop:be.pageYOffset}},De=function openMainWindow(){Ce=layer.open({type:1,title:!1,offset:[Re.top-ye().y+''+'px',Re.left+''+'px'],closeBtn:0,shade:0,zIndex:9999,fixed:!1,area:[,Ge+''+'px'],content:Ne,success:function success(){function be(){var Pe,Ye,je=ue.CONFIG.TIME_AREA_START_H0UR=parseInt($(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),Ve=ue.CONFIG.TIME_AREA_END_H0UR=parseInt($(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Xe=ue.CONFIG.TIME_AREA_START_MINUTE=parseInt($(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),Ke=ue.CONFIG.TIME_AREA_END_MINUTE=parseInt($(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(0>je||0>Ve||0>Xe||0>Ke)return void ue.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=je||24<=Ve||60<=Xe||60<=Ke)return void ue.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(ue.CONFIG.TIME_AREA_START_H0UR=je,ue.CONFIG.TIME_AREA_END_H0UR=Ve,ue.CONFIG.TIME_AREA_START_MINUTE=Xe,ue.CONFIG.TIME_AREA_END_MINUTE=Ke,Pe=parseFloat($(xe).find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>Pe||100<Pe)return void ue.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(ue.CONFIG.RANDOM_SKIP=Pe,Pe=parseFloat($(xe).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<Pe)return void ue.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>Pe)return void ue.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(ue.CONFIG.RANDOM_SEND_DANMU=Pe,Pe=parseInt($(xe).find('div[data-toggle="MAX_GIFT"] .num').val()),ue.CONFIG.MAX_GIFT=Pe,Pe=parseInt($(xe).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=Pe||1e4<Pe)return void ue.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(ue.CONFIG.TIME_RELOAD=Pe,Pe=parseFloat($(xe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),Ve=parseFloat($(xe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>Pe||100<Ve)return void ue.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Ve<=Pe)return void ue.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(ue.CONFIG.RND_DELAY_START=Pe,ue.CONFIG.RND_DELAY_END=Ve,Pe=parseInt($(xe).find('div[data-toggle="COIN"] .coin_number').val()),0>Pe||5<Pe)return void ue.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(ue.CONFIG.COIN_NUMBER=Pe,Pe=parseInt($(xe).find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=Pe)return void ue.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');ue.CONFIG.CHECK_HOUR_ROOM_INTERVAL=Pe,Pe=$(xe).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),Ye=Pe.split(',');for(var Qe=0;Qe<Ye.length;Qe++)''===Ye[Qe]&&(Ye[Qe]=0);Pe=Ye.join(','),ue.CONFIG.AUTO_GIFT_ROOMID=Pe,Pe=$(xe).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),Ye=Pe.split(',');for(var Qe=0;Qe<Ye.length;Qe++)''===Ye[Qe]&&(Ye[Qe]=0);return(Pe=Ye.join(','),ue.CONFIG.EXCLUDE_ROOMID=Pe,Pe=parseInt($(xe).find('div[data-toggle="GIFT_LIMIT"] .num').val()),ue.CONFIG.GIFT_LIMIT=Pe,je=parseInt($(xe).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),Ve=parseInt($(xe).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>je||0>Ve)?void ue.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning'):24<=je||60<=Ve?void ue.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning'):void(ue.CONFIG.GIFT_SEND_HOUR=je,ue.CONFIG.GIFT_SEND_MINUTE=Ve,Pe=$(xe).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),ue.CONFIG.SPARE_GIFT_ROOM=Pe,Pe=$(xe).find('div[data-toggle="SPARE_GIFT_UID"] .num').val(),ue.CONFIG.SPARE_GIFT_UID=Pe,Pe=parseInt($(xe).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),ue.CONFIG.STORM_QUEUE_SIZE=Pe,Pe=parseInt($(xe).find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),ue.CONFIG.STORM_MAX_COUNT=Pe,Pe=parseInt($(xe).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),ue.CONFIG.STORM_ONE_LIMIT=Pe,Pe=parseInt($(xe).find('div[data-toggle="COIN_UID"] .num').val()),ue.CONFIG.COIN_UID=Pe,Pe=$(xe).find('div[data-toggle="LIGHT_MEDALS"] .num').val(),ue.CONFIG.LIGHT_MEDALS=Pe,Pe=parseInt($(xe).find('div[data-toggle="MAX_TAB"] .num').val()),ue.CONFIG.MAX_TAB=Pe,ue.saveConfig())}function Le(Pe){return S.live_user.get_anchor_in_room(Pe).then(function(Ye){Z('API.live_user.get_anchor_in_room response',Ye),0!==Ye.code||!Ye.data.info?0===Ye.code&&Ye.data.info===void 0?layer.msg('\u623F\u95F4\u4E0D\u5B58\u5728',{time:2500}):layer.msg('\u68C0\u67E5\u623F\u95F4\u51FA\u9519 '+Ye.message,{time:2500}):layer.confirm('\u662F\u5426\u6D88\u801720\u786C\u5E01\u8D2D\u4E70UP\u4E3B\u3010'+Ye.data.info.uname+'\u3011\u7684\u7C89\u4E1D\u52CB\u7AE0\uFF1F',{title:'\u8D2D\u4E70\u52CB\u7AE0',btn:['\u662F','\u5426']},function(){return S.link_group.buy_medal(Ye.data.info.uid).then(function(je){Z('API.link_group.buy_medal re',je),0===je.code?layer.msg('\u8D2D\u4E70\u6210\u529F',{time:2e3,icon:1}):layer.msg('\u8D2D\u4E70\u5931\u8D25 '+je.message,{time:2500,icon:2})})},function(){layer.msg('\u5DF2\u53D6\u6D88\u8D2D\u4E70',{time:2e3})})})}$(xe).find('div[data-toggle="MAX_TAB"] .num').val(parseInt(ue.CONFIG.MAX_TAB).toString()),$(xe).find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(ue.CONFIG.GIFT_INTERVAL).toString()),$(xe).find('div[data-toggle="LIGHT_MEDALS"] .num').val(ue.CONFIG.LIGHT_MEDALS.toString()),$(xe).find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(ue.CONFIG.STORM_MAX_COUNT).toString()),$(xe).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(ue.CONFIG.STORM_ONE_LIMIT).toString()),$(xe).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(ue.CONFIG.STORM_QUEUE_SIZE).toString()),$(xe).find('div[data-toggle="SPARE_GIFT_UID"] .num').val(ue.CONFIG.SPARE_GIFT_UID.toString()),$(xe).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(ue.CONFIG.SPARE_GIFT_ROOM.toString()),$(xe).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(ue.CONFIG.TIME_RELOAD).toString()),$(xe).find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(ue.CONFIG.RANDOM_SKIP).toString()),$(xe).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(ue.CONFIG.RANDOM_SEND_DANMU).toString()),$(xe).find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(ue.CONFIG.MAX_GIFT).toString()),$(xe).find('div[data-toggle="COIN"] .coin_number').val(parseInt(ue.CONFIG.COIN_NUMBER).toString()),$(xe).find('div[data-toggle="COIN_UID"] .num').val(parseInt(ue.CONFIG.COIN_UID).toString()),$(xe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(ue.CONFIG.RND_DELAY_START).toString()),$(xe).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(ue.CONFIG.RND_DELAY_END).toString()),$(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(ue.CONFIG.TIME_AREA_START_H0UR).toString()),$(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(ue.CONFIG.TIME_AREA_END_H0UR).toString()),$(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(ue.CONFIG.TIME_AREA_START_MINUTE).toString()),$(xe).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(ue.CONFIG.TIME_AREA_END_MINUTE).toString()),$(xe).find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val(parseInt(ue.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),$(xe).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(ue.CONFIG.AUTO_GIFT_ROOMID.toString()),$(xe).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(ue.CONFIG.EXCLUDE_ROOMID.toString()),$(xe).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(ue.CONFIG.GIFT_SEND_HOUR.toString()),$(xe).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(ue.CONFIG.GIFT_SEND_MINUTE.toString()),$(xe).find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(ue.CONFIG.GIFT_LIMIT).toString());$(xe).find('div[id="giftCount"] [data-action="save"]').click(function(){be()}),$(xe).find('div[data-toggle="BUY_MEDAL"] [data-action="buy_medal"]').click(function(){var Pe=parseInt($(xe).find('div[data-toggle="BUY_MEDAL"] .num').val());Le(Pe)}),$(xe).find('button[data-action="reset"]').click(function(){ue.setDefaults()}),$(xe).find('button[data-action="checkUpdate"]').click(function(){ue.checkUpdate()}),$(xe).find('button[data-action="redo_dailyTasks"]').click(function(){ue.ReDoDailyTasks()}),$(xe).find('#resetArea [data-action="countReset"]').click(function(){ue.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},ue.saveGiftCount(),$('#giftCount span:eq(0)').text(ue.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(ue.GIFT_COUNT.SILVER_COUNT),ue.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),$(xe).find('button[data-action="sendGiftNow"]').click(function(){U=!0,ue.Gift.run()});var Se=['RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','GIFT_SORT','SEND_ALL_GIFT','MOBILE_HEARTBEAT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_activity','BLOCK_LIVE_VIDEO','FORCE_LIGHT'],Fe=!0,we=!1,ke=void 0;try{for(var Be,Ue=function _loop(){var Pe=Be.value,Ye=$(xe).find('div[data-toggle="'+Pe+'"] input:checkbox');ue.CONFIG[Pe]&&Ye.attr('checked',''),Ye.change(function(){ue.CONFIG[Pe]=$(this).prop('checked'),ue.saveConfig(),ue.CONFIG.BLOCK_LIVE_VIDEO?localStorage.setItem(N+'_block_live','block'):localStorage.setItem(N+'_block_live','pass')})},He=Se[Symbol.iterator]();!(Fe=(Be=He.next()).done);Fe=!0)Ue()}catch(Pe){we=!0,ke=Pe}finally{try{!Fe&&He.return&&He.return()}finally{if(we)throw ke}}$('input:text').bind('keydown',function(Pe){'13'==Pe.keyCode&&be()}),'COIN_DYN'==ue.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==ue.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==ue.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');$('input:radio[name=\'COIN_TYPE\']').change(function(){var Pe=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked');ue.CONFIG.COIN_TYPE=!0==Pe?'COIN_DYN':'COIN_UID',ue.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){var Pe=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked');ue.CONFIG.LIGHT_METHOD=!0==Pe?'LIGHT_WHITE':'LIGHT_BLACK',ue.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){var Pe=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked');ue.CONFIG.GIFT_METHOD=!0==Pe?'GIFT_INTERVAL':'GIFT_SEND_TIME',ue.saveConfig()})},end:function end(){L='hide',localStorage.setItem(N+'_msgHide',L),$('.igiftMsg').hide(),$('.link-toast').hide(),he.animate({scrollTop:0},0),setTimeout(function(){he.animate({scrollTop:he.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'}})},Me=!0;Oe.click(function(){Me&&(Me=!1,setTimeout(function(){Me=!0},200),'show'==L?(L='hide',localStorage.setItem(N+'_msgHide',L),$('.igiftMsg').hide(),$('.link-toast').hide(),layer.close(Ce),he.animate({scrollTop:0},0),setTimeout(function(){he.animate({scrollTop:he.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'):(L='show',localStorage.setItem(N+'_msgHide',L),$('.igiftMsg').show(),$('.link-toast').show(),De(),he.animate({scrollTop:he.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'))}),$('.attention-btn-ctnr').append(Oe),ue.CACHE.DailyReward_TS||layer.tips('\u70B9\u6211\u9690\u85CF/\u663E\u793A\u63A7\u5236\u9762\u677F','#hiderbtn',{tips:1}),'show'==L&&De()},chatLog:function chatLog(pe){var Ie=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',Te=$('<div class=\'igiftMsg\'>'),fe=$('<div>'),me=$('#chat-history-list'),Ee=new Date;fe.text(pe),Te.text(Ee.toLocaleString()),Te.append(fe),Te.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),fe.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===Ie?Te.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===Ie?Te.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===Ie?Te.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):Te.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});'show'==L?me.find('#chat-items').append(Te):me.find('#chat-items').append(Te.hide()),me.scrollTop(me.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(pe,Ie){var Te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';S.room.getConf(pe).then(function(fe){Z('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+Te,fe);var me=new S.DanmuWebSocket(Ie,pe,fe.data.host_server_list,fe.data.token);me.bind(function(Ee){me=Ee,ue.chatLog(Te+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){ue.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+pe+' \u5206\u533A: '+Te,'success')},function(){(ue.blocked||ue.stormBlack)&&(me.close(),ue.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+Te,'warning')),ue.max_blocked&&!ue.CONFIG.STORM&&(me.close(),ue.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+Te,'warning'))},function(Ee){if(!(O(ue.CONFIG.TIME_AREA_START_H0UR,ue.CONFIG.TIME_AREA_END_H0UR,ue.CONFIG.TIME_AREA_START_MINUTE,ue.CONFIG.TIME_AREA_END_MINUTE)&&ue.CONFIG.TIME_AREA_DISABLE))switch(Z('\u5F39\u5E55\u516C\u544A'+Te,Ee),Ee.cmd){case'GUARD_MSG':Ee.roomid===Ee.real_roomid?ue.checkRoom(Ee.roomid,Te):(ue.checkRoom(Ee.roomid,Te),ue.checkRoom(Ee.real_roomid,Te));break;case'PK_BATTLE_SETTLE_USER':Ee.data.winner?ue.checkRoom(Ee.data.winner.room_id,Te):ue.checkRoom(Ee.data.my_info.room_id,Te),ue.checkRoom(Ee.data.winner.room_id,Te);break;case'NOTICE_MSG':switch(Ee.msg_type){case 1:break;case 2:case 3:case 4:case 8:Ee.roomid===Ee.real_roomid?ue.checkRoom(Ee.roomid,Te):(ue.checkRoom(Ee.roomid,Te),ue.checkRoom(Ee.real_roomid,Te));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+Ee.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),ue.Storm.run(Ee.roomid);}break;case'SPECIAL_GIFT':if(Ee.data[39])switch(Ee.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+Ee.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),ue.Storm.run(Ee.roomid);case'end':};break;default:}})},function(){ue.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(pe){var Ie=[];try{var Te=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));Ie=[].concat(Te.list),Ie.push(pe),100<Ie.length&&Ie.splice(0,50),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:Ie})),Z(N+'_EntryRoom_list_add',Ie)}catch(Te){Ie.push(pe),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:Ie}))}},isIn:function isIn(pe){var Ie=[];try{var Te=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));return Ie=null===Te?[]:[].concat(Te.list),Z(N+'_EntryRoom_list_read',Te),-1<Ie.indexOf(pe)}catch(Te){return localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:Ie})),Z('\u8BFB\u53D6'+(N+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<Ie.indexOf(pe)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(pe){var Ie=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';ue.blocked||ue.max_blocked||0<=ue.RoomId_list.indexOf(pe)||(ue.RoomId_list.push(pe),ue.EntryRoom_list_history.isIn(pe)||(S.room.room_entry_action(pe),ue.EntryRoom_list_history.add(pe)),G(ue.CONFIG.RANDOM_SEND_DANMU)&&S.sendLiveDanmu(ue.auto_danmu_list[_Mathfloor(12*Math.random())],pe).then(function(Te){Z('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',Te)}),S.xlive.lottery.check(pe).then(function(Te){ue.RoomId_list.remove(pe),Z('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',Te);var fe=Te.data;if(0===Te.code){var me;if(fe.gift)for(var Ee in me=fe.gift,me)me.hasOwnProperty(Ee)&&ue.creat_join(pe,me[Ee],'gift',Ie);if(fe.guard)for(var Ee in me=fe.guard,me)me.hasOwnProperty(Ee)&&ue.creat_join(pe,me[Ee],'guard',Ie);if(fe.pk)for(var Ee in me=fe.pk,me)me.hasOwnProperty(Ee)&&ue.creat_join(pe,me[Ee],'pk',Ie)}else ue.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<ue.err_roomId.indexOf(pe)?Z('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+pe+Te.message):(ue.err_roomId.push(pe),ue.checkRoom(pe,Ie),Z('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+pe+Te.message))}))},Id_list_history:{add:function add(pe,Ie){var Te=[];try{var fe=JSON.parse(localStorage.getItem(N+'_'+Ie+'Id_list'));Te=[].concat(fe.list),Te.push(pe),200<Te.length&&Te.splice(0,50),localStorage.setItem(N+'_'+Ie+'Id_list',JSON.stringify({list:Te})),Z(N+'_'+Ie+'Id_list_add',Te)}catch(fe){Te.push(pe),localStorage.setItem(N+'_'+Ie+'Id_list',JSON.stringify({list:Te}))}},isIn:function isIn(pe,Ie){var Te=[];try{var fe=JSON.parse(localStorage.getItem(N+'_'+Ie+'Id_list'));return Te=null===fe?[]:[].concat(fe.list),Z(N+'_'+Ie+'Id_list_read',fe),-1<Te.indexOf(pe)}catch(fe){return localStorage.setItem(N+'_'+Ie+'Id_list',JSON.stringify({list:Te})),Z('\u8BFB\u53D6'+(N+'_'+Ie+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<Te.indexOf(pe)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(pe,Ie,Te){var fe=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(Z('\u793C\u7269\u4FE1\u606F',Ie),ue.GIFT_COUNT.COUNT>=ue.CONFIG.MAX_GIFT)return Z('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(ue.max_blocked=!0);switch(Te){case'gift':if(ue.Id_list_history.isIn(Ie.raffleId,'raffle'))return void Z('\u793C\u7269\u91CD\u590D','raffleId '+Ie.raffleId);ue.raffleId_list.push(Ie.raffleId),ue.Id_list_history.add(Ie.raffleId,'raffle');break;case'guard':if(ue.Id_list_history.isIn(Ie.id,'guard'))return void Z('\u8230\u957F\u91CD\u590D','id '+Ie.id);ue.guardId_list.push(Ie.id),ue.Id_list_history.add(Ie.id,'guard');break;case'pk':if(ue.Id_list_history.isIn(Ie.id,'pk'))return void Z('pk\u91CD\u590D','id '+Ie.id);ue.pkId_list.push(Ie.id),ue.Id_list_history.add(Ie.id,'pk');}var me=Ie.time_wait||0;ue.CONFIG.RANDOM_DELAY&&(me+=_Mathfloor(Math.random()*(ue.CONFIG.RND_DELAY_END-ue.CONFIG.RND_DELAY_START+1))+ue.CONFIG.RND_DELAY_START);var Ee=$('<div class=\'igiftMsg\'>'),ve=$('<div>'),Oe=$('<div>'),xe=$('#chat-history-list'),he=new Date;ve.text('['+fe+']'+Ie.thank_text.split('<%')[1].split('%>')[0]+Ie.thank_text.split('%>')[1]),Ee.text(he.toLocaleString()),Ee.append(ve),Oe.css('color','red'),Oe.text('\u7B49\u5F85\u62BD\u5956'),ve.append(Oe),Ee.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),ve.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),Ee.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),'show'==L?xe.find('#chat-items').append(Ee):xe.find('#chat-items').append(Ee.hide()),xe.scrollTop(xe.prop('scrollHeight'));var Ce=setInterval(function(){Oe.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+me+'\u79D2'),0>=me&&(G(ue.CONFIG.RANDOM_SKIP)?Oe.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(Oe.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===Te?ue.gift_join(pe,Ie.raffleId,Ie.type).then(function(Ge,Re){Oe.text(Ge),Re&&(-1<Ge.indexOf('\u8FA3\u6761')?ue.addGift(Re):-1<Ge.indexOf('\u94F6\u74DC\u5B50')&&ue.addSilver(Re)),ue.raffleId_list.remove(Ie.raffleId)}):'guard'===Te?ue.guard_join(pe,Ie.id).then(function(Ge,Re){Oe.text(Ge),Re&&(-1<Ge.indexOf('\u8FA3\u6761')?ue.addGift(Re):-1<Ge.indexOf('\u94F6\u74DC\u5B50')&&ue.addSilver(Re)),ue.guardId_list.remove(Ie.id)}):'pk'===Te?ue.pk_join(pe,Ie.id).then(function(Ge,Re){Oe.text(Ge),Re&&(-1<Ge.indexOf('\u8FA3\u6761')?ue.addGift(Re):-1<Ge.indexOf('\u94F6\u74DC\u5B50')&&ue.addSilver(Re)),ue.pkId_list.remove(Ie.id)}):void 0),Oe.css('color','green'),clearInterval(Ce)),me--},1e3)},gift_join:function gift_join(pe,Ie,Te){var fe=$.Deferred();return S.Lottery.Gift.join(pe,Ie,Te).then(function(me){switch(Z('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',me),me.code){case 0:me.data.award_text?fe.resolve(me.data.award_text,me.data.award_num):fe.resolve(me.data.award_name+'X'+me.data.award_num.toString(),me.data.award_num);break;default:-1<me.msg.indexOf('\u62D2\u7EDD')?!1==ue.CONFIG.FORCE_LOTTERY?(ue.blocked=!0,fe.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++F?ue.gift_join(pe,Ie,Te):(F=0,fe.resolve('[\u793C\u7269\u62BD\u5956](roomid='+pe+',id='+Ie+',type='+Te+')'+me.msg)):fe.resolve('[\u793C\u7269\u62BD\u5956](roomid='+pe+',id='+Ie+',type='+Te+')'+me.msg);}}),fe},guard_join:function guard_join(pe,Ie){var Te=$.Deferred();return S.Lottery.Guard.join(pe,Ie).then(function(fe){switch(Z('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',fe),fe.code){case 0:fe.data.award_text?Te.resolve(fe.data.award_text,fe.data.award_num):Te.resolve(fe.data.award_name+'X'+fe.data.award_num.toString(),fe.data.award_num);break;default:-1<fe.msg.indexOf('\u62D2\u7EDD')?!1==ue.CONFIG.FORCE_LOTTERY?(ue.blocked=!0,Te.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++w?ue.guard_join(pe,id):(w=0,Te.resolve('[\u793C\u7269\u62BD\u5956](roomid='+pe+',id='+raffleId+',type='+type+')'+fe.msg)):Te.resolve('[\u4E0A\u8239](roomid='+pe+',id='+Ie+')'+fe.msg);}}),Te},pk_join:function pk_join(pe,Ie){var Te=$.Deferred();return S.Lottery.Pk.join(pe,Ie).then(function(fe){switch(Z('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',fe),fe.code){case 0:fe.data.award_text?Te.resolve(fe.data.award_text,fe.data.award_num):Te.resolve(fe.data.award_name+'X'+fe.data.award_num.toString(),fe.data.award_num);break;default:-1<fe.msg.indexOf('\u62D2\u7EDD')?!1==ue.CONFIG.FORCE_LOTTERY?(ue.blocked=!0,Te.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++k?ue.pk_join(pe,id):(k=0,Te.resolve('[\u793C\u7269\u62BD\u5956](roomid='+pe+',id='+raffleId+',type='+type+')'+fe.msg)):Te.resolve('[PK](roomid='+pe+',id='+Ie+')'+fe.msg);}}),Te},GroupSign:{getGroups:function getGroups(){return S.Group.my_groups().then(function(pe){return(Z('GroupSign.getGroups: API.Group.my_groups',pe),0===pe.code)?$.Deferred().resolve(pe.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+pe.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.GroupSign.getGroups()})})},signInList:function signInList(pe){var Ie=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(Ie>=pe.length)return $.Deferred().resolve();var Te=pe[Ie];return Te.owner_uid==P.uid?GroupSign.signInList(pe,Ie+1):S.Group.sign_in(Te.group_id,Te.owner_uid).then(function(fe){Z('GroupSign.signInList: API.Group.sign_in',fe);var me=$.Deferred();if(0===fe.code)0<fe.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+Te.group_id+',owner_uid='+Te.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+fe.data.add_num,'success'),me.resolve()):0==fe.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+Te.group_id+',owner_uid='+Te.owner_uid+')\u5DF2\u7B7E\u5230','caution'),me.resolve()):me.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+fe.msg,'caution'),$.Deferred().reject();return $.when(ue.GroupSign.signInList(pe,Ie+1),me)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+Te.group_id+',owner_uid='+Te.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.GroupSign.signInList(pe,Ie)})})},run:function run(){try{return ue.CONFIG.AUTO_GROUP_SIGN?_e(ue.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=ue.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(ue.GroupSign.run,u(8,0)),$.Deferred().resolve()):ue.GroupSign.getGroups().then(function(pe){return ue.GroupSign.signInList(pe).then(function(){return ue.CACHE.AUTO_GROUP_SIGH_TS=X(),ue.saveCache(),te(ue.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return z(function(){return ue.GroupSign.run()})})},function(){return z(function(){return ue.GroupSign.run()})}):(te(ue.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(pe){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',pe),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return S.DailyReward.login().then(function(){Z('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.DailyReward.login()})})},watch:function watch(pe,Ie){return ue.CONFIG.WATCH?S.DailyReward.watch(pe,Ie,P.uid,K()).then(function(Te){Z('DailyReward.watch: API.DailyReward.watch',Te),0===Te.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+pe+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+Te.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.DailyReward.watch(pe,Ie)})}):$.Deferred().resolve()},coin:function coin(pe,Ie){var Te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,fe=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!ue.CONFIG.COIN)return $.Deferred().resolve();if(ue.DailyReward.coin_exp>=10*ue.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(Te>=pe.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var me=JSON.parse(pe[Te].card),Ee=_Mathmin(2,Ie);fe&&(Ee=1),S.x.getCoinInfo('','jsonp',me.aid,X()).then(function(ve){return 2===ve.data.multiply?(Z('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+me.aid),ue.DailyReward.coin(vlist,Ie,Te+1)):S.DailyReward.coin(me.aid,Ee).then(function(Oe){return(Z('DailyReward.coin: API.DailyReward.coin',Oe),0===Oe.code)?(ue.DailyReward.coin_exp+=10*Ee,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+me.aid+',num='+Ee+')','success'),ue.DailyReward.coin(pe,Ie-Ee,Te+1)):-110===Oe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===Oe.code?fe?ue.DailyReward.coin(pe,Ie,Te+1):ue.DailyReward.coin(pe,Ie,Te,!0):34005===Oe.code?ue.DailyReward.coin(pe,Ie,Te+1):-104===Oe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+Oe.msg,'caution'),ue.DailyReward.coin(pe,Ie,Te+1))},function(){return z(function(){return ue.DailyReward.coin(pe,Ie,Te)})})})},coin_uid:function coin_uid(pe,Ie,Te,fe){var me=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,Ee=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!ue.CONFIG.COIN)return $.Deferred().resolve();if(ue.DailyReward.coin_exp>=10*ue.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();me>=pe.length&&ue.DailyReward.UserSpace(ue.CONFIG.COIN_UID,30,0,Te++,'','pubdate','jsonp');var ve=pe[me];if(1===ve.is_union_video||ve.mid!=fe)return Z('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+ve.aid),ue.DailyReward.coin_uid(pe,Ie,Te,fe,me+1);var Oe=_Mathmin(2,Ie);Ee&&(Oe=1),S.x.getCoinInfo('','jsonp',ve.aid,X()).then(function(xe){return 2===xe.data.multiply?(Z('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+ve.aid),ue.DailyReward.coin_uid(pe,Ie,Te,fe,me+1)):S.DailyReward.coin(ve.aid,Oe).then(function(he){return(Z('DailyReward.coin_uid: API.DailyReward.coin_uid',he),0===he.code)?(ue.DailyReward.coin_exp+=10*Oe,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+ve.aid+',num='+Oe+')','success'),ue.DailyReward.coin_uid(pe,Ie-Oe,Te,fe,me+1)):-110===he.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===he.code?Ee?ue.DailyReward.coin_uid(pe,Ie,Te,fe,me+1):ue.DailyReward.coin_uid(pe,Ie,me,Te,fe,!0):34005===he.code?ue.DailyReward.coin_uid(pe,Ie,Te,fe,me+1):-104===he.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+he.msg,'caution'),ue.DailyReward.coin_uid(pe,Ie,Te,fe,me+1))},function(){return z(function(){return ue.DailyReward.coin_uid(pe,Ie,Te,fe,me)})})})},share:function share(pe){return ue.CONFIG.SHARE?S.DailyReward.share(pe).then(function(Ie){Z('DailyReward.share: API.DailyReward.share',Ie),0===Ie.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+pe+')','success'):71000===Ie.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+Ie.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.DailyReward.share(pe)})}):$.Deferred().resolve()},dynamic:function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(){var Te,fe;return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return Te=void 0,fe=ue.CONFIG.COIN_NUMBER-ue.DailyReward.coin_exp/10,Ee.next=4,S.getuserinfo().then(function(ve){return Z('DailyReward.dynamic: API.getuserinfo',ve),ve.data.biliCoin<fe?ve.data.biliCoin:fe});case 4:return Te=Ee.sent,Te<fe&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+Te+'\u4E2A\u5E01','warning'),Ee.abrupt('return',S.dynamic_svr.dynamic_new(P.uid,8).then(function(ve){if(Z('DailyReward.dynamic: API.dynamic_svr.dynamic_new',ve),0===ve.code){if(!!ve.data.cards){var he,Oe=JSON.parse(ve.data.cards[0].card),xe=ue.DailyReward.watch(Oe.aid,Oe.cid);he=0==ue.CONFIG.COIN_UID||'COIN_DYN'==ue.CONFIG.COIN_TYPE?ue.DailyReward.coin(ve.data.cards,_Mathmax(Te,0)):ue.DailyReward.UserSpace(ue.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var Ce=ue.DailyReward.share(Oe.aid);return $.when(xe,he,Ce)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+ve.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.DailyReward.dynamic()})}));case 7:case'end':return Ee.stop();}},Ie,ge)}));return function dynamic(){return pe.apply(this,arguments)}}(),UserSpace:function UserSpace(pe,Ie,Te,fe,me,Ee,ve){return S.x.getUserSpace(pe,Ie,Te,fe,me,Ee,ve).then(function(Oe){if(Z('DailyReward.UserSpace: API.dynamic_svr.UserSpace',Oe),0===Oe.code){if(!!Oe.data.list.vlist){var xe=ue.CONFIG.COIN_NUMBER-ue.DailyReward.coin_exp/10,he=ue.DailyReward.coin_uid(Oe.data.list.vlist,_Mathmax(xe,0),fe,pe);return he}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+Oe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.DailyReward.UserSpace(pe,Ie,Te,fe,me,Ee,ve)})})},run:function run(){try{return _e(ue.CACHE.DailyReward_TS)?S.DailyReward.exp().then(function(pe){return Z('DailyReward.run: API.DailyReward.exp',pe),0===pe.code?(ue.DailyReward.coin_exp=pe.number,ue.DailyReward.login(),ue.DailyReward.dynamic().then(function(){ue.CACHE.DailyReward_TS=X(),ue.saveCache(),J(ue.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+pe.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.DailyReward.run()})}):(J(ue.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(pe){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',pe),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return S.xlive.dosign().then(function(pe){Z('LiveReward.dailySignIn: API.xlive.dosign',pe),0===pe.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===pe.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+pe.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.LiveReward.dailySignIn()})})},run:function run(){try{if(!ue.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!_e(ue.CACHE.LiveReward_TS))return J(ue.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();ue.LiveReward.dailySignIn(),ue.CACHE.LiveReward_TS=X(),ue.saveCache(),J(ue.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(pe){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',pe),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return S.Exchange.silver2coin().then(function(pe){Z('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',pe),0===pe.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+pe.msg,'success'):403===pe.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+pe.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+pe.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return ue.CONFIG.SILVER2COIN?_e(ue.CACHE.Silver2Coin_TS)?ue.Exchange.silver2coin().then(function(){ue.CACHE.Silver2Coin_TS=X(),ue.saveCache(),J(ue.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return z(function(){return ue.Exchange.runS2C()})}):(J(ue.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(pe){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',pe),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!ue.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var pe=$.Deferred();return Q(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),pe.resolve(),!0;var Ie=$('#gift-control-vm div.treasure-box.p-relative');if(!Ie.length)return!1;Ie=Ie.first(),Ie.attr('id','old_treasure_box'),Ie.hide();var Te=$('<div id="'+N+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');ue.TreasureBox.DOM.div_tip=$('<div id="'+N+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),ue.TreasureBox.DOM.div_timer=$('<div id="'+N+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),ue.TreasureBox.DOM.image=$('<img id="'+N+'_treasure_image" style="display:none">'),ue.TreasureBox.DOM.canvas=$('<canvas id="'+N+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var fe='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';ue.TreasureBox.DOM.div_tip[0].style=fe,ue.TreasureBox.DOM.div_timer[0].style=fe,Te.append(ue.TreasureBox.DOM.div_tip),Te.append(ue.TreasureBox.DOM.image),Te.append(ue.TreasureBox.DOM.canvas),ue.TreasureBox.DOM.div_tip.after(ue.TreasureBox.DOM.div_timer),Ie.after(Te);try{if(OCRAD);}catch(me){return ue.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+N+']',me),pe.resolve(),!0}return ue.TreasureBox.timer=setInterval(function(){var me=parseInt(ue.TreasureBox.DOM.div_timer.text(),10);isNaN(me)&&(me=0),0<me?ue.TreasureBox.DOM.div_timer.text(me-1+'s'):ue.TreasureBox.DOM.div_timer.hide()},1e3),ue.TreasureBox.DOM.image[0].onload=function(){var me=ue.TreasureBox.DOM.canvas[0].getContext('2d');me.font='40px agencyfbbold',me.textBaseline='top',me.clearRect(0,0,ue.TreasureBox.DOM.canvas[0].width,ue.TreasureBox.DOM.canvas[0].height),me.drawImage(ue.TreasureBox.DOM.image[0],0,0);var Ee=ue.TreasureBox.captcha.OCR.getGrayscaleMap(me),ve=ue.TreasureBox.captcha.OCR.orderFilter2In3x3(Ee);me.clearRect(0,0,120,40);for(var xe,Oe=0;Oe<ve.length;++Oe)xe=ve[Oe],me.fillStyle='rgb('+xe+', '+xe+', '+xe+')',me.fillRect(Oe%120,_Mathround(Oe/120),1,1);try{var Oe=ue.TreasureBox.captcha.correctQuestion(OCRAD(me.getImageData(0,0,120,40)));Z('TreasureBox.DOM.image.load','question =',Oe);var xe=ue.TreasureBox.captcha.eval(Oe);Z('TreasureBox.DOM.image.load','answer =',xe),void 0!==xe&&(console.info('['+N+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+Oe+' = '+xe),ue.TreasureBox.promise.calc.resolve(xe))}catch(Oe){ue.TreasureBox.promise.calc.reject()}},pe.resolve(),!0}catch(Ie){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Ie),pe.reject(),!0}}),pe},run:function run(){try{if(!ue.CONFIG.AUTO_TREASUREBOX||!ue.TreasureBox.timer)return;if(P.blocked)return ue.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!_e(ue.CACHE.TreasureBox_TS))return ue.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void J(ue.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');ue.TreasureBox.getCurrentTask().then(function(pe){if(Z('TreasureBox.run: TreasureBox.getCurrentTask().then',pe),0===pe.code){ue.TreasureBox.promise.timer=$.Deferred(),ue.TreasureBox.promise.timer.then(function(){ue.TreasureBox.captcha.calc().then(function(Te){ue.TreasureBox.getAward(Te).then(function(){return ue.TreasureBox.run()},function(){return ue.TreasureBox.run()})},function(){return TreasureBox.run()})}),ue.TreasureBox.time_end=pe.data.time_end,ue.TreasureBox.time_start=pe.data.time_start;var Ie=ue.TreasureBox.time_end-K()+1;0>Ie&&(Ie=0),setTimeout(function(){ue.TreasureBox.promise.timer&&ue.TreasureBox.promise.timer.resolve()},1e3*Ie),ue.TreasureBox.DOM.div_timer.text(Ie+'s'),ue.TreasureBox.DOM.div_timer.show(),ue.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+pe.data.times+'/'+pe.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+pe.data.silver)}else if(-10017===pe.code)ue.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),ue.CACHE.TreasureBox_TS=X(),ue.saveCache(),J(ue.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===pe.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+pe.msg,'caution'),ue.TreasureBox.run()})}catch(pe){ue.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',pe)}},setMsg:function setMsg(pe){ue.CONFIG.AUTO_TREASUREBOX&&(ue.TreasureBox.promise.timer&&(ue.TreasureBox.promise.timer.reject(),ue.TreasureBox.promise.timer=void 0),ue.TreasureBox.DOM.div_timer&&ue.TreasureBox.DOM.div_timer.hide(),ue.TreasureBox.DOM.div_tip&&ue.TreasureBox.DOM.div_tip.html(pe))},getAward:function getAward(pe){var Ie=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return ue.CONFIG.AUTO_TREASUREBOX?3<Ie?$.Deferred().resolve():S.TreasureBox.getAward(ue.TreasureBox.time_start,ue.TreasureBox.time_end,pe).then(function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee;return regeneratorRuntime.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:Z('TreasureBox.getAward: getAward',me),Oe.t0=me.code,Oe.next=0===Oe.t0?4:-903===Oe.t0?5:-902===Oe.t0?6:-901===Oe.t0?6:-10017===Oe.t0?6:-800===Oe.t0?9:-500===Oe.t0?12:400===Oe.t0?15:22;break;case 4:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+me.data.awardSilver+' \u94F6\u74DC\u5B50','success');case 5:return Oe.abrupt('return',$.Deferred().resolve());case 6:return Oe.next=8,C(150);case 8:return Oe.abrupt('return',ue.TreasureBox.captcha.calc().then(function(xe){return ue.TreasureBox.getAward(xe,Ie)}));case 9:return ue.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),Oe.abrupt('return',$.Deferred().reject());case 12:return Ee=$.Deferred(),setTimeout(function(){ue.TreasureBox.captcha.calc().then(function(xe){ue.TreasureBox.getAward(xe,Ie+1).then(function(){return Ee.resolve()},function(){return Ee.reject()})},function(){return Ee.reject()})},3e3),Oe.abrupt('return',Ee);case 15:if(!(-1<me.msg.indexOf('\u62D2\u7EDD'))){Oe.next=20;break}return P.blocked=!0,ue.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),Oe.abrupt('return',$.Deferred().reject());case 20:return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+me.msg,'caution'),Oe.abrupt('return',$.Deferred().resolve());case 22:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+me.msg,'caution');case 23:case'end':return Oe.stop();}},fe,ge)}));return function(){return Te.apply(this,arguments)}}(),function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.TreasureBox.getAward(pe,Ie)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return ue.CONFIG.AUTO_TREASUREBOX?S.TreasureBox.getCurrentTask().then(function(pe){return Z('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',pe),$.Deferred().resolve(pe)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return ue.CONFIG.AUTO_TREASUREBOX?20<ue.TreasureBox.captcha.cnt?(ue.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):S.TreasureBox.getCaptcha(X()).then(function(pe){if(Z('TreasureBox.captcha.calc: getCaptcha',pe),0===pe.code){ue.TreasureBox.captcha.cnt++;var Ie=$.Deferred();return ue.TreasureBox.promise.calc=$.Deferred(),ue.TreasureBox.promise.calc.then(function(Te){ue.TreasureBox.captcha.cnt=0,Ie.resolve(Te)},function(){ue.TreasureBox.captcha.calc().then(function(Te){Ie.resolve(Te)},function(){Ie.reject()})}),ue.TreasureBox.DOM.image.attr('src',pe.data.img),Ie}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+pe.msg,'caution'),z(function(){return ue.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.TreasureBox.captcha.calc()})}):(ue.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(pe){for(var Ie=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,Te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,fe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,me=pe.getImageData(0,0,Te,fe).data,Ee=[],ve=0;ve<fe;ve++)for(var Oe=0;Oe<Te;Oe++){var xe=4*(ve*Te+Oe),he=me.slice(xe,xe+4),Ce=he?77*he[0]+150*he[1]+29*he[2]+128>>8:0;Ee.push(Ce>Ie?Ce:0)}return Ee},orderFilter2In3x3:function orderFilter2In3x3(pe){for(var Ie=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,Te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,fe=function gray(Ce,Ge){return 0<=Ce+Ge*Te?pe[Ce+Ge*Te]:255},me=[],Ee=pe.length,Ce=0;Ce<Ee;++Ce){var Oe=[Ce%Te,_Mathfloor(Ce/Te)],xe=Oe[0],he=Oe[1],Ge=Array(9);Ge[0]=fe(xe-1,he-1),Ge[1]=fe(xe+0,he-1),Ge[2]=fe(xe+1,he-1),Ge[3]=fe(xe-1,he+0),Ge[4]=fe(xe+0,he+0),Ge[5]=fe(xe+1,he+0),Ge[6]=fe(xe-1,he+1),Ge[7]=fe(xe+0,he+1),Ge[8]=fe(xe+1,he+1),Ge.sort(function(Re,Ae){return Re-Ae}),me.push(Ge[Ie-1])}return me}},eval:function _eval(pe){var Ie=Function;return new Ie('return '+pe)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(pe){var Ie='';for(var Te in pe=pe.trim(),pe){var fe=ue.TreasureBox.captcha.correctStr[pe[Te]];Ie+=void 0===fe?pe[Te]:fe}'4'===Ie[2]&&(Ie[2]='+');for(var Te=0;Te<=parseInt(Ie.length-2);Te++)'\''===Ie[Te]&&'1'===Ie[Te+1]&&(Ie[Te]='7',Ie.splice(Te+1,1));return Ie}}},Gift:(ce={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(ce,'run_timer',void 0),_defineProperty(ce,'sendGiftList',[1,6,30607]),_defineProperty(ce,'getMedalList',function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(){var Te=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return 1===Te&&(ue.Gift.medal_list=[]),me.next=3,S.i.medal(Te,25).then(function(Ee){if(Z('Gift.getMedalList: API.i.medal',Ee),ue.Gift.medal_list=ue.Gift.medal_list.concat(Ee.data.fansMedalList),Ee.data.pageinfo.curPage<Ee.data.pageinfo.totalpages)return ue.Gift.getMedalList(Te+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.Gift.getMedalList()})});case 3:return me.abrupt('return',me.sent);case 4:case'end':return me.stop();}},Ie,ge)}));return function getMedalList(){return pe.apply(this,arguments)}}()),_defineProperty(ce,'getBagList',function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(){return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.next=2,S.gift.bag_list().then(function(me){Z('Gift.getBagList: API.gift.bag_list',me),ue.Gift.bag_list=me.data.list,ue.Gift.time=me.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.Gift.getBagList()})});case 2:return fe.abrupt('return',fe.sent);case 3:case'end':return fe.stop();}},Ie,ge)}));return function getBagList(){return pe.apply(this,arguments)}}()),_defineProperty(ce,'getFeedByGiftID',function getFeedByGiftID(pe){for(var Ie=P.gift_list.length-1;0<=Ie;--Ie)if(P.gift_list[Ie].id===pe)return Math.ceil(P.gift_list[Ie].price/100);return 0}),_defineProperty(ce,'sort_medals',function sort_medals(pe){if(ue.CONFIG.GIFT_SORT?pe.sort(function(Oe,xe){return 0==xe.level-Oe.level?xe.intimacy-Oe.intimacy:xe.level-Oe.level}):pe.sort(function(Oe,xe){return 0==Oe.level-xe.level?Oe.intimacy-xe.intimacy:Oe.level-xe.level}),ue.CONFIG.AUTO_GIFT_ROOMID&&0<ue.CONFIG.AUTO_GIFT_ROOMID.length){var Oe=ue.CONFIG.AUTO_GIFT_ROOMID.split(',');Oe.reverse();var Ie=!0,Te=!1,fe=void 0;try{for(var ve,me=function _loop2(){var xe=ve.value,he=pe.findIndex(function(Ce){return Ce.roomid==xe});if(-1!=he){var Ce=pe[he];pe.splice(he,1),pe.unshift(Ce)}},Ee=Oe[Symbol.iterator]();!(Ie=(ve=Ee.next()).done);Ie=!0)me()}catch(xe){Te=!0,fe=xe}finally{try{!Ie&&Ee.return&&Ee.return()}finally{if(Te)throw fe}}}return pe}),_defineProperty(ce,'auto_light',function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(Te){var fe,me,Ee,ve,Oe,xe,he,Ce,Ge,Re,Ae,Ne,ye,De,Me,be;return regeneratorRuntime.wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:Se.prev=0,fe=ue.Gift.getFeedByGiftID(30607),me=ue.CONFIG.LIGHT_MEDALS.split(','),Ee=void 0,Ee='LIGHT_WHITE'==ue.CONFIG.LIGHT_METHOD?Te.filter(function(Fe){return 0==Fe.is_lighted&&Fe.day_limit-Fe.today_feed>=fe&&0<=me.findIndex(function(we){return we==Fe.roomid})}):Te.filter(function(Fe){return 0==Fe.is_lighted&&Fe.day_limit-Fe.today_feed>=fe&&-1==me.findIndex(function(we){return we==Fe.roomid})});;if(Z('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',Ee),!(Ee&&0<Ee.length)){Se.next=52;break}return Ee=ue.Gift.sort_medals(Ee),Se.next=11,ue.Gift.getBagList();case 11:if(ve=ue.Gift.bag_list.filter(function(Fe){return 30607==Fe.gift_id}),!(ve&&0<ve.length)){Se.next=52;break}Oe=!0,xe=!1,he=void 0,Se.prev=16,Ce=Ee[Symbol.iterator]();case 18:if(Oe=(Ge=Ce.next()).done){Se.next=38;break}if(Re=Ge.value,Ae=ve.find(function(Fe){return 30607==Fe.gift_id&&0<Fe.gift_num}),!Ae){Se.next=34;break}if(Ne=Re.day_limit-Re.today_feed,!(0<=Ne-fe||ue.CONFIG.FORCE_LIGHT)){Se.next=33;break}return Se.next=26,S.room.room_init(parseInt(Re.roomid,10));case 26:return ye=Se.sent,De=parseInt(ye.data.room_id,10),Me=1,Se.next=31,S.gift.bag_send(P.uid,30607,Re.target_id,Me,Ae.bag_id,De,P.rnd);case 31:be=Se.sent,0===be.code?(Ae.gift_num-=Me,Re.today_feed+=Me*fe,Ne-=Me*fe,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Re.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Me+'\u4E2A'+Ae.gift_name+'\uFF0C['+Re.today_feed+'/'+Re.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+Ne+']','success'),Z('Gift.auto_light','\u52CB\u7AE0['+Re.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Me+'\u4E2A'+Ae.gift_name+'\uFF0C['+Re.today_feed+'/'+Re.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Re.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+ye.msg+'\u3011','caution');case 33:return Se.abrupt('continue',35);case 34:return Se.abrupt('break',38);case 35:Oe=!0,Se.next=18;break;case 38:Se.next=44;break;case 40:Se.prev=40,Se.t0=Se['catch'](16),xe=!0,he=Se.t0;case 44:Se.prev=44,Se.prev=45,!Oe&&Ce.return&&Ce.return();case 47:if(Se.prev=47,!xe){Se.next=50;break}throw he;case 50:return Se.finish(47);case 51:return Se.finish(44);case 52:Se.next=58;break;case 54:Se.prev=54,Se.t1=Se['catch'](0),console.error(Se.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+Se.t1,'error');case 58:case'end':return Se.stop();}},Ie,ge,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return pe.apply(this,arguments)}}()),_defineProperty(ce,'run',function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(){var Te,fe,me,Ee,ve,Oe,xe,he;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:if(Te=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.Gift.run()})},fe=function nextTimeDebug(){if('GIFT_SEND_TIME'==ue.CONFIG.GIFT_METHOD){var Re=u(ue.CONFIG.GIFT_SEND_HOUR,ue.CONFIG.GIFT_SEND_MINUTE);ue.Gift.run_timer=setTimeout(ue.Gift.run,Re);var Ae=new Date(X()+Re).toLocaleString();Z('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ae+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),ue.CACHE.Gift_TS=X(),ue.saveCache()}else Z('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+ue.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),ue.CACHE.GiftInterval_TS=X(),ue.saveCache()},Ge.prev=2,ue.CONFIG.AUTO_GIFT){Ge.next=5;break}return Ge.abrupt('return',$.Deferred().resolve());case 5:if(ue.Gift.run_timer&&clearTimeout(ue.Gift.run_timer),'GIFT_SEND_TIME'!=ue.CONFIG.GIFT_METHOD||E(ue.CONFIG.GIFT_SEND_HOUR,ue.CONFIG.GIFT_SEND_MINUTE)||!1!=U){Ge.next=14;break}return me=u(ue.CONFIG.GIFT_SEND_HOUR,ue.CONFIG.GIFT_SEND_MINUTE),ue.Gift.run_timer=setTimeout(ue.Gift.run,me),Ee=new Date(X()+me).toLocaleString(),Z('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ee+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ge.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=ue.CONFIG.GIFT_METHOD||!1!=U){Ge.next=27;break}if(ve=6e4*ue.CONFIG.GIFT_INTERVAL,!ue.CACHE.GiftInterval_TS){Ge.next=25;break}if(Oe=X()-ue.CACHE.GiftInterval_TS,!(Oe<ve)){Ge.next=23;break}return xe=ve-Oe,ue.Gift.run_timer=setTimeout(function(){return ue.Gift.run()},xe),Z('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+xe+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ge.abrupt('return');case 23:Ge.next=27;break;case 25:ue.CACHE.GiftInterval_TS=X(),ue.saveCache();case 27:return ue.Gift.over=!1,Ge.next=30,ue.Gift.getMedalList();case 30:if(he=ue.Gift.medal_list,Z('Gift.run: Gift.getMedalList().then: Gift.medal_list',he),!(he&&0<he.length)){Ge.next=34;break}return Ge.delegateYield(regeneratorRuntime.mark(function Re(){var Ae,Ne,ye,De,Me,be,Le,Se,Fe,we;return regeneratorRuntime.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:he=he.filter(function(He){return 0<He.day_limit-He.today_feed&&20>He.level}),he=ue.Gift.sort_medals(he),ue.CONFIG.EXCLUDE_ROOMID&&0<ue.CONFIG.EXCLUDE_ROOMID.length&&(Ae=ue.CONFIG.EXCLUDE_ROOMID.split(','),he=he.filter(function(He){return-1==Ae.findIndex(function(Be){return Be==He.roomid})}));;return Ue.next=6,ue.Gift.auto_light(he);case 6:Ne=86400*ue.CONFIG.GIFT_LIMIT,ye=!0,De=!1,Me=void 0,Ue.prev=10,be=he[Symbol.iterator]();case 12:if(ye=(Le=be.next()).done){Ue.next=30;break}if(Se=Le.value,!ue.Gift.over){Ue.next=16;break}return Ue.abrupt('break',30);case 16:return Ue.next=18,S.room.room_init(parseInt(Se.roomid,10));case 18:if(Fe=Ue.sent,ue.Gift.room_id=parseInt(Fe.data.room_id,10),ue.Gift.ruid=Se.target_id,ue.Gift.remain_feed=Se.day_limit-Se.today_feed,!(0<ue.Gift.remain_feed)){Ue.next=27;break}return Ue.delegateYield(regeneratorRuntime.mark(function He(){var Be,Pe,Ye;return regeneratorRuntime.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,ue.Gift.getBagList();case 2:if(Be=K(),ue.CONFIG.SEND_ALL_GIFT){Ve.next=7;break}if(Pe=ue.Gift.bag_list.filter(function(Xe){return ue.Gift.sendGiftList.includes(Xe.gift_id)&&0<Xe.gift_num&&Xe.expire_at>Be&&Xe.expire_at-Be<Ne}),0!=Pe.length){Ve.next=7;break}return Ve.abrupt('return','break');case 7:;if(!(0<ue.Gift.remain_feed)){Ve.next=21;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Se.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+Se.today_feed+'/'+Se.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+ue.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Ve.next=12,ue.Gift.sendGift(Se);case 12:if(ue.CONFIG.SEND_ALL_GIFT){Ve.next=19;break}if(Ye=ue.Gift.bag_list.filter(function(Xe){return ue.Gift.sendGiftList.includes(Xe.gift_id)&&0<Xe.gift_num&&Xe.expire_at>Be&&Xe.expire_at-Be<Ne}),0!=Ye.length){Ve.next=18;break}return Ve.abrupt('return','break');case 18:ue.Gift.bag_list=Ye;case 19:Ve.next=22;break;case 21:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Se.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 22:case'end':return Ve.stop();}},He,ge)})(),'t0',24);case 24:if(we=Ue.t0,'break'!==we){Ue.next=27;break}return Ue.abrupt('break',30);case 27:ye=!0,Ue.next=12;break;case 30:Ue.next=36;break;case 32:Ue.prev=32,Ue.t1=Ue['catch'](10),De=!0,Me=Ue.t1;case 36:Ue.prev=36,Ue.prev=37,!ye&&be.return&&be.return();case 39:if(Ue.prev=39,!De){Ue.next=42;break}throw Me;case 42:return Ue.finish(39);case 43:return Ue.finish(36);case 44:case'end':return Ue.stop();}},Re,ge,[[10,32,36,44],[37,,39,43]])})(),'t0',34);case 34:return Ge.next=36,ue.Gift.sendRemainGift(ue.CONFIG.SPARE_GIFT_ROOM,ue.CONFIG.SPARE_GIFT_UID);case 36:Ge.next=44;break;case 38:return Ge.prev=38,Ge.t1=Ge['catch'](2),Te(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Ge.t1),Ge.abrupt('return',$.Deferred().reject());case 44:return U=!1,fe(),Ge.abrupt('return',$.Deferred().resolve());case 47:case'end':return Ge.stop();}},Ie,ge,[[2,38]])}));return function run(){return pe.apply(this,arguments)}}()),_defineProperty(ce,'sendGift',function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(Te){var fe,me,Ee,ve,Oe,xe,he,Ce,Ge,Re;return regeneratorRuntime.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return Ne.next=2,ue.Gift.getBagList();case 2:if(fe=void 0,!(0>=ue.Gift.remain_feed)){Ne.next=6;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Te.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+Te.today_feed+'/'+Te.day_limit+']','info'),Ne.abrupt('return',$.Deferred().resolve());case 6:if(0>=ue.Gift.time&&(ue.Gift.time=K()),ue.CONFIG.SEND_ALL_GIFT){Ne.next=17;break}if(me=ue.Gift.bag_list.filter(function(ye){return ue.Gift.sendGiftList.includes(ye.gift_id)&&0<ye.gift_num&&ye.corner_mark.substring(0,ye.corner_mark.indexOf('\u5929'))==ue.CONFIG.GIFT_LIMIT}),0!=me.length){Ne.next=14;break}return ue.Gift.over=!0,Ne.abrupt('return');case 14:fe=me;case 15:Ne.next=24;break;case 17:if(Ee=ue.Gift.bag_list.filter(function(ye){return 0<ye.gift_num&&'\u6C38\u4E45'!=ye.corner_mark}),0!=Ee.length){Ne.next=23;break}return ue.Gift.over=!0,Ne.abrupt('return');case 23:fe=Ee;case 24:Z('bag_list',fe),ve=!0,Oe=!1,xe=void 0,Ne.prev=28,he=regeneratorRuntime.mark(function(){var ye,De,Me;return regeneratorRuntime.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:if(ye=Ge.value,!(0>=Te.day_limit-Te.today_feed)){Le.next=4;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Te.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+Te.today_feed+'/'+Te.day_limit+']','info'),Le.abrupt('return',{v:void 0});case 4:if(De=ue.Gift.getFeedByGiftID(ye.gift_id),30607===ye.gift_id&&(De=50),!(0<De)){Le.next=13;break}if(Me=_Mathfloor(ue.Gift.remain_feed/De),Me>ye.gift_num&&(Me=ye.gift_num),!(0<Me)){Le.next=13;break}return Z('[\u81EA\u52A8\u9001\u793C]\u9001\u51FA\u793C\u7269\u7C7B\u578B',ye.gift_name),Le.next=13,S.gift.bag_send(P.uid,ye.gift_id,ue.Gift.ruid,Me,ye.bag_id,ue.Gift.room_id,P.rnd).then(function(Se){Z('Gift.sendGift: API.gift.bag_send',Se),0===Se.code?(ye.gift_num-=Me,Te.today_feed+=Me*De,ue.Gift.remain_feed-=Me*De,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Te.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Me+'\u4E2A'+ye.gift_name+'\uFF0C['+Te.today_feed+'/'+Te.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+ue.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Te.medalName+'] \u9001\u793C\u5F02\u5E38:'+Se.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.Gift.sendGift(Te)})});case 13:case'end':return Le.stop();}},he,ge)}),Ce=fe[Symbol.iterator]();case 31:if(ve=(Ge=Ce.next()).done){Ne.next=39;break}return Ne.delegateYield(he(),'t0',33);case 33:if(Re=Ne.t0,'object'!==('undefined'==typeof Re?'undefined':_typeof(Re))){Ne.next=36;break}return Ne.abrupt('return',Re.v);case 36:ve=!0,Ne.next=31;break;case 39:Ne.next=45;break;case 41:Ne.prev=41,Ne.t1=Ne['catch'](28),Oe=!0,xe=Ne.t1;case 45:Ne.prev=45,Ne.prev=46,!ve&&Ce.return&&Ce.return();case 48:if(Ne.prev=48,!Oe){Ne.next=51;break}throw xe;case 51:return Ne.finish(48);case 52:return Ne.finish(45);case 53:case'end':return Ne.stop();}},Ie,ge,[[28,41,45,53],[46,,48,52]])}));return function sendGift(){return pe.apply(this,arguments)}}()),_defineProperty(ce,'sendRemainGift',function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(Te,fe){var me,Ee,ve,Oe,xe,he,Ce,Ge,Re;return regeneratorRuntime.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return Ne.next=2,ue.Gift.getBagList();case 2:if(me=void 0,0>=ue.Gift.time&&(ue.Gift.time=K()),ue.CONFIG.SEND_ALL_GIFT){Ne.next=14;break}if(Ee=ue.Gift.bag_list.filter(function(ye){return ue.Gift.sendGiftList.includes(ye.gift_id)&&0<ye.gift_num&&'1\u5929'==ye.corner_mark}),0!=Ee.length){Ne.next=11;break}return ue.Gift.over=!0,Ne.abrupt('return');case 11:me=Ee;case 12:Ne.next=21;break;case 14:if(ve=ue.Gift.bag_list.filter(function(ye){return 0<ye.gift_num&&'\u6C38\u4E45'!=ye.corner_mark}),0!=ve.length){Ne.next=20;break}return ue.Gift.over=!0,Ne.abrupt('return');case 20:me=ve;case 21:Z('\u3010\u5269\u4F59\u793C\u7269\u3011bag_list',me),Oe=!0,xe=!1,he=void 0,Ne.prev=25,Ce=regeneratorRuntime.mark(function(){var ye,De,Me;return regeneratorRuntime.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:if(ye=Re.value,De=ue.Gift.getFeedByGiftID(ye.gift_id),!(0<De)){Le.next=7;break}if(Me=ye.gift_num,!(0<Me)){Le.next=7;break}return Le.next=7,S.gift.bag_send(P.uid,ye.gift_id,fe,Me,ye.bag_id,Te,P.rnd).then(function(Se){Z('Gift.sendGift: API.gift.bag_send',Se),0===Se.code?(ye.gift_num-=Me,window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+Te+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Me+'\u4E2A'+ye.gift_name,'success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+Te+'] \u9001\u793C\u5F02\u5E38:'+Se.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.Gift.sendGift(medal)})});case 7:case'end':return Le.stop();}},Ce,ge)}),Ge=me[Symbol.iterator]();case 28:if(Oe=(Re=Ge.next()).done){Ne.next=33;break}return Ne.delegateYield(Ce(),'t0',30);case 30:Oe=!0,Ne.next=28;break;case 33:Ne.next=39;break;case 35:Ne.prev=35,Ne.t1=Ne['catch'](25),xe=!0,he=Ne.t1;case 39:Ne.prev=39,Ne.prev=40,!Oe&&Ge.return&&Ge.return();case 42:if(Ne.prev=42,!xe){Ne.next=45;break}throw he;case 45:return Ne.finish(42);case 46:return Ne.finish(39);case 47:case'end':return Ne.stop();}},Ie,ge,[[25,35,39,47],[40,,42,46]])}));return function sendRemainGift(){return pe.apply(this,arguments)}}()),ce),MobileHeartBeat:{run:function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(){var Te,fe,me,Ee;return regeneratorRuntime.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:if(!1!=ue.CONFIG.MOBILE_HEARTBEAT){Oe.next=2;break}return Oe.abrupt('return',$.Deferred().resolve());case 2:if(_e(ue.CACHE.MobileHeartBeat_TS)){Oe.next=5;break}return J(ue.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),Oe.abrupt('return',$.Deferred().resolve());case 5:if(!1!==P.mobile_verify){Oe.next=9;break}return window.toast('[\u79FB\u52A8\u7AEF\u5FC3\u8DF3]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','warning'),Z('MobileHeartBeat','\u672A\u7ED1\u5B9A\u624B\u673A mobile_verify = '+P.mobile_verify),Oe.abrupt('return',$.Deferred().resolve());case 9:return Te=function mobileOnline(){R({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+ne.access_token+'&'+ae),data:'room_id='+P.room_id+'&scale=xxhdpi',responseType:'json',headers:ie.headers})},fe=function EndFunc(xe){Z('MobileHeartBeat GetAward',xe),clearInterval(Ee),ue.CACHE.MobileHeartBeat_TS=X(),ue.saveCache(),J(ue.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3')},me=function getWatchingAward(){S.activity.receive_award('double_watch_task').then(function(xe){return 0===xe.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u6210\u529F','success'),fe(xe),$.Deferred().resolve()):-400===xe.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u5DF2\u9886\u53D6','info'),fe(xe),$.Deferred().resolve()):(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]'+xe,'warning'),fe(xe),$.Deferred().resolve())},function(xe){return window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('MobileHeartBeat GetAward',xe),clearInterval(Ee),z(function(){return ue.MobileHeartBeat.run()})})},Oe.next=14,se();case 14:if(Oe.t1=Oe.sent,Oe.t2=void 0,Oe.t0=Oe.t1===Oe.t2,!Oe.t0){Oe.next=19;break}Oe.t0=void 0===ne.access_token;case 19:if(!Oe.t0){Oe.next=22;break}return Z('MobileHeartBeat','token\u8BBE\u7F6E\u5931\u8D25'),Oe.abrupt('return');case 22:Z('MobileHeartBeat','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),Te(),Ee=void 0,Ee=setInterval(function(){return Te()},300000),setTimeout(function(){return me()},360000);case 27:case'end':return Oe.stop();}},Ie,ge)}));return function run(){return pe.apply(this,arguments)}}()},stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(pe){var Ie=[];try{var Te=JSON.parse(localStorage.getItem(N+'stormIdSet'));Ie=[].concat(Te.list),Ie.push(pe),50<Ie.length&&Ie.splice(0,10),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:Ie})),Z(N+'storm_Id_list_add',Ie)}catch(Te){Ie.push(pe),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:Ie}))}},isIn:function isIn(pe){var Ie=[];try{var Te=JSON.parse(localStorage.getItem(N+'stormIdSet'));return Ie=null===Te?[]:[].concat(Te.list),Z(N+'storm_Id_list_read',Te),-1<Ie.indexOf(pe)}catch(Te){return localStorage.setItem(N+'stormIdSet',JSON.stringify({list:Ie})),Z('\u8BFB\u53D6'+(N+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<Ie.indexOf(pe)}}},Storm:{check:function check(pe){return-1<ue.stormQueue.indexOf(pe)},append:function append(pe){ue.stormQueue.push(pe),ue.stormQueue.length>ue.CONFIG.STORM_QUEUE_SIZE&&ue.stormQueue.shift()},over:function over(pe){var Ie=ue.stormQueue.indexOf(pe);-1<Ie&&ue.stormQueue.splice(pe,1)},run:function run(pe){try{return ue.CONFIG.STORM?ue.stormBlack?$.Deferred().resolve():O(ue.CONFIG.TIME_AREA_START_H0UR,ue.CONFIG.TIME_AREA_END_H0UR,ue.CONFIG.TIME_AREA_START_MINUTE,ue.CONFIG.TIME_AREA_END_MINUTE)&&ue.CONFIG.TIME_AREA_DISABLE?(Z('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+pe),$.Deferred().resolve()):S.Storm.check(pe).then(function(Ie){if(Z('MY_API.Storm.run: MY_API.API.Storm.check',Ie),0===Ie.code){var Te=Ie.data;return ue.Storm.join(Te.id,Te.roomid,_Mathround(new Date().getTime()/1e3)+Te.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+pe+')'+Ie.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+pe+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(Ie){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',Ie),$.Deferred().reject()}},join:function join(pe,Ie,Te){var fe=function(){var Oe=_asyncToGenerator(regeneratorRuntime.mark(function xe(){var he,Ce;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(Re.prev=0,ue.Storm.check(pe)){Re.next=4;break}return clearInterval(Ee),Re.abrupt('return');case 4:if(he=_Mathround(new Date().getTime()/1e3),!(he>Te&&0<Te)){Re.next=9;break}return ue.Storm.over(pe),clearInterval(Ee),Re.abrupt('return');case 9:if(ve++,!(ve>ue.CONFIG.STORM_MAX_COUNT&&0<ue.CONFIG.STORM_MAX_COUNT)){Re.next=15;break}return ue.Storm.over(pe),clearInterval(Ee),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+Ie+',id='+pe+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+ve+',\u8DDD\u79BB\u5230\u671F:'+(Te-he)+'s','caution'),Re.abrupt('return');case 15:if(Ce=void 0,Re.prev=16,!(oe&&ie&&ne.access_token)){Re.next=23;break}return Re.next=20,S.Storm.join_ex(pe,Ie,ne.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:Ce=Re.sent,Re.next=26;break;case 23:return Re.next=25,S.Storm.join(pe,captcha_token='',captcha_phrase='',Ie);case 25:Ce=Re.sent;case 26:if(Z('MY_API.Storm.join: MY_API.API.Storm.join',Ce),!Ce.code){Re.next=51;break}if(-1==Ce.msg.indexOf('\u9886\u53D6')){Re.next=33;break}return ue.Storm.over(pe),clearInterval(Ee),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+Ie+',id='+pe+')\u6210\u529F,'+Ce.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+ve,'success'),Re.abrupt('return');case 33:if(-1==Ce.msg.indexOf('\u9A8C\u8BC1\u7801')){Re.next=39;break}return ue.Storm.over(pe),clearInterval(Ee),ue.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+Ie+',id='+pe+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+Ce.msg,'caution'),Re.abrupt('return');case 39:if(!(Ce.data&&0==Ce.data.length&&-1!=Ce.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){Re.next=46;break}return ue.Storm.over(pe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+Ie+',id='+pe+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(Ee),ue.stormBlack=!0,setTimeout(function(){ue.stormBlack=!1},3600000),Re.abrupt('return');case 46:if(-1!=Ce.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){Re.next=49;break}return clearInterval(Ee),Re.abrupt('return');case 49:Re.next=56;break;case 51:return ue.Storm.over(pe),Statistics.appendGift(Ce.data.gift_name,Ce.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+Ie+',id='+pe+')\u6210\u529F,'+(Ce.data.gift_name+'x'+Ce.data.gift_num)+'\r\n'+Ce.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+ve,'success'),clearInterval(Ee),Re.abrupt('return');case 56:Re.next=65;break;case 58:return Re.prev=58,Re.t0=Re['catch'](16),ue.Storm.over(pe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+Ie+',id='+pe+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+ve,'error'),console.error(Re.t0),clearInterval(Ee),Re.abrupt('return');case 65:Re.next=74;break;case 67:return Re.prev=67,Re.t1=Re['catch'](0),ue.Storm.over(pe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+Ie+',id='+pe+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(Re.t1),clearInterval(Ee),Re.abrupt('return');case 74:case'end':return Re.stop();}},xe,this,[[0,67],[16,58]])}));return function(){return Oe.apply(this,arguments)}}();if(Ie=parseInt(Ie,10),pe=parseInt(pe,10),isNaN(Ie)||isNaN(pe))return $.Deferred().reject();var me=_Mathround(pe/1e6);if(ue.stormIdSet.isIn(me))return $.Deferred().resolve();if(ue.stormIdSet.add(me),!ue.Storm.check(pe)){ue.Storm.append(pe);var Ee=0;0>=Te&&(Te=_Mathround(new Date().getTime()/1e3)+90);var ve=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+Ie+',id='+pe+')','success'),Ee=setInterval(function(){return fe()},ue.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{medalRoom_list:[],liveRoom_list:[],getMedalRoomList:function getMedalRoomList(){var pe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 1===pe&&(ue.LITTLE_HEART.medalRoom_list=[]),S.i.medal(pe,25).then(function(Ie){Z('LITTLE_HEART.getMedalRoomList: API.i.medal',Ie);var Te=!0,fe=!1,me=void 0;try{for(var ve,Oe,Ee=Ie.data.fansMedalList[Symbol.iterator]();!(Te=(ve=Ee.next()).done);Te=!0)Oe=ve.value,ue.LITTLE_HEART.medalRoom_list=ue.LITTLE_HEART.medalRoom_list.concat(Oe.roomid)}catch(Oe){fe=!0,me=Oe}finally{try{!Te&&Ee.return&&Ee.return()}finally{if(fe)throw me}}Z('MY_API.LITTLE_HEART.medalRoom_list',ue.LITTLE_HEART.medalRoom_list),Ie.data.pageinfo.curPage<Ie.data.pageinfo.totalpages&&ue.LITTLE_HEART.getMedalRoomList(pe+1)},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.LITTLE_HEART.getMedalRoomList(pe)})})},checkRoomList:function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(Te){var fe,me,Ee,ve,Oe,xe,he;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:fe=[],me=!0,Ee=!1,ve=void 0,Ge.prev=4,Oe=Te[Symbol.iterator]();case 6:if(me=(xe=Oe.next()).done){Ge.next=13;break}return he=xe.value,Ge.next=10,S.room.get_info(he).then(function(Re){if(1===Re.data.live_status)return void(fe=fe.concat(Re.data.room_id))},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.LITTLE_HEART.checkRoomList(Te)})});case 10:me=!0,Ge.next=6;break;case 13:Ge.next=19;break;case 15:Ge.prev=15,Ge.t0=Ge['catch'](4),Ee=!0,ve=Ge.t0;case 19:Ge.prev=19,Ge.prev=20,!me&&Oe.return&&Oe.return();case 22:if(Ge.prev=22,!Ee){Ge.next=25;break}throw ve;case 25:return Ge.finish(22);case 26:return Ge.finish(19);case 27:;if(Z('MY_API.LITTLE_HEART.checkRoomList returnRoom',fe),void 0==fe){Ge.next=33;break}return Ge.abrupt('return',fe);case 33:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5F53\u524D\u7C89\u4E1D\u52CB\u7AE0\u5217\u8868\u4E2D\u65E0\u6B63\u5728\u76F4\u64AD\u623F\u95F4\uFF0C5\u5206\u949F\u540E\u91CD\u8BD5'),Ge.abrupt('return',z(function(){return ue.LITTLE_HEART.getMedalRoomList(page)},3e5));case 35:case'end':return Ge.stop();}},Ie,ge,[[4,15,19,27],[20,,22,26]])}));return function checkRoomList(){return pe.apply(this,arguments)}}(),checkRoom:function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(Te){var fe;return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return fe=void 0,Ee.next=3,S.room.get_info(Te).then(function(ve){fe=1===ve.data.live_status},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),z(function(){return ue.LITTLE_HEART.checkRoomList(roomList)})});case 3:return Ee.abrupt('return',fe);case 4:case'end':return Ee.stop();}},Ie,ge)}));return function checkRoom(){return pe.apply(this,arguments)}}(),doHeartBeat:function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(Te){var fe,me;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(-1!=B.indexOf(Te)){ve.next=2;break}return ve.abrupt('return');case 2:Z('[\u5C0F\u5FC3\u5FC3]\u6253\u5F00\u623F\u95F4',B),fe=layer.open({title:''+Te,type:2,shade:0,content:'https://live.bilibili.com/'+Te+'?cut',end:function end(){clearTimeout(me),I(Te,B),I(fe,H)}}),layer.style(fe,{display:'none'}),H.push(fe),me=setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function Oe(){return regeneratorRuntime.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if(_e(ue.CACHE.LittleHeart_TS)){he.next=3;break}return Z('[\u5C0F\u5FC3\u5FC3]','\u4ECA\u65E5\u4EFB\u52A1\u5B8C\u6210\uFF0C\u623F\u95F4'+Te+'\u4E0D\u518D\u6253\u5F00'),he.abrupt('return');case 3:if(ue.LITTLE_HEART.checkRoom(Te)){he.next=7;break}return window.toast('[\u5C0F\u5FC3\u5FC3]\u623F\u95F4'+Te+'\u4E0B\u64AD\uFF0C\u518D\u6B21\u5BFB\u627E\u5F00\u64AD\u623F\u95F4','info'),layer.close(fe),he.abrupt('return',ue.LITTLE_HEART.run());case 7:case'end':return he.stop();}},Oe,ge)})),310e3);case 7:case'end':return ve.stop();}},Ie,ge)}));return function doHeartBeat(){return pe.apply(this,arguments)}}(),checkHeart:function checkHeart(){var pe=function checkbag(){S.gift.bag_list().then(function(Te){Z('[\u5C0F\u5FC3\u5FC3]\u68C0\u67E5\u5305\u88F9',Te);var fe=Te.data.list.filter(function(me){return 30607==me.gift_id&&24==me.gift_num&&'7\u5929'==me.corner_mark});if(Z('[\u5C0F\u5FC3\u5FC3]\u5305\u88F9\u51857\u592924\u4E2A\u5C0F\u5FC3\u5FC3',fe),0<fe.length)return clearInterval(Ie),window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6','success'),ue.CACHE.LittleHeart_TS=X(),ue.saveCache(),T(H),J(ue.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3')})};pe();var Ie=setInterval(function(){pe()},310e3)},run:function run(){if(!ue.CONFIG.LITTLE_HEART)return $.Deferred().resolve();if(!_e(ue.CACHE.LittleHeart_TS))return J(ue.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3');var pe=function(){var Ie=_asyncToGenerator(regeneratorRuntime.mark(function Te(){var fe,me,Ee,ve,Oe,xe,he;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:return Ge.next=2,ue.LITTLE_HEART.getMedalRoomList();case 2:return Ge.next=4,ue.LITTLE_HEART.checkRoomList(ue.LITTLE_HEART.medalRoom_list);case 4:B=Ge.sent,fe=0,me=!0,Ee=!1,ve=void 0,Ge.prev=9,Oe=B[Symbol.iterator]();case 11:if(me=(xe=Oe.next()).done){Ge.next=23;break}if(he=xe.value,!(fe<ue.CONFIG.MAX_TAB)){Ge.next=19;break}return Ge.next=16,ue.LITTLE_HEART.doHeartBeat(he);case 16:fe++,Ge.next=20;break;case 19:return Ge.abrupt('break',23);case 20:me=!0,Ge.next=11;break;case 23:Ge.next=29;break;case 25:Ge.prev=25,Ge.t0=Ge['catch'](9),Ee=!0,ve=Ge.t0;case 29:Ge.prev=29,Ge.prev=30,!me&&Oe.return&&Oe.return();case 32:if(Ge.prev=32,!Ee){Ge.next=35;break}throw ve;case 35:return Ge.finish(32);case 36:return Ge.finish(29);case 37:;ue.LITTLE_HEART.checkHeart();case 39:case'end':return Ge.stop();}},Te,ge,[[9,25,29,37],[30,,32,36]])}));return function runFunc(){return Ie.apply(this,arguments)}}();ue.CONFIG.BLOCK_LIVE_VIDEO?pe():layer.confirm('\u82E5\u4E0D\u52FE\u9009\u3010\u62E6\u622A\u6302\u5C0F\u5FC3\u5FC3\u6253\u5F00\u7A97\u53E3\u7684\u76F4\u64AD\u6D41\u3011\u5C06\u8017\u8D39\u5927\u91CF\u6D41\u91CF\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F',{title:'\u8B66\u544A',btn:['\u662F','\u5426']},_asyncToGenerator(regeneratorRuntime.mark(function Ie(){return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:layer.msg('\u90A3\u7B97\u4E86\u256E(\uFFE3\u25BD\uFFE3)\u256D',{time:2e3}),pe();case 2:case'end':return fe.stop();}},Ie,ge)})),function(){layer.msg('\u52FE\u9009\u3010\u62E6\u622A\u6302\u5C0F\u5FC3\u5FC3\u6253\u5F00\u7A97\u53E3\u7684\u76F4\u64AD\u6D41\u3011\u540E\u9700\u5237\u65B0\u9875\u9762\u4F7F\u5176\u751F\u6548',{time:2500})})}}};ue.init().then(function(){try{var pe=$.Deferred();(function uniqueCheck(){var Te=Date.now();return 0<=Te-ue.CACHE.UNIQUE_CHECK&&15e3>=Te-ue.CACHE.UNIQUE_CHECK?($('.link-toast').hide(),$('.igiftMsg').hide(),ue.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),pe.reject()):pe.resolve()})().then(function(){var Te,fe=function uniqueMark(){Te=setTimeout(fe,1e4),ue.CACHE.UNIQUE_CHECK=Date.now(),ue.saveCache(!1)};return(window.addEventListener('unload',function(){Te&&(clearTimeout(Te),ue.CACHE.UNIQUE_CHECK=0,ue.saveCache()),T(H)}),fe(),0===parseInt(P.uid)||isNaN(parseInt(P.uid)))?void ue.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(ue.newMessage(GM_info.script.version),Z('MY_API.CONFIG',ue.CONFIG),_(ue))})}catch(pe){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',pe)}})}function _(ge){'use strict';var ce=function clearStat(){ge.GIFT_COUNT.COUNT=0,ge.GIFT_COUNT.CLEAR_TS=le(),ge.saveGiftCount(),Z('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};_e(ge.GIFT_COUNT.CLEAR_TS)&&ce(),ee(ce,'\u91CD\u7F6E\u7EDF\u8BA1'),ge.creatSetBox(),ge.LITTLE_HEART.run(),ge.removeUnnecessary(),setTimeout(function(){ge.GroupSign.run(),ge.DailyReward.run(),ge.LiveReward.run(),ge.Exchange.runS2C(),ge.TreasureBox.run(),ge.Gift.run(),ge.MobileHeartBeat.run()},6e3),S.room.getList().then(function(Te){Z('\u76F4\u64AD\u95F4\u5217\u8868',Te);var fe=!0,me=!1,Ee=void 0;try{for(var xe,ve=function _loop5(){var he=xe.value;S.room.getRoomList(he.id,0,0,1,1).then(function(Ce){Z('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',Ce);for(var Ge=0;Ge<Ce.data.length;++Ge)ge.listen(Ce.data[Ge].roomid,P.uid,he.name+'\u533A')})},Oe=Te.data[Symbol.iterator]();!(fe=(xe=Oe.next()).done);fe=!0)ve()}catch(he){me=!0,Ee=he}finally{try{!fe&&Oe.return&&Oe.return()}finally{if(me)throw Ee}}});var ue=function check_top_room(){if(ge.GIFT_COUNT.COUNT>=ge.CONFIG.MAX_GIFT&&(Z('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),ge.max_blocked=!0),ge.blocked||ge.max_blocked)return ge.blocked?(ge.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(pe)):void ge.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(O(ge.CONFIG.TIME_AREA_START_H0UR,ge.CONFIG.TIME_AREA_END_H0UR,ge.CONFIG.TIME_AREA_START_MINUTE,ge.CONFIG.TIME_AREA_END_MINUTE)&&ge.CONFIG.TIME_AREA_DISABLE)return void ge.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var Te=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],fe=1,me=function checkHourRank(ve){S.rankdb.getTopRealTimeHour(ve).then(function(Oe){var xe=Oe.data.list;ge.chatLog('\u68C0\u67E5'+Te[ve]+'\u623F\u95F4\u7684\u793C\u7269','warning'),Z(Te[ve]+'\u623F\u95F4\u5217\u8868',xe);var he=!0,Ce=!1,Ge=void 0;try{for(var Ae,Ne,Re=xe[Symbol.iterator]();!(he=(Ae=Re.next()).done);he=!0)Ne=Ae.value,ge.checkRoom(Ne.roomid,'\u5C0F\u65F6\u699C-'+Ne.area_v2_parent_name+'\u533A')}catch(Ne){Ce=!0,Ge=Ne}finally{try{!he&&Re.return&&Re.return()}finally{if(Ce)throw Ge}}})},Ee=setInterval(function(){fe<=Te.length-1?(me(fe),fe++):clearInterval(Ee)},1e3)};setTimeout(ue,6e3);var pe=setInterval(ue,parseInt(1e3*ge.CONFIG.CHECK_HOUR_ROOM_INTERVAL)),Ie=function reset(Te){var fe=setTimeout(function(){if(0<ge.raffleId_list.length||0<ge.guardId_list.length||0<ge.pkId_list.length)return Z('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void Ie(15000);if(_e(ge.CACHE.LittleHeart_TS))return Z('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u53D1\u9001\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(fe),void Ie(6e5);if(O(ge.CONFIG.TIME_AREA_START_H0UR,ge.CONFIG.TIME_AREA_END_H0UR,ge.CONFIG.TIME_AREA_START_MINUTE,ge.CONFIG.TIME_AREA_END_MINUTE)&&ge.CONFIG.IN_TIME_RELOAD_DISABLE){var me=u(ge.CONFIG.TIME_AREA_START_MINUTE,ge.CONFIG.TIME_AREA_END_MINUTE)+6e4;return Ie(me),void Z('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+me+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},Te)};Ie(6e4*ge.CONFIG.TIME_RELOAD)}function u(ge,ce){var ue=new Date,pe=ue.getHours(),Ie=ue.getMinutes(),Te=ue.getSeconds(),Ee=1e3*(3600*ge)+1e3*(60*ce)-(1e3*(3600*pe)+1e3*(60*Ie)+1e3*Te);return Z('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',Ee+'\u6BEB\u79D2'),0>Ee?86400000+Ee:Ee}function I(ge,ce){ce.splice(ce.indexOf(ge),1)}function T(ge){if(ge!=void 0){var ce=!0,ue=!1,pe=void 0;try{for(var Te,fe,Ie=ge[Symbol.iterator]();!(ce=(Te=Ie.next()).done);ce=!0)fe=Te.value,layer.close(fe)}catch(fe){ue=!0,pe=fe}finally{try{!ce&&Ie.return&&Ie.return()}finally{if(ue)throw pe}}}}function f(){0<$('.live-icon-un-mute').length?$('.live-icon-un-mute').click():setTimeout(function(){return f()},200),setTimeout(function(){0<$('[data-title="Flash\u64AD\u653E\u5668"]').length&&$('[data-title="Flash\u64AD\u653E\u5668"]').click()},4e3)}function E(ge,ce){var ue=new Date,pe=ue.getHours(),Ie=ue.getMinutes();return pe==ge&&Ie==ce||(Z('\u9519\u8BEF\u65F6\u95F4'),!1)}function O(ge,ce,ue,pe){if(23<ge||24<ce||0>ge||1>ce||59<ue||0>ue||59<pe||0>pe)return!1;var Ie=new Date,Te=Ie.getHours(),fe=Ie.getMinutes();if(ge<ce)return Te>=ge&&Te<ce||Te==ce&&fe>=ue&&fe<pe;return ge>ce?Te>=ge||Te<ce||Te==ce&&fe>=ue&&fe<pe:ge==ce?Te==ge&&ue<=pe&&fe>=ue&&fe<pe||Te==ge&&ue>pe&&fe<=pe&&fe>ue:void 0}function C(ge){return new Promise(function(ce){setTimeout(function(){ce()},ge)})}function G(ge){if(0>=ge)return!1;var ce=Math.random();return ge/100>=ce}function R(ge){return new Promise(function(ce){var ue=function onerror(pe){console.error('XHR',pe),ce(void 0)};if(ge.GM)'POST'===ge.method&&(void 0===ge.headers&&(ge.headers={}),void 0===ge.headers['Content-Type']&&(ge.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),ge.timeout=30000,ge.onload=function(pe){ce(pe.response)},ge.onerror=ue,ge.ontimeout=ue,GM_xmlhttpRequest(ge);else{var pe=new XMLHttpRequest;pe.open(ge.method,ge.url),'POST'===ge.method&&null===pe.getResponseHeader('Content-Type')&&pe.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),ge.cookie&&(pe.withCredentials=!0),ge.responseType!==void 0&&(pe.responseType=ge.responseType),pe.timeout=30000,pe.onload=function(Ie){var Te=Ie.target;ce({response:Te,body:Te.response})},pe.onerror=ue,pe.ontimeout=ue,pe.send(ge.data)}})}if('block'==D&&/https?:\/\/live\.bilibili\.com\/.*\?cut/.test(window.location.href))return f();window.localStorage.LIVE_PLAYER_STATUS=window.localStorage.LIVE_PLAYER_STATUS.replace('flash','html5');var L=localStorage.getItem(N+'_msgHide')||'hide',S=BilibiliAPI,F=0,w=0,k=0,U=!1,H=[],B=[],P={room_id:void 0,uid:void 0,ruid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},Y=navigator.userAgent,V=new Date().getTimezoneOffset()+480,X=function ts_ms(){return Date.now()},K=function ts_s(){return _Mathround(X()/1e3)},Q=function runUntilSucceed(ge){var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){ge()||Q(ge,ue,ue)},ce)},z=function delayCall(ge){var ce=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,ue=$.Deferred();return setTimeout(function(){var pe=ge();pe&&pe.then?pe.then(function(Ie,Te,fe,me,Ee,ve){return ue.resolve(Ie,Te,fe,me,Ee,ve)}):ue.resolve()},ce),ue},Z=function MYDEBUG(ge){for(var ce=arguments.length,ue=Array(1<ce?ce-1:0),pe=1;pe<ce;pe++)ue[pe-1]=arguments[pe];var Ie=new Date;return Ie='['+N+']['+Ie.getHours()+':'+Ie.getMinutes()+':'+Ie.getSeconds()+':'+Ie.getMilliseconds()+']',1===ue.length?void console.log(Ie,ge+':',ue[0]):void console.log(Ie,ge+':',ue)},J=function runMidnight(ge,ce){var ue=new Date;ue.setMinutes(ue.getMinutes()+V),ue.setDate(ue.getDate()+1),ue.setHours(0,1,0,0),ue.setMinutes(ue.getMinutes()-V),setTimeout(ge,ue-X()),Z('runMidnight',(ce||' ')+' '+ue.toString())},ee=function runExactMidnight(ge,ce){var ue=new Date;ue.setMinutes(ue.getMinutes()+V),ue.setDate(ue.getDate()+1),ue.setHours(0,0,0,0),ue.setMinutes(ue.getMinutes()-V),setTimeout(ge,ue-X()),Z('runExactMidnight',(ce||' ')+' '+ue.toString())},te=function runTomorrow(ge,ce,ue,pe){var Ie=new Date;Ie.setMinutes(Ie.getMinutes()+V),Ie.setDate(Ie.getDate()+1),Ie.setHours(ce,ue,0,0),Ie.setMinutes(Ie.getMinutes()-V),setTimeout(ge,Ie-X()),Z('runTomorrow',(pe||' ')+' '+Ie.toString())},ie=new BilibiliToken,ae='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',oe=void 0,ne=JSON.parse(localStorage.getItem(N+'_userToken'))||{},se=function(){var ge=_asyncToGenerator(regeneratorRuntime.mark(function ce(){return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(!(ne.time>K())){pe.next=4;break}oe=ne,pe.next=10;break;case 4:return pe.next=6,ie.getToken();case 6:ne=pe.sent,ne.time=K()+ne.expires_in,localStorage.setItem(N+'_Token',JSON.stringify(ne)),oe=ne;case 10:;return Z(N+'_userToken',ne),pe.abrupt('return','OK');case 13:case'end':return pe.stop();}},ce,A)}));return function setToken(){return ge.apply(this,arguments)}}(),de={init:function init(){return de.Toast.init().then(function(){})},Toast:{init:function init(){try{var ge=[];return window.toast=function(ce){var ue=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',pe=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(ue){case'success':case'info':break;case'caution':break;case'error':break;default:ue='info';}var Ie=$('<div class="link-toast '+ue+' fixed"><span class="toast-text">'+ce+'</span></div>')[0];document.body.appendChild(Ie),Ie.style.top=document.body.scrollTop+40*ge.length+10+'px',Ie.style.left=document.body.offsetWidth+document.body.scrollLeft-Ie.offsetWidth-5+'px','hide'==L&&$('.link-toast').hide(),ge.push(Ie),setTimeout(function(){Ie.className+=' out',setTimeout(function(){ge.shift(),ge.forEach(function(Te){Te.style.top=parseInt(Te.style.top,10)-40+'px'}),$(Ie).remove()},200)},pe)},$.Deferred().resolve()}catch(ge){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',ge),$.Deferred().reject()}}}};de.init(),$(function(){var ge=function loadInfo(ce){setTimeout(function(){var ue='undefined'==typeof unsafeWindow?window:unsafeWindow;ue.BilibiliLive===void 0||0===parseInt(ue.BilibiliLive.UID)||isNaN(parseInt(ue.BilibiliLive.UID))?(ge(1e3),window.toast('['+GM_info.script.name+']\u65E0\u914D\u7F6E\u4FE1\u606F','warning'),Z('\u65E0\u914D\u7F6E\u4FE1\u606F')):(P.room_id=ue.BilibiliLive.ROOMID,P.uid=ue.BilibiliLive.UID,S.live_user.get_info_in_room(P.room_id).then(function(pe){Z('InitData: API.live_user.get_info_in_room',pe),P.mobile_verify=pe.data.info.mobile_verify,P.identification=pe.data.info.identification}),S.gift.gift_config().then(function(pe){Z('InitData: API.gift.gift_config',pe),!!pe.data&&$.isArray(pe.data)?P.gift_list=pe.data:!!pe.data.list&&$.isArray(pe.data.list)?P.gift_list=pe.data.list:(P.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))}),P.bili_jct=S.getCookie('bili_jct'),P.ruid=ue.BilibiliLive.ANCHOR_UID,P.rnd=ue.BilibiliLive.RND,P.visit_id=ue.__statisObserver?ue.__statisObserver.__visitId:'',Z('Live_info',P),l())},ce)};ge(1e3),o()}),Array.prototype.remove=function(ge){var ce=this.indexOf(ge);-1<ce&&this.splice(ce,1)};var le=function dateNow(){return Date.now()},_e=function checkNewDay(ge){if(0===ge)return!0;var ce=new Date(ge),ue=new Date,pe=ce.getDate(),Ie=ue.getDate();return Ie!==pe}})();
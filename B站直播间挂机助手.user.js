// ==UserScript==
// @namespace      https://github.com/andywang425
// @name           B站直播间挂机助手
// @name:en        B站直播间挂机助手
// @author         andywang425
// @description    自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章，快捷购买粉丝勋章
// @description:en 自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章，快捷购买粉丝勋章
// @updateURL      https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @homepageURL    https://github.com/andywang425/BLTH/
// @supportURL     https://github.com/andywang425/BLTH/issues
// @icon           https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright      2020, andywang425 (https://github.com/andywang425)
// @license        MIT
// @compatible     chrome 80 or later
// @compatible     firefox 77 or later
// @compatible     opera 69 or later
// @version        4.2.3
// @include       /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at        document-start
// @connect       passport.bilibili.com
// @connect       api.live.bilibili.com
// @connect       live-trace.bilibili.com
// @require       https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@56149b5a33cf4b1318a6806d7edb06a4fbefcf4a/BilibiliAPI_Mod.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@56149b5a33cf4b1318a6806d7edb06a4fbefcf4a/OCRAD.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@56149b5a33cf4b1318a6806d7edb06a4fbefcf4a/libBilibiliToken.user.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@b40278754a4da6605c16e0cf2228a7ec73b676b0/layer.js
// @grant        unsafeWindow
// @grant        GM_xmlhttpRequest
// ==/UserScript==
'use strict';var _Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function I(T,f){try{var E=l[T](f),O=E.value}catch(C){return void u(C)}return E.done?void _(O):Promise.resolve(O).then(function(C){I('next',C)},function(C){I('throw',C)})}return I('next')})}}(function(){var A=this,N='IGIFTMSG',D=localStorage.getItem(N+'_block_live')||'pass';function o(){$('head').append('\n        <style>\n            .igiftMsg_input{\n                outline: none;\n                border: 1px solid #e9eaec;\n                background-color: #fff;\n                border-radius: 4px;\n                padding: 1px 0 0;\n                overflow: hidden;\n                font-size: 12px;\n                line-height: 19px;\n                width: 30px;\n                z-index: \'10001\';\n            }\n            .igiftMsg_btn{\n                background-color: #23ade5;\n                color: #fff;\n                border-radius: 4px;\n                border: none;\n                padding: 5px;\n                cursor: pointer;\n                box-shadow: 0 0 2px #00000075;\n                line-height: 10px;\n                z-index: 10001;\n            }\n            .igiftMsg_fs{\n                border: 2px solid #d4d4d4;\n                z-index: 10001;\n            }\n        </style>\n        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sentsin/layer@v3.1.1/dist/theme/default/layer.css" id="layuicss-layer">\n            ')}function l(){var pe,ue=this,Ie={CONFIG_DEFAULT:{AUTO_GIFT:!1,AUTO_GIFT_ROOMID:'0',AUTO_GROUP_SIGN:!0,AUTO_TREASUREBOX:!0,BLOCK_LIVE_VIDEO:!0,CHECK_HOUR_ROOM:!0,CHECK_HOUR_ROOM_INTERVAL:600,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,EXCLUDE_ROOMID:'0',FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_SEND_TIME',GIFT_SORT:'high',IN_TIME_RELOAD_DISABLE:!1,LOTTERY:!0,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!1,LIGHT_MEDALS:'0',LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,MAX_TAB:5,MOBILE_HEARTBEAT:!1,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_activity:!1,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:120,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,MobileHeartBeat_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{S.setCommonArgs(V.bili_jct)}catch(fe){return void console.error('['+N+']',fe)}var Te=$.Deferred();try{Ie.loadConfig().then(function(){Ie.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),Te.resolve()})}catch(fe){console.error('API\u521D\u59CB\u5316\u51FA\u9519',fe),Ie.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),Te.reject()}try{Ie.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),Te.resolve()})}catch(fe){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',fe),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),Te.reject()}return setTimeout(Ie.TreasureBox.init,5750),Te},loadConfig:function loadConfig(){var Te=$.Deferred();try{var fe=JSON.parse(localStorage.getItem(N+'_CONFIG'));for(var me in $.extend(!0,Ie.CONFIG,Ie.CONFIG_DEFAULT),Ie.CONFIG)Ie.CONFIG.hasOwnProperty(me)&&void 0!==fe[me]&&null!==fe[me]&&(Ie.CONFIG[me]=fe[me]);Ie.loadGiftCount(),Te.resolve()}catch(fe){ee('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',fe),Ie.setDefaults(),Te.reject()}return Te},loadCache:function loadCache(){var Te=$.Deferred();try{var fe=JSON.parse(localStorage.getItem(N+'_CACHE'));for(var me in $.extend(!0,Ie.CACHE,Ie.CACHE_DEFAULT),Ie.CACHE)Ie.CACHE.hasOwnProperty(me)&&void 0!==fe[me]&&null!==fe[me]&&(Ie.CACHE[me]=fe[me]);Te.resolve()}catch(fe){ee('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',fe),Ie.setDefaults(),Te.reject()}return Te},newMessage:function newMessage(Te){try{var fe=localStorage.getItem(N+'_NEWMSG_CACHE');if((fe==void 0||null==fe||'4.2.3'!=fe)&&'4.2.3'==Te){var me=function linkMsg(Ee,Oe){return'<a href="'+Oe+'"target="_blank">'+Ee+'</a>'};layer.open({title:Te+'\u66F4\u65B0\u63D0\u793A',content:'1.\u589E\u52A0\u65B0\u9009\u9879\u3010\u7ACB\u523B\u70B9\u4EAE\u52CB\u7AE0\u3011<br>2.\u5C0F\u5FC3\u5FC3\u6A21\u5757\u4F18\u5316<br>\n                            <em style="color:grey;">\n                            \u5982\u679C\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u9047\u5230\u95EE\u9898\uFF0C\u6B22\u8FCE\u53BB'+me('github','https://github.com/andywang425/BLTH/issues')+'\n                            \uFF08\u6216\u8005\u8FDBqq\u7FA4'+me('1106094437','https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O')+'\uFF09\u53CD\u9988\u3002\n                            </em>'}),localStorage.setItem(N+'_NEWMSG_CACHE',Te)}}catch(fe){ee('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u5931\u8D25',fe)}},saveConfig:function saveConfig(){try{return localStorage.setItem(N+'_CONFIG',JSON.stringify(Ie.CONFIG)),Ie.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),ee('MY_API.CONFIG',Ie.CONFIG),!0}catch(Te){return ee('API\u4FDD\u5B58\u51FA\u9519',Te),!1}},saveCache:function saveCache(Te){try{return localStorage.setItem(N+'_CACHE',JSON.stringify(Ie.CACHE)),!1!=Te&&ee('CACHE\u5DF2\u4FDD\u5B58',Ie.CACHE),!0}catch(fe){return ee('CACHE\u4FDD\u5B58\u51FA\u9519',fe),!1}},setDefaults:function setDefaults(){Ie.CONFIG=Ie.CONFIG_DEFAULT,Ie.CACHE=Ie.CACHE_DEFAULT,Ie.saveConfig(),Ie.saveCache(),Ie.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1','info'),setTimeout(function(){Ie.CACHE=Ie.CACHE_DEFAULT,Ie.GroupSign.run(),Ie.DailyReward.run(),Ie.LiveReward.run(),Ie.Exchange.runS2C(),Ie.TreasureBox.run(),Ie.Gift.run(),Ie.LITTLE_HEART.run(),Ie.MobileHeartBeat.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var Te=JSON.parse(localStorage.getItem(N+'_GIFT_COUNT'));for(var fe in Ie.GIFT_COUNT)Ie.GIFT_COUNT.hasOwnProperty(fe)&&void 0!==Te[fe]&&null!==Te[fe]&&(Ie.GIFT_COUNT[fe]=Te[fe]);ee('MY_API.GIFT_COUNT',Ie.GIFT_COUNT)}catch(Te){ee('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',Te)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(N+'_GIFT_COUNT',JSON.stringify(Ie.GIFT_COUNT)),ee('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',Ie.GIFT_COUNT),!0}catch(Te){return ee('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',Te),!1}},addGift:function addGift(Te){Ie.GIFT_COUNT.COUNT+=Te,$('#giftCount span:eq(0)').text(Ie.GIFT_COUNT.COUNT),Ie.saveGiftCount()},addSilver:function addSilver(Te){Ie.GIFT_COUNT.SILVER_COUNT+=Te,$('#giftCount span:eq(1)').text(Ie.GIFT_COUNT.SILVER_COUNT),Ie.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){var Te=['#my-dear-haruna-vm','.activity-entry','.bilibili-live-player'],fe=function removeUntiSucceed(me,Ee){!0===Ie.CONFIG[me]&&setInterval(function(){0<$(Te[Ee]).length&&$(Te[Ee]).remove()},200)};fe('REMOVE_ELEMENT_2233',0),fe('REMOVE_ELEMENT_activity',1),fe('REMOVE_ELEMENT_player',2)},creatSetBox:function creatSetBox(){var Te=['.chat-history-list','.attention-btn-ctnr','.live-player-mounter'],fe=!0,me=!1,Ee=void 0;try{for(var ve,Le,Oe=Te[Symbol.iterator]();!(fe=(ve=Oe.next()).done);fe=!0)if(Le=ve.value,0==$(Le).length)return J(function(){return Ie.creatSetBox()},200)}catch(Le){me=!0,Ee=Le}finally{try{!fe&&Oe.return&&Oe.return()}finally{if(me)throw Ee}}var xe='hide'==L?'\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F':'\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F',he=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">'+xe+'<br></button>'),Ce='#allsettings',Re=$('.chat-history-list'),Ge,ye=$('.live-player-mounter').height(),Ae=$('.live-player-mounter').offset(),Ne='"float:left"';-1<X.toLowerCase().indexOf('firefox')&&(Ne='""');var De='\n                <div id=\'allsettings\' class = "igiftMsg_main">\n    <fieldset class="igiftMsg_fs">\n        <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n        <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n            \u8FA3\u6761&nbsp;<span>'+Ie.GIFT_COUNT.COUNT+'</span>\n            \u94F6\u74DC\u5B50&nbsp;<span>'+Ie.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n            <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n        </div>\n    </fieldset>\n    <div id="left_fieldset" style='+Ne+'>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u62BD\u5956\u8BBE\u7F6E</legend>\n        <div data-toggle="LOTTERY">\n            <label style="margin: 5px auto; color: purple;line-height:30px";>\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u53C2\u4E0E\u62BD\u5956\n            </label>\n        </div>\n            <div data-toggle="RANDOM_DELAY">\n                <label style="margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                    <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                    <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                </label>\n            </div>\n            <div data-toggle="TIME_AREA_DISABLE">\n                <label style="margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u542F\u7528\n                    <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                    <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                    <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                    <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                </label>\n            </div>\n            <div data-toggle="RANDOM_SKIP">\n                <label style="margin: 5px auto; color: darkgreen">\n                    \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                </label>\n            </div>\n            <div data-toggle="MAX_GIFT">\n                <label style="margin: 5px auto; color: darkgreen">\n                    \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                </label>\n            </div>\n            <div data-toggle="RANDOM_SEND_DANMU">\n                <label style="margin: 5px auto; color: darkgreen">\n                    \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                </label>\n            </div>\n            <div data-toggle="CHECK_HOUR_ROOM">\n                <label style="margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u68C0\u67E5\u5C0F\u65F6\u699C\uFF08\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\uFF09\n                </label>\n            </div>\n            <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n            <label style="margin: 5px auto; color: red;">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n            </label>\n        </div>\n        </fieldset>\n\n        <fieldset class="igiftMsg_fs" style ="line-height:16px;">\n            <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n            <div data-toggle="LOGIN" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u767B\u9646\n            </div>\n            <div data-toggle="WATCH" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u89C2\u770B\u89C6\u9891\n            </div>\n            <div data-toggle="COIN" style=" color: black">\n                <label style="cursor: pointer">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                </label>\n            </div>\n            <div data-toggle="COIN_TYPE" style=" color: black">\n                <div data-toggle="COIN_UID">\n                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                \u7684\u89C6\u9891\u6295\u5E01\n                </div>\n                <div data-toggle="COIN_DYN">\n                    <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                    \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                </div>\n            </div>\n            <div data-toggle="SHARE" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u5206\u4EAB\u89C6\u9891\n            </div>\n            <div data-toggle="SILVER2COIN" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n            </div>\n            <div data-toggle="LIVE_SIGN" style=" color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u76F4\u64AD\u533A\u7B7E\u5230\n            </div>\n            <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u5E94\u63F4\u56E2\u7B7E\u5230\n            </div>\n            <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n            </div>\n            <div data-toggle="MOBILE_HEARTBEAT" style=" color: gray">\n            <input style="vertical-align: text-top;" type="checkbox">\n            \u6A21\u62DF\u79FB\u52A8\u7AEF\u5FC3\u8DF3\n            </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n            <div data-toggle="AUTO_GIFT" style=" color: purple">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u81EA\u52A8\u9001\u793C\n            </div>\n\n            <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                \u4F18\u5148\u9001\u793C\u623F\u95F4\n                <input class="num igiftMsg_input" style="width: 150px;" type="text">\n            </div>\n\n            <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                \u4E0D\u9001\u793C\u623F\u95F4\n                <input class="num igiftMsg_input" style="width: 150px;" type="text">\n            </div>\n            <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                \u95F4\u9694\n                <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                \u5206\u949F\u9001\u793C\n            </div>\n            <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                \u5B9A\u65F6\u9001\u793C<br>&nbsp;&nbsp;&nbsp;&nbsp;\n                \u9001\u793C\u65F6\u95F4\n                <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n            </div>\n            \n            <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                \u793C\u7269\u5230\u671F\u65F6\u95F4\n                <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                \u5929\n            </div>\n            <div data-toggle="GIFT_SORT_HIGH" style=" color: black;line-height: 20px;">\n            \u7C89\u4E1D\u724C\u9001\u793C\u4F18\u5148\u7EA7<br>\n            &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name = "GIFT_SORT">\n                \u4F18\u5148<strong style="color: purple">\u9AD8</strong>\u7B49\u7EA7\u7C89\u4E1D\u724C\n            </div>\n            <div data-toggle="GIFT_SORT_LOW" style=" color: black">\n            &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name = "GIFT_SORT">\n            \u4F18\u5148<strong style="color: purple">\u4F4E</strong>\u7B49\u7EA7\u7C89\u4E1D\u724C\n            </div>\n            <div data-toggle="SEND_ALL_GIFT" style="color: #ff5200;line-height:15px;">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u65E0\u89C6\u793C\u7269\u7C7B\u578B\u548C\u5230\u671F\u65F6\u95F4\u9650\u5236\n            </div>\n            <div data-toggle="SPARE_GIFT_ROOM" style="color: black;line-height:20px;">\n                \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 100px;">\n            </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n            <div data-toggle="STORM" style="line-height: 15px">\n                <label style="margin: 5px auto; color: #ff5200">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                </label>\n            </div>\n            <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n            </div>\n            <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n            </div>\n            <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                \u6BEB\u79D2\n            </div>\n        </fieldset>\n    </div>\n\n\n\n    <div id="right_fieldset" style='+Ne+'>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u8D2D\u4E70\u7C89\u4E1D\u52CB\u7AE0</legend>\n            <div data-toggle="BUY_MEDAL" style="color: black; line-height: 15px">\n            \u8F93\u5165\u7C89\u4E1D\u52CB\u7AE0\u5BF9\u5E94\u623F\u95F4\u53F7\uFF1A<input class="num igiftMsg_input" type="text" value = '+V.room_id+' onclick="select();" style="width: 70px">\n            <button  class="igiftMsg_btn" data-action="buy_medal">\u70B9\u51FB\u8D2D\u4E70\u52CB\u7AE0</button>\n            \uFF08\u82B1\u8D3920\u786C\u5E01\uFF09\n        </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n            <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                <label style="margin: 5px auto; color: black">\n                    <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                </label>\n            </div>\n            <div data-toggle="MAX_TAB" style="line-height: 15px">\n            <label style="margin: 5px auto; color: black">\n                \u6253\u5F00\u9690\u5F62\u7A97\u53E3\u6570\u91CF\u4E0A\u9650\n                <input class="num igiftMsg_input" type="text" style="width: 30px;">\n            </label>\n        </div>\n            <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n            <input class="num igiftMsg_input" style="width: 300px;" type="text">\n        </div>\n        <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n            \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n            <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                \u767D\u540D\u5355\n            </div>\n            <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                &nbsp;\n                <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                \u9ED1\u540D\u5355\n            </div>\n            <button style="font-size: small" class="igiftMsg_btn" data-action="lightMedalNow">\u7ACB\u523B\u70B9\u4EAE\u52CB\u7AE0</button>\n        </div>\n        <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n        <label style="margin: 5px auto; color: black">\n            <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n        </label>\n        </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs">\n            <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n            <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                <label style="margin: 5px auto; color: black">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u79FB\u96642233\u6A21\u578B\n                </label>\n            </div>\n            <div data-toggle="REMOVE_ELEMENT_activity" style="line-height: 15px">\n                <label style="margin: 5px auto; color: black">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u79FB\u9664\u6D3B\u52A8\u5165\u53E3\n                </label>\n            </div>\n            <div data-toggle="BLOCK_LIVE_VIDEO" style="line-height: 15px">\n            <label style="margin: 5px auto; color: black">\n                <input style="vertical-align: text-top;" type="checkbox">\n                \u62E6\u622A\u6302\u5C0F\u5FC3\u5FC3\u6253\u5F00\u7A97\u53E3\u7684\u76F4\u64AD\u6D41\n            </label>\n        </div>\n        </fieldset>\n        <fieldset class="igiftMsg_fs" style="line-height: 15px">\n            <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n            <div data-toggle="TIME_RELOAD" style="color: black">\n                \u672C\u76F4\u64AD\u95F4\u5237\u65B0\u65F6\u95F4\uFF1A\n                <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\u5206\n            </div>\n            <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 20px">\n                <label style="margin: 5px auto; color: darkgreen">\n                    <input style="vertical-align: text-top;" type="checkbox">\n                    \u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u5237\u65B0\u76F4\u64AD\u95F4\n                </label>\n            </div>\n            <div id="resetArea">\n                <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1</button>\n                <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n            </div>\n\n        </fieldset>\n        <label style="color: darkblue; font-size:large;">\n             <a href="https://github.com/andywang425/BLTH"\n                target="_blank">v'+GM_info.script.version+'&nbsp;\u66F4\u591A\u4FE1\u606F\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n        </label>\n    </div>\n</div>\n    ',Me=function getScrollPosition(){var Le=0<arguments.length&&arguments[0]!==void 0?arguments[0]:window;return{x:Le.pageXOffset===void 0?Le.scrollLeft:Le.pageXOffset,y:Le.pageYOffset===void 0?Le.scrollTop:Le.pageYOffset}},be=function openMainWindow(){Ge=layer.open({type:1,title:!1,offset:[Ae.top-Me().y+''+'px',Ae.left+''+'px'],closeBtn:0,shade:0,zIndex:9999,fixed:!1,area:[,ye+''+'px'],content:De,success:function success(){function Le(){var Ye,je,Ve=parseInt($(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),Xe=parseInt($(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Ke=parseInt($(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),Qe=parseInt($(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(24<=Ve||24<=Xe||60<=Ke||60<=Qe||0>Ve||0>Xe||0>Ke||0>Qe)return void Ie.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(Ie.CONFIG.TIME_AREA_START_H0UR=Ve,Ie.CONFIG.TIME_AREA_END_H0UR=Xe,Ie.CONFIG.TIME_AREA_START_MINUTE=Ke,Ie.CONFIG.TIME_AREA_END_MINUTE=Qe,Ye=parseFloat($(Ce).find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>Ye||100<Ye)return void Ie.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Ie.CONFIG.RANDOM_SKIP=Ye,Ye=parseFloat($(Ce).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<Ye)return void Ie.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>Ye)return void Ie.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(Ie.CONFIG.RANDOM_SEND_DANMU=Ye,Ye=parseInt($(Ce).find('div[data-toggle="MAX_GIFT"] .num').val()),Ie.CONFIG.MAX_GIFT=Ye,Ye=parseInt($(Ce).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=Ye||1e4<Ye)return void Ie.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(Ie.CONFIG.TIME_RELOAD=Ye,Ye=parseFloat($(Ce).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),Xe=parseFloat($(Ce).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>Ye||100<Xe)return void Ie.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Xe<=Ye)return void Ie.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(Ie.CONFIG.RND_DELAY_START=Ye,Ie.CONFIG.RND_DELAY_END=Xe,Ye=parseInt($(Ce).find('div[data-toggle="COIN"] .coin_number').val()),0>Ye||5<Ye)return void Ie.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(Ie.CONFIG.COIN_NUMBER=Ye,Ye=parseInt($(Ce).find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=Ye)return void Ie.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');Ie.CONFIG.CHECK_HOUR_ROOM_INTERVAL=Ye,Ye=$(Ce).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),je=Ye.split(',');for(var We=0;We<je.length;We++)''===je[We]&&(je[We]=0);Ye=je.join(','),Ie.CONFIG.AUTO_GIFT_ROOMID=Ye,Ye=$(Ce).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),je=Ye.split(',');for(var We=0;We<je.length;We++)''===je[We]&&(je[We]=0);return(Ye=je.join(','),Ie.CONFIG.EXCLUDE_ROOMID=Ye,Ye=parseInt($(Ce).find('div[data-toggle="GIFT_LIMIT"] .num').val()),Ie.CONFIG.GIFT_LIMIT=Ye,Ve=parseInt($(Ce).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),Xe=parseInt($(Ce).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>Ve||0>Xe)?void Ie.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning'):24<=Ve||60<=Xe?void Ie.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning'):void(Ie.CONFIG.GIFT_SEND_HOUR=Ve,Ie.CONFIG.GIFT_SEND_MINUTE=Xe,Ye=$(Ce).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),Ie.CONFIG.SPARE_GIFT_ROOM=Ye,Ye=parseInt($(Ce).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),Ie.CONFIG.STORM_QUEUE_SIZE=Ye,Ye=parseInt($(Ce).find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),Ie.CONFIG.STORM_MAX_COUNT=Ye,Ye=parseInt($(Ce).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),Ie.CONFIG.STORM_ONE_LIMIT=Ye,Ye=parseInt($(Ce).find('div[data-toggle="COIN_UID"] .num').val()),Ie.CONFIG.COIN_UID=Ye,Ye=$(Ce).find('div[data-toggle="LIGHT_MEDALS"] .num').val(),Ie.CONFIG.LIGHT_MEDALS=Ye,Ye=parseInt($(Ce).find('div[data-toggle="MAX_TAB"] .num').val()),Ie.CONFIG.MAX_TAB=Ye,Ie.saveConfig())}function Se(Ye){return S.live_user.get_anchor_in_room(Ye).then(function(je){ee('API.live_user.get_anchor_in_room response',je),0!==je.code||!je.data.info?0===je.code&&je.data.info===void 0?layer.msg('\u623F\u95F4\u4E0D\u5B58\u5728',{time:2500}):layer.msg('\u68C0\u67E5\u623F\u95F4\u51FA\u9519 '+je.message,{time:2500}):layer.confirm('\u662F\u5426\u6D88\u801720\u786C\u5E01\u8D2D\u4E70UP\u4E3B\u3010'+je.data.info.uname+'\u3011\u7684\u7C89\u4E1D\u52CB\u7AE0\uFF1F',{title:'\u8D2D\u4E70\u52CB\u7AE0',btn:['\u662F','\u5426']},function(){return S.link_group.buy_medal(je.data.info.uid).then(function(Ve){ee('API.link_group.buy_medal re',Ve),0===Ve.code?layer.msg('\u8D2D\u4E70\u6210\u529F',{time:2e3,icon:1}):layer.msg('\u8D2D\u4E70\u5931\u8D25 '+Ve.message,{time:2500,icon:2})})},function(){layer.msg('\u5DF2\u53D6\u6D88\u8D2D\u4E70',{time:2e3})})})}$(Ce).find('div[data-toggle="MAX_TAB"] .num').val(parseInt(Ie.CONFIG.MAX_TAB).toString()),$(Ce).find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(Ie.CONFIG.GIFT_INTERVAL).toString()),$(Ce).find('div[data-toggle="LIGHT_MEDALS"] .num').val(Ie.CONFIG.LIGHT_MEDALS.toString()),$(Ce).find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(Ie.CONFIG.STORM_MAX_COUNT).toString()),$(Ce).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(Ie.CONFIG.STORM_ONE_LIMIT).toString()),$(Ce).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(Ie.CONFIG.STORM_QUEUE_SIZE).toString()),$(Ce).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(Ie.CONFIG.SPARE_GIFT_ROOM.toString()),$(Ce).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(Ie.CONFIG.TIME_RELOAD).toString()),$(Ce).find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(Ie.CONFIG.RANDOM_SKIP).toString()),$(Ce).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(Ie.CONFIG.RANDOM_SEND_DANMU).toString()),$(Ce).find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(Ie.CONFIG.MAX_GIFT).toString()),$(Ce).find('div[data-toggle="COIN"] .coin_number').val(parseInt(Ie.CONFIG.COIN_NUMBER).toString()),$(Ce).find('div[data-toggle="COIN_UID"] .num').val(parseInt(Ie.CONFIG.COIN_UID).toString()),$(Ce).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(Ie.CONFIG.RND_DELAY_START).toString()),$(Ce).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(Ie.CONFIG.RND_DELAY_END).toString()),$(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(Ie.CONFIG.TIME_AREA_START_H0UR).toString()),$(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(Ie.CONFIG.TIME_AREA_END_H0UR).toString()),$(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(Ie.CONFIG.TIME_AREA_START_MINUTE).toString()),$(Ce).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(Ie.CONFIG.TIME_AREA_END_MINUTE).toString()),$(Ce).find('div[data-toggle="CHECK_HOUR_ROOM"] .num').val(parseInt(Ie.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),$(Ce).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(Ie.CONFIG.AUTO_GIFT_ROOMID.toString()),$(Ce).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(Ie.CONFIG.EXCLUDE_ROOMID.toString()),$(Ce).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(Ie.CONFIG.GIFT_SEND_HOUR.toString()),$(Ce).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(Ie.CONFIG.GIFT_SEND_MINUTE.toString()),$(Ce).find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(Ie.CONFIG.GIFT_LIMIT).toString());$(Ce).find('div[id="giftCount"] [data-action="save"]').click(function(){Le()}),$(Ce).find('div[data-toggle="BUY_MEDAL"] [data-action="buy_medal"]').click(function(){var Ye=parseInt($(Ce).find('div[data-toggle="BUY_MEDAL"] .num').val());Se(Ye)}),$(Ce).find('button[data-action="reset"]').click(function(){Ie.setDefaults()}),$(Ce).find('button[data-action="checkUpdate"]').click(function(){Ie.checkUpdate()}),$(Ce).find('button[data-action="redo_dailyTasks"]').click(function(){Ie.ReDoDailyTasks()}),$(Ce).find('#resetArea [data-action="countReset"]').click(function(){Ie.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},Ie.saveGiftCount(),$('#giftCount span:eq(0)').text(Ie.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(Ie.GIFT_COUNT.SILVER_COUNT),Ie.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),$(Ce).find('button[data-action="sendGiftNow"]').click(function(){H=!0,Ie.Gift.run()}),$(Ce).find('button[data-action="lightMedalNow"]').click(function(){U=!0,Ie.Gift.run()});var Fe=['RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','SEND_ALL_GIFT','MOBILE_HEARTBEAT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_activity','BLOCK_LIVE_VIDEO','FORCE_LIGHT','LOTTERY','CHECK_HOUR_ROOM'],we=!0,ke=!1,He=void 0;try{for(var Pe,Ue=function _loop(){var Ye=Pe.value,je=$(Ce).find('div[data-toggle="'+Ye+'"] input:checkbox');Ie.CONFIG[Ye]&&je.attr('checked',''),je.change(function(){Ie.CONFIG[Ye]=$(this).prop('checked'),Ie.saveConfig(),Ie.CONFIG.BLOCK_LIVE_VIDEO?localStorage.setItem(N+'_block_live','block'):localStorage.setItem(N+'_block_live','pass')})},Be=Fe[Symbol.iterator]();!(we=(Pe=Be.next()).done);we=!0)Ue()}catch(Ye){ke=!0,He=Ye}finally{try{!we&&Be.return&&Be.return()}finally{if(ke)throw He}}$('input:text').bind('keydown',function(Ye){'13'==Ye.keyCode&&Le()}),'COIN_DYN'==Ie.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==Ie.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==Ie.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');'high'==Ie.CONFIG.GIFT_SORT?$('div[data-toggle=\'GIFT_SORT_HIGH\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SORT_LOW\'] input:radio').attr('checked',''),$('input:radio[name=\'COIN_TYPE\']').change(function(){var Ye=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked');Ie.CONFIG.COIN_TYPE=!0==Ye?'COIN_DYN':'COIN_UID',Ie.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){var Ye=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked');Ie.CONFIG.LIGHT_METHOD=!0==Ye?'LIGHT_WHITE':'LIGHT_BLACK',Ie.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){var Ye=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked');Ie.CONFIG.GIFT_METHOD=!0==Ye?'GIFT_INTERVAL':'GIFT_SEND_TIME',Ie.saveConfig()}),$('input:radio[name=\'GIFT_SORT\']').change(function(){var Ye=$('div[data-toggle=\'GIFT_SORT_HIGH\'] input:radio').is(':checked');Ie.CONFIG.GIFT_SORT=!0==Ye?'high':'low',Ie.saveConfig()})},end:function end(){L='hide',localStorage.setItem(N+'_msgHide',L),$('.igiftMsg').hide(),$('.link-toast').hide(),Re.animate({scrollTop:0},0),setTimeout(function(){Re.animate({scrollTop:Re.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'}})};he.click(function(){B&&(B=!1,setTimeout(function(){B=!0},200),'show'==L?(L='hide',localStorage.setItem(N+'_msgHide',L),$('.igiftMsg').hide(),$('.link-toast').hide(),layer.close(Ge),Re.animate({scrollTop:0},0),setTimeout(function(){Re.animate({scrollTop:Re.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'):(L='show',localStorage.setItem(N+'_msgHide',L),$('.igiftMsg').show(),$('.link-toast').show(),be(),Re.animate({scrollTop:Re.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'))}),$('.attention-btn-ctnr').append(he),Ie.CACHE.DailyReward_TS||layer.tips('\u70B9\u6211\u9690\u85CF/\u663E\u793A\u63A7\u5236\u9762\u677F','#hiderbtn',{tips:1}),'show'==L&&be()},chatLog:function chatLog(Te){var fe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',me=$('<div class=\'igiftMsg\'>'),Ee=$('<div>'),Oe=$('#chat-history-list'),ve=new Date;Ee.text(Te),me.text(ve.toLocaleString()),me.append(Ee),me.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),Ee.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===fe?me.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===fe?me.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===fe?me.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):me.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});'show'==L?Oe.find('#chat-items').append(me):Oe.find('#chat-items').append(me.hide()),Oe.scrollTop(Oe.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(Te,fe){var me=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';S.room.getConf(Te).then(function(Ee){ee('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+me,Ee);var Oe=new S.DanmuWebSocket(fe,Te,Ee.data.host_server_list,Ee.data.token);Oe.bind(function(ve){Oe=ve,Ie.chatLog(me+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){Ie.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+Te+' \u5206\u533A: '+me,'success')},function(){(Ie.blocked||Ie.stormBlack)&&(Oe.close(),Ie.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+me,'warning')),Ie.max_blocked&&!Ie.CONFIG.STORM&&(Oe.close(),Ie.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+me,'warning'))},function(ve){if(!(O(Ie.CONFIG.TIME_AREA_START_H0UR,Ie.CONFIG.TIME_AREA_END_H0UR,Ie.CONFIG.TIME_AREA_START_MINUTE,Ie.CONFIG.TIME_AREA_END_MINUTE)&&Ie.CONFIG.TIME_AREA_DISABLE))switch(ee('\u5F39\u5E55\u516C\u544A'+me,ve),ve.cmd){case'GUARD_MSG':ve.roomid===ve.real_roomid?Ie.checkRoom(ve.roomid,me):(Ie.checkRoom(ve.roomid,me),Ie.checkRoom(ve.real_roomid,me));break;case'PK_BATTLE_SETTLE_USER':ve.data.winner?Ie.checkRoom(ve.data.winner.room_id,me):Ie.checkRoom(ve.data.my_info.room_id,me),Ie.checkRoom(ve.data.winner.room_id,me);break;case'NOTICE_MSG':switch(ve.msg_type){case 1:break;case 2:case 3:case 4:case 8:ve.roomid===ve.real_roomid?Ie.checkRoom(ve.roomid,me):(Ie.checkRoom(ve.roomid,me),Ie.checkRoom(ve.real_roomid,me));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+ve.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),Ie.Storm.run(ve.roomid);}break;case'SPECIAL_GIFT':if(ve.data[39])switch(ve.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+ve.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),Ie.Storm.run(ve.roomid);case'end':};break;default:}})},function(){Ie.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(Te){var fe=[];try{var me=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));fe=[].concat(me.list),fe.push(Te),100<fe.length&&fe.splice(0,50),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:fe})),ee(N+'_EntryRoom_list_add',fe)}catch(me){fe.push(Te),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:fe}))}},isIn:function isIn(Te){var fe=[];try{var me=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));return fe=null===me?[]:[].concat(me.list),ee(N+'_EntryRoom_list_read',me),-1<fe.indexOf(Te)}catch(me){return localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:fe})),ee('\u8BFB\u53D6'+(N+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<fe.indexOf(Te)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(Te){var fe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';Ie.blocked||Ie.max_blocked||0<=Ie.RoomId_list.indexOf(Te)||(Ie.RoomId_list.push(Te),Ie.EntryRoom_list_history.isIn(Te)||(S.room.room_entry_action(Te),Ie.EntryRoom_list_history.add(Te)),R(Ie.CONFIG.RANDOM_SEND_DANMU)&&S.sendLiveDanmu(Ie.auto_danmu_list[_Mathfloor(12*Math.random())],Te).then(function(me){ee('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',me)}),S.xlive.lottery.check(Te).then(function(me){Ie.RoomId_list.remove(Te),ee('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',me);var Ee=me.data;if(0===me.code){var Oe;if(Ee.gift)for(var ve in Oe=Ee.gift,Oe)Oe.hasOwnProperty(ve)&&Ie.creat_join(Te,Oe[ve],'gift',fe);if(Ee.guard)for(var ve in Oe=Ee.guard,Oe)Oe.hasOwnProperty(ve)&&Ie.creat_join(Te,Oe[ve],'guard',fe);if(Ee.pk)for(var ve in Oe=Ee.pk,Oe)Oe.hasOwnProperty(ve)&&Ie.creat_join(Te,Oe[ve],'pk',fe)}else Ie.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<Ie.err_roomId.indexOf(Te)?ee('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+Te+me.message):(Ie.err_roomId.push(Te),Ie.checkRoom(Te,fe),ee('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+Te+me.message))}))},Id_list_history:{add:function add(Te,fe){var me=[];try{var Ee=JSON.parse(localStorage.getItem(N+'_'+fe+'Id_list'));me=[].concat(Ee.list),me.push(Te),200<me.length&&me.splice(0,50),localStorage.setItem(N+'_'+fe+'Id_list',JSON.stringify({list:me})),ee(N+'_'+fe+'Id_list_add',me)}catch(Ee){me.push(Te),localStorage.setItem(N+'_'+fe+'Id_list',JSON.stringify({list:me}))}},isIn:function isIn(Te,fe){var me=[];try{var Ee=JSON.parse(localStorage.getItem(N+'_'+fe+'Id_list'));return me=null===Ee?[]:[].concat(Ee.list),ee(N+'_'+fe+'Id_list_read',Ee),-1<me.indexOf(Te)}catch(Ee){return localStorage.setItem(N+'_'+fe+'Id_list',JSON.stringify({list:me})),ee('\u8BFB\u53D6'+(N+'_'+fe+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<me.indexOf(Te)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(Te,fe,me){var Ee=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(ee('\u793C\u7269\u4FE1\u606F',fe),Ie.GIFT_COUNT.COUNT>=Ie.CONFIG.MAX_GIFT)return ee('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(Ie.max_blocked=!0);switch(me){case'gift':if(Ie.Id_list_history.isIn(fe.raffleId,'raffle'))return void ee('\u793C\u7269\u91CD\u590D','raffleId '+fe.raffleId);Ie.raffleId_list.push(fe.raffleId),Ie.Id_list_history.add(fe.raffleId,'raffle');break;case'guard':if(Ie.Id_list_history.isIn(fe.id,'guard'))return void ee('\u8230\u957F\u91CD\u590D','id '+fe.id);Ie.guardId_list.push(fe.id),Ie.Id_list_history.add(fe.id,'guard');break;case'pk':if(Ie.Id_list_history.isIn(fe.id,'pk'))return void ee('pk\u91CD\u590D','id '+fe.id);Ie.pkId_list.push(fe.id),Ie.Id_list_history.add(fe.id,'pk');}var Oe=fe.time_wait||0;Ie.CONFIG.RANDOM_DELAY&&(Oe+=_Mathfloor(Math.random()*(Ie.CONFIG.RND_DELAY_END-Ie.CONFIG.RND_DELAY_START+1))+Ie.CONFIG.RND_DELAY_START);var ve=$('<div class=\'igiftMsg\'>'),xe=$('<div>'),he=$('<div>'),Ce=$('#chat-history-list'),Re=new Date;xe.text('['+Ee+']'+fe.thank_text.split('<%')[1].split('%>')[0]+fe.thank_text.split('%>')[1]),ve.text(Re.toLocaleString()),ve.append(xe),he.css('color','red'),he.text('\u7B49\u5F85\u62BD\u5956'),xe.append(he),ve.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),xe.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),ve.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),'show'==L?Ce.find('#chat-items').append(ve):Ce.find('#chat-items').append(ve.hide()),Ce.scrollTop(Ce.prop('scrollHeight'));var Ge=setInterval(function(){he.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+Oe+'\u79D2'),0>=Oe&&(R(Ie.CONFIG.RANDOM_SKIP)?he.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(he.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===me?Ie.gift_join(Te,fe.raffleId,fe.type).then(function(ye,Ae){he.text(ye),Ae&&(-1<ye.indexOf('\u8FA3\u6761')?Ie.addGift(Ae):-1<ye.indexOf('\u94F6\u74DC\u5B50')&&Ie.addSilver(Ae)),Ie.raffleId_list.remove(fe.raffleId)}):'guard'===me?Ie.guard_join(Te,fe.id).then(function(ye,Ae){he.text(ye),Ae&&(-1<ye.indexOf('\u8FA3\u6761')?Ie.addGift(Ae):-1<ye.indexOf('\u94F6\u74DC\u5B50')&&Ie.addSilver(Ae)),Ie.guardId_list.remove(fe.id)}):'pk'===me?Ie.pk_join(Te,fe.id).then(function(ye,Ae){he.text(ye),Ae&&(-1<ye.indexOf('\u8FA3\u6761')?Ie.addGift(Ae):-1<ye.indexOf('\u94F6\u74DC\u5B50')&&Ie.addSilver(Ae)),Ie.pkId_list.remove(fe.id)}):void 0),he.css('color','green'),clearInterval(Ge)),Oe--},1e3)},gift_join:function gift_join(Te,fe,me){var Ee=$.Deferred();return S.Lottery.Gift.join(Te,fe,me).then(function(Oe){switch(ee('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',Oe),Oe.code){case 0:Oe.data.award_text?Ee.resolve(Oe.data.award_text,Oe.data.award_num):Ee.resolve(Oe.data.award_name+'X'+Oe.data.award_num.toString(),Oe.data.award_num);break;default:-1<Oe.msg.indexOf('\u62D2\u7EDD')?!1==Ie.CONFIG.FORCE_LOTTERY?(Ie.blocked=!0,Ee.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++F?Ie.gift_join(Te,fe,me):(F=0,Ee.resolve('[\u793C\u7269\u62BD\u5956](roomid='+Te+',id='+fe+',type='+me+')'+Oe.msg)):Ee.resolve('[\u793C\u7269\u62BD\u5956](roomid='+Te+',id='+fe+',type='+me+')'+Oe.msg);}}),Ee},guard_join:function guard_join(Te,fe){var me=$.Deferred();return S.Lottery.Guard.join(Te,fe).then(function(Ee){switch(ee('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',Ee),Ee.code){case 0:Ee.data.award_text?me.resolve(Ee.data.award_text,Ee.data.award_num):me.resolve(Ee.data.award_name+'X'+Ee.data.award_num.toString(),Ee.data.award_num);break;default:-1<Ee.msg.indexOf('\u62D2\u7EDD')?!1==Ie.CONFIG.FORCE_LOTTERY?(Ie.blocked=!0,me.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++w?Ie.guard_join(Te,id):(w=0,me.resolve('[\u793C\u7269\u62BD\u5956](roomid='+Te+',id='+raffleId+',type='+type+')'+Ee.msg)):me.resolve('[\u4E0A\u8239](roomid='+Te+',id='+fe+')'+Ee.msg);}}),me},pk_join:function pk_join(Te,fe){var me=$.Deferred();return S.Lottery.Pk.join(Te,fe).then(function(Ee){switch(ee('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',Ee),Ee.code){case 0:Ee.data.award_text?me.resolve(Ee.data.award_text,Ee.data.award_num):me.resolve(Ee.data.award_name+'X'+Ee.data.award_num.toString(),Ee.data.award_num);break;default:-1<Ee.msg.indexOf('\u62D2\u7EDD')?!1==Ie.CONFIG.FORCE_LOTTERY?(Ie.blocked=!0,me.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++k?Ie.pk_join(Te,id):(k=0,me.resolve('[\u793C\u7269\u62BD\u5956](roomid='+Te+',id='+raffleId+',type='+type+')'+Ee.msg)):me.resolve('[PK](roomid='+Te+',id='+fe+')'+Ee.msg);}}),me},GroupSign:{getGroups:function getGroups(){return S.Group.my_groups().then(function(Te){return(ee('GroupSign.getGroups: API.Group.my_groups',Te),0===Te.code)?$.Deferred().resolve(Te.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+Te.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.GroupSign.getGroups()})})},signInList:function signInList(Te){var fe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(fe>=Te.length)return $.Deferred().resolve();var me=Te[fe];return me.owner_uid==V.uid?GroupSign.signInList(Te,fe+1):S.Group.sign_in(me.group_id,me.owner_uid).then(function(Ee){ee('GroupSign.signInList: API.Group.sign_in',Ee);var Oe=$.Deferred();if(0===Ee.code)0<Ee.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+me.group_id+',owner_uid='+me.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+Ee.data.add_num,'success'),Oe.resolve()):0==Ee.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+me.group_id+',owner_uid='+me.owner_uid+')\u5DF2\u7B7E\u5230','caution'),Oe.resolve()):Oe.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+Ee.msg,'caution'),$.Deferred().reject();return $.when(Ie.GroupSign.signInList(Te,fe+1),Oe)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+me.group_id+',owner_uid='+me.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.GroupSign.signInList(Te,fe)})})},run:function run(){try{return Ie.CONFIG.AUTO_GROUP_SIGN?ce(Ie.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=Ie.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(Ie.GroupSign.run,u(8,0)),$.Deferred().resolve()):Ie.GroupSign.getGroups().then(function(Te){return Ie.GroupSign.signInList(Te).then(function(){return Ie.CACHE.AUTO_GROUP_SIGH_TS=Q(),Ie.saveCache(),ae(Ie.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return J(function(){return Ie.GroupSign.run()})})},function(){return J(function(){return Ie.GroupSign.run()})}):(ae(Ie.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(Te){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Te),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return S.DailyReward.login().then(function(){ee('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.DailyReward.login()})})},watch:function watch(Te,fe){return Ie.CONFIG.WATCH?S.DailyReward.watch(Te,fe,V.uid,z()).then(function(me){ee('DailyReward.watch: API.DailyReward.watch',me),0===me.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+Te+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+me.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.DailyReward.watch(Te,fe)})}):$.Deferred().resolve()},coin:function coin(Te,fe){var me=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,Ee=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!Ie.CONFIG.COIN)return $.Deferred().resolve();if(Ie.DailyReward.coin_exp>=10*Ie.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(me>=Te.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var Oe=JSON.parse(Te[me].card),ve=_Mathmin(2,fe);Ee&&(ve=1),S.x.getCoinInfo('','jsonp',Oe.aid,Q()).then(function(xe){return 2===xe.data.multiply?(ee('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+Oe.aid),Ie.DailyReward.coin(vlist,fe,me+1)):S.DailyReward.coin(Oe.aid,ve).then(function(he){return(ee('DailyReward.coin: API.DailyReward.coin',he),0===he.code)?(Ie.DailyReward.coin_exp+=10*ve,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+Oe.aid+',num='+ve+')','success'),Ie.DailyReward.coin(Te,fe-ve,me+1)):-110===he.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===he.code?Ee?Ie.DailyReward.coin(Te,fe,me+1):Ie.DailyReward.coin(Te,fe,me,!0):34005===he.code?Ie.DailyReward.coin(Te,fe,me+1):-104===he.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+he.msg,'caution'),Ie.DailyReward.coin(Te,fe,me+1))},function(){return J(function(){return Ie.DailyReward.coin(Te,fe,me)})})})},coin_uid:function coin_uid(Te,fe,me,Ee){var Oe=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,ve=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!Ie.CONFIG.COIN)return $.Deferred().resolve();if(Ie.DailyReward.coin_exp>=10*Ie.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();Oe>=Te.length&&Ie.DailyReward.UserSpace(Ie.CONFIG.COIN_UID,30,0,me++,'','pubdate','jsonp');var xe=Te[Oe];if(1===xe.is_union_video||xe.mid!=Ee)return ee('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+xe.aid),Ie.DailyReward.coin_uid(Te,fe,me,Ee,Oe+1);var he=_Mathmin(2,fe);ve&&(he=1),S.x.getCoinInfo('','jsonp',xe.aid,Q()).then(function(Ce){return 2===Ce.data.multiply?(ee('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+xe.aid),Ie.DailyReward.coin_uid(Te,fe,me,Ee,Oe+1)):S.DailyReward.coin(xe.aid,he).then(function(Re){return(ee('DailyReward.coin_uid: API.DailyReward.coin_uid',Re),0===Re.code)?(Ie.DailyReward.coin_exp+=10*he,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+xe.aid+',num='+he+')','success'),Ie.DailyReward.coin_uid(Te,fe-he,me,Ee,Oe+1)):-110===Re.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===Re.code?ve?Ie.DailyReward.coin_uid(Te,fe,me,Ee,Oe+1):Ie.DailyReward.coin_uid(Te,fe,Oe,me,Ee,!0):34005===Re.code?Ie.DailyReward.coin_uid(Te,fe,me,Ee,Oe+1):-104===Re.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+Re.msg,'caution'),Ie.DailyReward.coin_uid(Te,fe,me,Ee,Oe+1))},function(){return J(function(){return Ie.DailyReward.coin_uid(Te,fe,me,Ee,Oe)})})})},share:function share(Te){return Ie.CONFIG.SHARE?S.DailyReward.share(Te).then(function(fe){ee('DailyReward.share: API.DailyReward.share',fe),0===fe.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+Te+')','success'):71000===fe.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+fe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.DailyReward.share(Te)})}):$.Deferred().resolve()},dynamic:function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(){var me,Ee;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return me=void 0,Ee=Ie.CONFIG.COIN_NUMBER-Ie.DailyReward.coin_exp/10,ve.next=4,S.getuserinfo().then(function(xe){return ee('DailyReward.dynamic: API.getuserinfo',xe),xe.data.biliCoin<Ee?xe.data.biliCoin:Ee});case 4:return me=ve.sent,me<Ee&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+me+'\u4E2A\u5E01','warning'),ve.abrupt('return',S.dynamic_svr.dynamic_new(V.uid,8).then(function(xe){if(ee('DailyReward.dynamic: API.dynamic_svr.dynamic_new',xe),0===xe.code){if(!!xe.data.cards){var Re,he=JSON.parse(xe.data.cards[0].card),Ce=Ie.DailyReward.watch(he.aid,he.cid);Re=0==Ie.CONFIG.COIN_UID||'COIN_DYN'==Ie.CONFIG.COIN_TYPE?Ie.DailyReward.coin(xe.data.cards,_Mathmax(me,0)):Ie.DailyReward.UserSpace(Ie.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var Ge=Ie.DailyReward.share(he.aid);return $.when(Ce,Re,Ge)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+xe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.DailyReward.dynamic()})}));case 7:case'end':return ve.stop();}},fe,ue)}));return function dynamic(){return Te.apply(this,arguments)}}(),UserSpace:function UserSpace(Te,fe,me,Ee,Oe,ve,xe){return S.x.getUserSpace(Te,fe,me,Ee,Oe,ve,xe).then(function(he){if(ee('DailyReward.UserSpace: API.dynamic_svr.UserSpace',he),0===he.code){if(!!he.data.list.vlist){var Ce=Ie.CONFIG.COIN_NUMBER-Ie.DailyReward.coin_exp/10,Re=Ie.DailyReward.coin_uid(he.data.list.vlist,_Mathmax(Ce,0),Ee,Te);return Re}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+he.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.DailyReward.UserSpace(Te,fe,me,Ee,Oe,ve,xe)})})},run:function run(){try{return ce(Ie.CACHE.DailyReward_TS)?S.DailyReward.exp().then(function(Te){return ee('DailyReward.run: API.DailyReward.exp',Te),0===Te.code?(Ie.DailyReward.coin_exp=Te.number,Ie.DailyReward.login(),Ie.DailyReward.dynamic().then(function(){Ie.CACHE.DailyReward_TS=Q(),Ie.saveCache(),te(Ie.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+Te.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.DailyReward.run()})}):(te(Ie.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(Te){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',Te),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return S.xlive.dosign().then(function(Te){ee('LiveReward.dailySignIn: API.xlive.dosign',Te),0===Te.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===Te.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+Te.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.LiveReward.dailySignIn()})})},run:function run(){try{if(!Ie.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!ce(Ie.CACHE.LiveReward_TS))return te(Ie.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();Ie.LiveReward.dailySignIn(),Ie.CACHE.LiveReward_TS=Q(),Ie.saveCache(),te(Ie.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(Te){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',Te),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return S.Exchange.silver2coin().then(function(Te){ee('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',Te),0===Te.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+Te.msg,'success'):403===Te.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+Te.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+Te.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return Ie.CONFIG.SILVER2COIN?ce(Ie.CACHE.Silver2Coin_TS)?Ie.Exchange.silver2coin().then(function(){Ie.CACHE.Silver2Coin_TS=Q(),Ie.saveCache(),te(Ie.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return J(function(){return Ie.Exchange.runS2C()})}):(te(Ie.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(Te){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Te),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!Ie.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var Te=$.Deferred();return Z(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),Te.resolve(),!0;var fe=$('#gift-control-vm div.treasure-box.p-relative');if(!fe.length)return!1;fe=fe.first(),fe.attr('id','old_treasure_box'),fe.hide();var me=$('<div id="'+N+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');Ie.TreasureBox.DOM.div_tip=$('<div id="'+N+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),Ie.TreasureBox.DOM.div_timer=$('<div id="'+N+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),Ie.TreasureBox.DOM.image=$('<img id="'+N+'_treasure_image" style="display:none">'),Ie.TreasureBox.DOM.canvas=$('<canvas id="'+N+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var Ee='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';Ie.TreasureBox.DOM.div_tip[0].style=Ee,Ie.TreasureBox.DOM.div_timer[0].style=Ee,me.append(Ie.TreasureBox.DOM.div_tip),me.append(Ie.TreasureBox.DOM.image),me.append(Ie.TreasureBox.DOM.canvas),Ie.TreasureBox.DOM.div_tip.after(Ie.TreasureBox.DOM.div_timer),fe.after(me);try{if(OCRAD);}catch(Oe){return Ie.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+N+']',Oe),Te.resolve(),!0}return Ie.TreasureBox.timer=setInterval(function(){var Oe=parseInt(Ie.TreasureBox.DOM.div_timer.text(),10);isNaN(Oe)&&(Oe=0),0<Oe?Ie.TreasureBox.DOM.div_timer.text(Oe-1+'s'):Ie.TreasureBox.DOM.div_timer.hide()},1e3),Ie.TreasureBox.DOM.image[0].onload=function(){var Oe=Ie.TreasureBox.DOM.canvas[0].getContext('2d');Oe.font='40px agencyfbbold',Oe.textBaseline='top',Oe.clearRect(0,0,Ie.TreasureBox.DOM.canvas[0].width,Ie.TreasureBox.DOM.canvas[0].height),Oe.drawImage(Ie.TreasureBox.DOM.image[0],0,0);var ve=Ie.TreasureBox.captcha.OCR.getGrayscaleMap(Oe),xe=Ie.TreasureBox.captcha.OCR.orderFilter2In3x3(ve);Oe.clearRect(0,0,120,40);for(var Ce,he=0;he<xe.length;++he)Ce=xe[he],Oe.fillStyle='rgb('+Ce+', '+Ce+', '+Ce+')',Oe.fillRect(he%120,_Mathround(he/120),1,1);try{var he=Ie.TreasureBox.captcha.correctQuestion(OCRAD(Oe.getImageData(0,0,120,40)));ee('TreasureBox.DOM.image.load','question =',he);var Ce=Ie.TreasureBox.captcha.eval(he);ee('TreasureBox.DOM.image.load','answer =',Ce),void 0!==Ce&&(console.info('['+N+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+he+' = '+Ce),Ie.TreasureBox.promise.calc.resolve(Ce))}catch(he){Ie.TreasureBox.promise.calc.reject()}},Te.resolve(),!0}catch(fe){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',fe),Te.reject(),!0}}),Te},run:function run(){try{if(!Ie.CONFIG.AUTO_TREASUREBOX||!Ie.TreasureBox.timer)return;if(V.blocked)return Ie.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!ce(Ie.CACHE.TreasureBox_TS))return Ie.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void te(Ie.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');Ie.TreasureBox.getCurrentTask().then(function(Te){if(ee('TreasureBox.run: TreasureBox.getCurrentTask().then',Te),0===Te.code){Ie.TreasureBox.promise.timer=$.Deferred(),Ie.TreasureBox.promise.timer.then(function(){Ie.TreasureBox.captcha.calc().then(function(me){Ie.TreasureBox.getAward(me).then(function(){return Ie.TreasureBox.run()},function(){return Ie.TreasureBox.run()})},function(){return TreasureBox.run()})}),Ie.TreasureBox.time_end=Te.data.time_end,Ie.TreasureBox.time_start=Te.data.time_start;var fe=Ie.TreasureBox.time_end-z()+1;0>fe&&(fe=0),setTimeout(function(){Ie.TreasureBox.promise.timer&&Ie.TreasureBox.promise.timer.resolve()},1e3*fe),Ie.TreasureBox.DOM.div_timer.text(fe+'s'),Ie.TreasureBox.DOM.div_timer.show(),Ie.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+Te.data.times+'/'+Te.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+Te.data.silver)}else if(-10017===Te.code)Ie.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),Ie.CACHE.TreasureBox_TS=Q(),Ie.saveCache(),te(Ie.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===Te.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Te.msg,'caution'),Ie.TreasureBox.run()})}catch(Te){Ie.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Te)}},setMsg:function setMsg(Te){Ie.CONFIG.AUTO_TREASUREBOX&&(Ie.TreasureBox.promise.timer&&(Ie.TreasureBox.promise.timer.reject(),Ie.TreasureBox.promise.timer=void 0),Ie.TreasureBox.DOM.div_timer&&Ie.TreasureBox.DOM.div_timer.hide(),Ie.TreasureBox.DOM.div_tip&&Ie.TreasureBox.DOM.div_tip.html(Te))},getAward:function getAward(Te){var fe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return Ie.CONFIG.AUTO_TREASUREBOX?3<fe?$.Deferred().resolve():S.TreasureBox.getAward(Ie.TreasureBox.time_start,Ie.TreasureBox.time_end,Te).then(function(){var me=_asyncToGenerator(regeneratorRuntime.mark(function Ee(Oe){var ve;return regeneratorRuntime.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:ee('TreasureBox.getAward: getAward',Oe),he.t0=Oe.code,he.next=0===he.t0?4:-903===he.t0?5:-902===he.t0?6:-901===he.t0?6:-10017===he.t0?6:-800===he.t0?9:-500===he.t0?12:400===he.t0?15:22;break;case 4:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+Oe.data.awardSilver+' \u94F6\u74DC\u5B50','success');case 5:return he.abrupt('return',$.Deferred().resolve());case 6:return he.next=8,C(150);case 8:return he.abrupt('return',Ie.TreasureBox.captcha.calc().then(function(Ce){return Ie.TreasureBox.getAward(Ce,fe)}));case 9:return Ie.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),he.abrupt('return',$.Deferred().reject());case 12:return ve=$.Deferred(),setTimeout(function(){Ie.TreasureBox.captcha.calc().then(function(Ce){Ie.TreasureBox.getAward(Ce,fe+1).then(function(){return ve.resolve()},function(){return ve.reject()})},function(){return ve.reject()})},3e3),he.abrupt('return',ve);case 15:if(!(-1<Oe.msg.indexOf('\u62D2\u7EDD'))){he.next=20;break}return V.blocked=!0,Ie.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),he.abrupt('return',$.Deferred().reject());case 20:return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Oe.msg,'caution'),he.abrupt('return',$.Deferred().resolve());case 22:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Oe.msg,'caution');case 23:case'end':return he.stop();}},Ee,ue)}));return function(){return me.apply(this,arguments)}}(),function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.TreasureBox.getAward(Te,fe)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return Ie.CONFIG.AUTO_TREASUREBOX?S.TreasureBox.getCurrentTask().then(function(Te){return ee('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',Te),$.Deferred().resolve(Te)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return Ie.CONFIG.AUTO_TREASUREBOX?20<Ie.TreasureBox.captcha.cnt?(Ie.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):S.TreasureBox.getCaptcha(Q()).then(function(Te){if(ee('TreasureBox.captcha.calc: getCaptcha',Te),0===Te.code){Ie.TreasureBox.captcha.cnt++;var fe=$.Deferred();return Ie.TreasureBox.promise.calc=$.Deferred(),Ie.TreasureBox.promise.calc.then(function(me){Ie.TreasureBox.captcha.cnt=0,fe.resolve(me)},function(){Ie.TreasureBox.captcha.calc().then(function(me){fe.resolve(me)},function(){fe.reject()})}),Ie.TreasureBox.DOM.image.attr('src',Te.data.img),fe}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Te.msg,'caution'),J(function(){return Ie.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.TreasureBox.captcha.calc()})}):(Ie.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(Te){for(var fe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,me=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,Ee=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,Oe=Te.getImageData(0,0,me,Ee).data,ve=[],xe=0;xe<Ee;xe++)for(var he=0;he<me;he++){var Ce=4*(xe*me+he),Re=Oe.slice(Ce,Ce+4),Ge=Re?77*Re[0]+150*Re[1]+29*Re[2]+128>>8:0;ve.push(Ge>fe?Ge:0)}return ve},orderFilter2In3x3:function orderFilter2In3x3(Te){for(var fe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,me=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,Ee=function gray(Ge,ye){return 0<=Ge+ye*me?Te[Ge+ye*me]:255},Oe=[],ve=Te.length,Ge=0;Ge<ve;++Ge){var he=[Ge%me,_Mathfloor(Ge/me)],Ce=he[0],Re=he[1],ye=Array(9);ye[0]=Ee(Ce-1,Re-1),ye[1]=Ee(Ce+0,Re-1),ye[2]=Ee(Ce+1,Re-1),ye[3]=Ee(Ce-1,Re+0),ye[4]=Ee(Ce+0,Re+0),ye[5]=Ee(Ce+1,Re+0),ye[6]=Ee(Ce-1,Re+1),ye[7]=Ee(Ce+0,Re+1),ye[8]=Ee(Ce+1,Re+1),ye.sort(function(Ae,Ne){return Ae-Ne}),Oe.push(ye[fe-1])}return Oe}},eval:function _eval(Te){var fe=Function;return new fe('return '+Te)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(Te){var fe='';for(var me in Te=Te.trim(),Te){var Ee=Ie.TreasureBox.captcha.correctStr[Te[me]];fe+=void 0===Ee?Te[me]:Ee}'4'===fe[2]&&(fe[2]='+');for(var me=0;me<=parseInt(fe.length-2);me++)'\''===fe[me]&&'1'===fe[me+1]&&(fe[me]='7',fe.splice(me+1,1));return fe}}},Gift:(pe={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(pe,'run_timer',void 0),_defineProperty(pe,'sendGiftList',[1,6,30607]),_defineProperty(pe,'getMedalList',function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(){var me=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return 1===me&&(Ie.Gift.medal_list=[]),Oe.next=3,S.i.medal(me,25).then(function(ve){if(ee('Gift.getMedalList: API.i.medal',ve),Ie.Gift.medal_list=Ie.Gift.medal_list.concat(ve.data.fansMedalList),ve.data.pageinfo.curPage<ve.data.pageinfo.totalpages)return Ie.Gift.getMedalList(me+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.Gift.getMedalList()})});case 3:return Oe.abrupt('return',Oe.sent);case 4:case'end':return Oe.stop();}},fe,ue)}));return function getMedalList(){return Te.apply(this,arguments)}}()),_defineProperty(pe,'getBagList',function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(){return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return Ee.next=2,S.gift.bag_list().then(function(Oe){ee('Gift.getBagList: API.gift.bag_list',Oe),Ie.Gift.bag_list=Oe.data.list,Ie.Gift.time=Oe.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.Gift.getBagList()})});case 2:return Ee.abrupt('return',Ee.sent);case 3:case'end':return Ee.stop();}},fe,ue)}));return function getBagList(){return Te.apply(this,arguments)}}()),_defineProperty(pe,'getFeedByGiftID',function getFeedByGiftID(Te){if(30607===Te)return 50;for(var fe=V.gift_list.length-1;0<=fe;--fe)if(V.gift_list[fe].id===Te)return Math.ceil(V.gift_list[fe].price/100);return 0}),_defineProperty(pe,'sort_medals',function sort_medals(Te){if('high'==Ie.CONFIG.GIFT_SORT?Te.sort(function(he,Ce){return 0==Ce.level-he.level?Ce.intimacy-he.intimacy:Ce.level-he.level}):Te.sort(function(he,Ce){return 0==he.level-Ce.level?he.intimacy-Ce.intimacy:he.level-Ce.level}),Ie.CONFIG.AUTO_GIFT_ROOMID&&0<Ie.CONFIG.AUTO_GIFT_ROOMID.length){var he=Ie.CONFIG.AUTO_GIFT_ROOMID.split(',');he.reverse();var fe=!0,me=!1,Ee=void 0;try{for(var xe,Oe=function _loop2(){var Ce=xe.value,Re=Te.findIndex(function(Ge){return Ge.roomid==Ce});if(-1!=Re){var Ge=Te[Re];Te.splice(Re,1),Te.unshift(Ge)}},ve=he[Symbol.iterator]();!(fe=(xe=ve.next()).done);fe=!0)Oe()}catch(Ce){me=!0,Ee=Ce}finally{try{!fe&&ve.return&&ve.return()}finally{if(me)throw Ee}}}return Te}),_defineProperty(pe,'auto_light',function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee,Oe,ve,xe,he,Ce,Re,Ge,ye,Ae,Ne,De,Me,be,Le,Se;return regeneratorRuntime.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:we.prev=0,Ee=Ie.Gift.getFeedByGiftID(30607),Oe=Ie.CONFIG.LIGHT_MEDALS.split(','),ve=void 0,ve='LIGHT_WHITE'==Ie.CONFIG.LIGHT_METHOD?me.filter(function(ke){return 0==ke.is_lighted&&ke.day_limit-ke.today_feed>=Ee&&0<=Oe.findIndex(function(He){return He==ke.roomid})}):me.filter(function(ke){return 0==ke.is_lighted&&ke.day_limit-ke.today_feed>=Ee&&-1==Oe.findIndex(function(He){return He==ke.roomid})});;if(ee('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',ve),!(ve&&0<ve.length)){we.next=52;break}return ve=Ie.Gift.sort_medals(ve),we.next=11,Ie.Gift.getBagList();case 11:if(xe=Ie.Gift.bag_list.filter(function(ke){return 30607==ke.gift_id}),!(xe&&0<xe.length)){we.next=52;break}he=!0,Ce=!1,Re=void 0,we.prev=16,Ge=ve[Symbol.iterator]();case 18:if(he=(ye=Ge.next()).done){we.next=38;break}if(Ae=ye.value,Ne=xe.find(function(ke){return 30607==ke.gift_id&&0<ke.gift_num}),!Ne){we.next=34;break}if(De=Ae.day_limit-Ae.today_feed,!(0<=De-Ee||Ie.CONFIG.FORCE_LIGHT)){we.next=33;break}return we.next=26,S.room.room_init(parseInt(Ae.roomid,10));case 26:return Me=we.sent,be=parseInt(Me.data.room_id,10),Le=1,we.next=31,S.gift.bag_send(V.uid,30607,Ae.target_id,Le,Ne.bag_id,be,V.rnd);case 31:Se=we.sent,0===Se.code?(Ne.gift_num-=Le,Ae.today_feed+=Le*Ee,De-=Le*Ee,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ae.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Le+'\u4E2A'+Ne.gift_name+'\uFF0C['+Ae.today_feed+'/'+Ae.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+De+']','success'),ee('Gift.auto_light','\u52CB\u7AE0['+Ae.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Le+'\u4E2A'+Ne.gift_name+'\uFF0C['+Ae.today_feed+'/'+Ae.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ae.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+Me.msg+'\u3011','caution');case 33:return we.abrupt('continue',35);case 34:return we.abrupt('break',38);case 35:he=!0,we.next=18;break;case 38:we.next=44;break;case 40:we.prev=40,we.t0=we['catch'](16),Ce=!0,Re=we.t0;case 44:we.prev=44,we.prev=45,!he&&Ge.return&&Ge.return();case 47:if(we.prev=47,!Ce){we.next=50;break}throw Re;case 50:return we.finish(47);case 51:return we.finish(44);case 52:we.next=58;break;case 54:we.prev=54,we.t1=we['catch'](0),console.error(we.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+we.t1,'error');case 58:case'end':return we.stop();}},fe,ue,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return Te.apply(this,arguments)}}()),_defineProperty(pe,'run',function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(){var me,Ee,Oe,ve,xe,he,Ce,Re,Ge,ye,Ae,Ne,De,Me,be,Le;return regeneratorRuntime.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(me=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.Gift.run()})},Ee=function nextTimeDebug(){if('GIFT_SEND_TIME'==Ie.CONFIG.GIFT_METHOD){var we=u(Ie.CONFIG.GIFT_SEND_HOUR,Ie.CONFIG.GIFT_SEND_MINUTE);Ie.Gift.run_timer=setTimeout(Ie.Gift.run,we);var ke=new Date(Q()+we).toLocaleString();ee('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+ke+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ie.CACHE.Gift_TS=Q(),Ie.saveCache()}else ee('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ie.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ie.CACHE.GiftInterval_TS=Q(),Ie.saveCache()},Fe.prev=2,Ie.CONFIG.AUTO_GIFT){Fe.next=5;break}return Fe.abrupt('return',$.Deferred().resolve());case 5:if(Ie.Gift.run_timer&&clearTimeout(Ie.Gift.run_timer),'GIFT_SEND_TIME'!=Ie.CONFIG.GIFT_METHOD||E(Ie.CONFIG.GIFT_SEND_HOUR,Ie.CONFIG.GIFT_SEND_MINUTE)||H||U){Fe.next=14;break}return Oe=u(Ie.CONFIG.GIFT_SEND_HOUR,Ie.CONFIG.GIFT_SEND_MINUTE),Ie.Gift.run_timer=setTimeout(Ie.Gift.run,Oe),ve=new Date(Q()+Oe).toLocaleString(),ee('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+ve+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Fe.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=Ie.CONFIG.GIFT_METHOD||H||U){Fe.next=27;break}if(xe=6e4*Ie.CONFIG.GIFT_INTERVAL,!Ie.CACHE.GiftInterval_TS){Fe.next=25;break}if(he=Q()-Ie.CACHE.GiftInterval_TS,!(he<xe)){Fe.next=23;break}return Ce=xe-he,Ie.Gift.run_timer=setTimeout(Ie.Gift.run,Ce),ee('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ce+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Fe.abrupt('return');case 23:Fe.next=27;break;case 25:Ie.CACHE.GiftInterval_TS=Q(),Ie.saveCache();case 27:return Ie.Gift.over=!1,Fe.next=30,Ie.Gift.getMedalList();case 30:if(Re=Ie.Gift.medal_list,ee('Gift.run: Gift.getMedalList().then: Gift.medal_list',Re),!(Re&&0<Re.length)){Fe.next=84;break}Re=Re.filter(function(we){return 0<we.day_limit-we.today_feed&&20>we.level}),Re=Ie.Gift.sort_medals(Re),Ie.CONFIG.EXCLUDE_ROOMID&&0<Ie.CONFIG.EXCLUDE_ROOMID.length&&(Ge=Ie.CONFIG.EXCLUDE_ROOMID.split(','),Re=Re.filter(function(we){return-1==Ge.findIndex(function(ke){return ke==we.roomid})}));;return Fe.next=39,Ie.Gift.auto_light(Re);case 39:if(!U){Fe.next=42;break}return U=!1,Fe.abrupt('return',$.Deferred().resolve());case 42:ye=!0,Ae=!1,Ne=void 0,Fe.prev=45,De=Re[Symbol.iterator]();case 47:if(ye=(Me=De.next()).done){Fe.next=70;break}if(be=Me.value,!Ie.Gift.over){Fe.next=51;break}return Fe.abrupt('break',70);case 51:return Fe.next=53,S.room.room_init(parseInt(be.roomid,10));case 53:if(Le=Fe.sent,Ie.Gift.room_id=parseInt(Le.data.room_id,10),Ie.Gift.ruid=be.target_id,Ie.Gift.remain_feed=be.day_limit-be.today_feed,!(0<Ie.Gift.remain_feed)){Fe.next=67;break}return Fe.next=60,Ie.Gift.getBagList();case 60:if(!(0<Ie.Gift.remain_feed)){Fe.next=66;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+be.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+be.today_feed+'/'+be.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+Ie.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Fe.next=64,Ie.Gift.sendGift(be);case 64:Fe.next=67;break;case 66:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+be.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 67:ye=!0,Fe.next=47;break;case 70:Fe.next=76;break;case 72:Fe.prev=72,Fe.t0=Fe['catch'](45),Ae=!0,Ne=Fe.t0;case 76:Fe.prev=76,Fe.prev=77,!ye&&De.return&&De.return();case 79:if(Fe.prev=79,!Ae){Fe.next=82;break}throw Ne;case 82:return Fe.finish(79);case 83:return Fe.finish(76);case 84:return Fe.next=86,Ie.Gift.sendRemainGift(Ie.CONFIG.SPARE_GIFT_ROOM);case 86:Fe.next=94;break;case 88:return Fe.prev=88,Fe.t1=Fe['catch'](2),me(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Fe.t1),Fe.abrupt('return',$.Deferred().reject());case 94:return H=!1,Ee(),Fe.abrupt('return',$.Deferred().resolve());case 97:case'end':return Fe.stop();}},fe,ue,[[2,88],[45,72,76,84],[77,,79,83]])}));return function run(){return Te.apply(this,arguments)}}()),_defineProperty(pe,'sendGift',function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee,Oe,ve,xe,he,Ce,Re,Ge,ye,Ae;return regeneratorRuntime.wrap(function(De){for(;;)switch(De.prev=De.next){case 0:return De.next=2,Ie.Gift.getBagList();case 2:if(Ee=void 0,!(0>=Ie.Gift.remain_feed)){De.next=6;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+me.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+me.today_feed+'/'+me.day_limit+']','info'),De.abrupt('return',$.Deferred().resolve());case 6:if(0>=Ie.Gift.time&&(Ie.Gift.time=z()),Ie.CONFIG.SEND_ALL_GIFT){De.next=18;break}if(Oe=Ie.Gift.bag_list.filter(function(Me){return Ie.Gift.sendGiftList.includes(Me.gift_id)&&0<Me.gift_num&&Me.corner_mark.substring(0,Me.corner_mark.indexOf('\u5929'))<=Ie.CONFIG.GIFT_LIMIT}),ee('pass',Oe),0!=Oe.length){De.next=15;break}return Ie.Gift.over=!0,De.abrupt('return');case 15:Ee=Oe;case 16:De.next=25;break;case 18:if(ve=Ie.Gift.bag_list.filter(function(Me){return 0<Me.gift_num&&'\u6C38\u4E45'!=Me.corner_mark}),0!=ve.length){De.next=24;break}return Ie.Gift.over=!0,De.abrupt('return');case 24:Ee=ve;case 25:ee('bag_list',Ee),xe=!0,he=!1,Ce=void 0,De.prev=29,Re=regeneratorRuntime.mark(function(){var Me,be,Le;return regeneratorRuntime.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Me=ye.value,!(0>=me.day_limit-me.today_feed)){Fe.next=4;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+me.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+me.today_feed+'/'+me.day_limit+']','info'),Fe.abrupt('return',{v:void 0});case 4:if(be=Ie.Gift.getFeedByGiftID(Me.gift_id),!(0<be)){Fe.next=12;break}if(Le=_Mathfloor(Ie.Gift.remain_feed/be),Le>Me.gift_num&&(Le=Me.gift_num),!(0<Le)){Fe.next=12;break}return ee('[\u81EA\u52A8\u9001\u793C]\u9001\u51FA\u793C\u7269\u7C7B\u578B',Me.gift_name),Fe.next=12,S.gift.bag_send(V.uid,Me.gift_id,Ie.Gift.ruid,Le,Me.bag_id,Ie.Gift.room_id,V.rnd).then(function(we){ee('Gift.sendGift: API.gift.bag_send',we),0===we.code?(Me.gift_num-=Le,me.today_feed+=Le*be,Ie.Gift.remain_feed-=Le*be,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+me.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Le+'\u4E2A'+Me.gift_name+'\uFF0C['+me.today_feed+'/'+me.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+Ie.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+me.medalName+'] \u9001\u793C\u5F02\u5E38:'+we.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.Gift.sendGift(me)})});case 12:case'end':return Fe.stop();}},Re,ue)}),Ge=Ee[Symbol.iterator]();case 32:if(xe=(ye=Ge.next()).done){De.next=40;break}return De.delegateYield(Re(),'t0',34);case 34:if(Ae=De.t0,'object'!==('undefined'==typeof Ae?'undefined':_typeof(Ae))){De.next=37;break}return De.abrupt('return',Ae.v);case 37:xe=!0,De.next=32;break;case 40:De.next=46;break;case 42:De.prev=42,De.t1=De['catch'](29),he=!0,Ce=De.t1;case 46:De.prev=46,De.prev=47,!xe&&Ge.return&&Ge.return();case 49:if(De.prev=49,!he){De.next=52;break}throw Ce;case 52:return De.finish(49);case 53:return De.finish(46);case 54:case'end':return De.stop();}},fe,ue,[[29,42,46,54],[47,,49,53]])}));return function sendGift(){return Te.apply(this,arguments)}}()),_defineProperty(pe,'sendRemainGift',function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee,Oe,ve,xe,he,Ce,Re,Ge,ye,Ae;return regeneratorRuntime.wrap(function(De){for(;;)switch(De.prev=De.next){case 0:if(0!=me){De.next=2;break}return De.abrupt('return',$.Deferred().resolve());case 2:return Ee=void 0,De.next=5,S.live_user.get_anchor_in_room(me).then(function(Me){return ee('API.live_user.get_anchor_in_room',Me),Me.data.info.uid?void(Ee=Me.data.info.uid):(window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u68C0\u67E5\u623F\u95F4\u51FA\u9519'),$.Deferred().reject())});case 5:return De.next=7,Ie.Gift.getBagList();case 7:if(Oe=void 0,0>=Ie.Gift.time&&(Ie.Gift.time=z()),Ie.CONFIG.SEND_ALL_GIFT){De.next=19;break}if(ve=Ie.Gift.bag_list.filter(function(Me){return Ie.Gift.sendGiftList.includes(Me.gift_id)&&0<Me.gift_num&&'1\u5929'==Me.corner_mark}),0!=ve.length){De.next=16;break}return Ie.Gift.over=!0,De.abrupt('return');case 16:Oe=ve;case 17:De.next=26;break;case 19:if(xe=Ie.Gift.bag_list.filter(function(Me){return 0<Me.gift_num&&'\u6C38\u4E45'!=Me.corner_mark}),0!=xe.length){De.next=25;break}return Ie.Gift.over=!0,De.abrupt('return');case 25:Oe=xe;case 26:ee('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011bag_list',Oe),he=!0,Ce=!1,Re=void 0,De.prev=30,Ge=regeneratorRuntime.mark(function(){var Me,be,Le;return regeneratorRuntime.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Me=Ae.value,be=Ie.Gift.getFeedByGiftID(Me.gift_id),!(0<be)){Fe.next=7;break}if(Le=Me.gift_num,!(0<Le)){Fe.next=7;break}return Fe.next=7,S.gift.bag_send(V.uid,Me.gift_id,Ee,Le,Me.bag_id,me,V.rnd).then(function(we){ee('Gift.sendGift: API.gift.bag_send',we),0===we.code?(Me.gift_num-=Le,window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+me+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Le+'\u4E2A'+Me.gift_name,'success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+me+'] \u9001\u793C\u5F02\u5E38:'+we.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.Gift.sendGift(medal)})});case 7:case'end':return Fe.stop();}},Ge,ue)}),ye=Oe[Symbol.iterator]();case 33:if(he=(Ae=ye.next()).done){De.next=38;break}return De.delegateYield(Ge(),'t0',35);case 35:he=!0,De.next=33;break;case 38:De.next=44;break;case 40:De.prev=40,De.t1=De['catch'](30),Ce=!0,Re=De.t1;case 44:De.prev=44,De.prev=45,!he&&ye.return&&ye.return();case 47:if(De.prev=47,!Ce){De.next=50;break}throw Re;case 50:return De.finish(47);case 51:return De.finish(44);case 52:case'end':return De.stop();}},fe,ue,[[30,40,44,52],[45,,47,51]])}));return function sendRemainGift(){return Te.apply(this,arguments)}}()),pe),MobileHeartBeat:{run:function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(){var me,Ee,Oe,ve;return regeneratorRuntime.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if(!1!=Ie.CONFIG.MOBILE_HEARTBEAT){he.next=2;break}return he.abrupt('return',$.Deferred().resolve());case 2:if(ce(Ie.CACHE.MobileHeartBeat_TS)){he.next=5;break}return te(Ie.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),he.abrupt('return',$.Deferred().resolve());case 5:if(!1!==V.mobile_verify){he.next=9;break}return window.toast('[\u79FB\u52A8\u7AEF\u5FC3\u8DF3]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','warning'),ee('MobileHeartBeat','\u672A\u7ED1\u5B9A\u624B\u673A mobile_verify = '+V.mobile_verify),he.abrupt('return',$.Deferred().resolve());case 9:return me=function mobileOnline(){G({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+de.access_token+'&'+ne),data:'room_id='+V.room_id+'&scale=xxhdpi',responseType:'json',headers:oe.headers})},Ee=function EndFunc(Ce){ee('MobileHeartBeat GetAward',Ce),clearInterval(ve),Ie.CACHE.MobileHeartBeat_TS=Q(),Ie.saveCache(),te(Ie.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3')},Oe=function getWatchingAward(){S.activity.receive_award('double_watch_task').then(function(Ce){return 0===Ce.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u6210\u529F','success'),Ee(Ce),$.Deferred().resolve()):-400===Ce.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u5DF2\u9886\u53D6','info'),Ee(Ce),$.Deferred().resolve()):(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]'+Ce,'warning'),Ee(Ce),$.Deferred().resolve())},function(Ce){return window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('MobileHeartBeat GetAward',Ce),clearInterval(ve),J(function(){return Ie.MobileHeartBeat.run()})})},he.next=14,le();case 14:if(he.t1=he.sent,he.t2=void 0,he.t0=he.t1===he.t2,!he.t0){he.next=19;break}he.t0=void 0===de.access_token;case 19:if(!he.t0){he.next=22;break}return ee('MobileHeartBeat','token\u8BBE\u7F6E\u5931\u8D25'),he.abrupt('return');case 22:ee('MobileHeartBeat','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),me(),ve=void 0,ve=setInterval(function(){return me()},300000),setTimeout(Oe,360000);case 27:case'end':return he.stop();}},fe,ue)}));return function run(){return Te.apply(this,arguments)}}()},stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(Te){var fe=[];try{var me=JSON.parse(localStorage.getItem(N+'stormIdSet'));fe=[].concat(me.list),fe.push(Te),50<fe.length&&fe.splice(0,10),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:fe})),ee(N+'storm_Id_list_add',fe)}catch(me){fe.push(Te),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:fe}))}},isIn:function isIn(Te){var fe=[];try{var me=JSON.parse(localStorage.getItem(N+'stormIdSet'));return fe=null===me?[]:[].concat(me.list),ee(N+'storm_Id_list_read',me),-1<fe.indexOf(Te)}catch(me){return localStorage.setItem(N+'stormIdSet',JSON.stringify({list:fe})),ee('\u8BFB\u53D6'+(N+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<fe.indexOf(Te)}}},Storm:{check:function check(Te){return-1<Ie.stormQueue.indexOf(Te)},append:function append(Te){Ie.stormQueue.push(Te),Ie.stormQueue.length>Ie.CONFIG.STORM_QUEUE_SIZE&&Ie.stormQueue.shift()},over:function over(Te){var fe=Ie.stormQueue.indexOf(Te);-1<fe&&Ie.stormQueue.splice(Te,1)},run:function run(Te){try{return Ie.CONFIG.STORM?Ie.stormBlack?$.Deferred().resolve():O(Ie.CONFIG.TIME_AREA_START_H0UR,Ie.CONFIG.TIME_AREA_END_H0UR,Ie.CONFIG.TIME_AREA_START_MINUTE,Ie.CONFIG.TIME_AREA_END_MINUTE)&&Ie.CONFIG.TIME_AREA_DISABLE?(ee('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+Te),$.Deferred().resolve()):S.Storm.check(Te).then(function(fe){if(ee('MY_API.Storm.run: MY_API.API.Storm.check',fe),0===fe.code){var me=fe.data;return Ie.Storm.join(me.id,me.roomid,_Mathround(new Date().getTime()/1e3)+me.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+Te+')'+fe.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+Te+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(fe){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',fe),$.Deferred().reject()}},join:function join(Te,fe,me){var Ee=function(){var he=_asyncToGenerator(regeneratorRuntime.mark(function Ce(){var Re,Ge;return regeneratorRuntime.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:if(Ae.prev=0,Ie.Storm.check(Te)){Ae.next=4;break}return clearInterval(ve),Ae.abrupt('return');case 4:if(Re=_Mathround(new Date().getTime()/1e3),!(Re>me&&0<me)){Ae.next=9;break}return Ie.Storm.over(Te),clearInterval(ve),Ae.abrupt('return');case 9:if(xe++,!(xe>Ie.CONFIG.STORM_MAX_COUNT&&0<Ie.CONFIG.STORM_MAX_COUNT)){Ae.next=15;break}return Ie.Storm.over(Te),clearInterval(ve),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+fe+',id='+Te+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+xe+',\u8DDD\u79BB\u5230\u671F:'+(me-Re)+'s','caution'),Ae.abrupt('return');case 15:if(Ge=void 0,Ae.prev=16,!(se&&oe&&de.access_token)){Ae.next=23;break}return Ae.next=20,S.Storm.join_ex(Te,fe,de.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:Ge=Ae.sent,Ae.next=26;break;case 23:return Ae.next=25,S.Storm.join(Te,captcha_token='',captcha_phrase='',fe);case 25:Ge=Ae.sent;case 26:if(ee('MY_API.Storm.join: MY_API.API.Storm.join',Ge),!Ge.code){Ae.next=51;break}if(-1==Ge.msg.indexOf('\u9886\u53D6')){Ae.next=33;break}return Ie.Storm.over(Te),clearInterval(ve),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+fe+',id='+Te+')\u6210\u529F,'+Ge.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+xe,'success'),Ae.abrupt('return');case 33:if(-1==Ge.msg.indexOf('\u9A8C\u8BC1\u7801')){Ae.next=39;break}return Ie.Storm.over(Te),clearInterval(ve),Ie.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+fe+',id='+Te+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+Ge.msg,'caution'),Ae.abrupt('return');case 39:if(!(Ge.data&&0==Ge.data.length&&-1!=Ge.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){Ae.next=46;break}return Ie.Storm.over(Te),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+fe+',id='+Te+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(ve),Ie.stormBlack=!0,setTimeout(function(){Ie.stormBlack=!1},3600000),Ae.abrupt('return');case 46:if(-1!=Ge.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){Ae.next=49;break}return clearInterval(ve),Ae.abrupt('return');case 49:Ae.next=56;break;case 51:return Ie.Storm.over(Te),Statistics.appendGift(Ge.data.gift_name,Ge.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+fe+',id='+Te+')\u6210\u529F,'+(Ge.data.gift_name+'x'+Ge.data.gift_num)+'\r\n'+Ge.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+xe,'success'),clearInterval(ve),Ae.abrupt('return');case 56:Ae.next=65;break;case 58:return Ae.prev=58,Ae.t0=Ae['catch'](16),Ie.Storm.over(Te),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+fe+',id='+Te+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+xe,'error'),console.error(Ae.t0),clearInterval(ve),Ae.abrupt('return');case 65:Ae.next=74;break;case 67:return Ae.prev=67,Ae.t1=Ae['catch'](0),Ie.Storm.over(Te),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+fe+',id='+Te+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(Ae.t1),clearInterval(ve),Ae.abrupt('return');case 74:case'end':return Ae.stop();}},Ce,this,[[0,67],[16,58]])}));return function(){return he.apply(this,arguments)}}();if(fe=parseInt(fe,10),Te=parseInt(Te,10),isNaN(fe)||isNaN(Te))return $.Deferred().reject();var Oe=_Mathround(Te/1e6);if(Ie.stormIdSet.isIn(Oe))return $.Deferred().resolve();if(Ie.stormIdSet.add(Oe),!Ie.Storm.check(Te)){Ie.Storm.append(Te);var ve=0;0>=me&&(me=_Mathround(new Date().getTime()/1e3)+90);var xe=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+fe+',id='+Te+')','success'),ve=setInterval(function(){return Ee()},Ie.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{medalRoom_list:[],liveRoom_list:[],getMedalRoomList:function getMedalRoomList(){var Te=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 1===Te&&(Ie.LITTLE_HEART.medalRoom_list=[]),S.i.medal(Te,25).then(function(fe){ee('LITTLE_HEART.getMedalRoomList: API.i.medal',fe);var me=!0,Ee=!1,Oe=void 0;try{for(var xe,he,ve=fe.data.fansMedalList[Symbol.iterator]();!(me=(xe=ve.next()).done);me=!0)he=xe.value,Ie.LITTLE_HEART.medalRoom_list=Ie.LITTLE_HEART.medalRoom_list.concat(he.roomid)}catch(he){Ee=!0,Oe=he}finally{try{!me&&ve.return&&ve.return()}finally{if(Ee)throw Oe}}ee('MY_API.LITTLE_HEART.medalRoom_list',Ie.LITTLE_HEART.medalRoom_list),fe.data.pageinfo.curPage<fe.data.pageinfo.totalpages&&Ie.LITTLE_HEART.getMedalRoomList(Te+1)},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.LITTLE_HEART.getMedalRoomList(Te)})})},checkRoomList:function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee,Oe,ve,xe,he,Ce,Re;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:Ee=[],Oe=!0,ve=!1,xe=void 0,ye.prev=4,he=me[Symbol.iterator]();case 6:if(Oe=(Ce=he.next()).done){ye.next=13;break}return Re=Ce.value,ye.next=10,S.room.get_info(Re).then(function(Ae){if(1===Ae.data.live_status)return void(Ee=Ee.concat(Ae.data.room_id))},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.LITTLE_HEART.checkRoomList(me)})});case 10:Oe=!0,ye.next=6;break;case 13:ye.next=19;break;case 15:ye.prev=15,ye.t0=ye['catch'](4),ve=!0,xe=ye.t0;case 19:ye.prev=19,ye.prev=20,!Oe&&he.return&&he.return();case 22:if(ye.prev=22,!ve){ye.next=25;break}throw xe;case 25:return ye.finish(22);case 26:return ye.finish(19);case 27:;if(ee('MY_API.LITTLE_HEART.checkRoomList returnRoom',Ee),void 0==Ee){ye.next=33;break}return ye.abrupt('return',Ee);case 33:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5F53\u524D\u7C89\u4E1D\u52CB\u7AE0\u5217\u8868\u4E2D\u65E0\u6B63\u5728\u76F4\u64AD\u623F\u95F4\uFF0C5\u5206\u949F\u540E\u91CD\u8BD5'),ye.abrupt('return',J(function(){return Ie.LITTLE_HEART.getMedalRoomList(page)},3e5));case 35:case'end':return ye.stop();}},fe,ue,[[4,15,19,27],[20,,22,26]])}));return function checkRoomList(){return Te.apply(this,arguments)}}(),checkRoom:function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return Ee=void 0,ve.next=3,S.room.get_info(me).then(function(xe){Ee=1===xe.data.live_status},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),J(function(){return Ie.LITTLE_HEART.checkRoomList(roomList)})});case 3:return ve.abrupt('return',Ee);case 4:case'end':return ve.stop();}},fe,ue)}));return function checkRoom(){return Te.apply(this,arguments)}}(),doHeartBeat:function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(me){var Ee,Oe;return regeneratorRuntime.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(-1!=Y.indexOf(me)){xe.next=2;break}return xe.abrupt('return');case 2:ee('[\u5C0F\u5FC3\u5FC3]\u6253\u5F00\u623F\u95F4',Y),Ee=layer.open({title:''+me,type:2,shade:0,zIndex:0,content:'https://live.bilibili.com/'+me+'?visit_id=1cut2cut3cut',end:function end(){clearTimeout(Oe),I(me,Y),I(Ee,P)}}),layer.style(Ee,{display:'none'}),P.push(Ee),Oe=setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function he(){return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:if(ce(Ie.CACHE.LittleHeart_TS)){Re.next=3;break}return ee('[\u5C0F\u5FC3\u5FC3]','\u4ECA\u65E5\u4EFB\u52A1\u5B8C\u6210\uFF0C\u623F\u95F4'+me+'\u4E0D\u518D\u6253\u5F00'),Re.abrupt('return',$.Deferred().resolve());case 3:if(Ie.LITTLE_HEART.checkRoom(me)){Re.next=7;break}return window.toast('[\u5C0F\u5FC3\u5FC3]\u623F\u95F4'+me+'\u4E0B\u64AD\uFF0C\u518D\u6B21\u5BFB\u627E\u5F00\u64AD\u623F\u95F4','info'),layer.close(Ee),Re.abrupt('return',Ie.LITTLE_HEART.run());case 7:case'end':return Re.stop();}},he,ue)})),310e3);case 7:case'end':return xe.stop();}},fe,ue)}));return function doHeartBeat(){return Te.apply(this,arguments)}}(),checkHeart:function checkHeart(){var Te=function checkbag(){S.gift.bag_list().then(function(me){ee('[\u5C0F\u5FC3\u5FC3]\u68C0\u67E5\u5305\u88F9',me);var Ee=me.data.list.filter(function(Ge){return 30607==Ge.gift_id&&'7\u5929'==Ge.corner_mark}),Oe=0,ve=!0,xe=!1,he=void 0;try{for(var Re,Ge,Ce=Ee[Symbol.iterator]();!(ve=(Re=Ce.next()).done);ve=!0)Ge=Re.value,ee('[\u5C0F\u5FC3\u5FC3]\u68C0\u6D4B\u5305\u88F9\u51857\u5929\u5C0F\u5FC3\u5FC3'+Ge.gift_num+'\u4E2A',Ge),Oe+=Ge.gift_num}catch(Ge){xe=!0,he=Ge}finally{try{!ve&&Ce.return&&Ce.return()}finally{if(xe)throw he}}if(24===Oe)return clearInterval(fe),window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6','success'),Ie.CACHE.LittleHeart_TS=Q(),Ie.saveCache(),T(P),te(Ie.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3')})};Te();var fe=setInterval(function(){Te()},310e3)},run:function run(){if(!Ie.CONFIG.LITTLE_HEART)return $.Deferred().resolve();if(!ce(Ie.CACHE.LittleHeart_TS))return te(Ie.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3');var Te=function(){var fe=_asyncToGenerator(regeneratorRuntime.mark(function me(){var Ee,Oe,ve,xe,he,Ce,Re;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return Ie.LITTLE_HEART.checkHeart(),ye.next=3,Ie.LITTLE_HEART.getMedalRoomList();case 3:return ye.next=5,Ie.LITTLE_HEART.checkRoomList(Ie.LITTLE_HEART.medalRoom_list);case 5:Y=ye.sent,Ee=0,Oe=!0,ve=!1,xe=void 0,ye.prev=10,he=Y[Symbol.iterator]();case 12:if(Oe=(Ce=he.next()).done){ye.next=24;break}if(Re=Ce.value,!(Ee<Ie.CONFIG.MAX_TAB)){ye.next=20;break}return ye.next=17,Ie.LITTLE_HEART.doHeartBeat(Re);case 17:Ee++,ye.next=21;break;case 20:return ye.abrupt('break',24);case 21:Oe=!0,ye.next=12;break;case 24:ye.next=30;break;case 26:ye.prev=26,ye.t0=ye['catch'](10),ve=!0,xe=ye.t0;case 30:ye.prev=30,ye.prev=31,!Oe&&he.return&&he.return();case 33:if(ye.prev=33,!ve){ye.next=36;break}throw xe;case 36:return ye.finish(33);case 37:return ye.finish(30);case 38:case'end':return ye.stop();}},me,ue,[[10,26,30,38],[31,,33,37]])}));return function runFunc(){return fe.apply(this,arguments)}}();Ie.CONFIG.BLOCK_LIVE_VIDEO?Te():layer.confirm('\u82E5\u4E0D\u52FE\u9009\u3010\u62E6\u622A\u6302\u5C0F\u5FC3\u5FC3\u6253\u5F00\u7A97\u53E3\u7684\u76F4\u64AD\u6D41\u3011\u5C06\u8017\u8D39\u5927\u91CF\u6D41\u91CF\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F',{title:'\u8B66\u544A',btn:['\u662F','\u5426']},_asyncToGenerator(regeneratorRuntime.mark(function fe(){return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:layer.msg('\u90A3\u7B97\u4E86\u256E(\uFFE3\u25BD\uFFE3)\u256D',{time:2e3}),Te();case 2:case'end':return Ee.stop();}},fe,ue)})),function(){layer.msg('\u52FE\u9009\u3010\u62E6\u622A\u6302\u5C0F\u5FC3\u5FC3\u6253\u5F00\u7A97\u53E3\u7684\u76F4\u64AD\u6D41\u3011\u540E\u9700\u5237\u65B0\u9875\u9762\u4F7F\u5176\u751F\u6548',{time:2500})})}}};Ie.init().then(function(){try{var Te=$.Deferred();(function uniqueCheck(){var me=Date.now();return 0<=me-Ie.CACHE.UNIQUE_CHECK&&15e3>=me-Ie.CACHE.UNIQUE_CHECK?($('.link-toast').hide(),$('.igiftMsg').hide(),Ie.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),Te.reject()):Te.resolve()})().then(function(){var me,Ee=function uniqueMark(){me=setTimeout(Ee,1e4),Ie.CACHE.UNIQUE_CHECK=Date.now(),Ie.saveCache(!1)};return(window.addEventListener('unload',function(){me&&(clearTimeout(me),Ie.CACHE.UNIQUE_CHECK=0,Ie.saveCache()),T(P)}),Ee(),0===parseInt(V.uid)||isNaN(parseInt(V.uid)))?void Ie.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(Ie.newMessage(GM_info.script.version),ee('MY_API.CONFIG',Ie.CONFIG),_(Ie))})}catch(Te){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',Te)}})}function _(ue){'use strict';var pe=function clearStat(){ue.GIFT_COUNT.COUNT=0,ue.GIFT_COUNT.CLEAR_TS=ge(),ue.saveGiftCount(),ee('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};if(ce(ue.GIFT_COUNT.CLEAR_TS)&&pe(),ie(pe,'\u91CD\u7F6E\u7EDF\u8BA1'),ue.creatSetBox(),ue.LITTLE_HEART.run(),ue.removeUnnecessary(),setTimeout(function(){ue.GroupSign.run(),ue.DailyReward.run(),ue.LiveReward.run(),ue.Exchange.runS2C(),ue.TreasureBox.run(),ue.Gift.run(),ue.MobileHeartBeat.run()},6e3),ue.CONFIG.LOTTERY&&(S.room.getList().then(function(Te){ee('\u76F4\u64AD\u95F4\u5217\u8868',Te);var fe=!0,me=!1,Ee=void 0;try{for(var xe,Oe=function _loop5(){var he=xe.value;S.room.getRoomList(he.id,0,0,1,1).then(function(Ce){ee('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',Ce);for(var Re=0;Re<Ce.data.length;++Re)ue.listen(Ce.data[Re].roomid,V.uid,he.name+'\u533A')})},ve=Te.data[Symbol.iterator]();!(fe=(xe=ve.next()).done);fe=!0)Oe()}catch(he){me=!0,Ee=he}finally{try{!fe&&ve.return&&ve.return()}finally{if(me)throw Ee}}}),ue.CONFIG.CHECK_HOUR_ROOM)){var Te=function check_top_room(){if(ue.GIFT_COUNT.COUNT>=ue.CONFIG.MAX_GIFT&&(ee('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),ue.max_blocked=!0),ue.blocked||ue.max_blocked)return ue.blocked?(ue.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(fe)):void ue.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(O(ue.CONFIG.TIME_AREA_START_H0UR,ue.CONFIG.TIME_AREA_END_H0UR,ue.CONFIG.TIME_AREA_START_MINUTE,ue.CONFIG.TIME_AREA_END_MINUTE)&&ue.CONFIG.TIME_AREA_DISABLE)return void ue.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var me=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],Ee=1,Oe=function checkHourRank(xe){S.rankdb.getTopRealTimeHour(xe).then(function(he){var Ce=he.data.list;ue.chatLog('\u68C0\u67E5'+me[xe]+'\u623F\u95F4\u7684\u793C\u7269','warning'),ee(me[xe]+'\u623F\u95F4\u5217\u8868',Ce);var Re=!0,Ge=!1,ye=void 0;try{for(var Ne,De,Ae=Ce[Symbol.iterator]();!(Re=(Ne=Ae.next()).done);Re=!0)De=Ne.value,ue.checkRoom(De.roomid,'\u5C0F\u65F6\u699C-'+De.area_v2_parent_name+'\u533A')}catch(De){Ge=!0,ye=De}finally{try{!Re&&Ae.return&&Ae.return()}finally{if(Ge)throw ye}}})},ve=setInterval(function(){Ee<=me.length-1?(Oe(Ee),Ee++):clearInterval(ve)},1e3)};setTimeout(Te,6e3);var fe=setInterval(Te,parseInt(1e3*ue.CONFIG.CHECK_HOUR_ROOM_INTERVAL))}var Ie=function reset(Te){var fe=setTimeout(function(){if(0<ue.raffleId_list.length||0<ue.guardId_list.length||0<ue.pkId_list.length)return ee('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void Ie(15000);if(ce(ue.CACHE.LittleHeart_TS))return ee('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(fe),void Ie(6e5);if(O(ue.CONFIG.TIME_AREA_START_H0UR,ue.CONFIG.TIME_AREA_END_H0UR,ue.CONFIG.TIME_AREA_START_MINUTE,ue.CONFIG.TIME_AREA_END_MINUTE)&&ue.CONFIG.IN_TIME_RELOAD_DISABLE){var me=u(ue.CONFIG.TIME_AREA_START_MINUTE,ue.CONFIG.TIME_AREA_END_MINUTE)+6e4;return Ie(me),void ee('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+me+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},Te)};Ie(6e4*ue.CONFIG.TIME_RELOAD)}function u(ue,pe){var Ie=new Date,Te=Ie.getHours(),fe=Ie.getMinutes(),me=Ie.getSeconds(),ve=1e3*(3600*ue)+1e3*(60*pe)-(1e3*(3600*Te)+1e3*(60*fe)+1e3*me);return ee('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',ve+'\u6BEB\u79D2'),0>ve?86400000+ve:ve}function I(ue,pe){pe.splice(pe.indexOf(ue),1)}function T(ue){if(ue!=void 0){var pe=!0,Ie=!1,Te=void 0;try{for(var me,Ee,fe=ue[Symbol.iterator]();!(pe=(me=fe.next()).done);pe=!0)Ee=me.value,layer.close(Ee)}catch(Ee){Ie=!0,Te=Ee}finally{try{!pe&&fe.return&&fe.return()}finally{if(Ie)throw Te}}}}function E(ue,pe){var Ie=new Date,Te=Ie.getHours(),fe=Ie.getMinutes();return Te==ue&&fe==pe||(ee('isTime','\u9519\u8BEF\u65F6\u95F4'),!1)}function O(ue,pe,Ie,Te){if(23<ue||24<pe||0>ue||1>pe||59<Ie||0>Ie||59<Te||0>Te)return!1;var fe=new Date,me=fe.getHours(),Ee=fe.getMinutes();if(ue<pe)return me>=ue&&me<pe||me==pe&&Ee>=Ie&&Ee<Te;return ue>pe?me>=ue||me<pe||me==pe&&Ee>=Ie&&Ee<Te:ue==pe?me==ue&&Ie<=Te&&Ee>=Ie&&Ee<Te||me==ue&&Ie>Te&&Ee<=Te&&Ee>Ie:void 0}function C(ue){return new Promise(function(pe){setTimeout(function(){pe()},ue)})}function R(ue){if(0>=ue)return!1;var pe=Math.random();return ue/100>=pe}function G(ue){return new Promise(function(pe){var Ie=function onerror(Te){console.error('XHR',Te),pe(void 0)};if(ue.GM)'POST'===ue.method&&(void 0===ue.headers&&(ue.headers={}),void 0===ue.headers['Content-Type']&&(ue.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),ue.timeout=30000,ue.onload=function(Te){pe(Te.response)},ue.onerror=Ie,ue.ontimeout=Ie,GM_xmlhttpRequest(ue);else{var Te=new XMLHttpRequest;Te.open(ue.method,ue.url),'POST'===ue.method&&null===Te.getResponseHeader('Content-Type')&&Te.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),ue.cookie&&(Te.withCredentials=!0),ue.responseType!==void 0&&(Te.responseType=ue.responseType),Te.timeout=30000,Te.onload=function(fe){var me=fe.target;pe({response:me,body:me.response})},Te.onerror=Ie,Te.ontimeout=Ie,Te.send(ue.data)}})}if('block'==D&&/https?:\/\/live\.bilibili\.com\/.*\?visit_id=1cut2cut3cut/.test(window.location.href))return function(){var ue=setInterval(function(){0<$('.live-icon-un-mute').length&&($('.live-icon-un-mute').click(),clearInterval(ue))},200),pe=setInterval(function(){0<$('[data-title="Flash\u64AD\u653E\u5668"]').length&&($('[data-title="Flash\u64AD\u653E\u5668"]').click(),clearInterval(pe))},5e3)}();window.localStorage.LIVE_PLAYER_STATUS=window.localStorage.LIVE_PLAYER_STATUS.replace('flash','html5');var L=localStorage.getItem(N+'_msgHide')||'hide',S=BilibiliAPI,F=0,w=0,k=0,H=!1,U=!1,B=!0,P=[],Y=[],V={room_id:void 0,uid:void 0,ruid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},X=navigator.userAgent,K=new Date().getTimezoneOffset()+480,Q=function ts_ms(){return Date.now()},z=function ts_s(){return _Mathround(Q()/1e3)},Z=function runUntilSucceed(ue){var pe=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,Ie=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){ue()||Z(ue,Ie,Ie)},pe)},J=function delayCall(ue){var pe=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,Ie=$.Deferred();return setTimeout(function(){var Te=ue();Te&&Te.then?Te.then(function(fe,me,Ee,Oe,ve,xe){return Ie.resolve(fe,me,Ee,Oe,ve,xe)}):Ie.resolve()},pe),Ie},ee=function MYDEBUG(ue){for(var pe=arguments.length,Ie=Array(1<pe?pe-1:0),Te=1;Te<pe;Te++)Ie[Te-1]=arguments[Te];var fe=new Date;return fe='['+N+']['+fe.getHours()+':'+fe.getMinutes()+':'+fe.getSeconds()+':'+fe.getMilliseconds()+']',1===Ie.length?void console.log(fe,ue+':',Ie[0]):void console.log(fe,ue+':',Ie)},te=function runMidnight(ue,pe){var Ie=new Date;Ie.setMinutes(Ie.getMinutes()+K),Ie.setDate(Ie.getDate()+1),Ie.setHours(0,1,0,0),Ie.setMinutes(Ie.getMinutes()-K),setTimeout(ue,Ie-Q()),ee('runMidnight',(pe||' ')+' '+Ie.toString())},ie=function runExactMidnight(ue,pe){var Ie=new Date;Ie.setMinutes(Ie.getMinutes()+K),Ie.setDate(Ie.getDate()+1),Ie.setHours(0,0,0,0),Ie.setMinutes(Ie.getMinutes()-K),setTimeout(ue,Ie-Q()),ee('runExactMidnight',(pe||' ')+' '+Ie.toString())},ae=function runTomorrow(ue,pe,Ie,Te){var fe=new Date;fe.setMinutes(fe.getMinutes()+K),fe.setDate(fe.getDate()+1),fe.setHours(pe,Ie,0,0),fe.setMinutes(fe.getMinutes()-K),setTimeout(ue,fe-Q()),ee('runTomorrow',(Te||' ')+' '+fe.toString())},oe=new BilibiliToken,ne='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',se=void 0,de=JSON.parse(localStorage.getItem(N+'_userToken'))||{},le=function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function pe(){return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(!(de.time>z())){Te.next=4;break}se=de,Te.next=10;break;case 4:return Te.next=6,oe.getToken();case 6:de=Te.sent,de.time=z()+de.expires_in,localStorage.setItem(N+'_Token',JSON.stringify(de)),se=de;case 10:;return ee(N+'_userToken',de),Te.abrupt('return','OK');case 13:case'end':return Te.stop();}},pe,A)}));return function setToken(){return ue.apply(this,arguments)}}(),_e={init:function init(){return _e.Toast.init().then(function(){})},Toast:{init:function init(){try{var ue=[];return window.toast=function(pe){var Ie=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',Te=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(Ie){case'success':case'info':break;case'caution':break;case'error':break;default:Ie='info';}var fe=$('<div class="link-toast '+Ie+' fixed"><span class="toast-text">'+pe+'</span></div>')[0];document.body.appendChild(fe),fe.style.top=document.body.scrollTop+40*ue.length+10+'px',fe.style.left=document.body.offsetWidth+document.body.scrollLeft-fe.offsetWidth-5+'px','hide'==L&&$('.link-toast').hide(),ue.push(fe),setTimeout(function(){fe.className+=' out',setTimeout(function(){ue.shift(),ue.forEach(function(me){me.style.top=parseInt(me.style.top,10)-40+'px'}),$(fe).remove()},200)},Te)},$.Deferred().resolve()}catch(ue){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',ue),$.Deferred().reject()}}}};_e.init(),$(function(){var ue=function loadInfo(pe){setTimeout(function(){var Ie='undefined'==typeof unsafeWindow?window:unsafeWindow;Ie.BilibiliLive===void 0||0===parseInt(Ie.BilibiliLive.UID)||isNaN(parseInt(Ie.BilibiliLive.UID))?(ue(1e3),window.toast('['+GM_info.script.name+']\u65E0\u914D\u7F6E\u4FE1\u606F','warning'),ee('\u65E0\u914D\u7F6E\u4FE1\u606F')):(V.room_id=Ie.BilibiliLive.ROOMID,V.uid=Ie.BilibiliLive.UID,S.live_user.get_info_in_room(V.room_id).then(function(Te){ee('InitData: API.live_user.get_info_in_room',Te),V.mobile_verify=Te.data.info.mobile_verify,V.identification=Te.data.info.identification}),S.gift.gift_config().then(function(Te){ee('InitData: API.gift.gift_config',Te),!!Te.data&&$.isArray(Te.data)?V.gift_list=Te.data:!!Te.data.list&&$.isArray(Te.data.list)?V.gift_list=Te.data.list:(V.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))}),V.bili_jct=S.getCookie('bili_jct'),V.ruid=Ie.BilibiliLive.ANCHOR_UID,V.rnd=Ie.BilibiliLive.RND,V.visit_id=Ie.__statisObserver?Ie.__statisObserver.__visitId:'',ee('Live_info',V),l())},pe)};ue(1e3),o()}),Array.prototype.remove=function(ue){var pe=this.indexOf(ue);-1<pe&&this.splice(pe,1)};var ge=function dateNow(){return Date.now()},ce=function checkNewDay(ue){if(0===ue)return!0;var pe=new Date(ue),Ie=new Date,Te=pe.getDate(),fe=Ie.getDate();return fe!==Te}})();
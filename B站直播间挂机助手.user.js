// ==UserScript==
// @namespace      https://github.com/andywang425
// @name           B站直播间挂机助手
// @name:en        B站直播间挂机助手
// @author         andywang425
// @description    自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，自动送礼，自动获取小心心，批量点亮勋章，参加被广播的节奏风暴(几乎没有)，自动发弹幕，快捷购买粉丝勋章
// @description:en 自动参与Bilibili直播区抽奖(现在极少)，直播区签到，完成主站每日任务，自动送礼，自动获取小心心，批量点亮勋章，参加被广播的节奏风暴(几乎没有)，自动发弹幕，快捷购买粉丝勋章
// @updateURL      https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E9%97%B4%E6%8C%82%E6%9C%BA%E5%8A%A9%E6%89%8B.user.js
// @homepageURL    https://github.com/andywang425/BLTH/
// @supportURL     https://github.com/andywang425/BLTH/issues
// @icon           https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright      2020, andywang425 (https://github.com/andywang425)
// @license        MIT
// @compatible     chrome 80 or later
// @compatible     firefox 77 or later
// @compatible     opera 69 or later
// @version        4.4.1
// @include       /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at        document-start
// @connect       passport.bilibili.com
// @connect       api.live.bilibili.com
// @connect       live-trace.bilibili.com
// @require       https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/BilibiliAPI_Mod.min.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/layer.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/libBilibiliToken.js
// @require       https://cdn.jsdelivr.net/gh/andywang425/BLTH@ae50298c8b1ce34108d737606ae254f448b0a22e/library_files/libWasmHash.js
// @grant        unsafeWindow
// @grant        GM_xmlhttpRequest
// ==/UserScript==
'use strict';var _Mathceil=Math.ceil,_Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function c(I,f){try{var T=l[I](f),E=T.value}catch(O){return void u(O)}return T.done?void _(E):Promise.resolve(E).then(function(O){c('next',O)},function(O){c('throw',O)})}return c('next')})}}(function(){var E=this,O='IGIFTMSG',C=BilibiliAPI,A=navigator.userAgent,G=new Date().getTimezoneOffset()+480,y=function ts_ms(){return Date.now()},x=function ts_s(){return _Mathround(y()/1e3)},D=function delayCall(ae){var ne=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,oe=$.Deferred();return setTimeout(function(){var de=ae();de&&de.then?de.then(function(se,le,_e,ge,ue,ce){return oe.resolve(se,le,_e,ge,ue,ce)}):oe.resolve()},ne),oe},M=function MYDEBUG(ae){for(var ne=arguments.length,oe=Array(1<ne?ne-1:0),de=1;de<ne;de++)oe[de-1]=arguments[de];var se=new Date;return se='['+O+']['+se.getHours()+':'+se.getMinutes()+':'+se.getSeconds()+':'+se.getMilliseconds()+']',1===oe.length?void console.log(se,ae+':',oe[0]):void console.log(se,ae+':',oe)},L=function runMidnight(ae,ne){var oe=new Date;oe.setMinutes(oe.getMinutes()+G),oe.setDate(oe.getDate()+1),oe.setHours(0,1,0,0),oe.setMinutes(oe.getMinutes()-G),setTimeout(ae,oe-y()),M('runMidnight',(ne||' ')+' '+oe.toString())},S=function runExactMidnight(ae,ne){var oe=new Date;oe.setMinutes(oe.getMinutes()+G),oe.setDate(oe.getDate()+1),oe.setHours(0,0,0,0),oe.setMinutes(oe.getMinutes()-G),setTimeout(ae,oe-y()),M('runExactMidnight',(ne||' ')+' '+oe.toString())},F=function runTomorrow(ae,ne,oe,de){var se=new Date;se.setMinutes(se.getMinutes()+G),se.setDate(se.getDate()+1),se.setHours(ne,oe,0,0),se.setMinutes(se.getMinutes()-G),setTimeout(ae,se-y()),M('runTomorrow',(de||' ')+' '+se.toString())},U=new BilibiliToken,k='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',w=function(){var ae=_asyncToGenerator(regeneratorRuntime.mark(function ne(){return regeneratorRuntime.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(!(ee.time>x())){de.next=4;break}J=ee,de.next=10;break;case 4:return de.next=6,U.getToken();case 6:ee=de.sent,ee.time=x()+ee.expires_in,localStorage.setItem(O+'_Token',JSON.stringify(ee)),J=ee;case 10:;return M(O+'_Token',ee),de.abrupt('return','OK');case 13:case'end':return de.stop();}},ne,E)}));return function setToken(){return ae.apply(this,arguments)}}(),H={init:function init(){return H.Toast.init().then(function(){})},Toast:{init:function init(){try{var ae=[];return window.toast=function(ne){var oe=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',de=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(oe){case'success':case'info':break;case'caution':break;case'error':break;default:oe='info';}var se=$('<div class="link-toast '+oe+' fixed"><span class="toast-text">'+ne+'</span></div>')[0];document.body.appendChild(se),se.style.top=document.body.scrollTop+40*ae.length+10+'px',se.style.left=document.body.offsetWidth+document.body.scrollLeft-se.offsetWidth-5+'px','hide'==B&&$('.link-toast').hide(),ae.push(se),setTimeout(function(){se.className+=' out',setTimeout(function(){ae.shift(),ae.forEach(function(le){le.style.top=parseInt(le.style.top,10)-40+'px'}),$(se).remove()},200)},de)},$.Deferred().resolve()}catch(ae){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',ae),$.Deferred().reject()}}}},P=function addStyle(){$('head').append('\n            <style>\n                .igiftMsg_input{\n                    outline: none;\n                    border: 1px solid #e9eaec;\n                    background-color: #fff;\n                    border-radius: 4px;\n                    padding: 1px 0 0;\n                    overflow: hidden;\n                    font-size: 12px;\n                    line-height: 19px;\n                    width: 30px;\n                    z-index: \'10001\';\n                }\n                .igiftMsg_btn{\n                    background-color: #23ade5;\n                    color: #fff;\n                    border-radius: 4px;\n                    border: none;\n                    padding: 5px;\n                    cursor: pointer;\n                    box-shadow: 0 0 2px #00000075;\n                    line-height: 10px;\n                    z-index: 10001;\n                }\n                .igiftMsg_fs{\n                    border: 2px solid #d4d4d4;\n                    z-index: 10001;\n                }\n            </style>\n            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sentsin/layer@v3.1.1/dist/theme/default/layer.css" id="layuicss-layer">\n                ')},B=localStorage.getItem(O+'_msgHide')||'hide',Y=0,V=0,X=0,K=!1,Q=!1,z=!1,q=!0,Z={room_id:void 0,uid:void 0,ruid:void 0,tid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},J=void 0,ee=JSON.parse(localStorage.getItem(O+'_Token'))||{};function o(){var ne,ae=this,oe={CONFIG_DEFAULT:{AUTO_DANMU:!1,AUTO_GIFT:!1,AUTO_GIFT_ROOMID:['0'],AUTO_GROUP_SIGN:!0,CHECK_HOUR_ROOM:!1,CHECK_HOUR_ROOM_INTERVAL:600,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,DANMU_CONTENT:['\u8FD9\u662F\u4E00\u6761\u5F39\u5E55'],DANMU_ROOMID:['22474988'],DANMU_INTERVAL_TIME:['10m'],EXCLUDE_ROOMID:['0'],FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_SEND_TIME',GIFT_SORT:'high',IN_TIME_RELOAD_DISABLE:!1,LOTTERY:!0,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!0,LIGHT_MEDALS:['0'],LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,NOSLEEP:!0,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_activity:!1,REMOVE_ELEMENT_rank:!0,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:!1,TIME_RELOAD_MINUTE:120,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_SEND_DANMU_TS:[],AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{C.setCommonArgs(Z.bili_jct)}catch(se){return void console.error('['+O+']',se)}var de=$.Deferred();try{oe.loadConfig().then(function(){oe.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),de.resolve()})}catch(se){console.error('API\u521D\u59CB\u5316\u51FA\u9519',se),oe.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),de.reject()}try{oe.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),de.resolve()})}catch(se){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',se),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),de.reject()}return de},loadConfig:function loadConfig(){var de=$.Deferred();try{var se=JSON.parse(localStorage.getItem(O+'_CONFIG'));for(var le in $.extend(!0,oe.CONFIG,oe.CONFIG_DEFAULT),oe.CONFIG)oe.CONFIG.hasOwnProperty(le)&&void 0!==se[le]&&null!==se[le]&&(oe.CONFIG[le]=se[le]);oe.loadGiftCount(),de.resolve()}catch(se){M('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',se),oe.setDefaults(),de.reject()}return de},loadCache:function loadCache(){var de=$.Deferred();try{var se=JSON.parse(localStorage.getItem(O+'_CACHE'));for(var le in $.extend(!0,oe.CACHE,oe.CACHE_DEFAULT),oe.CACHE)oe.CACHE.hasOwnProperty(le)&&void 0!==se[le]&&null!==se[le]&&(oe.CACHE[le]=se[le]);de.resolve()}catch(se){M('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',se),oe.setDefaults(),de.reject()}return de},newMessage:function newMessage(de){try{var se=localStorage.getItem(O+'_NEWMSG_CACHE');if((se==void 0||null==se||'4.4.1'!=se)&&'4.4.1'==de){var le=function linkMsg(_e,ge){return'<a href="'+ge+'"target="_blank">'+_e+'</a>'};layer.open({title:de+'\u66F4\u65B0\u63D0\u793A',content:'<strong>1.\u65B0\u589E\u81EA\u52A8\u53D1\u5B9A\u65F6\u5F39\u5E55\u529F\u80FD</strong><br>\n                            '+le('\u4F7F\u7528\u524D\u5EFA\u8BAE\u5148\u770B\u4E0B\u8BF4\u660E(\u70B9\u6211\u524D\u5F80\u5BF9\u5E94\u8BF4\u660E\u5904)','https://github.com/andywang425/BLTH/blob/master/README.md#\u5F39\u5E55\u8BBE\u7F6E')+'<br>\n                            2.\u8C03\u6574\u4E86\u5F39\u5E55\u8BBE\u7F6E-\u53D1\u9001\u65F6\u95F4\u7684\u586B\u5199\u65B9\u6CD5\u3002<br>\n                            3.\u4FEE\u590D\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694\u65F6\u95F4\u65E0\u6CD5\u4FEE\u6539\u7684bug\u3002<br>\n                            4.\u5220\u9664\u4E86\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\u7684\u529F\u80FD\u3002<br>\n                            <hr>\n                            <em style="color:grey;">\n                            \u5982\u679C\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u9047\u5230\u95EE\u9898\uFF0C\u6B22\u8FCE\u53BB'+le('github','https://github.com/andywang425/BLTH/issues')+'\n                            \uFF08\u6216\u8005\u8FDBqq\u7FA4'+le('1106094437','https://jq.qq.com/?_wv=1027&amp;k=fCSfWf1O')+'\uFF09\u53CD\u9988\u3002\n                            </em>'}),localStorage.setItem(O+'_NEWMSG_CACHE',de)}}catch(se){M('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u5931\u8D25',se)}},saveConfig:function saveConfig(){try{return localStorage.setItem(O+'_CONFIG',JSON.stringify(oe.CONFIG)),oe.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),M('MY_API.CONFIG',oe.CONFIG),!0}catch(de){return M('API\u4FDD\u5B58\u51FA\u9519',de),!1}},saveCache:function saveCache(){var de=0<arguments.length&&arguments[0]!==void 0?arguments[0]:!0;try{return localStorage.setItem(O+'_CACHE',JSON.stringify(oe.CACHE)),de&&M('CACHE\u5DF2\u4FDD\u5B58',oe.CACHE),!0}catch(se){return M('CACHE\u4FDD\u5B58\u51FA\u9519',se),!1}},setDefaults:function setDefaults(){oe.CONFIG=oe.CONFIG_DEFAULT,oe.CACHE=oe.CACHE_DEFAULT,oe.saveConfig(),oe.saveCache(),oe.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1','info'),setTimeout(function(){oe.CACHE=oe.CACHE_DEFAULT,oe.GroupSign.run(),oe.DailyReward.run(),oe.LiveReward.run(),oe.Exchange.runS2C(),oe.Gift.run(),oe.LITTLE_HEART.run(),oe.AUTO_DANMU.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var de=JSON.parse(localStorage.getItem(O+'_GIFT_COUNT'));for(var se in oe.GIFT_COUNT)oe.GIFT_COUNT.hasOwnProperty(se)&&void 0!==de[se]&&null!==de[se]&&(oe.GIFT_COUNT[se]=de[se]);M('MY_API.GIFT_COUNT',oe.GIFT_COUNT)}catch(de){M('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',de)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(O+'_GIFT_COUNT',JSON.stringify(oe.GIFT_COUNT)),M('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',oe.GIFT_COUNT),!0}catch(de){return M('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',de),!1}},addGift:function addGift(de){oe.GIFT_COUNT.COUNT+=de,$('#giftCount span:eq(0)').text(oe.GIFT_COUNT.COUNT),oe.saveGiftCount()},addSilver:function addSilver(de){oe.GIFT_COUNT.SILVER_COUNT+=de,$('#giftCount span:eq(1)').text(oe.GIFT_COUNT.SILVER_COUNT),oe.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){for(var de=['#my-dear-haruna-vm','.activity-entry','.activity-rank'],se=['REMOVE_ELEMENT_2233','REMOVE_ELEMENT_activity','REMOVE_ELEMENT_rank'],le=function removeUntiSucceed(_e){oe.CONFIG[se[_e]]&&setInterval(function(){0<$(de[_e]).length&&$(de[_e]).remove()},200)},_e=0;_e<de.length;_e++)le(_e);oe.CONFIG.NOSLEEP&&setInterval(function(){return document.dispatchEvent(new Event('visibilitychange'))},600000)},creatSetBox:function creatSetBox(){var de=['.chat-history-list','.attention-btn-ctnr','.live-player-mounter'],se=!0,le=!1,_e=void 0;try{for(var ue,Ce,ge=de[Symbol.iterator]();!(se=(ue=ge.next()).done);se=!0)if(Ce=ue.value,0===$(Ce).length)return D(function(){return oe.creatSetBox()},200)}catch(Ce){le=!0,_e=Ce}finally{try{!se&&ge.return&&ge.return()}finally{if(le)throw _e}}var ce='hide'==B?'\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F':'\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F',pe=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">'+ce+'<br></button>'),Ie='#allsettings',fe=$('.chat-history-list'),Te,me=$('.live-player-mounter').height(),Ee=$('.live-player-mounter').offset(),Oe='"float:left"';-1<A.toLowerCase().indexOf('firefox')&&(Oe='""');var ve='\n                <div id=\'allsettings\' class = "igiftMsg_main">\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n                    <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n                        \u8FA3\u6761&nbsp;<span>'+oe.GIFT_COUNT.COUNT+'</span>\n                        \u94F6\u74DC\u5B50&nbsp;<span>'+oe.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n                    </div>\n                </fieldset>\n                <div id="left_fieldset" style='+Oe+'>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u62BD\u5956\u8BBE\u7F6E</legend>\n                    <div data-toggle="LOTTERY">\n                        <label style="margin: 5px auto; color: purple;line-height:30px";>\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u53C2\u4E0E\u62BD\u5956\n                        </label>\n                    </div>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u542F\u7528\n                                <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                                <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_GIFT">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u68C0\u67E5\u5C0F\u65F6\u699C\uFF08\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\uFF09\n                            </label>\n                        </div>\n                        <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n                        <label style="margin: 5px auto; color: red;">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n                        </label>\n                    </div>\n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs" style ="line-height:16px;">\n                        <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u767B\u9646\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u89C2\u770B\u89C6\u9891\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                            </label>\n                        </div>\n                        <div data-toggle="COIN_TYPE" style=" color: black">\n                            <div data-toggle="COIN_UID">\n                            <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                            \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                            \u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                            <div data-toggle="COIN_DYN">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5206\u4EAB\u89C6\u9891\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u76F4\u64AD\u533A\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5E94\u63F4\u56E2\u7B7E\u5230\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9001\u793C\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            \u4F18\u5148\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                            \u4E0D\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n                        <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u95F4\u9694\n                            <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                            \u5206\u949F\u9001\u793C\n                        </div>\n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u5B9A\u65F6\u9001\u793C<br>&nbsp;&nbsp;&nbsp;&nbsp;\n                            \u9001\u793C\u65F6\u95F4\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n                        </div>\n                        \n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            \u793C\u7269\u5230\u671F\u65F6\u95F4\n                            <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                            \u5929\n                        </div>\n                        <div data-toggle="GIFT_SORT_HIGH" style=" color: black;line-height: 20px;">\n                        \u7C89\u4E1D\u724C\u9001\u793C\u4F18\u5148\u7EA7<br>\n                        &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name = "GIFT_SORT">\n                            \u4F18\u5148<strong style="color: purple">\u9AD8</strong>\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="GIFT_SORT_LOW" style=" color: black">\n                        &nbsp;&nbsp;&nbsp;&nbsp;<input style="vertical-align: text-top;" type="radio" name = "GIFT_SORT">\n                        \u4F18\u5148<strong style="color: purple">\u4F4E</strong>\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style="color: #ff5200;line-height:15px;">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u65E0\u89C6\u793C\u7269\u7C7B\u578B\u548C\u5230\u671F\u65F6\u95F4\u9650\u5236\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style="color: black;line-height:20px;">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            \u6BEB\u79D2\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style='+Oe+'>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8D2D\u4E70\u7C89\u4E1D\u52CB\u7AE0</legend>\n                        <div data-toggle="BUY_MEDAL" style="color: black; line-height: 15px">\n                        \u8F93\u5165\u7C89\u4E1D\u52CB\u7AE0\u5BF9\u5E94\u623F\u95F4\u53F7\uFF1A<input class="num igiftMsg_input" type="text" value = '+Z.room_id+' onclick="select();" style="width: 70px">\n                        <button  class="igiftMsg_btn" data-action="buy_medal">\u70B9\u51FB\u8D2D\u4E70\u52CB\u7AE0</button>\n                        \uFF08\u82B1\u8D3920\u786C\u5E01\uFF09\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n                        <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                            </label>\n                        </div>\n                        <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                            \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n                        <input class="num igiftMsg_input" style="width: 300px;" type="text">\n                    </div>\n                    <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n                        \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n                        <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u767D\u540D\u5355\n                        </div>\n                        <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                            &nbsp;\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u9ED1\u540D\u5355\n                        </div>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="lightMedalNow">\u7ACB\u523B\u70B9\u4EAE\u52CB\u7AE0</button>\n                    </div>\n                    <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n                    <label style="margin: 5px auto; color: black">\n                        <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n                    </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n                        <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u79FB\u96642233\u6A21\u578B\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_activity" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u79FB\u9664\u6D3B\u52A8\u5165\u53E3\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_rank" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u79FB\u9664\u6392\u884C\u699C\n                        </label>\n                    </div>\n                        <div data-toggle="NOSLEEP">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5C4F\u853D\u6302\u673A\u68C0\u6D4B\n                        </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 25px">\n                        <legend style="color: black">\u5F39\u5E55\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_DANMU">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u53D1\u5F39\u5E55<br>\n                            \u5F39\u5E55\u5185\u5BB9\n                            <input class="Danmu igiftMsg_input" style="width: 330px;" type="text"><br>\n                            \u623F\u95F4\u53F7\n                            <input class="Roomid igiftMsg_input" style="width: 330px;" type="text"><br>\n                            \u53D1\u9001\u65F6\u95F4\n                            <input class="Time igiftMsg_input" style="width: 330px;" type="text">\n                        </div>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="sendDanmuNow">\u7ACB\u523B\u53D1\u9001\u5F39\u5E55</button>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="clearDanmuCache">\u6E05\u9664\u5F39\u5E55\u7F13\u5B58</button>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 15px">\n                        <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n                        <div data-toggle="TIME_RELOAD" style="color: black">\n                        <input style="vertical-align: text-top;" type="checkbox">\n                            \u6BCF\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\n                            \u5206\u949F\u5237\u65B0\u4E00\u6B21\u9875\u9762\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\n                                \u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u5237\u65B0\u76F4\u64AD\u95F4\n                            </label>\n                        </div>\n            \n                        <div id="resetArea">\n                            <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                            <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1</button>\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n                        </div>\n            \n                    </fieldset>\n                    <label style="color: darkblue; font-size:large;">\n                         <a href="https://github.com/andywang425/BLTH"\n                            target="_blank">v'+GM_info.script.version+'&nbsp;\u66F4\u591A\u4FE1\u606F\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n                    </label>\n                </div>\n            </div>\n    ',Ne=function getScrollPosition(){var Ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:window;return{x:Ce.pageXOffset===void 0?Ce.scrollLeft:Ce.pageXOffset,y:Ce.pageYOffset===void 0?Ce.scrollTop:Ce.pageYOffset}},he=function openMainWindow(){Te=layer.open({type:1,title:!1,offset:[Ee.top-Ne().y+''+'px',Ee.left+''+'px'],closeBtn:0,shade:0,zIndex:9999,fixed:!1,area:[,me+''+'px'],content:ve,success:function success(){function Ce(){var Le,Se,Fe=parseInt($(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),Ue=parseInt($(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),ke=parseInt($(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),we=parseInt($(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(24<=Fe||24<=Ue||60<=ke||60<=we||0>Fe||0>Ue||0>ke||0>we)return void oe.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(oe.CONFIG.TIME_AREA_START_H0UR=Fe,oe.CONFIG.TIME_AREA_END_H0UR=Ue,oe.CONFIG.TIME_AREA_START_MINUTE=ke,oe.CONFIG.TIME_AREA_END_MINUTE=we,Le=parseFloat($(Ie).find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>Le||100<Le)return void oe.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(oe.CONFIG.RANDOM_SKIP=Le,Le=parseFloat($(Ie).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<Le)return void oe.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>Le)return void oe.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(oe.CONFIG.RANDOM_SEND_DANMU=Le,Le=parseInt($(Ie).find('div[data-toggle="MAX_GIFT"] .num').val()),oe.CONFIG.MAX_GIFT=Le,Le=parseInt($(Ie).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=Le||1e4<Le)return void oe.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(oe.CONFIG.TIME_RELOAD_MINUTE=Le,Le=parseFloat($(Ie).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),Ue=parseFloat($(Ie).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>Le||100<Ue)return void oe.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Ue<=Le)return void oe.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(oe.CONFIG.RND_DELAY_START=Le,oe.CONFIG.RND_DELAY_END=Ue,Le=parseInt($(Ie).find('div[data-toggle="COIN"] .coin_number').val()),0>Le||5<Le)return void oe.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(oe.CONFIG.COIN_NUMBER=Le,Le=parseInt($(Ie).find('div[data-toggle="CHECK_HOUR_ROOM"] .num').val()),0>=Le)return void oe.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');oe.CONFIG.CHECK_HOUR_ROOM_INTERVAL=Le,Le=$(Ie).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),Se=Le.split(',');for(var He=0;He<Se.length;He++)''===Se[He]&&(Se[He]=22474988);oe.CONFIG.AUTO_GIFT_ROOMID=Se,Le=$(Ie).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),Se=Le.split(',');for(var He=0;He<Se.length;He++)''===Se[He]&&(Se[He]=0);if(oe.CONFIG.EXCLUDE_ROOMID=Se,Le=parseInt($(Ie).find('div[data-toggle="GIFT_LIMIT"] .num').val()),oe.CONFIG.GIFT_LIMIT=Le,Fe=parseInt($(Ie).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),Ue=parseInt($(Ie).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>Fe||0>Ue)return void oe.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=Fe||60<=Ue)return void oe.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning');oe.CONFIG.GIFT_SEND_HOUR=Fe,oe.CONFIG.GIFT_SEND_MINUTE=Ue,Le=$(Ie).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),oe.CONFIG.SPARE_GIFT_ROOM=Le,Le=parseInt($(Ie).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),oe.CONFIG.STORM_QUEUE_SIZE=Le,Le=parseInt($(Ie).find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),oe.CONFIG.STORM_MAX_COUNT=Le,Le=parseInt($(Ie).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),oe.CONFIG.STORM_ONE_LIMIT=Le,Le=parseInt($(Ie).find('div[data-toggle="COIN_UID"] .num').val()),oe.CONFIG.COIN_UID=Le,Le=$(Ie).find('div[data-toggle="LIGHT_MEDALS"] .num').val(),Se=Le.split(',');for(var He=0;He<Se.length;He++)''===Se[He]&&(Se[He]=0);oe.CONFIG.LIGHT_MEDALS=Se,Le=parseInt($(Ie).find('div[data-toggle="MAX_TAB"] .num').val()),oe.CONFIG.MAX_TAB=Le,Fe=$(Ie).find('div[data-toggle="AUTO_DANMU"] .Danmu').val(),Se=Fe.split(',');for(var He=0;He<Se.length;He++)''===Se[He]&&(Se[He]='\u8FD9\u662F\u4E00\u6761\u5F39\u5E55');Fe=Se,Ue=$(Ie).find('div[data-toggle="AUTO_DANMU"] .Roomid').val(),Se=Ue.split(',');for(var He=0;He<Se.length;He++)''===Se[He]&&(Se[He]='22474988');Ue=Se,ke=$(Ie).find('div[data-toggle="AUTO_DANMU"] .Time').val(),Se=ke.split(',');for(var He=0;He<Se.length;He++)''===Se[He]&&(Se[He]='10m');ke=Se,oe.CONFIG.DANMU_CONTENT=Fe,oe.CONFIG.DANMU_ROOMID=Ue,oe.CONFIG.DANMU_INTERVAL_TIME=ke,oe.saveConfig()}function Ae(Le){return C.live_user.get_anchor_in_room(Le).then(function(Se){M('API.live_user.get_anchor_in_room response',Se),0!==Se.code||!Se.data.info?0===Se.code&&Se.data.info===void 0?layer.msg('\u623F\u95F4\u4E0D\u5B58\u5728',{time:2500}):layer.msg('\u68C0\u67E5\u623F\u95F4\u51FA\u9519 '+Se.message,{time:2500}):layer.confirm('\u662F\u5426\u6D88\u801720\u786C\u5E01\u8D2D\u4E70UP\u4E3B\u3010'+Se.data.info.uname+'\u3011\u7684\u7C89\u4E1D\u52CB\u7AE0\uFF1F',{title:'\u8D2D\u4E70\u52CB\u7AE0',btn:['\u662F','\u5426']},function(){return C.link_group.buy_medal(Se.data.info.uid).then(function(Fe){M('API.link_group.buy_medal re',Fe),0===Fe.code?layer.msg('\u8D2D\u4E70\u6210\u529F',{time:2e3,icon:1}):layer.msg('\u8D2D\u4E70\u5931\u8D25 '+Fe.message,{time:2500,icon:2})})},function(){layer.msg('\u5DF2\u53D6\u6D88\u8D2D\u4E70',{time:2e3})})})}$(Ie).find('div[data-toggle="AUTO_DANMU"] .Time').val(oe.CONFIG.DANMU_INTERVAL_TIME.toString()),$(Ie).find('div[data-toggle="AUTO_DANMU"] .Roomid').val(oe.CONFIG.DANMU_ROOMID.toString()),$(Ie).find('div[data-toggle="AUTO_DANMU"] .Danmu').val(oe.CONFIG.DANMU_CONTENT.toString()),$(Ie).find('div[data-toggle="MAX_TAB"] .num').val(parseInt(oe.CONFIG.MAX_TAB).toString()),$(Ie).find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(oe.CONFIG.GIFT_INTERVAL).toString()),$(Ie).find('div[data-toggle="LIGHT_MEDALS"] .num').val(oe.CONFIG.LIGHT_MEDALS.toString()),$(Ie).find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(oe.CONFIG.STORM_MAX_COUNT).toString()),$(Ie).find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(oe.CONFIG.STORM_ONE_LIMIT).toString()),$(Ie).find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(oe.CONFIG.STORM_QUEUE_SIZE).toString()),$(Ie).find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(oe.CONFIG.SPARE_GIFT_ROOM.toString()),$(Ie).find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(oe.CONFIG.TIME_RELOAD_MINUTE).toString()),$(Ie).find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(oe.CONFIG.RANDOM_SKIP).toString()),$(Ie).find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(oe.CONFIG.RANDOM_SEND_DANMU).toString()),$(Ie).find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(oe.CONFIG.MAX_GIFT).toString()),$(Ie).find('div[data-toggle="COIN"] .coin_number').val(parseInt(oe.CONFIG.COIN_NUMBER).toString()),$(Ie).find('div[data-toggle="COIN_UID"] .num').val(parseInt(oe.CONFIG.COIN_UID).toString()),$(Ie).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(oe.CONFIG.RND_DELAY_START).toString()),$(Ie).find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(oe.CONFIG.RND_DELAY_END).toString()),$(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(oe.CONFIG.TIME_AREA_START_H0UR).toString()),$(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(oe.CONFIG.TIME_AREA_END_H0UR).toString()),$(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(oe.CONFIG.TIME_AREA_START_MINUTE).toString()),$(Ie).find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(oe.CONFIG.TIME_AREA_END_MINUTE).toString()),$(Ie).find('div[data-toggle="CHECK_HOUR_ROOM"] .num').val(parseInt(oe.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),$(Ie).find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(oe.CONFIG.AUTO_GIFT_ROOMID.toString()),$(Ie).find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(oe.CONFIG.EXCLUDE_ROOMID.toString()),$(Ie).find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(oe.CONFIG.GIFT_SEND_HOUR.toString()),$(Ie).find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(oe.CONFIG.GIFT_SEND_MINUTE.toString()),$(Ie).find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(oe.CONFIG.GIFT_LIMIT).toString());$(Ie).find('div[id="giftCount"] [data-action="save"]').click(function(){Ce()}),$(Ie).find('div[data-toggle="BUY_MEDAL"] [data-action="buy_medal"]').click(function(){var Le=parseInt($(Ie).find('div[data-toggle="BUY_MEDAL"] .num').val());Ae(Le)}),$(Ie).find('button[data-action="reset"]').click(function(){oe.setDefaults()}),$(Ie).find('button[data-action="checkUpdate"]').click(function(){oe.checkUpdate()}),$(Ie).find('button[data-action="redo_dailyTasks"]').click(function(){oe.ReDoDailyTasks()}),$(Ie).find('#resetArea [data-action="countReset"]').click(function(){oe.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},oe.saveGiftCount(),$('#giftCount span:eq(0)').text(oe.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(oe.GIFT_COUNT.SILVER_COUNT),oe.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),$(Ie).find('button[data-action="sendGiftNow"]').click(function(){K=!0,oe.Gift.run()}),$(Ie).find('button[data-action="lightMedalNow"]').click(function(){z=!0,oe.Gift.run()}),$(Ie).find('button[data-action="sendDanmuNow"]').click(function(){Q=!0,oe.AUTO_DANMU.run()}),$(Ie).find('button[data-action="clearDanmuCache"]').click(function(){oe.CACHE.AUTO_SEND_DANMU_TS=[],oe.saveCache()&&oe.chatLog('\u6E05\u9664\u5F39\u5E55\u7F13\u5B58\u6210\u529F','success')});var Ge=['AUTO_DANMU','RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','TIME_RELOAD','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','SEND_ALL_GIFT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_activity','REMOVE_ELEMENT_rank','FORCE_LIGHT','LOTTERY','CHECK_HOUR_ROOM','NOSLEEP'],ye=!0,xe=!1,Re=void 0;try{for(var be,De=function _loop(){var Le=be.value,Se=$(Ie).find('div[data-toggle="'+Le+'"] input:checkbox');oe.CONFIG[Le]&&Se.attr('checked',''),Se.change(function(){oe.CONFIG[Le]=$(this).prop('checked'),oe.saveConfig()})},Me=Ge[Symbol.iterator]();!(ye=(be=Me.next()).done);ye=!0)De()}catch(Le){xe=!0,Re=Le}finally{try{!ye&&Me.return&&Me.return()}finally{if(xe)throw Re}}$('input:text').bind('keydown',function(Le){'13'==Le.keyCode&&Ce()}),'COIN_DYN'==oe.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==oe.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==oe.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');'high'==oe.CONFIG.GIFT_SORT?$('div[data-toggle=\'GIFT_SORT_HIGH\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SORT_LOW\'] input:radio').attr('checked',''),$('input:radio[name=\'COIN_TYPE\']').change(function(){oe.CONFIG.COIN_TYPE=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked')?'COIN_DYN':'COIN_UID',oe.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){oe.CONFIG.LIGHT_METHOD=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked')?'LIGHT_WHITE':'LIGHT_BLACK',oe.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){oe.CONFIG.GIFT_METHOD=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked')?'GIFT_INTERVAL':'GIFT_SEND_TIME',oe.saveConfig()}),$('input:radio[name=\'GIFT_SORT\']').change(function(){oe.CONFIG.GIFT_SORT=$('div[data-toggle=\'GIFT_SORT_HIGH\'] input:radio').is(':checked')?'high':'low',oe.saveConfig()})},end:function end(){B='hide',localStorage.setItem(O+'_msgHide',B),$('.igiftMsg').hide(),$('.link-toast').hide(),fe.animate({scrollTop:0},0),setTimeout(function(){fe.animate({scrollTop:fe.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'}})};pe.click(function(){q&&(q=!1,setTimeout(function(){q=!0},200),'show'==B?(B='hide',localStorage.setItem(O+'_msgHide',B),$('.igiftMsg').hide(),$('.link-toast').hide(),layer.close(Te),fe.animate({scrollTop:0},0),setTimeout(function(){fe.animate({scrollTop:fe.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'):(B='show',localStorage.setItem(O+'_msgHide',B),$('.igiftMsg').show(),$('.link-toast').show(),he(),fe.animate({scrollTop:fe.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u63D0\u793A\u4FE1\u606F'))}),$('.attention-btn-ctnr').append(pe),oe.CACHE.DailyReward_TS||layer.tips('\u70B9\u6211\u9690\u85CF/\u663E\u793A\u63A7\u5236\u9762\u677F','#hiderbtn',{tips:1}),'show'==B&&he()},chatLog:function chatLog(de){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',le=$('<div class=\'igiftMsg\'>'),_e=$('<div>'),ge=$('#chat-history-list'),ue=new Date;_e.text(de),le.text(ue.toLocaleString()),le.append(_e),le.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),_e.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===se?le.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===se?le.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===se?le.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):le.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});'show'==B?ge.find('#chat-items').append(le):ge.find('#chat-items').append(le.hide()),ge.scrollTop(ge.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(de,se){var le=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';C.room.getConf(de).then(function(_e){M('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+le,_e);var ge=new C.DanmuWebSocket(se,de,_e.data.host_server_list,_e.data.token);ge.bind(function(ue){ge=ue,oe.chatLog(le+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){oe.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+de+' \u5206\u533A: '+le,'success')},function(){(oe.blocked||oe.stormBlack)&&(ge.close(),oe.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+le,'warning')),oe.max_blocked&&!oe.CONFIG.STORM&&(ge.close(),oe.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+le,'warning'))},function(ue){if(!(c(oe.CONFIG.TIME_AREA_START_H0UR,oe.CONFIG.TIME_AREA_END_H0UR,oe.CONFIG.TIME_AREA_START_MINUTE,oe.CONFIG.TIME_AREA_END_MINUTE)&&oe.CONFIG.TIME_AREA_DISABLE))switch(M('\u5F39\u5E55\u516C\u544A'+le,ue),ue.cmd){case'GUARD_MSG':ue.roomid===ue.real_roomid?oe.checkRoom(ue.roomid,le):(oe.checkRoom(ue.roomid,le),oe.checkRoom(ue.real_roomid,le));break;case'PK_BATTLE_SETTLE_USER':ue.data.winner?oe.checkRoom(ue.data.winner.room_id,le):oe.checkRoom(ue.data.my_info.room_id,le),oe.checkRoom(ue.data.winner.room_id,le);break;case'NOTICE_MSG':switch(ue.msg_type){case 1:break;case 2:case 3:case 4:case 8:ue.roomid===ue.real_roomid?oe.checkRoom(ue.roomid,le):(oe.checkRoom(ue.roomid,le),oe.checkRoom(ue.real_roomid,le));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+ue.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),oe.Storm.run(ue.roomid);}break;case'SPECIAL_GIFT':if(ue.data[39])switch(ue.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+ue.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),oe.Storm.run(ue.roomid);case'end':};break;default:}})},function(){oe.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(de){var se=[];try{var le=JSON.parse(localStorage.getItem(O+'_EntryRoom_list'));se=[].concat(le.list),se.push(de),100<se.length&&se.splice(0,50),localStorage.setItem(O+'_EntryRoom_list',JSON.stringify({list:se})),M(O+'_EntryRoom_list_add',se)}catch(le){se.push(de),localStorage.setItem(O+'_EntryRoom_list',JSON.stringify({list:se}))}},isIn:function isIn(de){var se=[];try{var le=JSON.parse(localStorage.getItem(O+'_EntryRoom_list'));return se=null===le?[]:[].concat(le.list),M(O+'_EntryRoom_list_read',le),-1<se.indexOf(de)}catch(le){return localStorage.setItem(O+'_EntryRoom_list',JSON.stringify({list:se})),M('\u8BFB\u53D6'+(O+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<se.indexOf(de)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(de){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';oe.blocked||oe.max_blocked||0<=oe.RoomId_list.indexOf(de)||(oe.RoomId_list.push(de),oe.EntryRoom_list_history.isIn(de)||(C.room.room_entry_action(de),oe.EntryRoom_list_history.add(de)),f(oe.CONFIG.RANDOM_SEND_DANMU)&&C.sendLiveDanmu(oe.auto_danmu_list[_Mathfloor(12*Math.random())],de).then(function(le){M('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',le)}),C.xlive.lottery.check(de).then(function(le){oe.RoomId_list.remove(de),M('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',le);var _e=le.data;if(0===le.code){var ge;if(_e.gift)for(var ue in ge=_e.gift,ge)ge.hasOwnProperty(ue)&&oe.creat_join(de,ge[ue],'gift',se);if(_e.guard)for(var ue in ge=_e.guard,ge)ge.hasOwnProperty(ue)&&oe.creat_join(de,ge[ue],'guard',se);if(_e.pk)for(var ue in ge=_e.pk,ge)ge.hasOwnProperty(ue)&&oe.creat_join(de,ge[ue],'pk',se)}else oe.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<oe.err_roomId.indexOf(de)?M('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+de+le.message):(oe.err_roomId.push(de),oe.checkRoom(de,se),M('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+de+le.message))}))},Id_list_history:{add:function add(de,se){var le=[];try{var _e=JSON.parse(localStorage.getItem(O+'_'+se+'Id_list'));le=[].concat(_e.list),le.push(de),200<le.length&&le.splice(0,50),localStorage.setItem(O+'_'+se+'Id_list',JSON.stringify({list:le})),M(O+'_'+se+'Id_list_add',le)}catch(_e){le.push(de),localStorage.setItem(O+'_'+se+'Id_list',JSON.stringify({list:le}))}},isIn:function isIn(de,se){var le=[];try{var _e=JSON.parse(localStorage.getItem(O+'_'+se+'Id_list'));return le=null===_e?[]:[].concat(_e.list),M(O+'_'+se+'Id_list_read',_e),-1<le.indexOf(de)}catch(_e){return localStorage.setItem(O+'_'+se+'Id_list',JSON.stringify({list:le})),M('\u8BFB\u53D6'+(O+'_'+se+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<le.indexOf(de)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(de,se,le){var _e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(M('\u793C\u7269\u4FE1\u606F',se),oe.GIFT_COUNT.COUNT>=oe.CONFIG.MAX_GIFT)return M('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(oe.max_blocked=!0);switch(le){case'gift':if(oe.Id_list_history.isIn(se.raffleId,'raffle'))return void M('\u793C\u7269\u91CD\u590D','raffleId '+se.raffleId);oe.raffleId_list.push(se.raffleId),oe.Id_list_history.add(se.raffleId,'raffle');break;case'guard':if(oe.Id_list_history.isIn(se.id,'guard'))return void M('\u8230\u957F\u91CD\u590D','id '+se.id);oe.guardId_list.push(se.id),oe.Id_list_history.add(se.id,'guard');break;case'pk':if(oe.Id_list_history.isIn(se.id,'pk'))return void M('pk\u91CD\u590D','id '+se.id);oe.pkId_list.push(se.id),oe.Id_list_history.add(se.id,'pk');}var ge=se.time_wait||0;oe.CONFIG.RANDOM_DELAY&&(ge+=_Mathfloor(Math.random()*(oe.CONFIG.RND_DELAY_END-oe.CONFIG.RND_DELAY_START+1))+oe.CONFIG.RND_DELAY_START);var ue=$('<div class=\'igiftMsg\'>'),ce=$('<div>'),pe=$('<div>'),Ie=$('#chat-history-list'),fe=new Date;ce.text('['+_e+']'+se.thank_text.split('<%')[1].split('%>')[0]+se.thank_text.split('%>')[1]),ue.text(fe.toLocaleString()),ue.append(ce),pe.css('color','red'),pe.text('\u7B49\u5F85\u62BD\u5956'),ce.append(pe),ue.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),ce.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),ue.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),'show'==B?Ie.find('#chat-items').append(ue):Ie.find('#chat-items').append(ue.hide()),Ie.scrollTop(Ie.prop('scrollHeight'));var Te=setInterval(function(){pe.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+ge+'\u79D2'),0>=ge&&(f(oe.CONFIG.RANDOM_SKIP)?pe.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(pe.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===le?oe.gift_join(de,se.raffleId,se.type).then(function(me,Ee){pe.text(me),Ee&&(-1<me.indexOf('\u8FA3\u6761')?oe.addGift(Ee):-1<me.indexOf('\u94F6\u74DC\u5B50')&&oe.addSilver(Ee)),oe.raffleId_list.remove(se.raffleId)}):'guard'===le?oe.guard_join(de,se.id).then(function(me,Ee){pe.text(me),Ee&&(-1<me.indexOf('\u8FA3\u6761')?oe.addGift(Ee):-1<me.indexOf('\u94F6\u74DC\u5B50')&&oe.addSilver(Ee)),oe.guardId_list.remove(se.id)}):'pk'===le?oe.pk_join(de,se.id).then(function(me,Ee){pe.text(me),Ee&&(-1<me.indexOf('\u8FA3\u6761')?oe.addGift(Ee):-1<me.indexOf('\u94F6\u74DC\u5B50')&&oe.addSilver(Ee)),oe.pkId_list.remove(se.id)}):void 0),pe.css('color','green'),clearInterval(Te)),ge--},1e3)},gift_join:function gift_join(de,se,le){var _e=$.Deferred();return C.Lottery.Gift.join(de,se,le).then(function(ge){switch(M('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',ge),ge.code){case 0:ge.data.award_text?_e.resolve(ge.data.award_text,ge.data.award_num):_e.resolve(ge.data.award_name+'X'+ge.data.award_num.toString(),ge.data.award_num);break;default:-1<ge.msg.indexOf('\u62D2\u7EDD')?!1==oe.CONFIG.FORCE_LOTTERY?(oe.blocked=!0,_e.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++Y?oe.gift_join(de,se,le):(Y=0,_e.resolve('[\u793C\u7269\u62BD\u5956](roomid='+de+',id='+se+',type='+le+')'+ge.msg)):_e.resolve('[\u793C\u7269\u62BD\u5956](roomid='+de+',id='+se+',type='+le+')'+ge.msg);}}),_e},guard_join:function guard_join(de,se){var le=$.Deferred();return C.Lottery.Guard.join(de,se).then(function(_e){switch(M('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',_e),_e.code){case 0:_e.data.award_text?le.resolve(_e.data.award_text,_e.data.award_num):le.resolve(_e.data.award_name+'X'+_e.data.award_num.toString(),_e.data.award_num);break;default:-1<_e.msg.indexOf('\u62D2\u7EDD')?!1==oe.CONFIG.FORCE_LOTTERY?(oe.blocked=!0,le.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++V?oe.guard_join(de,id):(V=0,le.resolve('[\u793C\u7269\u62BD\u5956](roomid='+de+',id='+raffleId+',type='+type+')'+_e.msg)):le.resolve('[\u4E0A\u8239](roomid='+de+',id='+se+')'+_e.msg);}}),le},pk_join:function pk_join(de,se){var le=$.Deferred();return C.Lottery.Pk.join(de,se).then(function(_e){switch(M('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',_e),_e.code){case 0:_e.data.award_text?le.resolve(_e.data.award_text,_e.data.award_num):le.resolve(_e.data.award_name+'X'+_e.data.award_num.toString(),_e.data.award_num);break;default:-1<_e.msg.indexOf('\u62D2\u7EDD')?!1==oe.CONFIG.FORCE_LOTTERY?(oe.blocked=!0,le.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++X?oe.pk_join(de,id):(X=0,le.resolve('[\u793C\u7269\u62BD\u5956](roomid='+de+',id='+raffleId+',type='+type+')'+_e.msg)):le.resolve('[PK](roomid='+de+',id='+se+')'+_e.msg);}}),le},GroupSign:{getGroups:function getGroups(){return C.Group.my_groups().then(function(de){return(M('GroupSign.getGroups: API.Group.my_groups',de),0===de.code)?$.Deferred().resolve(de.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+de.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.GroupSign.getGroups()})})},signInList:function signInList(de){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(se>=de.length)return $.Deferred().resolve();var le=de[se];return le.owner_uid==Z.uid?GroupSign.signInList(de,se+1):C.Group.sign_in(le.group_id,le.owner_uid).then(function(_e){M('GroupSign.signInList: API.Group.sign_in',_e);var ge=$.Deferred();if(0===_e.code)0<_e.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+le.group_id+',owner_uid='+le.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+_e.data.add_num,'success'),ge.resolve()):0==_e.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+le.group_id+',owner_uid='+le.owner_uid+')\u5DF2\u7B7E\u5230','caution'),ge.resolve()):ge.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+_e.msg,'caution'),$.Deferred().reject();return $.when(oe.GroupSign.signInList(de,se+1),ge)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+le.group_id+',owner_uid='+le.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.GroupSign.signInList(de,se)})})},run:function run(){try{return oe.CONFIG.AUTO_GROUP_SIGN?ie(oe.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=oe.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(oe.GroupSign.run,_(8,0)),$.Deferred().resolve()):oe.GroupSign.getGroups().then(function(de){return oe.GroupSign.signInList(de).then(function(){return oe.CACHE.AUTO_GROUP_SIGH_TS=y(),oe.saveCache(),F(oe.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return D(function(){return oe.GroupSign.run()})})},function(){return D(function(){return oe.GroupSign.run()})}):(F(oe.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(de){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+O+']',de),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return C.DailyReward.login().then(function(){M('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.DailyReward.login()})})},watch:function watch(de,se){return oe.CONFIG.WATCH?C.DailyReward.watch(de,se,Z.uid,x()).then(function(le){M('DailyReward.watch: API.DailyReward.watch',le),0===le.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+de+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+le.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.DailyReward.watch(de,se)})}):$.Deferred().resolve()},coin:function coin(de,se){var le=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,_e=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!oe.CONFIG.COIN)return $.Deferred().resolve();if(oe.DailyReward.coin_exp>=10*oe.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(le>=de.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var ge=JSON.parse(de[le].card),ue=_Mathmin(2,se);_e&&(ue=1),C.x.getCoinInfo('','jsonp',ge.aid,y()).then(function(ce){return 2===ce.data.multiply?(M('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+ge.aid),oe.DailyReward.coin(vlist,se,le+1)):C.DailyReward.coin(ge.aid,ue).then(function(pe){return(M('DailyReward.coin: API.DailyReward.coin',pe),0===pe.code)?(oe.DailyReward.coin_exp+=10*ue,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+ge.aid+',num='+ue+')','success'),oe.DailyReward.coin(de,se-ue,le+1)):-110===pe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===pe.code?_e?oe.DailyReward.coin(de,se,le+1):oe.DailyReward.coin(de,se,le,!0):34005===pe.code?oe.DailyReward.coin(de,se,le+1):-104===pe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+pe.msg,'caution'),oe.DailyReward.coin(de,se,le+1))},function(){return D(function(){return oe.DailyReward.coin(de,se,le)})})})},coin_uid:function coin_uid(de,se,le,_e){var ge=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,ue=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!oe.CONFIG.COIN)return $.Deferred().resolve();if(oe.DailyReward.coin_exp>=10*oe.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();ge>=de.length&&oe.DailyReward.UserSpace(oe.CONFIG.COIN_UID,30,0,le++,'','pubdate','jsonp');var ce=de[ge];if(1===ce.is_union_video||ce.mid!=_e)return M('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+ce.aid),oe.DailyReward.coin_uid(de,se,le,_e,ge+1);var pe=_Mathmin(2,se);ue&&(pe=1),C.x.getCoinInfo('','jsonp',ce.aid,y()).then(function(Ie){return 2===Ie.data.multiply?(M('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+ce.aid),oe.DailyReward.coin_uid(de,se,le,_e,ge+1)):C.DailyReward.coin(ce.aid,pe).then(function(fe){return(M('DailyReward.coin_uid: API.DailyReward.coin_uid',fe),0===fe.code)?(oe.DailyReward.coin_exp+=10*pe,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+ce.aid+',num='+pe+')','success'),oe.DailyReward.coin_uid(de,se-pe,le,_e,ge+1)):-110===fe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===fe.code?ue?oe.DailyReward.coin_uid(de,se,le,_e,ge+1):oe.DailyReward.coin_uid(de,se,ge,le,_e,!0):34005===fe.code?oe.DailyReward.coin_uid(de,se,le,_e,ge+1):-104===fe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+fe.msg,'caution'),oe.DailyReward.coin_uid(de,se,le,_e,ge+1))},function(){return D(function(){return oe.DailyReward.coin_uid(de,se,le,_e,ge)})})})},share:function share(de){return oe.CONFIG.SHARE?C.DailyReward.share(de).then(function(se){M('DailyReward.share: API.DailyReward.share',se),0===se.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+de+')','success'):71000===se.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+se.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.DailyReward.share(de)})}):$.Deferred().resolve()},dynamic:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le,_e;return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return le=void 0,_e=oe.CONFIG.COIN_NUMBER-oe.DailyReward.coin_exp/10,ue.next=4,C.getuserinfo().then(function(ce){return M('DailyReward.dynamic: API.getuserinfo',ce),ce.data.biliCoin<_e?ce.data.biliCoin:_e});case 4:return le=ue.sent,le<_e&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+le+'\u4E2A\u5E01','warning'),ue.abrupt('return',C.dynamic_svr.dynamic_new(Z.uid,8).then(function(ce){if(M('DailyReward.dynamic: API.dynamic_svr.dynamic_new',ce),0===ce.code){if(!!ce.data.cards){var fe,pe=JSON.parse(ce.data.cards[0].card),Ie=oe.DailyReward.watch(pe.aid,pe.cid);fe=0==oe.CONFIG.COIN_UID||'COIN_DYN'==oe.CONFIG.COIN_TYPE?oe.DailyReward.coin(ce.data.cards,_Mathmax(le,0)):oe.DailyReward.UserSpace(oe.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var Te=oe.DailyReward.share(pe.aid);return $.when(Ie,fe,Te)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+ce.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.DailyReward.dynamic()})}));case 7:case'end':return ue.stop();}},se,ae)}));return function dynamic(){return de.apply(this,arguments)}}(),UserSpace:function UserSpace(de,se,le,_e,ge,ue,ce){return C.x.getUserSpace(de,se,le,_e,ge,ue,ce).then(function(pe){if(M('DailyReward.UserSpace: API.dynamic_svr.UserSpace',pe),0===pe.code){if(!!pe.data.list.vlist){var Ie=oe.CONFIG.COIN_NUMBER-oe.DailyReward.coin_exp/10,fe=oe.DailyReward.coin_uid(pe.data.list.vlist,_Mathmax(Ie,0),_e,de);return fe}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+pe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.DailyReward.UserSpace(de,se,le,_e,ge,ue,ce)})})},run:function run(){try{return ie(oe.CACHE.DailyReward_TS)?C.DailyReward.exp().then(function(de){return M('DailyReward.run: API.DailyReward.exp',de),0===de.code?(oe.DailyReward.coin_exp=de.number,oe.DailyReward.login(),oe.DailyReward.dynamic().then(function(){oe.CACHE.DailyReward_TS=y(),oe.saveCache(),L(oe.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+de.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.DailyReward.run()})}):(L(oe.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(de){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+O+']',de),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return C.xlive.dosign().then(function(de){M('LiveReward.dailySignIn: API.xlive.dosign',de),0===de.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===de.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+de.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.LiveReward.dailySignIn()})})},run:function run(){try{if(!oe.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!ie(oe.CACHE.LiveReward_TS))return L(oe.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();oe.LiveReward.dailySignIn(),oe.CACHE.LiveReward_TS=y(),oe.saveCache(),L(oe.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(de){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+O+']',de),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return C.Exchange.silver2coin().then(function(de){M('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',de),0===de.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+de.msg,'success'):403===de.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+de.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+de.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return oe.CONFIG.SILVER2COIN?ie(oe.CACHE.Silver2Coin_TS)?oe.Exchange.silver2coin().then(function(){oe.CACHE.Silver2Coin_TS=y(),oe.saveCache(),L(oe.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return D(function(){return oe.Exchange.runS2C()})}):(L(oe.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(de){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+O+']',de),$.Deferred().reject()}}},Gift:(ne={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(ne,'run_timer',void 0),_defineProperty(ne,'sendGiftList',[1,6,30607]),_defineProperty(ne,'getMedalList',function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return 1===le&&(oe.Gift.medal_list=[]),ge.next=3,C.i.medal(le,25).then(function(ue){if(M('Gift.getMedalList: API.i.medal',ue),oe.Gift.medal_list=oe.Gift.medal_list.concat(ue.data.fansMedalList),ue.data.pageinfo.curPage<ue.data.pageinfo.totalpages)return oe.Gift.getMedalList(le+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.Gift.getMedalList()})});case 3:return ge.abrupt('return',ge.sent);case 4:case'end':return ge.stop();}},se,ae)}));return function getMedalList(){return de.apply(this,arguments)}}()),_defineProperty(ne,'getBagList',function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){return regeneratorRuntime.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return _e.next=2,C.gift.bag_list().then(function(ge){M('Gift.getBagList: API.gift.bag_list',ge),oe.Gift.bag_list=ge.data.list,oe.Gift.time=ge.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.Gift.getBagList()})});case 2:return _e.abrupt('return',_e.sent);case 3:case'end':return _e.stop();}},se,ae)}));return function getBagList(){return de.apply(this,arguments)}}()),_defineProperty(ne,'getFeedByGiftID',function getFeedByGiftID(de){if(30607===de)return 50;for(var se=Z.gift_list.length-1;0<=se;--se)if(Z.gift_list[se].id===de)return _Mathceil(Z.gift_list[se].price/100);return 0}),_defineProperty(ne,'sort_medals',function sort_medals(de){if('high'==oe.CONFIG.GIFT_SORT?de.sort(function(pe,Ie){return 0==Ie.level-pe.level?Ie.intimacy-pe.intimacy:Ie.level-pe.level}):de.sort(function(pe,Ie){return 0==pe.level-Ie.level?pe.intimacy-Ie.intimacy:pe.level-Ie.level}),oe.CONFIG.AUTO_GIFT_ROOMID&&0<oe.CONFIG.AUTO_GIFT_ROOMID.length){var pe=oe.CONFIG.AUTO_GIFT_ROOMID;pe.reverse();var se=!0,le=!1,_e=void 0;try{for(var ce,ge=function _loop2(){var Ie=ce.value,fe=de.findIndex(function(Te){return Te.roomid==Ie});if(-1!=fe){var Te=de[fe];de.splice(fe,1),de.unshift(Te)}},ue=pe[Symbol.iterator]();!(se=(ce=ue.next()).done);se=!0)ge()}catch(Ie){le=!0,_e=Ie}finally{try{!se&&ue.return&&ue.return()}finally{if(le)throw _e}}}return de}),_defineProperty(ne,'auto_light',function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(le){var _e,ge,ue,ce,pe,Ie,fe,Te,me,Ee,Oe,ve,Ne,he,Ce,Ae;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:ye.prev=0,_e=oe.Gift.getFeedByGiftID(30607),ge=oe.CONFIG.LIGHT_MEDALS,ue=void 0,ue='LIGHT_WHITE'==oe.CONFIG.LIGHT_METHOD?le.filter(function(xe){return 0==xe.is_lighted&&xe.day_limit-xe.today_feed>=_e&&0<=ge.findIndex(function(Re){return Re==xe.roomid})}):le.filter(function(xe){return 0==xe.is_lighted&&xe.day_limit-xe.today_feed>=_e&&-1==ge.findIndex(function(Re){return Re==xe.roomid})});;if(M('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',ue),!(ue&&0<ue.length)){ye.next=52;break}return ue=oe.Gift.sort_medals(ue),ye.next=11,oe.Gift.getBagList();case 11:if(ce=oe.Gift.bag_list.filter(function(xe){return 30607==xe.gift_id}),!(ce&&0<ce.length)){ye.next=52;break}pe=!0,Ie=!1,fe=void 0,ye.prev=16,Te=ue[Symbol.iterator]();case 18:if(pe=(me=Te.next()).done){ye.next=38;break}if(Ee=me.value,Oe=ce.find(function(xe){return 30607==xe.gift_id&&0<xe.gift_num}),!Oe){ye.next=34;break}if(ve=Ee.day_limit-Ee.today_feed,!(0<=ve-_e||oe.CONFIG.FORCE_LIGHT)){ye.next=33;break}return ye.next=26,C.room.room_init(parseInt(Ee.roomid,10));case 26:return Ne=ye.sent,he=parseInt(Ne.data.room_id,10),Ce=1,ye.next=31,C.gift.bag_send(Z.uid,30607,Ee.target_id,Ce,Oe.bag_id,he,Z.rnd);case 31:Ae=ye.sent,0===Ae.code?(Oe.gift_num-=Ce,Ee.today_feed+=Ce*_e,ve-=Ce*_e,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ee.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Ce+'\u4E2A'+Oe.gift_name+'\uFF0C['+Ee.today_feed+'/'+Ee.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+ve+']','success'),M('Gift.auto_light','\u52CB\u7AE0['+Ee.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Ce+'\u4E2A'+Oe.gift_name+'\uFF0C['+Ee.today_feed+'/'+Ee.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ee.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+Ae.msg+'\u3011','caution');case 33:return ye.abrupt('continue',35);case 34:return ye.abrupt('break',38);case 35:pe=!0,ye.next=18;break;case 38:ye.next=44;break;case 40:ye.prev=40,ye.t0=ye['catch'](16),Ie=!0,fe=ye.t0;case 44:ye.prev=44,ye.prev=45,!pe&&Te.return&&Te.return();case 47:if(ye.prev=47,!Ie){ye.next=50;break}throw fe;case 50:return ye.finish(47);case 51:return ye.finish(44);case 52:ye.next=58;break;case 54:ye.prev=54,ye.t1=ye['catch'](0),console.error(ye.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+ye.t1,'error');case 58:case'end':return ye.stop();}},se,ae,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return de.apply(this,arguments)}}()),_defineProperty(ne,'run',function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le,_e,ge,ue,ce,pe,Ie,fe,Te,me,Ee,Oe,ve,Ne,he,Ce;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:if(le=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.Gift.run()})},_e=function nextTimeDebug(){if('GIFT_SEND_TIME'==oe.CONFIG.GIFT_METHOD){var ye=_(oe.CONFIG.GIFT_SEND_HOUR,oe.CONFIG.GIFT_SEND_MINUTE);oe.Gift.run_timer=setTimeout(oe.Gift.run,ye);var xe=new Date(y()+ye).toLocaleString();M('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+xe+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),oe.CACHE.Gift_TS=y(),oe.saveCache()}else M('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+oe.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),oe.CACHE.GiftInterval_TS=y(),oe.saveCache()},Ge.prev=2,oe.CONFIG.AUTO_GIFT){Ge.next=5;break}return Ge.abrupt('return',$.Deferred().resolve());case 5:if(oe.Gift.run_timer&&clearTimeout(oe.Gift.run_timer),'GIFT_SEND_TIME'!=oe.CONFIG.GIFT_METHOD||u(oe.CONFIG.GIFT_SEND_HOUR,oe.CONFIG.GIFT_SEND_MINUTE)||K||z){Ge.next=14;break}return ge=_(oe.CONFIG.GIFT_SEND_HOUR,oe.CONFIG.GIFT_SEND_MINUTE),oe.Gift.run_timer=setTimeout(oe.Gift.run,ge),ue=new Date(y()+ge).toLocaleString(),M('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+ue+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ge.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=oe.CONFIG.GIFT_METHOD||K||z){Ge.next=27;break}if(ce=6e4*oe.CONFIG.GIFT_INTERVAL,!oe.CACHE.GiftInterval_TS){Ge.next=25;break}if(pe=y()-oe.CACHE.GiftInterval_TS,!(pe<ce)){Ge.next=23;break}return Ie=ce-pe,oe.Gift.run_timer=setTimeout(oe.Gift.run,Ie),M('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ie+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ge.abrupt('return');case 23:Ge.next=27;break;case 25:oe.CACHE.GiftInterval_TS=y(),oe.saveCache();case 27:return oe.Gift.over=!1,Ge.next=30,oe.Gift.getMedalList();case 30:if(fe=oe.Gift.medal_list,M('Gift.run: Gift.getMedalList().then: Gift.medal_list',fe),!(fe&&0<fe.length)){Ge.next=84;break}fe=fe.filter(function(ye){return 0<ye.day_limit-ye.today_feed&&20>ye.level}),fe=oe.Gift.sort_medals(fe),oe.CONFIG.EXCLUDE_ROOMID&&0<oe.CONFIG.EXCLUDE_ROOMID.length&&(Te=oe.CONFIG.EXCLUDE_ROOMID,fe=fe.filter(function(ye){return-1==Te.findIndex(function(xe){return xe==ye.roomid})}));;return Ge.next=39,oe.Gift.auto_light(fe);case 39:if(!z){Ge.next=42;break}return z=!1,Ge.abrupt('return',$.Deferred().resolve());case 42:me=!0,Ee=!1,Oe=void 0,Ge.prev=45,ve=fe[Symbol.iterator]();case 47:if(me=(Ne=ve.next()).done){Ge.next=70;break}if(he=Ne.value,!oe.Gift.over){Ge.next=51;break}return Ge.abrupt('break',70);case 51:return Ge.next=53,C.room.room_init(parseInt(he.roomid,10));case 53:if(Ce=Ge.sent,oe.Gift.room_id=parseInt(Ce.data.room_id,10),oe.Gift.ruid=he.target_id,oe.Gift.remain_feed=he.day_limit-he.today_feed,!(0<oe.Gift.remain_feed)){Ge.next=67;break}return Ge.next=60,oe.Gift.getBagList();case 60:if(!(0<oe.Gift.remain_feed)){Ge.next=66;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+he.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+he.today_feed+'/'+he.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+oe.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Ge.next=64,oe.Gift.sendGift(he);case 64:Ge.next=67;break;case 66:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+he.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 67:me=!0,Ge.next=47;break;case 70:Ge.next=76;break;case 72:Ge.prev=72,Ge.t0=Ge['catch'](45),Ee=!0,Oe=Ge.t0;case 76:Ge.prev=76,Ge.prev=77,!me&&ve.return&&ve.return();case 79:if(Ge.prev=79,!Ee){Ge.next=82;break}throw Oe;case 82:return Ge.finish(79);case 83:return Ge.finish(76);case 84:return Ge.next=86,oe.Gift.sendRemainGift(oe.CONFIG.SPARE_GIFT_ROOM);case 86:Ge.next=94;break;case 88:return Ge.prev=88,Ge.t1=Ge['catch'](2),le(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+O+']',Ge.t1),Ge.abrupt('return',$.Deferred().reject());case 94:return K=!1,_e(),Ge.abrupt('return',$.Deferred().resolve());case 97:case'end':return Ge.stop();}},se,ae,[[2,88],[45,72,76,84],[77,,79,83]])}));return function run(){return de.apply(this,arguments)}}()),_defineProperty(ne,'sendGift',function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(le){var _e,ge,ue,ce,pe,Ie,fe,Te,me,Ee;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.next=2,oe.Gift.getBagList();case 2:if(_e=void 0,!(0>=oe.Gift.remain_feed)){ve.next=6;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+le.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+le.today_feed+'/'+le.day_limit+']','info'),ve.abrupt('return',$.Deferred().resolve());case 6:if(0>=oe.Gift.time&&(oe.Gift.time=x()),oe.CONFIG.SEND_ALL_GIFT){ve.next=18;break}if(ge=oe.Gift.bag_list.filter(function(Ne){return oe.Gift.sendGiftList.includes(Ne.gift_id)&&0<Ne.gift_num&&Ne.corner_mark.substring(0,Ne.corner_mark.indexOf('\u5929'))<=oe.CONFIG.GIFT_LIMIT}),M('pass',ge),0!=ge.length){ve.next=15;break}return oe.Gift.over=!0,ve.abrupt('return');case 15:_e=ge;case 16:ve.next=25;break;case 18:if(ue=oe.Gift.bag_list.filter(function(Ne){return 0<Ne.gift_num&&'\u6C38\u4E45'!=Ne.corner_mark}),0!=ue.length){ve.next=24;break}return oe.Gift.over=!0,ve.abrupt('return');case 24:_e=ue;case 25:M('bag_list',_e),ce=!0,pe=!1,Ie=void 0,ve.prev=29,fe=regeneratorRuntime.mark(function(){var Ne,he,Ce;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:if(Ne=me.value,!(0>=le.day_limit-le.today_feed)){Ge.next=4;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+le.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+le.today_feed+'/'+le.day_limit+']','info'),Ge.abrupt('return',{v:void 0});case 4:if(he=oe.Gift.getFeedByGiftID(Ne.gift_id),!(0<he)){Ge.next=12;break}if(Ce=_Mathfloor(oe.Gift.remain_feed/he),Ce>Ne.gift_num&&(Ce=Ne.gift_num),!(0<Ce)){Ge.next=12;break}return M('[\u81EA\u52A8\u9001\u793C]\u9001\u51FA\u793C\u7269\u7C7B\u578B',Ne.gift_name),Ge.next=12,C.gift.bag_send(Z.uid,Ne.gift_id,oe.Gift.ruid,Ce,Ne.bag_id,oe.Gift.room_id,Z.rnd).then(function(ye){M('Gift.sendGift: API.gift.bag_send',ye),0===ye.code?(Ne.gift_num-=Ce,le.today_feed+=Ce*he,oe.Gift.remain_feed-=Ce*he,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+le.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ce+'\u4E2A'+Ne.gift_name+'\uFF0C['+le.today_feed+'/'+le.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+oe.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+le.medalName+'] \u9001\u793C\u5F02\u5E38:'+ye.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.Gift.sendGift(le)})});case 12:case'end':return Ge.stop();}},fe,ae)}),Te=_e[Symbol.iterator]();case 32:if(ce=(me=Te.next()).done){ve.next=40;break}return ve.delegateYield(fe(),'t0',34);case 34:if(Ee=ve.t0,'object'!==('undefined'==typeof Ee?'undefined':_typeof(Ee))){ve.next=37;break}return ve.abrupt('return',Ee.v);case 37:ce=!0,ve.next=32;break;case 40:ve.next=46;break;case 42:ve.prev=42,ve.t1=ve['catch'](29),pe=!0,Ie=ve.t1;case 46:ve.prev=46,ve.prev=47,!ce&&Te.return&&Te.return();case 49:if(ve.prev=49,!pe){ve.next=52;break}throw Ie;case 52:return ve.finish(49);case 53:return ve.finish(46);case 54:case'end':return ve.stop();}},se,ae,[[29,42,46,54],[47,,49,53]])}));return function sendGift(){return de.apply(this,arguments)}}()),_defineProperty(ne,'sendRemainGift',function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(le){var _e,ge,ue,ce,pe,Ie,fe,Te,me,Ee;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(0!=le){ve.next=2;break}return ve.abrupt('return',$.Deferred().resolve());case 2:return _e=void 0,ve.next=5,C.live_user.get_anchor_in_room(le).then(function(Ne){return M('API.live_user.get_anchor_in_room',Ne),Ne.data.info.uid?void(_e=Ne.data.info.uid):(window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u68C0\u67E5\u623F\u95F4\u51FA\u9519'),$.Deferred().reject())});case 5:return ve.next=7,oe.Gift.getBagList();case 7:if(ge=void 0,0>=oe.Gift.time&&(oe.Gift.time=x()),oe.CONFIG.SEND_ALL_GIFT){ve.next=19;break}if(ue=oe.Gift.bag_list.filter(function(Ne){return oe.Gift.sendGiftList.includes(Ne.gift_id)&&0<Ne.gift_num&&'1\u5929'==Ne.corner_mark}),0!=ue.length){ve.next=16;break}return oe.Gift.over=!0,ve.abrupt('return');case 16:ge=ue;case 17:ve.next=26;break;case 19:if(ce=oe.Gift.bag_list.filter(function(Ne){return 0<Ne.gift_num&&'\u6C38\u4E45'!=Ne.corner_mark}),0!=ce.length){ve.next=25;break}return oe.Gift.over=!0,ve.abrupt('return');case 25:ge=ce;case 26:M('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011bag_list',ge),pe=!0,Ie=!1,fe=void 0,ve.prev=30,Te=regeneratorRuntime.mark(function(){var Ne,he,Ce;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:if(Ne=Ee.value,he=oe.Gift.getFeedByGiftID(Ne.gift_id),!(0<he)){Ge.next=7;break}if(Ce=Ne.gift_num,!(0<Ce)){Ge.next=7;break}return Ge.next=7,C.gift.bag_send(Z.uid,Ne.gift_id,_e,Ce,Ne.bag_id,le,Z.rnd).then(function(ye){M('Gift.sendGift: API.gift.bag_send',ye),0===ye.code?(Ne.gift_num-=Ce,window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+le+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ce+'\u4E2A'+Ne.gift_name,'success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u623F\u95F4['+le+'] \u9001\u793C\u5F02\u5E38:'+ye.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u3010\u5269\u4F59\u793C\u7269\u3011\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),D(function(){return oe.Gift.sendGift(medal)})});case 7:case'end':return Ge.stop();}},Te,ae)}),me=ge[Symbol.iterator]();case 33:if(pe=(Ee=me.next()).done){ve.next=38;break}return ve.delegateYield(Te(),'t0',35);case 35:pe=!0,ve.next=33;break;case 38:ve.next=44;break;case 40:ve.prev=40,ve.t1=ve['catch'](30),Ie=!0,fe=ve.t1;case 44:ve.prev=44,ve.prev=45,!pe&&me.return&&me.return();case 47:if(ve.prev=47,!Ie){ve.next=50;break}throw fe;case 50:return ve.finish(47);case 51:return ve.finish(44);case 52:case'end':return ve.stop();}},se,ae,[[30,40,44,52],[45,,47,51]])}));return function sendRemainGift(){return de.apply(this,arguments)}}()),ne),stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(de){var se=[];try{var le=JSON.parse(localStorage.getItem(O+'stormIdSet'));se=[].concat(le.list),se.push(de),50<se.length&&se.splice(0,10),localStorage.setItem(O+'stormIdSet',JSON.stringify({list:se})),M(O+'storm_Id_list_add',se)}catch(le){se.push(de),localStorage.setItem(O+'stormIdSet',JSON.stringify({list:se}))}},isIn:function isIn(de){var se=[];try{var le=JSON.parse(localStorage.getItem(O+'stormIdSet'));return se=null===le?[]:[].concat(le.list),M(O+'storm_Id_list_read',le),-1<se.indexOf(de)}catch(le){return localStorage.setItem(O+'stormIdSet',JSON.stringify({list:se})),M('\u8BFB\u53D6'+(O+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<se.indexOf(de)}}},Storm:{check:function check(de){return-1<oe.stormQueue.indexOf(de)},append:function append(de){oe.stormQueue.push(de),oe.stormQueue.length>oe.CONFIG.STORM_QUEUE_SIZE&&oe.stormQueue.shift()},over:function over(de){var se=oe.stormQueue.indexOf(de);-1<se&&oe.stormQueue.splice(de,1)},run:function run(de){try{return oe.CONFIG.STORM?oe.stormBlack?$.Deferred().resolve():c(oe.CONFIG.TIME_AREA_START_H0UR,oe.CONFIG.TIME_AREA_END_H0UR,oe.CONFIG.TIME_AREA_START_MINUTE,oe.CONFIG.TIME_AREA_END_MINUTE)&&oe.CONFIG.TIME_AREA_DISABLE?(M('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+de),$.Deferred().resolve()):C.Storm.check(de).then(function(se){if(M('MY_API.Storm.run: MY_API.API.Storm.check',se),0===se.code){var le=se.data;return oe.Storm.join(le.id,le.roomid,_Mathround(new Date().getTime()/1e3)+le.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+de+')'+se.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+de+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(se){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+O+']',se),$.Deferred().reject()}},join:function join(de,se,le){var _e=function(){var pe=_asyncToGenerator(regeneratorRuntime.mark(function Ie(){var fe,Te;return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(Ee.prev=0,oe.Storm.check(de)){Ee.next=4;break}return clearInterval(ue),Ee.abrupt('return');case 4:if(fe=_Mathround(new Date().getTime()/1e3),!(fe>le&&0<le)){Ee.next=9;break}return oe.Storm.over(de),clearInterval(ue),Ee.abrupt('return');case 9:if(ce++,!(ce>oe.CONFIG.STORM_MAX_COUNT&&0<oe.CONFIG.STORM_MAX_COUNT)){Ee.next=15;break}return oe.Storm.over(de),clearInterval(ue),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+de+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+ce+',\u8DDD\u79BB\u5230\u671F:'+(le-fe)+'s','caution'),Ee.abrupt('return');case 15:if(Te=void 0,Ee.prev=16,!(J&&U&&ee.access_token)){Ee.next=23;break}return Ee.next=20,C.Storm.join_ex(de,se,ee.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:Te=Ee.sent,Ee.next=26;break;case 23:return Ee.next=25,C.Storm.join(de,captcha_token='',captcha_phrase='',se);case 25:Te=Ee.sent;case 26:if(M('MY_API.Storm.join: MY_API.API.Storm.join',Te),!Te.code){Ee.next=51;break}if(-1==Te.msg.indexOf('\u9886\u53D6')){Ee.next=33;break}return oe.Storm.over(de),clearInterval(ue),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+se+',id='+de+')\u6210\u529F,'+Te.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+ce,'success'),Ee.abrupt('return');case 33:if(-1==Te.msg.indexOf('\u9A8C\u8BC1\u7801')){Ee.next=39;break}return oe.Storm.over(de),clearInterval(ue),oe.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+de+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+Te.msg,'caution'),Ee.abrupt('return');case 39:if(!(Te.data&&0==Te.data.length&&-1!=Te.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){Ee.next=46;break}return oe.Storm.over(de),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+de+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(ue),oe.stormBlack=!0,setTimeout(function(){oe.stormBlack=!1},3600000),Ee.abrupt('return');case 46:if(-1!=Te.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){Ee.next=49;break}return clearInterval(ue),Ee.abrupt('return');case 49:Ee.next=56;break;case 51:return oe.Storm.over(de),Statistics.appendGift(Te.data.gift_name,Te.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+se+',id='+de+')\u6210\u529F,'+(Te.data.gift_name+'x'+Te.data.gift_num)+'\r\n'+Te.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+ce,'success'),clearInterval(ue),Ee.abrupt('return');case 56:Ee.next=65;break;case 58:return Ee.prev=58,Ee.t0=Ee['catch'](16),oe.Storm.over(de),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+de+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+ce,'error'),console.error(Ee.t0),clearInterval(ue),Ee.abrupt('return');case 65:Ee.next=74;break;case 67:return Ee.prev=67,Ee.t1=Ee['catch'](0),oe.Storm.over(de),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+de+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(Ee.t1),clearInterval(ue),Ee.abrupt('return');case 74:case'end':return Ee.stop();}},Ie,this,[[0,67],[16,58]])}));return function(){return pe.apply(this,arguments)}}();if(se=parseInt(se,10),de=parseInt(de,10),isNaN(se)||isNaN(de))return $.Deferred().reject();var ge=_Mathround(de/1e6);if(oe.stormIdSet.isIn(ge))return $.Deferred().resolve();if(oe.stormIdSet.add(ge),!oe.Storm.check(de)){oe.Storm.append(de);var ue=0;0>=le&&(le=_Mathround(new Date().getTime()/1e3)+90);var ce=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+se+',id='+de+')','success'),ue=setInterval(function(){return _e()},oe.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{getInfo:function getInfo(){return T({GM:!0,anonymous:!0,method:'GET',url:'https://passport.bilibili.com/x/passport-login/oauth2/info?'+U.signLoginQuery('access_key='+ee.access_token),responseType:'json',headers:U.headers})},mobileOnline:function mobileOnline(){return T({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+ee.access_token+'&'+k),data:'room_id='+Z.room_id+'&scale=xxhdpi',responseType:'json',headers:U.headers})},RandomHex:function RandomHex(de){var se='0123456789abcdef',le='';le+=se[_Mathfloor(15*Math.random())+1];for(var _e=0;_e<de-1;_e++)le+=se[_Mathfloor(16*Math.random())];return le},uuid:function uuid(){return oe.LITTLE_HEART.RandomHex(32).replace(/(\w{8})(\w{4})\w(\w{3})\w(\w{3})(\w{12})/,'$1-$2-4$3-'+'89ab'[_Mathfloor(4*Math.random())]+'$4-$5')},getFansMedal:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le;return regeneratorRuntime.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return ge.next=2,T({GM:!0,anonymous:!0,method:'GET',url:'https://api.live.bilibili.com/fans_medal/v1/FansMedal/get_list_in_room?'+BilibiliToken.signQuery('access_key='+ee.access_token+'&target_id='+Z.tid+'&uid='+Z.uid+'&'+k),responseType:'json',headers:U.headers});case 2:if(le=ge.sent,void 0===le||200!==le.response.status){ge.next=7;break}if(0!==le.body.code){ge.next=7;break}if(!(0<le.body.data.length)){ge.next=7;break}return ge.abrupt('return',le.body.data);case 7:case'end':return ge.stop();}},se,ae)}));return function getFansMedal(){return de.apply(this,arguments)}}(),getGiftNum:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le;return regeneratorRuntime.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return le=0,ge.next=3,C.gift.bag_list().then(function(ue){M('[\u5C0F\u5FC3\u5FC3]\u68C0\u67E5\u5305\u88F9',ue);var ce=ue.data.list.filter(function(Ee){return 30607==Ee.gift_id&&'7\u5929'==Ee.corner_mark}),pe=!0,Ie=!1,fe=void 0;try{for(var me,Ee,Te=ce[Symbol.iterator]();!(pe=(me=Te.next()).done);pe=!0)Ee=me.value,le+=Ee.gift_num}catch(Ee){Ie=!0,fe=Ee}finally{try{!pe&&Te.return&&Te.return()}finally{if(Ie)throw fe}}});case 3:return M('[\u5C0F\u5FC3\u5FC3]\u68C0\u6D4B\u5230\u5305\u88F9\u51857\u5929\u5C0F\u5FC3\u5FC3\u6570\u91CF',le),ge.abrupt('return',le);case 5:case'end':return ge.stop();}},se,ae)}));return function getGiftNum(){return de.apply(this,arguments)}}(),mobileHeartBeat:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(le){var _e,ge,ue,ce,pe,Ie;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return _e=new WasmHash,Te.next=3,_e.init();case 3:for(pe in ge=function clientSign(me){return _e.hash('BLAKE2b512',_e.hash('SHA3-384',_e.hash('SHA384',_e.hash('SHA3-512',_e.hash('SHA512',JSON.stringify(me))))))},ue=ge(le),ce='',le)ce+=pe+'='+encodeURIComponent(le[pe])+'&';return ce+='client_sign='+ue,Te.next=10,T({GM:!0,anonymous:!0,method:'POST',url:'https://live-trace.bilibili.com/xlive/data-interface/v1/heartbeat/mobileHeartBeat',data:BilibiliToken.signQuery('access_key='+ee.access_token+'&'+ce+'&'+k),responseType:'json',headers:U.headers});case 10:if(Ie=Te.sent,void 0===Ie||200!==Ie.response.status){Te.next=14;break}if(0!==Ie.body.code){Te.next=14;break}return Te.abrupt('return',!0);case 14:return Te.abrupt('return',!1);case 15:case'end':return Te.stop();}},se,ae)}));return function mobileHeartBeat(){return de.apply(this,arguments)}}(),run:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le,_e,ge,ue,ce,pe,Ie,fe,Te,me,Ee,Oe,ve,Ne,he,Ce,Ae;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(oe.CONFIG.LITTLE_HEART){ye.next=2;break}return ye.abrupt('return',$.Deferred().resolve());case 2:if(ie(oe.CACHE.LittleHeart_TS)){ye.next=5;break}return L(oe.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3'),ye.abrupt('return',$.Deferred().resolve());case 5:if(le={platform:'android',uuid:oe.LITTLE_HEART.uuid(),buvid:U.buvid,seq_id:'1',room_id:'{room_id}',parent_id:'6',area_id:'283',timestamp:'{timestamp}',secret_key:'axoaadsffcazxksectbbb',watch_time:'300',up_id:'{target_id}',up_level:'40',jump_from:'30000',gu_id:oe.LITTLE_HEART.RandomHex(43),play_type:'0',play_url:'',s_time:'0',data_behavior_id:'',data_source_id:'',up_session:'l:one:live:record:{room_id}:{last_wear_time}',visit_id:oe.LITTLE_HEART.RandomHex(32),watch_status:'%7B%22pk_id%22%3A0%2C%22screen_status%22%3A1%7D',click_id:oe.LITTLE_HEART.uuid(),session_id:'',player_type:'0',client_ts:'{client_ts}'},_e=function endFunc(){window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6','success'),clearInterval(ue),oe.CACHE.LittleHeart_TS=y(),oe.saveCache(),L(oe.LITTLE_HEART.run,'\u83B7\u53D6\u5C0F\u5FC3\u5FC3')},ye.t0=void 0===ee.access_token,!ye.t0){ye.next=14;break}return ye.next=11,w();case 11:ye.t1=ye.sent,ye.t2=void 0,ye.t0=ye.t1===ye.t2;case 14:if(!ye.t0){ye.next=18;break}return ye.abrupt('return');case 18:if(ee.access_token||ee.mid||ee.refresh_token){ye.next=45;break}return ye.next=21,oe.LITTLE_HEART.getInfo();case 21:if(ge=ye.sent,M('[\u5C0F\u5FC3\u5FC3]userInfo',ge),void 0!==ge){ye.next=25;break}return ye.abrupt('return',console.error(GM_info.script.name,'\u83B7\u53D6\u7528\u6237\u4FE1\u606F\u9519\u8BEF'));case 25:if(ye.t3=0!==ge.body.code,!ye.t3){ye.next=32;break}return ye.next=29,w();case 29:ye.t4=ye.sent,ye.t5=void 0,ye.t3=ye.t4===ye.t5;case 32:if(!ye.t3){ye.next=36;break}return ye.abrupt('return');case 36:if(ye.t6=ge.body.data.mid!==Z.uid,!ye.t6){ye.next=43;break}return ye.next=40,w();case 40:ye.t7=ye.sent,ye.t8=void 0,ye.t6=ye.t7===ye.t8;case 43:if(!ye.t6){ye.next=45;break}return ye.abrupt('return');case 45:return M('[\u5C0F\u5FC3\u5FC3]','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),oe.LITTLE_HEART.mobileOnline(),ue=setInterval(function(){return oe.LITTLE_HEART.mobileOnline()},300000),ye.next=50,oe.LITTLE_HEART.getGiftNum();case 50:if(ce=ye.sent,!(24>ce)){ye.next=102;break}return ye.next=54,oe.LITTLE_HEART.getFansMedal();case 54:if(pe=ye.sent,void 0===pe){ye.next=100;break}Ie=24-ce,fe=_Mathceil(Ie/pe.length),Te=0,me=0;case 60:if(!(me<fe)){ye.next=100;break}Ee=!0,Oe=!1,ve=void 0,ye.prev=64,Ne=pe[Symbol.iterator]();case 66:if(Ee=(he=Ne.next()).done){ye.next=77;break}if(Ce=he.value,!(Te>=Ie)){ye.next=70;break}return ye.abrupt('break',77);case 70:return Ae=Object.assign({},le,{room_id:Ce.room_id.toString(),timestamp:(BilibiliToken.TS-300).toString(),up_id:Ce.target_id.toString(),up_session:'l:one:live:record:'+Ce.room_id+':'+Ce.last_wear_time,client_ts:BilibiliToken.TS.toString()}),ye.next=73,oe.LITTLE_HEART.mobileHeartBeat(Ae);case 73:Te++;case 74:Ee=!0,ye.next=66;break;case 77:ye.next=83;break;case 79:ye.prev=79,ye.t9=ye['catch'](64),Oe=!0,ve=ye.t9;case 83:ye.prev=83,ye.prev=84,!Ee&&Ne.return&&Ne.return();case 86:if(ye.prev=86,!Oe){ye.next=89;break}throw ve;case 89:return ye.finish(86);case 90:return ye.finish(83);case 91:if(!(Te>=Ie)){ye.next=95;break}return ye.abrupt('break',100);case 95:return ye.next=97,I(300000);case 97:me++,ye.next=60;break;case 100:ye.next=103;break;case 102:_e();case 103:return ye.abrupt('return',$.Deferred().resolve());case 104:case'end':return ye.stop();}},se,ae,[[64,79,83,91],[84,,86,90]])}));return function run(){return de.apply(this,arguments)}}()},AUTO_DANMU:{setValue:function setValue(de,se){return void 0===oe.CONFIG[de][se]&&0<se?oe.AUTO_DANMU.setValue(de,se-1):oe.CONFIG[de][se]},sendDanmu:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(le,_e){return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return console.log('sendDanmu',le,_e),ue.next=3,C.sendLiveDanmu(le,_e).then(function(ce){M('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+le+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+_e+'\u3011',ce),0!==ce.code||ce.msg?window.toast('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u3010'+le+'\u3011\uFF08\u623F\u95F4\u53F7\u3010'+_e+'\u3011\uFF09\u51FA\u9519 '+ce.msg,'caution'):window.toast('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u3010'+le+'\u3011\uFF08\u623F\u95F4\u53F7\u3010'+_e+'\u3011\uFF09\u53D1\u9001\u6210\u529F','success')},function(){window.toast('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u3010'+le+'\u3011\uFF08\u623F\u95F4\u53F7\u3010'+_e+'\u3011\uFF09\u53D1\u9001\u5931\u8D25','error')});case 3:return ue.abrupt('return',ue.sent);case 4:case'end':return ue.stop();}},se,ae)}));return function sendDanmu(){return de.apply(this,arguments)}}(),getMaxLength:function getMaxLength(){var de;return de=oe.CONFIG.DANMU_CONTENT.length>=oe.CONFIG.DANMU_ROOMID.length?oe.CONFIG.DANMU_CONTENT.length:oe.CONFIG.DANMU_ROOMID.length,de<oe.CONFIG.DANMU_INTERVAL_TIME.length&&(de=oe.CONFIG.DANMU_INTERVAL_TIME.length),de},run:function(){var de=_asyncToGenerator(regeneratorRuntime.mark(function se(){var le,_e,ge;return regeneratorRuntime.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(oe.CONFIG.AUTO_DANMU){ce.next=2;break}return ce.abrupt('return',$.Deferred().resolve());case 2:le=oe.AUTO_DANMU.getMaxLength(),_e=regeneratorRuntime.mark(function(){var Ie,fe,Te,me,Ee,Oe,ve,Ne,he,Ce,Ae,Ge,ye,xe,Re,De,Me,be,Le,Se,Fe,Ue,ke,we,He,Pe,Be,Ye,je,Ve,Xe;return regeneratorRuntime.wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:Ie=oe.AUTO_DANMU.setValue('DANMU_CONTENT',pe),fe=parseInt(oe.AUTO_DANMU.setValue('DANMU_ROOMID',pe)),Te=oe.AUTO_DANMU.setValue('DANMU_INTERVAL_TIME',pe),me=void 0,Ee=oe.CACHE.AUTO_SEND_DANMU_TS,Oe=void 0,ve=void 0,Ne=void 0,he=void 0,Ce=0,-1<Te.indexOf(':')?(ve=!0,Ae=Te.split(':'),Ge=parseInt(Ae[0]),ye=parseInt(Ae[1]),xe=parseInt(Ae[2]),!u(Ge,ye,xe)&&(Ce=_(Ge,ye,xe))):(ve=!1,Te=Te.toLowerCase(),console.log('danmu_intervalTime',Te),-1<Te.indexOf('h')||-1<Te.indexOf('m')||-1<Te.indexOf('s')?(Re=Te.split('h'),console.log('hourArray',Re),De=void 0===Re[1]?Re[0].split('m'):Re[1].split('m'),console.log('minuteArray',De),Me=void 0===De[1]?De[0].split('s'):De[1].split('s'),console.log('secondArray',Me),be=Re[0],Le=De[0],Se=Me[0],console.log('hour minute second',isNaN(be)?0:be||0,isNaN(Le)?0:Le||0,isNaN(Se)?0:Se||0),Fe=isNaN(be)?0:be||0,Ue=isNaN(Le)?0:Le||0,ke=isNaN(Se)?0:Se||0,he=3.6e6*Fe+6e4*Ue+1e3*ke):he=6e4*Te),console.log('danmu_intervalTime_Ts',he),M('[\u81EA\u52A8\u53D1\u5F39\u5E55]MY_API.CACHE.AUTO_SEND_DANMU_TS => jsoncache',Ee),we=!0,He=!1,Pe=void 0,Qe.prev=7,Be=Ee[Symbol.iterator]();case 9:if(we=(Ye=Be.next()).done){Qe.next=18;break}if(je=Ye.value,je.roomid!=fe||je.content!=Ie){Qe.next=15;break}return me=je.sendTs,Oe=Ee.indexOf(je),Qe.abrupt('break',18);case 15:we=!0,Qe.next=9;break;case 18:Qe.next=24;break;case 20:Qe.prev=20,Qe.t0=Qe['catch'](7),He=!0,Pe=Qe.t0;case 24:Qe.prev=24,Qe.prev=25,!we&&Be.return&&Be.return();case 27:if(Qe.prev=27,!He){Qe.next=30;break}throw Pe;case 30:return Qe.finish(27);case 31:return Qe.finish(24);case 32:if(ve||(me?Ne=y()-me:Ne=y()),console.log('intervalTime',Ne),Ve=function setCache(){var We={roomid:fe,content:Ie,sendTs:y()};me?Ee[Oe].sendTs=y():Ee.push(We),oe.CACHE.AUTO_SEND_DANMU_TS=Ee,oe.saveCache(!1)},Xe=function sendNextDanmu(We,ze){ze||Ve(),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function qe(){return regeneratorRuntime.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return $e.next=2,oe.AUTO_DANMU.sendDanmu(Ie,fe);case 2:ze||Ve(),Xe(We,ze);case 4:case'end':return $e.stop();}},qe,ae)})),We)},!(!ve&&(Ne>=he||Q))){Qe.next=44;break}return Q=!1,Qe.next=40,oe.AUTO_DANMU.sendDanmu(Ie,fe);case 40:M('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+Ie+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+fe+'\u3011\uFF0C\u8DDD\u4E0B\u6B21\u53D1\u9001\u8FD8\u6709',Te),Xe(he,ve),Qe.next=55;break;case 44:if(!(ve&&!Ce||Q)){Qe.next=53;break}return Q=!1,Qe.next=48,oe.AUTO_DANMU.sendDanmu(Ie,fe);case 48:Ce=_(danmu_time[0],danmu_time[1],danmu_time[2]),M('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+Ie+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+fe+'\u3011\uFF0C\u8DDD\u4E0B\u6B21\u53D1\u9001\u8FD8\u6709','\u7EA624\u5C0F\u65F6'),Xe(Ce,ve),Qe.next=55;break;case 53:M('[\u81EA\u52A8\u53D1\u5F39\u5E55]\u5F39\u5E55\u53D1\u9001\u5185\u5BB9\u3010'+Ie+'\u3011\uFF0C\u623F\u95F4\u53F7\u3010'+fe+'\u3011\uFF0C\u8DDD\u4E0B\u6B21\u53D1\u9001\u8FD8\u6709',(ve?Ce/6e4:(he-Ne)/6e4)+'\u5206\u949F'),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function We(){return regeneratorRuntime.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.next=2,oe.AUTO_DANMU.sendDanmu(Ie,fe);case 2:Xe(ve?8.64e7:he,ve);case 3:case'end':return qe.stop();}},We,ae)})),ve?Ce:he-Ne);case 55:return Qe.next=57,I(1100);case 57:case'end':return Qe.stop();}},_e,ae,[[7,20,24,32],[25,,27,31]])}),ge=0;case 5:if(!(ge<le)){ce.next=10;break}return ce.delegateYield(_e(ge),'t0',7);case 7:ge++,ce.next=5;break;case 10:case'end':return ce.stop();}},se,ae)}));return function run(){return de.apply(this,arguments)}}()}};oe.init().then(function(){try{var de=$.Deferred();(function uniqueCheck(){var le=y();return 0<=le-oe.CACHE.UNIQUE_CHECK&&15e3>=le-oe.CACHE.UNIQUE_CHECK?($('.link-toast').remove(),$('.igiftMsg').remove(),window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),de.reject()):de.resolve()})().then(function(){var le,_e=function uniqueMark(){le=setTimeout(_e,1e4),oe.CACHE.UNIQUE_CHECK=Date.now(),oe.saveCache(!1)};return(window.addEventListener('unload',function(){le&&(clearTimeout(le),oe.CACHE.UNIQUE_CHECK=0,oe.saveCache())}),_e(),0===parseInt(Z.uid)||isNaN(parseInt(Z.uid)))?void oe.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(oe.newMessage(GM_info.script.version),M('MY_API.CONFIG',oe.CONFIG),l(oe))})}catch(de){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',de)}})}function l(ae){'use strict';var ne=function clearStat(){ae.GIFT_COUNT.COUNT=0,ae.GIFT_COUNT.CLEAR_TS=te(),ae.saveGiftCount(),M('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};if(ie(ae.GIFT_COUNT.CLEAR_TS)&&ne(),S(ne,'\u91CD\u7F6E\u7EDF\u8BA1'),ae.creatSetBox(),ae.removeUnnecessary(),setTimeout(function(){ae.AUTO_DANMU.run(),ae.LITTLE_HEART.run(),ae.GroupSign.run(),ae.DailyReward.run(),ae.LiveReward.run(),ae.Exchange.runS2C(),ae.Gift.run()},6e3),ae.CONFIG.LOTTERY&&(C.room.getList().then(function(de){M('\u76F4\u64AD\u95F4\u5217\u8868',de);var se=!0,le=!1,_e=void 0;try{for(var ce,ge=function _loop6(){var pe=ce.value;C.room.getRoomList(pe.id,0,0,1,1).then(function(Ie){M('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',Ie);for(var fe=0;fe<Ie.data.length;++fe)ae.listen(Ie.data[fe].roomid,Z.uid,pe.name+'\u533A')})},ue=de.data[Symbol.iterator]();!(se=(ce=ue.next()).done);se=!0)ge()}catch(pe){le=!0,_e=pe}finally{try{!se&&ue.return&&ue.return()}finally{if(le)throw _e}}}),ae.CONFIG.CHECK_HOUR_ROOM)){var de=function check_top_room(){if(ae.GIFT_COUNT.COUNT>=ae.CONFIG.MAX_GIFT&&(M('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),ae.max_blocked=!0),ae.blocked||ae.max_blocked)return ae.blocked?(ae.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(se)):void ae.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(c(ae.CONFIG.TIME_AREA_START_H0UR,ae.CONFIG.TIME_AREA_END_H0UR,ae.CONFIG.TIME_AREA_START_MINUTE,ae.CONFIG.TIME_AREA_END_MINUTE)&&ae.CONFIG.TIME_AREA_DISABLE)return void ae.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var le=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],_e=1,ge=function checkHourRank(ce){C.rankdb.getTopRealTimeHour(ce).then(function(pe){var Ie=pe.data.list;ae.chatLog('\u68C0\u67E5'+le[ce]+'\u623F\u95F4\u7684\u793C\u7269','warning'),M(le[ce]+'\u623F\u95F4\u5217\u8868',Ie);var fe=!0,Te=!1,me=void 0;try{for(var Oe,ve,Ee=Ie[Symbol.iterator]();!(fe=(Oe=Ee.next()).done);fe=!0)ve=Oe.value,ae.checkRoom(ve.roomid,'\u5C0F\u65F6\u699C-'+ve.area_v2_parent_name+'\u533A')}catch(ve){Te=!0,me=ve}finally{try{!fe&&Ee.return&&Ee.return()}finally{if(Te)throw me}}})},ue=setInterval(function(){_e<=le.length-1?(ge(_e),_e++):clearInterval(ue)},1e3)};setTimeout(de,6e3);var se=setInterval(de,parseInt(1e3*ae.CONFIG.CHECK_HOUR_ROOM_INTERVAL))}var oe=function reset(de){var se=setTimeout(function(){if(0<ae.raffleId_list.length||0<ae.guardId_list.length||0<ae.pkId_list.length)return M('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void oe(15000);if(ie(ae.CACHE.LittleHeart_TS))return M('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(se),void oe(6e5);if(c(ae.CONFIG.TIME_AREA_START_H0UR,ae.CONFIG.TIME_AREA_END_H0UR,ae.CONFIG.TIME_AREA_START_MINUTE,ae.CONFIG.TIME_AREA_END_MINUTE)&&ae.CONFIG.IN_TIME_RELOAD_DISABLE){var le=_(ae.CONFIG.TIME_AREA_START_MINUTE,ae.CONFIG.TIME_AREA_END_MINUTE)+6e4;return oe(le),void M('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+le+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},de)};ae.CONFIG.TIME_RELOAD&&oe(6e4*ae.CONFIG.TIME_RELOAD_MINUTE)}function _(ae,ne,oe){var de=new Date,se=de.getHours(),le=de.getMinutes(),_e=de.getSeconds(),ge=1e3*(3600*ae)+1e3*(60*ne)+(oe?1e3*oe:0),ce=ge-(1e3*(3600*se)+1e3*(60*le)+1e3*_e);return M('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',ce+'\u6BEB\u79D2'),0>ce?86400000+ce:ce}function u(ae,ne,oe){var de=new Date,se=de.getHours(),le=de.getMinutes(),_e=de.getSeconds();return(se!=ae||le!=ne||oe)&&(se!=ae||le!=ne||_e!=oe)?(M('isTime \u9519\u8BEF\u65F6\u95F4','\u76EE\u6807\u65F6\u95F4'+ae+'\u65F6'+ne+'\u5206'+(oe||0)+'\u79D2\uFF0C\u5F53\u524D\u65F6\u95F4'+se+'\u65F6'+le+'\u5206'+_e+'\u79D2'),!1):!0}function c(ae,ne,oe,de){if(23<ae||24<ne||0>ae||1>ne||59<oe||0>oe||59<de||0>de)return!1;var se=new Date,le=se.getHours(),_e=se.getMinutes();if(ae<ne)return le>=ae&&le<ne||le==ne&&_e>=oe&&_e<de;return ae>ne?le>=ae||le<ne||le==ne&&_e>=oe&&_e<de:ae==ne?le==ae&&oe<=de&&_e>=oe&&_e<de||le==ae&&oe>de&&_e<=de&&_e>oe:void 0}function I(ae){return new Promise(function(ne){setTimeout(function(){ne()},ae)})}function f(ae){if(0>=ae)return!1;var ne=Math.random();return ae/100>=ne}function T(ae){return new Promise(function(ne){var oe=function onerror(de){console.error(GM_info.script.name,de),ne(void 0)};if(ae.GM)'POST'===ae.method&&(void 0===ae.headers&&(ae.headers={}),void 0===ae.headers['Content-Type']&&(ae.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),ae.timeout=30000,ae.onload=function(de){return ne({response:de,body:de.response})},ae.onerror=oe,ae.ontimeout=oe,GM_xmlhttpRequest(ae);else{var de=new XMLHttpRequest;de.open(ae.method,ae.url),'POST'===ae.method&&null===de.getResponseHeader('Content-Type')&&de.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),ae.cookie&&(de.withCredentials=!0),ae.responseType!==void 0&&(de.responseType=ae.responseType),de.timeout=30000,de.onload=function(se){var le=se.target;ne({response:le,body:le.response})},de.onerror=oe,de.ontimeout=oe,de.send(ae.data)}})}H.init(),$(function(){var ae=function loadInfo(ne){setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function oe(){var de;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(de='undefined'==typeof unsafeWindow?window:unsafeWindow,!(void 0===de.BilibiliLive||0===parseInt(de.BilibiliLive.UID)||isNaN(parseInt(de.BilibiliLive.UID)))){le.next=5;break}return le.abrupt('return',ae(1e3));case 5:return Z.room_id=de.BilibiliLive.ROOMID,Z.uid=de.BilibiliLive.UID,Z.tid=de.BilibiliLive.ANCHOR_UID,le.next=10,C.live_user.get_info_in_room(Z.room_id).then(function(_e){M('InitData: API.live_user.get_info_in_room',_e),Z.mobile_verify=_e.data.info.mobile_verify,Z.identification=_e.data.info.identification});case 10:return le.next=12,C.gift.gift_config().then(function(_e){M('InitData: API.gift.gift_config',_e),!!_e.data&&$.isArray(_e.data)?Z.gift_list=_e.data:!!_e.data.list&&$.isArray(_e.data.list)?Z.gift_list=_e.data.list:(Z.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))});case 12:Z.bili_jct=C.getCookie('bili_jct'),Z.ruid=de.BilibiliLive.ANCHOR_UID,Z.rnd=de.BilibiliLive.RND,Z.visit_id=de.__statisObserver?de.__statisObserver.__visitId:'',M('Live_info',Z),o();case 18:case'end':return le.stop();}},oe,E)})),ne)};ae(1e3),P()}),Array.prototype.remove=function(ae){var ne=this.indexOf(ae);-1<ne&&this.splice(ne,1)};var te=function dateNow(){return Date.now()},ie=function checkNewDay(ae){if(0===ae)return!0;var ne=new Date(ae),oe=new Date,de=ne.getDate(),se=oe.getDate();return se!==de}})();
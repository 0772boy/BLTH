!function(){let e=new TextEncoder,n=new TextDecoder;let t={addCommandHandler(e,n){let t=this._commandHandlers[e];t||(t=this._commandHandlers[e]=[]),t.push(n)},removeCommandHandler(e,n){let t=this._commandHandlers[e];t&&(this._commandHandlers[e]=t.filter((e=>e!==n)))},hook(){window.WebSocket=new Proxy(window.WebSocket,{construct(e,n){let t=new e(...n);return new Proxy(t,r)}})},_commandHandlers:{},_getCommandHandlers(e){return this._commandHandlers[e]||null}},r={get(e,n){let t=e[n];return"function"==typeof t&&(t=t.bind(e)),t},set(e,n,t){if("onmessage"===n){let e=t;t=function(n){!function(e,n){if(!(e.data instanceof ArrayBuffer))return void n(e);function t(t){n({...e,data:t})}i(new Uint8Array(e.data),t)}(n,e)}}return e[n]=t,t}};function o(e,n){let t=16+e.byteLength,r=new ArrayBuffer(t),o=3===n?0:1,i=new DataView(r);i.setUint32(0,t),i.setUint16(4,16),i.setUint16(6,o),i.setUint32(8,n),i.setUint32(12,1);let a=new Uint8Array(r,16,e.byteLength);for(let n=0;n<e.byteLength;n++)a[n]=e[n];return r}function i(e,t){let r=0;for(;r<e.byteLength;){let d=new DataView(e.buffer,r),f=d.getUint32(0),l=d.getUint16(6),s=d.getUint32(8),c=new Uint8Array(e.buffer,r+16,f-16);if(5===s)2==l?(c=pako.inflate(c),i(c,t)):(c=JSON.parse(n.decode(c)),a(c,t));else{t(o(c,s))}r+=f}}function a(n,r){if(n instanceof Array){for(let e of n)this.handleCommand(e);return}let i=n.cmd||"",a=i.indexOf(":");-1!=a&&(i=i.substr(0,a));let d=t._getCommandHandlers(i);if(d)for(let e of d)e(n);r(function(n){return o(e.encode(JSON.stringify(n)),5)}(n))}window.bliveproxy||(window.bliveproxy=t)}();
// ==UserScript==
// @namespace     https://github.com/andywang425
// @name          B站直播自动抢辣条
// @name:en       B站直播自动抢辣条
// @author        andywang425
// @description   自动参与Bilibili直播区抽奖(虽然几乎没了);完成每日任务，领银瓜子宝箱，自动送礼，获取小心心，批量点亮勋章
// @description:en 自动参与Bilibili直播区抽奖(虽然几乎没了);完成每日任务，领银瓜子宝箱，自动送礼，获取小心心，批量点亮勋章
// @updateURL     https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @homepageURL   https://github.com/andywang425/Bilibili-SGTH/
// @supportURL    https://github.com/andywang425/Bilibili-SGTH/issues
// @icon          https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright     2020, andywang425 (https://github.com/andywang425)
// @license       MIT
// @version       3.9.1
// @include      /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at       document-end
// @connect      passport.bilibili.com
// @connect      api.live.bilibili.com
// @connect      live-trace.bilibili.com
//@require https://cdn.jsdelivr.net/gh/jquery/jquery@3.2.1/dist/jquery.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.4/BilibiliAPI_Mod.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.2/OCRAD.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.4/libBilibiliToken.user.js
// @grant       unsafeWindow
// @grant       GM_xmlhttpRequest
// @grant       GM_openInTab
// ==/UserScript==
'use strict';var _Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function I(T,f){try{var E=l[T](f),O=E.value}catch(R){return void u(R)}return E.done?void _(O):Promise.resolve(O).then(function(R){I('next',R)},function(R){I('throw',R)})}return I('next')})}}(function(){var G=this,C=!1,N='IGIFTMSG',D=BilibiliAPI,M=0,L=0,S=0,F=!1,w=[],U=window&&window.navigator?window.navigator.userAgent:'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36',H=new Date().getTimezoneOffset()+480,k=function ts_ms(){return Date.now()},B=function ts_s(){return _Mathround(k()/1e3)},P={room_id:void 0,uid:void 0,ruid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},Y=function runUntilSucceed(se){var de=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,le=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){se()||Y(se,le,le)},de)},X=function delayCall(se){var de=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,le=$.Deferred();return setTimeout(function(){var _e=se();_e&&_e.then?_e.then(function(ge,ue,ce,Ie,pe,Te){return le.resolve(ge,ue,ce,Ie,pe,Te)}):le.resolve()},de),le},V=function MYDEBUG(se){for(var de=arguments.length,le=Array(1<de?de-1:0),_e=1;_e<de;_e++)le[_e-1]=arguments[_e];var ge=new Date;return ge='['+N+']['+ge.getHours()+':'+ge.getMinutes()+':'+ge.getSeconds()+':'+ge.getMilliseconds()+']',1===le.length?void console.log(ge,se+':',le[0]):void console.log(ge,se+':',le)},K=function runMidnight(se,de){var le=new Date;le.setMinutes(le.getMinutes()+H),le.setDate(le.getDate()+1),le.setHours(0,1,0,0),le.setMinutes(le.getMinutes()-H),setTimeout(se,le-k()),V('runMidnight',(de||' ')+' '+le.toString())},Q=function runExactMidnight(se,de){var le=new Date;le.setMinutes(le.getMinutes()+H),le.setDate(le.getDate()+1),le.setHours(0,0,0,0),le.setMinutes(le.getMinutes()-H),setTimeout(se,le-k()),V('runExactMidnight',(de||' ')+' '+le.toString())},z=function runTomorrow(se,de,le,_e){var ge=new Date;ge.setMinutes(ge.getMinutes()+H),ge.setDate(ge.getDate()+1),ge.setHours(de,le,0,0),ge.setMinutes(ge.getMinutes()-H),setTimeout(se,ge-k()),V('runTomorrow',(_e||' ')+' '+ge.toString())},Z=new BilibiliToken,J='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',ee=void 0,te=JSON.parse(localStorage.getItem(N+'_userToken'))||{},ie=function(){var se=_asyncToGenerator(regeneratorRuntime.mark(function de(){return regeneratorRuntime.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(!(te.time>B())){_e.next=4;break}ee=ee,_e.next=10;break;case 4:return _e.next=6,Z.getToken();case 6:te=_e.sent,te.time=B()+te.expires_in,localStorage.setItem(N+'_Token',JSON.stringify(te)),ee=te;case 10:;return V(N+'_userToken',te),_e.abrupt('return','OK');case 13:case'end':return _e.stop();}},de,G)}));return function setToken(){return se.apply(this,arguments)}}(),ae={init:function init(){return ae.Toast.init().then(function(){})},Toast:{init:function init(){try{var se=[];return window.toast=function(de){var le=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',_e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(le){case'success':case'info':break;case'caution':break;case'error':break;default:le='info';}var ge=$('<div class="link-toast '+le+' fixed"><span class="toast-text">'+de+'</span></div>')[0];document.body.appendChild(ge),ge.style.top=document.body.scrollTop+40*se.length+10+'px',ge.style.left=document.body.offsetWidth+document.body.scrollLeft-ge.offsetWidth-5+'px',se.push(ge),setTimeout(function(){ge.className+=' out',setTimeout(function(){se.shift(),se.forEach(function(ue){ue.style.top=parseInt(ue.style.top,10)-40+'px'}),$(ge).remove()},200)},_e)},$.Deferred().resolve()}catch(se){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',se),$.Deferred().reject()}}}};function o(){$('head').append('\n        <style>\n            .igiftMsg_input{\n                outline: none;\n                border: 1px solid #e9eaec;\n                background-color: #fff;\n                border-radius: 4px;\n                padding: 1px 0 0;\n                overflow: hidden;\n                font-size: 12px;\n                line-height: 19px;\n                width: 30px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_btn{\n                background-color: #23ade5;\n                color: #fff;\n                border-radius: 4px;\n                border: none;\n                padding: 5px;\n                cursor: pointer;\n                box-shadow: 0 0 2px #00000075;\n                line-height: 10px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_fs{\n                border: 2px solid #d4d4d4;\n                \'z-index\': \'10001\';\n            }\n        </style>\n            ')}function l(){var de,se=this,le={CONFIG_DEFAULT:{AUTO_GIFT:!1,AUTO_GIFT_ROOMID:'0',AUTO_GROUP_SIGN:!0,AUTO_TREASUREBOX:!0,CHECK_HOUR_ROOM_INTERVAL:120,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,EXCLUDE_ROOMID:'0',FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_SEND_TIME',GIFT_SORT:!1,IN_TIME_RELOAD_DISABLE:!1,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!1,LIGHT_MEDALS:'0',LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,MAX_TAB:5,MOBILE_HEARTBEAT:!0,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_july:!1,REMOVE_ELEMENT_player:!1,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',SPARE_GIFT_UID:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:60,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,MobileHeartBeat_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{D.setCommonArgs(P.bili_jct)}catch(ge){return void console.error('['+N+']',ge)}var _e=$.Deferred();try{le.loadConfig().then(function(){le.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),_e.resolve()})}catch(ge){console.error('API\u521D\u59CB\u5316\u51FA\u9519',ge),le.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),_e.reject()}try{le.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),_e.resolve()})}catch(ge){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',ge),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),_e.reject()}return setTimeout(function(){le.TreasureBox.init()},5750),_e},loadConfig:function loadConfig(){var _e=$.Deferred();try{var ge=JSON.parse(localStorage.getItem(N+'_CONFIG'));for(var ue in $.extend(!0,le.CONFIG,le.CONFIG_DEFAULT),le.CONFIG)le.CONFIG.hasOwnProperty(ue)&&void 0!==ge[ue]&&null!==ge[ue]&&(le.CONFIG[ue]=ge[ue]);le.loadGiftCount(),_e.resolve()}catch(ge){V('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',ge),le.setDefaults(),_e.reject()}return _e},loadCache:function loadCache(){var _e=$.Deferred();try{var ge=JSON.parse(localStorage.getItem(N+'_CACHE'));for(var ue in $.extend(!0,le.CACHE,le.CACHE_DEFAULT),le.CACHE)le.CACHE.hasOwnProperty(ue)&&void 0!==ge[ue]&&null!==ge[ue]&&(le.CACHE[ue]=ge[ue]);_e.resolve()}catch(ge){V('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',ge),le.setDefaults(),_e.reject()}return _e},newMessage:function newMessage(_e){try{var ue=localStorage.getItem(N+'_NEWMSG_CACHE');(ue==void 0||null==ue||'3.9'!=ue)&&'3.9'==_e&&(alert(_e+'\u66F4\u65B0\u63D0\u793A\uFF1A\n\n                \u8BF7\u9605\u8BFB\u4E00\u4E0B\u811A\u672C\u8BF4\u660E\u4E2D\u7684\u5C0F\u5FC3\u5FC3\u90E8\u5206\uFF0C\u83B7\u53D6\u65B9\u5F0F\u6709\u53D8\u52A8\u3002\n\n                \u7B49b\u7AD9\u5220\u9664\u8FA3\u6761\u540E\u811A\u672C\u4F1A\u6539\u540D(\u76EE\u524D\u597D\u50CF\u5C31\u5269\u4E2A\u6D41\u661F\u96E8\u6709\u62BD\u5956\u4E86)\uFF0C\n                \uFF08greasyfork\u7528\u6237\u53EF\u5FFD\u7565\u4EE5\u4E0B\u90E8\u5206\uFF09\u6240\u4EE5\u66F4\u65B0\u94FE\u63A5\u4E5F\u4F1A\u53D8\u5316\u3002\n                \u6539\u540D\u540E\uFF0C\u6211\u4F1A\u53D1\u5E03B\u7AD9\u76F4\u64AD\u81EA\u52A8\u62A2\u8FA3\u6761\u7684\u6700\u7EC8\u7248\u672C\u3002\n                \u5B89\u88C5\u8FD9\u4E2A\u7248\u672C\u540E\u811A\u672C\u4F1A\u63D0\u793A\u4F60\u5B89\u88C5\u6539\u540D\u540E\u7684\u65B0\u811A\u672C\u3002\n\n                \u672C\u63D0\u793A\u5728\u6BCF\u4E2A\u7248\u672C\u4EC5\u4F1A\u51FA\u73B0\u4E00\u6B21\u3002'),localStorage.setItem(N+'_NEWMSG_CACHE',_e))}catch(ue){V('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25',ue)}},saveConfig:function saveConfig(){try{return localStorage.setItem(N+'_CONFIG',JSON.stringify(le.CONFIG)),le.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),V('MY_API.CONFIG',le.CONFIG),!0}catch(_e){return V('API\u4FDD\u5B58\u51FA\u9519',_e),!1}},saveCache:function saveCache(_e){try{return localStorage.setItem(N+'_CACHE',JSON.stringify(le.CACHE)),!1!=_e&&V('CACHE\u5DF2\u4FDD\u5B58',le.CACHE),!0}catch(ge){return V('CACHE\u4FDD\u5B58\u51FA\u9519',ge),!1}},setDefaults:function setDefaults(){le.CONFIG=le.CONFIG_DEFAULT,le.CACHE=le.CACHE_DEFAULT,le.saveConfig(),le.saveCache(),le.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1','info'),setTimeout(function(){le.CACHE=le.CACHE_DEFAULT,le.GroupSign.run(),le.DailyReward.run(),le.LiveReward.run(),le.Exchange.runS2C(),le.TreasureBox.run(),le.Gift.run(),le.LITTLE_HEART.run(),le.MobileHeartBeat.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var _e=JSON.parse(localStorage.getItem(N+'_GIFT_COUNT'));for(var ge in le.GIFT_COUNT)le.GIFT_COUNT.hasOwnProperty(ge)&&void 0!==_e[ge]&&null!==_e[ge]&&(le.GIFT_COUNT[ge]=_e[ge]);V('MY_API.GIFT_COUNT',le.GIFT_COUNT)}catch(_e){V('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',_e)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(N+'_GIFT_COUNT',JSON.stringify(le.GIFT_COUNT)),V('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',le.GIFT_COUNT),!0}catch(_e){return V('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',_e),!1}},addGift:function addGift(_e){le.GIFT_COUNT.COUNT+=_e,$('#giftCount span:eq(0)').text(le.GIFT_COUNT.COUNT),le.saveGiftCount()},addSilver:function addSilver(_e){le.GIFT_COUNT.SILVER_COUNT+=10*_e,$('#giftCount span:eq(1)').text(le.GIFT_COUNT.SILVER_COUNT),le.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){var _e=['#my-dear-haruna-vm','.july-activity-entry','.bilibili-live-player'],ge=function removeUntiSucceed(ue,ce){!0===le.CONFIG[ue]&&setInterval(function(){0<$(_e[ce]).length&&$(_e[ce]).remove()},200)};ge('REMOVE_ELEMENT_2233',0),ge('REMOVE_ELEMENT_july',1),ge('REMOVE_ELEMENT_player',2)},creatSetBox:function creatSetBox(){function _e(){var ve,xe,Re=le.CONFIG.TIME_AREA_START_H0UR=parseInt(ue.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),Ge=le.CONFIG.TIME_AREA_END_H0UR=parseInt(ue.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Ce=le.CONFIG.TIME_AREA_START_MINUTE=parseInt(ue.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),he=le.CONFIG.TIME_AREA_END_MINUTE=parseInt(ue.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(0>Re||0>Ge||0>Ce||0>he)return void le.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=Re||24<=Ge||60<=Ce||60<=he)return void le.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(le.CONFIG.TIME_AREA_START_H0UR=Re,le.CONFIG.TIME_AREA_END_H0UR=Ge,le.CONFIG.TIME_AREA_START_MINUTE=Ce,le.CONFIG.TIME_AREA_END_MINUTE=he,ve=parseFloat(ue.find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>ve||100<ve)return void le.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(le.CONFIG.RANDOM_SKIP=ve,ve=parseFloat(ue.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<ve)return void le.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>ve)return void le.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(le.CONFIG.RANDOM_SEND_DANMU=ve,ve=parseInt(ue.find('div[data-toggle="MAX_GIFT"] .num').val()),le.CONFIG.MAX_GIFT=ve,ve=parseInt(ue.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=ve||1e4<ve)return void le.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(le.CONFIG.TIME_RELOAD=ve,ve=parseFloat(ue.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),Ge=parseFloat(ue.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>ve||100<Ge)return void le.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Ge<=ve)return void le.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(le.CONFIG.RND_DELAY_START=ve,le.CONFIG.RND_DELAY_END=Ge,ve=parseInt(ue.find('div[data-toggle="COIN"] .coin_number').val()),0>ve||5<ve)return void le.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(le.CONFIG.COIN_NUMBER=ve,ve=parseInt(ue.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=ve)return void le.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');le.CONFIG.CHECK_HOUR_ROOM_INTERVAL=ve,ve=ue.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),xe=ve.split(',');for(var Ae=0;Ae<xe.length;Ae++)''===xe[Ae]&&(xe[Ae]=0);ve=xe.join(','),le.CONFIG.AUTO_GIFT_ROOMID=ve,ve=ue.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),xe=ve.split(',');for(var Ae=0;Ae<xe.length;Ae++)''===xe[Ae]&&(xe[Ae]=0);return(ve=xe.join(','),le.CONFIG.EXCLUDE_ROOMID=ve,ve=parseInt(ue.find('div[data-toggle="GIFT_LIMIT"] .num').val()),le.CONFIG.GIFT_LIMIT=ve,Re=parseInt(ue.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),Ge=parseInt(ue.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>Re||0>Ge)?void le.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning'):24<=Re||60<=Ge?void le.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning'):void(le.CONFIG.GIFT_SEND_HOUR=Re,le.CONFIG.GIFT_SEND_MINUTE=Ge,ve=ue.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),le.CONFIG.SPARE_GIFT_ROOM=ve,ve=ue.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(),le.CONFIG.SPARE_GIFT_UID=ve,ve=parseInt(ue.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),le.CONFIG.STORM_QUEUE_SIZE=ve,ve=parseInt(ue.find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),le.CONFIG.STORM_MAX_COUNT=ve,ve=parseInt(ue.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),le.CONFIG.STORM_ONE_LIMIT=ve,ve=parseInt(ue.find('div[data-toggle="COIN_UID"] .num').val()),le.CONFIG.COIN_UID=ve,ve=ue.find('div[data-toggle="LIGHT_MEDALS"] .num').val(),le.CONFIG.LIGHT_MEDALS=ve,ve=parseInt(ue.find('div[data-toggle="MAX_TAB"] .num').val()),le.CONFIG.MAX_TAB=ve,le.saveConfig())}var ge=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F<br></button>');ge.click(function(){if(!1==C){C=!0,$('.igiftMsg').hide(),ue.hide();var ve=$('.chat-history-list');ve.animate({scrollTop:0},0),setTimeout(function(){ve.animate({scrollTop:ve.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}else{C=!1,$('.igiftMsg').show(),ue.show();var ve=$('.chat-history-list');ve.animate({scrollTop:ve.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}}),$('.attention-btn-ctnr').append(ge);var ue=$('<div>'),ce=$('.live-player-mounter').height();ue.css({width:'auto',height:ce,position:'absolute',top:'-2px',right:'0px',background:'#F0F0F0',padding:'10px',"z-index":'10001',"border-radius":'4px',overflow:'scroll',"line-height":'15px'}),ue.append('\n                <div id=\'allsettings\'>\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n                    <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n                        \u8FA3\u6761&nbsp;<span>'+le.GIFT_COUNT.COUNT+'</span>\n                        \u94F6\u74DC\u5B50&nbsp;<span>'+le.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n                    </div>\n                </fieldset>\n                <div id="left_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u4F4E\u8C03\u8BBE\u7F6E</legend>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u542F\u7528\n                                <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                                <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_GIFT">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM_INTERVAL">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\n                            </label>\n                        </div>\n            \n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u767B\u9646\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u89C2\u770B\u89C6\u9891\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="cursor: pointer; vertical-align: text-top;" type="checkbox">\n                                \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                            </label>\n                        </div>\n                        <div data-toggle="COIN_TYPE" style=" color: black">\n                            <div data-toggle="COIN_UID">\n                            <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                            \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                            \u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                            <div data-toggle="COIN_DYN">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5206\u4EAB\u89C6\u9891\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u76F4\u64AD\u533A\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5E94\u63F4\u56E2\u7B7E\u5230\n                        </div>\n                        <div data-toggle="MOBILE_HEARTBEAT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u6A21\u62DF\u79FB\u52A8\u7AEF\u5FC3\u8DF3 + \u9886\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD\u5956\u52B1\n                        </div>\n                        <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9001\u793C\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            \u4F18\u5148\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                            \u4E0D\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n                        <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u95F4\u9694\n                            <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                            \u5206\u949F\u9001\u793C\n                        </div>\n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u5B9A\u65F6\u9001\u793C<br>\n                            \u9001\u793C\u65F6\u95F4\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n                        </div>\n                        \n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            \u793C\u7269\u5230\u671F\u65F6\u95F4\n                            <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                            \u5929\n                        </div>\n                        <div data-toggle="GIFT_SORT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u793C\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                        <div data-toggle="SPARE_GIFT_UID" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\u62E5\u6709\u8005UID\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            \u6BEB\u79D2\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8BF4\u660E</legend>\n                        \u81EA\u52A8\u9001\u793C\u76EE\u524D\u53EA\u4F1A\u9001\u51FA\u8FA3\u6761\uFF0C\u4EBF\u5706\u548C\u5C0F\u5FC3\u5FC3\u3002<br>\n                        \u793C\u7269\u5230\u671F\u65F6\u95F4: \u5C06\u8981\u5728\u8FD9\u4E2A\u65F6\u95F4\u6BB5\u91CC\u8FC7\u671F\u7684\u793C\u7269\u4F1A\u88AB\u9001\u51FA<br>\n                        \u52FE\u9009\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u65F6\u65E0\u8BBA\u662F\u5426\u5C06\u8981\u8FC7\u671F\u90FD\u4F1A\u88AB\u9001\u51FA<br>\n                        \u5982\u679C\u8981\u586B\u5199\u591A\u4E2A\u4F18\u5148\u9001\u793C\u623F\u95F4\uFF0C<br>\n                        \u6BCF\u4E2A\u623F\u95F4\u53F7\u4E4B\u95F4\u9700\u7528\u534A\u89D2\u9017\u53F7,\u9694\u5F00\u3002(\u4E0D\u9001\u793C\u623F\u95F4\uFF0C\u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\u540C\u7406)<br>\n                        \u5982 666,777,888\u3002\u4E3A0\u5219\u4E0D\u9001\u3002<br>\n                        \u5982\u679C\u6CA1\u6709\u8FD9\u4E9B\u623F\u95F4\u7684\u7C89\u4E1D\u724C\u4E5F\u4E0D\u9001\u3002<br>\n                        \u65E0\u8BBA\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u5982\u4F55\u8BBE\u7F6E\uFF0C\u4F1A\u6839\u636E\u3010\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u3011<br>\n                        \uFF08\u52FE\u9009\u5219\u8865\u6EE1\uFF0C\u5426\u5219\u53EA\u9001\u5230\u671F\u7684\uFF09\u6761\u4EF6\u53BB\u6309\u4F18\u5148\u9001\u793C\u623F\u95F4\u5148\u540E\u987A\u5E8F\u9001\u793C\u3002<br>\n                        \u4E4B\u540E\u6839\u636E\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u51B3\u5B9A\u5148\u9001\u9AD8\u7EA7\u8FD8\u662F\u4F4E\u7EA7\uFF08\u52FE\u9009\u5148\u9AD8\u7EA7\uFF0C\u4E0D\u52FE\u9009\u5148\u4F4E\u7EA7\uFF09\u3002<br>\n                        \u5269\u4F59\u793C\u7269:\u6307\u9001\u5B8C\u4E86\u6240\u6709\u7C89\u4E1D\u724C\uFF0C\u4F46\u4ECD\u6709\u5269\u4F59\u7684\u5C06\u57281\u5929\u5185\u8FC7\u671F\u7684\u793C\u7269\u3002<br>\n                        \u5269\u4F59\u793C\u7269\u4E5F\u4F1A\u5728\u6307\u5B9A\u9001\u793C\u65F6\u95F4\u88AB\u9001\u51FA\u3002<br>\n                        \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\u98CE\u9669\u8F83\u5927\uFF0C\u5982\u679C\u6CA1\u6709\u5B9E\u540D\u53EF\u80FD\u65E0\u6CD5\u53C2\u52A0\u3002<br>\n                        \u811A\u672C\u4EC5\u80FD\u53C2\u52A0\u5E7F\u64AD\u4E2D\u7684\u8282\u594F\u98CE\u66B4\u3002<br>\n                        \u3010\u7ED9\u7528\u6237(UID:___)\u7684\u89C6\u9891\u6295\u5E01\u3011\u82E5\u586B0\u5219\u7ED9\u52A8\u6001\u4E2D\u7684\u89C6\u9891\u4F9D\u6B21\u6295\u5E01(\u56E0\u4E3A\u65E0UID\u4E3A0\u7684\u7528\u6237)\n            \n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n                        <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u540E\u53F0\u5FAA\u73AF\u5F00\u5173\u6807\u7B7E\u9875\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_TAB" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            \u6253\u5F00\u6807\u7B7E\u9875\u6570\u91CF\u4E0A\u9650\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </label>\n                    </div>\n                        <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                            \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n                        <input class="num igiftMsg_input" style="width: 300px;" type="text">\n                    </div>\n                    <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n                        \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n                        <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u767D\u540D\u5355\n                        </div>\n                        <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                            &nbsp;\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u9ED1\u540D\u5355\n                        </div>\n                    </div>\n                    <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n                    <label style="margin: 5px auto; color: black">\n                        <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n                    </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n                        <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u96642233\u6A21\u578B\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_july" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u590F\u65E5\u6D3B\u52A8\u5165\u53E3\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_player" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u76F4\u64AD\u753B\u9762\n                        </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 15px">\n                        <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n                        <div data-toggle="TIME_RELOAD" style="color: black">\n                            \u672C\u76F4\u64AD\u95F4\u5237\u65B0\u65F6\u95F4\uFF1A\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\u5206\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u91CD\u8F7D\u76F4\u64AD\u95F4\n                            </label>\n                        </div>\n                        <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: red;">\n                                <input style="vertical-align: text-top;" type="checkbox">\u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n                            </label>\n                        </div>\n                        <div id="resetArea">\n                            <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                            <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1</button>\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n                        </div>\n            \n                    </fieldset>\n                    <label style="color: darkblue; font-size:large;">\n                        v'+GM_info.script.version+' <a href="https://github.com/andywang425/Bilibili-SGTH/"\n                            target="_blank">\u66F4\u591A\u8BF4\u660E\u548C\u66F4\u65B0\u65E5\u5FD7\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n                    </label>\n                </div>\n            </div>\n    '),$('.live-player-mounter').append(ue),ue.find('div[data-toggle="MAX_TAB"] .num').val(parseInt(le.CONFIG.MAX_TAB).toString()),ue.find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(le.CONFIG.GIFT_INTERVAL).toString()),ue.find('div[data-toggle="LIGHT_MEDALS"] .num').val(le.CONFIG.LIGHT_MEDALS.toString()),ue.find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(le.CONFIG.STORM_MAX_COUNT).toString()),ue.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(le.CONFIG.STORM_ONE_LIMIT).toString()),ue.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(le.CONFIG.STORM_QUEUE_SIZE).toString()),ue.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(le.CONFIG.SPARE_GIFT_UID.toString()),ue.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(le.CONFIG.SPARE_GIFT_ROOM.toString()),ue.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(le.CONFIG.TIME_RELOAD).toString()),ue.find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(le.CONFIG.RANDOM_SKIP).toString()),ue.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(le.CONFIG.RANDOM_SEND_DANMU).toString()),ue.find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(le.CONFIG.MAX_GIFT).toString()),ue.find('div[data-toggle="COIN"] .coin_number').val(parseInt(le.CONFIG.COIN_NUMBER).toString()),ue.find('div[data-toggle="COIN_UID"] .num').val(parseInt(le.CONFIG.COIN_UID).toString()),ue.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(le.CONFIG.RND_DELAY_START).toString()),ue.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(le.CONFIG.RND_DELAY_END).toString()),ue.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(le.CONFIG.TIME_AREA_START_H0UR).toString()),ue.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(le.CONFIG.TIME_AREA_END_H0UR).toString()),ue.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(le.CONFIG.TIME_AREA_START_MINUTE).toString()),ue.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(le.CONFIG.TIME_AREA_END_MINUTE).toString()),ue.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val(parseInt(le.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),ue.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(le.CONFIG.AUTO_GIFT_ROOMID.toString()),ue.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(le.CONFIG.EXCLUDE_ROOMID.toString()),ue.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(le.CONFIG.GIFT_SEND_HOUR.toString()),ue.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(le.CONFIG.GIFT_SEND_MINUTE.toString()),ue.find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(le.CONFIG.GIFT_LIMIT).toString());ue.find('div[id="giftCount"] [data-action="save"]').click(function(){_e()}),ue.find('button[data-action="reset"]').click(function(){le.setDefaults()}),ue.find('button[data-action="checkUpdate"]').click(function(){le.checkUpdate()}),ue.find('button[data-action="redo_dailyTasks"]').click(function(){le.ReDoDailyTasks()}),ue.find('#resetArea [data-action="countReset"]').click(function(){le.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},le.saveGiftCount(),$('#giftCount span:eq(0)').text(le.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(le.GIFT_COUNT.SILVER_COUNT),le.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),ue.find('button[data-action="sendGiftNow"]').click(function(){F=!0,le.Gift.run()});var Ie=['RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','GIFT_SORT','SEND_ALL_GIFT','MOBILE_HEARTBEAT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_july','REMOVE_ELEMENT_player','FORCE_LIGHT'],pe=!0,Te=!1,fe=void 0;try{for(var Oe,Ee=function _loop(){var ve=Oe.value,xe=ue.find('div[data-toggle="'+ve+'"] input:checkbox');le.CONFIG[ve]&&xe.attr('checked',''),xe.change(function(){le.CONFIG[ve]=$(this).prop('checked'),le.saveConfig()})},me=Ie[Symbol.iterator]();!(pe=(Oe=me.next()).done);pe=!0)Ee()}catch(ve){Te=!0,fe=ve}finally{try{!pe&&me.return&&me.return()}finally{if(Te)throw fe}}$('input:text').bind('keydown',function(ve){'13'==ve.keyCode&&_e()}),'COIN_DYN'==le.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==le.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==le.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');$('input:radio[name=\'COIN_TYPE\']').change(function(){var ve=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked');le.CONFIG.COIN_TYPE=!0==ve?'COIN_DYN':'COIN_UID',le.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){var ve=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked');le.CONFIG.LIGHT_METHOD=!0==ve?'LIGHT_WHITE':'LIGHT_BLACK',le.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){var ve=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked');le.CONFIG.GIFT_METHOD=!0==ve?'GIFT_INTERVAL':'GIFT_SEND_TIME',le.saveConfig()})},chatLog:function chatLog(_e){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',ue=$('<div class=\'igiftMsg\'>'),ce=$('<div>'),Ie=$('#chat-history-list'),pe=new Date;ce.text(_e),ue.text(pe.toLocaleString()),ue.append(ce),ue.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),ce.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===ge?ue.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===ge?ue.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===ge?ue.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):ue.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});!1==C?Ie.find('#chat-items').append(ue):Ie.find('#chat-items').append(ue.hide()),Ie.scrollTop(Ie.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(_e,ge){var ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';D.room.getConf(_e).then(function(ce){V('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+ue,ce);var Ie=new D.DanmuWebSocket(ge,_e,ce.data.host_server_list,ce.data.token);Ie.bind(function(pe){Ie=pe,le.chatLog(ue+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){le.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+_e+' \u5206\u533A: '+ue,'success')},function(){(le.blocked||le.stormBlack)&&(Ie.close(),le.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ue,'warning')),le.max_blocked&&!le.CONFIG.STORM&&(Ie.close(),le.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ue,'warning'))},function(pe){if(!(f(le.CONFIG.TIME_AREA_START_H0UR,le.CONFIG.TIME_AREA_END_H0UR,le.CONFIG.TIME_AREA_START_MINUTE,le.CONFIG.TIME_AREA_END_MINUTE)&&le.CONFIG.TIME_AREA_DISABLE))switch(V('\u5F39\u5E55\u516C\u544A'+ue,pe),pe.cmd){case'GUARD_MSG':pe.roomid===pe.real_roomid?le.checkRoom(pe.roomid,ue):(le.checkRoom(pe.roomid,ue),le.checkRoom(pe.real_roomid,ue));break;case'PK_BATTLE_SETTLE_USER':pe.data.winner?le.checkRoom(pe.data.winner.room_id,ue):le.checkRoom(pe.data.my_info.room_id,ue),le.checkRoom(pe.data.winner.room_id,ue);break;case'NOTICE_MSG':switch(pe.msg_type){case 1:break;case 2:case 3:case 4:case 8:pe.roomid===pe.real_roomid?le.checkRoom(pe.roomid,ue):(le.checkRoom(pe.roomid,ue),le.checkRoom(pe.real_roomid,ue));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+pe.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),le.Storm.run(pe.roomid);}break;case'SPECIAL_GIFT':if(pe.data[39])switch(pe.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+pe.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),le.Storm.run(pe.roomid);case'end':};break;default:}})},function(){le.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(_e){var ge=[];try{var ue=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));ge=[].concat(ue.list),ge.push(_e),100<ge.length&&ge.splice(0,50),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:ge})),V(N+'_EntryRoom_list_add',ge)}catch(ue){ge.push(_e),localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:ge}))}},isIn:function isIn(_e){var ge=[];try{var ue=JSON.parse(localStorage.getItem(N+'_EntryRoom_list'));return ge=null===ue?[]:[].concat(ue.list),V(N+'_EntryRoom_list_read',ue),-1<ge.indexOf(_e)}catch(ue){return localStorage.setItem(N+'_EntryRoom_list',JSON.stringify({list:ge})),V('\u8BFB\u53D6'+(N+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ge.indexOf(_e)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(_e){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';le.blocked||le.max_blocked||0<=le.RoomId_list.indexOf(_e)||(le.RoomId_list.push(_e),le.EntryRoom_list_history.isIn(_e)||(D.room.room_entry_action(_e),le.EntryRoom_list_history.add(_e)),O(le.CONFIG.RANDOM_SEND_DANMU)&&D.sendLiveDanmu(le.auto_danmu_list[_Mathfloor(12*Math.random())],_e).then(function(ue){V('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',ue)}),D.xlive.lottery.check(_e).then(function(ue){le.RoomId_list.remove(_e),V('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',ue);var ce=ue.data;if(0===ue.code){var Ie;if(ce.gift)for(var pe in Ie=ce.gift,Ie)Ie.hasOwnProperty(pe)&&le.creat_join(_e,Ie[pe],'gift',ge);if(ce.guard)for(var pe in Ie=ce.guard,Ie)Ie.hasOwnProperty(pe)&&le.creat_join(_e,Ie[pe],'guard',ge);if(ce.pk)for(var pe in Ie=ce.pk,Ie)Ie.hasOwnProperty(pe)&&le.creat_join(_e,Ie[pe],'pk',ge)}else le.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<le.err_roomId.indexOf(_e)?V('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+_e+ue.message):(le.err_roomId.push(_e),le.checkRoom(_e,ge),V('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+_e+ue.message))}))},Id_list_history:{add:function add(_e,ge){var ue=[];try{var ce=JSON.parse(localStorage.getItem(N+'_'+ge+'Id_list'));ue=[].concat(ce.list),ue.push(_e),200<ue.length&&ue.splice(0,50),localStorage.setItem(N+'_'+ge+'Id_list',JSON.stringify({list:ue})),V(N+'_'+ge+'Id_list_add',ue)}catch(ce){ue.push(_e),localStorage.setItem(N+'_'+ge+'Id_list',JSON.stringify({list:ue}))}},isIn:function isIn(_e,ge){var ue=[];try{var ce=JSON.parse(localStorage.getItem(N+'_'+ge+'Id_list'));return ue=null===ce?[]:[].concat(ce.list),V(N+'_'+ge+'Id_list_read',ce),-1<ue.indexOf(_e)}catch(ce){return localStorage.setItem(N+'_'+ge+'Id_list',JSON.stringify({list:ue})),V('\u8BFB\u53D6'+(N+'_'+ge+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ue.indexOf(_e)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(_e,ge,ue){var ce=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(V('\u793C\u7269\u4FE1\u606F',ge),le.GIFT_COUNT.COUNT>=le.CONFIG.MAX_GIFT)return V('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(le.max_blocked=!0);switch(ue){case'gift':if(le.Id_list_history.isIn(ge.raffleId,'raffle'))return void V('\u793C\u7269\u91CD\u590D','raffleId '+ge.raffleId);le.raffleId_list.push(ge.raffleId),le.Id_list_history.add(ge.raffleId,'raffle');break;case'guard':if(le.Id_list_history.isIn(ge.id,'guard'))return void V('\u8230\u957F\u91CD\u590D','id '+ge.id);le.guardId_list.push(ge.id),le.Id_list_history.add(ge.id,'guard');break;case'pk':if(le.Id_list_history.isIn(ge.id,'pk'))return void V('pk\u91CD\u590D','id '+ge.id);le.pkId_list.push(ge.id),le.Id_list_history.add(ge.id,'pk');}var Ie=ge.time_wait||0;le.CONFIG.RANDOM_DELAY&&(Ie+=_Mathfloor(Math.random()*(le.CONFIG.RND_DELAY_END-le.CONFIG.RND_DELAY_START+1))+le.CONFIG.RND_DELAY_START);var pe=$('<div class=\'igiftMsg\'>'),Te=$('<div>'),fe=$('<div>'),Ee=$('#chat-history-list'),me=new Date;Te.text('['+ce+']'+ge.thank_text.split('<%')[1].split('%>')[0]+ge.thank_text.split('%>')[1]),pe.text(me.toLocaleString()),pe.append(Te),fe.css('color','red'),fe.text('\u7B49\u5F85\u62BD\u5956'),Te.append(fe),pe.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),Te.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),pe.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),!1==C?Ee.find('#chat-items').append(pe):Ee.find('#chat-items').append(pe.hide()),Ee.scrollTop(Ee.prop('scrollHeight'));var Oe=setInterval(function(){fe.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+Ie+'\u79D2'),0>=Ie&&(O(le.CONFIG.RANDOM_SKIP)?fe.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(fe.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===ue?le.gift_join(_e,ge.raffleId,ge.type).then(function(ve,xe){fe.text(ve),xe&&(-1<ve.indexOf('\u8FA3\u6761')?le.addGift(xe):-1<ve.indexOf('\u94F6\u74DC\u5B50')&&le.addSilver(xe)),le.raffleId_list.remove(ge.raffleId)}):'guard'===ue?le.guard_join(_e,ge.id).then(function(ve,xe){fe.text(ve),xe&&(-1<ve.indexOf('\u8FA3\u6761')?le.addGift(xe):-1<ve.indexOf('\u94F6\u74DC\u5B50')&&le.addSilver(xe)),le.guardId_list.remove(ge.id)}):'pk'===ue?le.pk_join(_e,ge.id).then(function(ve,xe){fe.text(ve),xe&&(-1<ve.indexOf('\u8FA3\u6761')?le.addGift(xe):-1<ve.indexOf('\u94F6\u74DC\u5B50')&&le.addSilver(xe)),le.pkId_list.remove(ge.id)}):void 0),fe.css('color','green'),clearInterval(Oe)),Ie--},1e3)},gift_join:function gift_join(_e,ge,ue){var ce=$.Deferred();return D.Lottery.Gift.join(_e,ge,ue).then(function(Ie){switch(V('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',Ie),Ie.code){case 0:Ie.data.award_text?ce.resolve(Ie.data.award_text,Ie.data.award_num):ce.resolve(Ie.data.award_name+'X'+Ie.data.award_num.toString(),Ie.data.award_num);break;default:-1<Ie.msg.indexOf('\u62D2\u7EDD')?!1==le.CONFIG.FORCE_LOTTERY?(le.blocked=!0,ce.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++M?le.gift_join(_e,ge,ue):(M=0,ce.resolve('[\u793C\u7269\u62BD\u5956](roomid='+_e+',id='+ge+',type='+ue+')'+Ie.msg)):ce.resolve('[\u793C\u7269\u62BD\u5956](roomid='+_e+',id='+ge+',type='+ue+')'+Ie.msg);}}),ce},guard_join:function guard_join(_e,ge){var ue=$.Deferred();return D.Lottery.Guard.join(_e,ge).then(function(ce){switch(V('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',ce),ce.code){case 0:ce.data.award_text?ue.resolve(ce.data.award_text,ce.data.award_num):ue.resolve(ce.data.award_name+'X'+ce.data.award_num.toString(),ce.data.award_num);break;default:-1<ce.msg.indexOf('\u62D2\u7EDD')?!1==le.CONFIG.FORCE_LOTTERY?(le.blocked=!0,ue.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++L?le.guard_join(_e,id):(L=0,ue.resolve('[\u793C\u7269\u62BD\u5956](roomid='+_e+',id='+raffleId+',type='+type+')'+ce.msg)):ue.resolve('[\u4E0A\u8239](roomid='+_e+',id='+ge+')'+ce.msg);}}),ue},pk_join:function pk_join(_e,ge){var ue=$.Deferred();return D.Lottery.Pk.join(_e,ge).then(function(ce){switch(V('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',ce),ce.code){case 0:ce.data.award_text?ue.resolve(ce.data.award_text,ce.data.award_num):ue.resolve(ce.data.award_name+'X'+ce.data.award_num.toString(),ce.data.award_num);break;default:-1<ce.msg.indexOf('\u62D2\u7EDD')?!1==le.CONFIG.FORCE_LOTTERY?(le.blocked=!0,ue.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++S?le.pk_join(_e,id):(S=0,ue.resolve('[\u793C\u7269\u62BD\u5956](roomid='+_e+',id='+raffleId+',type='+type+')'+ce.msg)):ue.resolve('[PK](roomid='+_e+',id='+ge+')'+ce.msg);}}),ue},GroupSign:{getGroups:function getGroups(){return D.Group.my_groups().then(function(_e){return(V('GroupSign.getGroups: API.Group.my_groups',_e),0===_e.code)?$.Deferred().resolve(_e.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+_e.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.GroupSign.getGroups()})})},signInList:function signInList(_e){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(ge>=_e.length)return $.Deferred().resolve();var ue=_e[ge];return ue.owner_uid==P.uid?GroupSign.signInList(_e,ge+1):D.Group.sign_in(ue.group_id,ue.owner_uid).then(function(ce){V('GroupSign.signInList: API.Group.sign_in',ce);var Ie=$.Deferred();if(0===ce.code)0<ce.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ue.group_id+',owner_uid='+ue.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+ce.data.add_num,'success'),Ie.resolve()):0==ce.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ue.group_id+',owner_uid='+ue.owner_uid+')\u5DF2\u7B7E\u5230','caution'),Ie.resolve()):Ie.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+ce.msg,'caution'),$.Deferred().reject();return $.when(le.GroupSign.signInList(_e,ge+1),Ie)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ue.group_id+',owner_uid='+ue.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.GroupSign.signInList(_e,ge)})})},run:function run(){try{return le.CONFIG.AUTO_GROUP_SIGN?ne(le.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=le.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(le.GroupSign.run,u(8,0)),$.Deferred().resolve()):le.GroupSign.getGroups().then(function(_e){return le.GroupSign.signInList(_e).then(function(){return le.CACHE.AUTO_GROUP_SIGH_TS=k(),le.saveCache(),z(le.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return X(function(){return le.GroupSign.run()})})},function(){return X(function(){return le.GroupSign.run()})}):(z(le.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(_e){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',_e),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return D.DailyReward.login().then(function(){V('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.DailyReward.login()})})},watch:function watch(_e,ge){return le.CONFIG.WATCH?D.DailyReward.watch(_e,ge,P.uid,B()).then(function(ue){V('DailyReward.watch: API.DailyReward.watch',ue),0===ue.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+_e+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+ue.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.DailyReward.watch(_e,ge)})}):$.Deferred().resolve()},coin:function coin(_e,ge){var ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,ce=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!le.CONFIG.COIN)return $.Deferred().resolve();if(le.DailyReward.coin_exp>=10*le.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(ue>=_e.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var Ie=JSON.parse(_e[ue].card),pe=_Mathmin(2,ge);ce&&(pe=1),D.x.getCoinInfo('','jsonp',Ie.aid,k()).then(function(Te){return 2===Te.data.multiply?(V('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+Ie.aid),le.DailyReward.coin(vlist,ge,ue+1)):D.DailyReward.coin(Ie.aid,pe).then(function(fe){return(V('DailyReward.coin: API.DailyReward.coin',fe),0===fe.code)?(le.DailyReward.coin_exp+=10*pe,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+Ie.aid+',num='+pe+')','success'),le.DailyReward.coin(_e,ge-pe,ue+1)):-110===fe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===fe.code?ce?le.DailyReward.coin(_e,ge,ue+1):le.DailyReward.coin(_e,ge,ue,!0):34005===fe.code?le.DailyReward.coin(_e,ge,ue+1):-104===fe.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+fe.msg,'caution'),le.DailyReward.coin(_e,ge,ue+1))},function(){return X(function(){return le.DailyReward.coin(_e,ge,ue)})})})},coin_uid:function coin_uid(_e,ge,ue,ce){var Ie=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,pe=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!le.CONFIG.COIN)return $.Deferred().resolve();if(le.DailyReward.coin_exp>=10*le.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();Ie>=_e.length&&le.DailyReward.UserSpace(le.CONFIG.COIN_UID,30,0,ue++,'','pubdate','jsonp');var Te=_e[Ie];if(1===Te.is_union_video||Te.mid!=ce)return V('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+Te.aid),le.DailyReward.coin_uid(_e,ge,ue,ce,Ie+1);var fe=_Mathmin(2,ge);pe&&(fe=1),D.x.getCoinInfo('','jsonp',Te.aid,k()).then(function(Ee){return 2===Ee.data.multiply?(V('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+Te.aid),le.DailyReward.coin_uid(_e,ge,ue,ce,Ie+1)):D.DailyReward.coin(Te.aid,fe).then(function(me){return(V('DailyReward.coin_uid: API.DailyReward.coin_uid',me),0===me.code)?(le.DailyReward.coin_exp+=10*fe,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+Te.aid+',num='+fe+')','success'),le.DailyReward.coin_uid(_e,ge-fe,ue,ce,Ie+1)):-110===me.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===me.code?pe?le.DailyReward.coin_uid(_e,ge,ue,ce,Ie+1):le.DailyReward.coin_uid(_e,ge,Ie,ue,ce,!0):34005===me.code?le.DailyReward.coin_uid(_e,ge,ue,ce,Ie+1):-104===me.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+me.msg,'caution'),le.DailyReward.coin_uid(_e,ge,ue,ce,Ie+1))},function(){return X(function(){return le.DailyReward.coin_uid(_e,ge,ue,ce,Ie)})})})},share:function share(_e){return le.CONFIG.SHARE?D.DailyReward.share(_e).then(function(ge){V('DailyReward.share: API.DailyReward.share',ge),0===ge.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+_e+')','success'):71000===ge.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+ge.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.DailyReward.share(_e)})}):$.Deferred().resolve()},dynamic:function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(){var ue,ce;return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return ue=void 0,ce=le.CONFIG.COIN_NUMBER-le.DailyReward.coin_exp/10,pe.next=4,D.getuserinfo().then(function(Te){return V('DailyReward.dynamic: API.getuserinfo',Te),Te.data.biliCoin<ce?Te.data.biliCoin:ce});case 4:if(ue=pe.sent,0!==ue){pe.next=9;break}return pe.abrupt('return',$.Deferred().resolve());case 9:ue<ce&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+ue+'\u4E2A\u5E01','warning');case 10:;return pe.abrupt('return',D.dynamic_svr.dynamic_new(P.uid,8).then(function(Te){if(V('DailyReward.dynamic: API.dynamic_svr.dynamic_new',Te),0===Te.code){if(!!Te.data.cards){var me,fe=JSON.parse(Te.data.cards[0].card),Ee=le.DailyReward.watch(fe.aid,fe.cid);me=0==le.CONFIG.COIN_UID||'COIN_DYN'==le.CONFIG.COIN_TYPE?le.DailyReward.coin(Te.data.cards,_Mathmax(ue,0)):le.DailyReward.UserSpace(le.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var Oe=le.DailyReward.share(fe.aid);return $.when(Ee,me,Oe)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+Te.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.DailyReward.dynamic()})}));case 12:case'end':return pe.stop();}},ge,se)}));return function dynamic(){return _e.apply(this,arguments)}}(),UserSpace:function UserSpace(_e,ge,ue,ce,Ie,pe,Te){return D.x.getUserSpace(_e,ge,ue,ce,Ie,pe,Te).then(function(fe){if(V('DailyReward.UserSpace: API.dynamic_svr.UserSpace',fe),0===fe.code){if(!!fe.data.list.vlist){var Ee=le.CONFIG.COIN_NUMBER-le.DailyReward.coin_exp/10,me=le.DailyReward.coin_uid(fe.data.list.vlist,_Mathmax(Ee,0),ce,_e);return me}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+fe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.DailyReward.UserSpace(_e,ge,ue,ce,Ie,pe,Te)})})},run:function run(){try{return ne(le.CACHE.DailyReward_TS)?D.DailyReward.exp().then(function(_e){return V('DailyReward.run: API.DailyReward.exp',_e),0===_e.code?(le.DailyReward.coin_exp=_e.number,le.DailyReward.login(),le.DailyReward.dynamic().then(function(){le.CACHE.DailyReward_TS=k(),le.saveCache(),K(le.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+_e.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.DailyReward.run()})}):(K(le.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(_e){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',_e),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return D.xlive.dosign().then(function(_e){V('LiveReward.dailySignIn: API.xlive.dosign',_e),0===_e.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===_e.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+_e.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.LiveReward.dailySignIn()})})},run:function run(){try{if(!le.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!ne(le.CACHE.LiveReward_TS))return K(le.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();le.LiveReward.dailySignIn(),le.CACHE.LiveReward_TS=k(),le.saveCache(),K(le.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(_e){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',_e),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return D.Exchange.silver2coin().then(function(_e){V('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',_e),0===_e.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+_e.msg,'success'):403===_e.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+_e.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+_e.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return le.CONFIG.SILVER2COIN?ne(le.CACHE.Silver2Coin_TS)?le.Exchange.silver2coin().then(function(){le.CACHE.Silver2Coin_TS=k(),le.saveCache(),K(le.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return X(function(){return le.Exchange.runS2C()})}):(K(le.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(_e){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',_e),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!le.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var _e=$.Deferred();return Y(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),_e.resolve(),!0;var ge=$('#gift-control-vm div.treasure-box.p-relative');if(!ge.length)return!1;ge=ge.first(),ge.attr('id','old_treasure_box'),ge.hide();var ue=$('<div id="'+N+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');le.TreasureBox.DOM.div_tip=$('<div id="'+N+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),le.TreasureBox.DOM.div_timer=$('<div id="'+N+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),le.TreasureBox.DOM.image=$('<img id="'+N+'_treasure_image" style="display:none">'),le.TreasureBox.DOM.canvas=$('<canvas id="'+N+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var ce='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';le.TreasureBox.DOM.div_tip[0].style=ce,le.TreasureBox.DOM.div_timer[0].style=ce,ue.append(le.TreasureBox.DOM.div_tip),ue.append(le.TreasureBox.DOM.image),ue.append(le.TreasureBox.DOM.canvas),le.TreasureBox.DOM.div_tip.after(le.TreasureBox.DOM.div_timer),ge.after(ue);try{if(OCRAD);}catch(Ie){return le.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+N+']',Ie),_e.resolve(),!0}return le.TreasureBox.timer=setInterval(function(){var Ie=parseInt(le.TreasureBox.DOM.div_timer.text(),10);isNaN(Ie)&&(Ie=0),0<Ie?le.TreasureBox.DOM.div_timer.text(Ie-1+'s'):le.TreasureBox.DOM.div_timer.hide()},1e3),le.TreasureBox.DOM.image[0].onload=function(){var Ie=le.TreasureBox.DOM.canvas[0].getContext('2d');Ie.font='40px agencyfbbold',Ie.textBaseline='top',Ie.clearRect(0,0,le.TreasureBox.DOM.canvas[0].width,le.TreasureBox.DOM.canvas[0].height),Ie.drawImage(le.TreasureBox.DOM.image[0],0,0);var pe=le.TreasureBox.captcha.OCR.getGrayscaleMap(Ie),Te=le.TreasureBox.captcha.OCR.orderFilter2In3x3(pe);Ie.clearRect(0,0,120,40);for(var Ee,fe=0;fe<Te.length;++fe)Ee=Te[fe],Ie.fillStyle='rgb('+Ee+', '+Ee+', '+Ee+')',Ie.fillRect(fe%120,_Mathround(fe/120),1,1);try{var fe=le.TreasureBox.captcha.correctQuestion(OCRAD(Ie.getImageData(0,0,120,40)));V('TreasureBox.DOM.image.load','question =',fe);var Ee=le.TreasureBox.captcha.eval(fe);V('TreasureBox.DOM.image.load','answer =',Ee),void 0!==Ee&&(console.info('['+N+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+fe+' = '+Ee),le.TreasureBox.promise.calc.resolve(Ee))}catch(fe){le.TreasureBox.promise.calc.reject()}},_e.resolve(),!0}catch(ge){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',ge),_e.reject(),!0}}),_e},run:function run(){try{if(!le.CONFIG.AUTO_TREASUREBOX||!le.TreasureBox.timer)return;if(P.blocked)return le.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!ne(le.CACHE.TreasureBox_TS))return le.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void K(le.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');le.TreasureBox.getCurrentTask().then(function(_e){if(V('TreasureBox.run: TreasureBox.getCurrentTask().then',_e),0===_e.code){le.TreasureBox.promise.timer=$.Deferred(),le.TreasureBox.promise.timer.then(function(){le.TreasureBox.captcha.calc().then(function(ue){le.TreasureBox.getAward(ue).then(function(){return le.TreasureBox.run()},function(){return le.TreasureBox.run()})},function(){return TreasureBox.run()})}),le.TreasureBox.time_end=_e.data.time_end,le.TreasureBox.time_start=_e.data.time_start;var ge=le.TreasureBox.time_end-B()+1;0>ge&&(ge=0),setTimeout(function(){le.TreasureBox.promise.timer&&le.TreasureBox.promise.timer.resolve()},1e3*ge),le.TreasureBox.DOM.div_timer.text(ge+'s'),le.TreasureBox.DOM.div_timer.show(),le.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+_e.data.times+'/'+_e.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+_e.data.silver)}else if(-10017===_e.code)le.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),le.CACHE.TreasureBox_TS=k(),le.saveCache(),K(le.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===_e.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+_e.msg,'caution'),le.TreasureBox.run()})}catch(_e){le.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',_e)}},setMsg:function setMsg(_e){le.CONFIG.AUTO_TREASUREBOX&&(le.TreasureBox.promise.timer&&(le.TreasureBox.promise.timer.reject(),le.TreasureBox.promise.timer=void 0),le.TreasureBox.DOM.div_timer&&le.TreasureBox.DOM.div_timer.hide(),le.TreasureBox.DOM.div_tip&&le.TreasureBox.DOM.div_tip.html(_e))},getAward:function getAward(_e){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return le.CONFIG.AUTO_TREASUREBOX?3<ge?$.Deferred().resolve():D.TreasureBox.getAward(le.TreasureBox.time_start,le.TreasureBox.time_end,_e).then(function(ue){switch(V('TreasureBox.getAward: getAward',ue),ue.code){case 0:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+ue.data.awardSilver+' \u94F6\u74DC\u5B50','success');case-903:return $.Deferred().resolve();case-902:case-901:case-10017:return le.TreasureBox.captcha.calc().then(function(Ie){return le.TreasureBox.getAward(Ie,ge)});case-800:return le.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),$.Deferred().reject();case-500:var ce=$.Deferred();return setTimeout(function(){le.TreasureBox.captcha.calc().then(function(Ie){le.TreasureBox.getAward(Ie,ge+1).then(function(){return ce.resolve()},function(){return ce.reject()})},function(){return ce.reject()})},3e3),ce;case 400:return-1<ue.msg.indexOf('\u62D2\u7EDD')?(P.blocked=!0,le.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ue.msg,'caution'),$.Deferred().resolve());default:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ue.msg,'caution');}},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.TreasureBox.getAward(_e,ge)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return le.CONFIG.AUTO_TREASUREBOX?D.TreasureBox.getCurrentTask().then(function(_e){return V('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',_e),$.Deferred().resolve(_e)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return le.CONFIG.AUTO_TREASUREBOX?20<le.TreasureBox.captcha.cnt?(le.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):D.TreasureBox.getCaptcha(k()).then(function(_e){if(V('TreasureBox.captcha.calc: getCaptcha',_e),0===_e.code){le.TreasureBox.captcha.cnt++;var ge=$.Deferred();return le.TreasureBox.promise.calc=$.Deferred(),le.TreasureBox.promise.calc.then(function(ue){le.TreasureBox.captcha.cnt=0,ge.resolve(ue)},function(){le.TreasureBox.captcha.calc().then(function(ue){ge.resolve(ue)},function(){ge.reject()})}),le.TreasureBox.DOM.image.attr('src',_e.data.img),ge}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+_e.msg,'caution'),X(function(){return le.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.TreasureBox.captcha.calc()})}):(le.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(_e){for(var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,ce=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,Ie=_e.getImageData(0,0,ue,ce).data,pe=[],Te=0;Te<ce;Te++)for(var fe=0;fe<ue;fe++){var Ee=4*(Te*ue+fe),me=Ie.slice(Ee,Ee+4),Oe=me?77*me[0]+150*me[1]+29*me[2]+128>>8:0;pe.push(Oe>ge?Oe:0)}return pe},orderFilter2In3x3:function orderFilter2In3x3(_e){for(var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,ce=function gray(Oe,ve){return 0<=Oe+ve*ue?_e[Oe+ve*ue]:255},Ie=[],pe=_e.length,Oe=0;Oe<pe;++Oe){var fe=[Oe%ue,_Mathfloor(Oe/ue)],Ee=fe[0],me=fe[1],ve=Array(9);ve[0]=ce(Ee-1,me-1),ve[1]=ce(Ee+0,me-1),ve[2]=ce(Ee+1,me-1),ve[3]=ce(Ee-1,me+0),ve[4]=ce(Ee+0,me+0),ve[5]=ce(Ee+1,me+0),ve[6]=ce(Ee-1,me+1),ve[7]=ce(Ee+0,me+1),ve[8]=ce(Ee+1,me+1),ve.sort(function(xe,Re){return xe-Re}),Ie.push(ve[ge-1])}return Ie}},eval:function _eval(_e){var ge=Function;return new ge('return '+_e)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(_e){var ge='';for(var ue in _e=_e.trim(),_e){var ce=le.TreasureBox.captcha.correctStr[_e[ue]];ge+=void 0===ce?_e[ue]:ce}'4'===ge[2]&&(ge[2]='+');for(var ue=0;ue<=parseInt(ge.length-2);ue++)'\''===ge[ue]&&'1'===ge[ue+1]&&(ge[ue]='7',ge.splice(ue+1,1));return ge}}},Gift:(de={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(de,'run_timer',void 0),_defineProperty(de,'sendGiftList',[1,6,30607]),_defineProperty(de,'getMedalList',function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(){var ue=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return 1===ue&&(le.Gift.medal_list=[]),Ie.next=3,D.i.medal(ue,25).then(function(pe){if(V('Gift.getMedalList: API.i.medal',pe),le.Gift.medal_list=le.Gift.medal_list.concat(pe.data.fansMedalList),pe.data.pageinfo.curPage<pe.data.pageinfo.totalpages)return le.Gift.getMedalList(ue+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.Gift.getMedalList()})});case 3:return Ie.abrupt('return',Ie.sent);case 4:case'end':return Ie.stop();}},ge,se)}));return function getMedalList(){return _e.apply(this,arguments)}}()),_defineProperty(de,'getBagList',function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(){return regeneratorRuntime.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,D.gift.bag_list().then(function(Ie){V('Gift.getBagList: API.gift.bag_list',Ie),le.Gift.bag_list=Ie.data.list,le.Gift.time=Ie.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.Gift.getBagList()})});case 2:return ce.abrupt('return',ce.sent);case 3:case'end':return ce.stop();}},ge,se)}));return function getBagList(){return _e.apply(this,arguments)}}()),_defineProperty(de,'getFeedByGiftID',function getFeedByGiftID(_e){for(var ge=P.gift_list.length-1;0<=ge;--ge)if(P.gift_list[ge].id===_e)return Math.ceil(P.gift_list[ge].price/100);return 0}),_defineProperty(de,'sort_medals',function sort_medals(_e){if(le.CONFIG.GIFT_SORT?_e.sort(function(fe,Ee){return 0==Ee.level-fe.level?Ee.intimacy-fe.intimacy:Ee.level-fe.level}):_e.sort(function(fe,Ee){return 0==fe.level-Ee.level?fe.intimacy-Ee.intimacy:fe.level-Ee.level}),le.CONFIG.AUTO_GIFT_ROOMID&&0<le.CONFIG.AUTO_GIFT_ROOMID.length){var fe=le.CONFIG.AUTO_GIFT_ROOMID.split(',');fe.reverse();var ge=!0,ue=!1,ce=void 0;try{for(var Te,Ie=function _loop2(){var Ee=Te.value,me=_e.findIndex(function(Oe){return Oe.roomid==Ee});if(-1!=me){var Oe=_e[me];_e.splice(me,1),_e.unshift(Oe)}},pe=fe[Symbol.iterator]();!(ge=(Te=pe.next()).done);ge=!0)Ie()}catch(Ee){ue=!0,ce=Ee}finally{try{!ge&&pe.return&&pe.return()}finally{if(ue)throw ce}}}return _e}),_defineProperty(de,'auto_light',function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(ue){var ce,Ie,pe,Te,fe,Ee,me,Oe,ve,xe,Re,Ge,Ce,he,Ae,Ne;return regeneratorRuntime.wrap(function(De){for(;;)switch(De.prev=De.next){case 0:De.prev=0,ce=le.Gift.getFeedByGiftID(30607),Ie=le.CONFIG.LIGHT_MEDALS.split(','),pe=void 0,pe='LIGHT_WHITE'==le.CONFIG.LIGHT_METHOD?ue.filter(function(Me){return 0==Me.is_lighted&&Me.day_limit-Me.today_feed>=ce&&0<=Ie.findIndex(function(be){return be==Me.roomid})}):ue.filter(function(Me){return 0==Me.is_lighted&&Me.day_limit-Me.today_feed>=ce&&-1==Ie.findIndex(function(be){return be==Me.roomid})});;if(V('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',pe),!(pe&&0<pe.length)){De.next=52;break}return pe=le.Gift.sort_medals(pe),De.next=11,le.Gift.getBagList();case 11:if(Te=le.Gift.bag_list.filter(function(Me){return 30607==Me.gift_id}),!(Te&&0<Te.length)){De.next=52;break}fe=!0,Ee=!1,me=void 0,De.prev=16,Oe=pe[Symbol.iterator]();case 18:if(fe=(ve=Oe.next()).done){De.next=38;break}if(xe=ve.value,Re=Te.find(function(Me){return 30607==Me.gift_id&&0<Me.gift_num}),!Re){De.next=34;break}if(Ge=xe.day_limit-xe.today_feed,!(0<=Ge-ce||le.CONFIG.FORCE_LIGHT)){De.next=33;break}return De.next=26,D.room.room_init(parseInt(xe.roomid,10));case 26:return Ce=De.sent,he=parseInt(Ce.data.room_id,10),Ae=1,De.next=31,D.gift.bag_send(P.uid,30607,xe.target_id,Ae,Re.bag_id,he,P.rnd);case 31:Ne=De.sent,0===Ne.code?(Re.gift_num-=Ae,xe.today_feed+=Ae*ce,Ge-=Ae*ce,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+xe.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Ae+'\u4E2A'+Re.gift_name+'\uFF0C['+xe.today_feed+'/'+xe.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+Ge+']','success'),V('Gift.auto_light','\u52CB\u7AE0['+xe.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+Ae+'\u4E2A'+Re.gift_name+'\uFF0C['+xe.today_feed+'/'+xe.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+xe.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+Ce.msg+'\u3011','caution');case 33:return De.abrupt('continue',35);case 34:return De.abrupt('break',38);case 35:fe=!0,De.next=18;break;case 38:De.next=44;break;case 40:De.prev=40,De.t0=De['catch'](16),Ee=!0,me=De.t0;case 44:De.prev=44,De.prev=45,!fe&&Oe.return&&Oe.return();case 47:if(De.prev=47,!Ee){De.next=50;break}throw me;case 50:return De.finish(47);case 51:return De.finish(44);case 52:De.next=58;break;case 54:De.prev=54,De.t1=De['catch'](0),console.error(De.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+De.t1,'error');case 58:case'end':return De.stop();}},ge,se,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return _e.apply(this,arguments)}}()),_defineProperty(de,'run',function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(){var ue,ce,Ie,pe,Te,fe,Ee,me,Oe,ve,xe,Re,Ge,Ce;return regeneratorRuntime.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:if(ue=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.Gift.run()})},ce=function nextTimeDebug(){if('GIFT_SEND_TIME'==le.CONFIG.GIFT_METHOD){var Ne=u(le.CONFIG.GIFT_SEND_HOUR,le.CONFIG.GIFT_SEND_MINUTE);le.Gift.run_timer=setTimeout(le.Gift.run,Ne);var ye=new Date(k()+Ne).toLocaleString();V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+ye+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),le.CACHE.Gift_TS=k(),le.saveCache()}else V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+le.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),le.CACHE.GiftInterval_TS=k(),le.saveCache()},Ae.prev=2,le.CONFIG.AUTO_GIFT){Ae.next=5;break}return Ae.abrupt('return',$.Deferred().resolve());case 5:if(le.Gift.run_timer&&clearTimeout(le.Gift.run_timer),'GIFT_SEND_TIME'!=le.CONFIG.GIFT_METHOD||T(le.CONFIG.GIFT_SEND_HOUR,le.CONFIG.GIFT_SEND_MINUTE)||!1!=F){Ae.next=14;break}return Ie=u(le.CONFIG.GIFT_SEND_HOUR,le.CONFIG.GIFT_SEND_MINUTE),le.Gift.run_timer=setTimeout(le.Gift.run,Ie),pe=new Date(k()+Ie).toLocaleString(),V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+pe+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ae.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=le.CONFIG.GIFT_METHOD||!1!=F){Ae.next=27;break}if(Te=6e4*le.CONFIG.GIFT_INTERVAL,!le.CACHE.GiftInterval_TS){Ae.next=25;break}if(fe=k()-le.CACHE.GiftInterval_TS,!(fe<Te)){Ae.next=23;break}return Ee=Te-fe,le.Gift.run_timer=setTimeout(function(){return le.Gift.run()},Ee),V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ee+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),Ae.abrupt('return');case 23:Ae.next=27;break;case 25:le.CACHE.GiftInterval_TS=k(),le.saveCache();case 27:return le.Gift.over=!1,Ae.next=30,le.Gift.getMedalList();case 30:if(me=le.Gift.medal_list,V('Gift.run: Gift.getMedalList().then: Gift.medal_list',me),!(me&&0<me.length)){Ae.next=34;break}return Ae.delegateYield(regeneratorRuntime.mark(function Ne(){var ye,De,Me,be,Le,Se,Fe,we,Ue;return regeneratorRuntime.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:me=me.filter(function(Be){return 0<Be.day_limit-Be.today_feed&&20>Be.level}),me=le.Gift.sort_medals(me),le.CONFIG.EXCLUDE_ROOMID&&0<le.CONFIG.EXCLUDE_ROOMID.length&&(ArrayEXCLUDE_ROOMID=le.CONFIG.EXCLUDE_ROOMID.split(','),me=me.filter(function(Be){return-1==ArrayEXCLUDE_ROOMID.findIndex(function(Pe){return Pe==Be.roomid})}));;return ke.next=6,le.Gift.auto_light(me);case 6:ye=86400*le.CONFIG.GIFT_LIMIT,De=!0,Me=!1,be=void 0,ke.prev=10,Le=me[Symbol.iterator]();case 12:if(De=(Se=Le.next()).done){ke.next=28;break}return Fe=Se.value,ke.next=16,D.room.room_init(parseInt(Fe.roomid,10));case 16:if(we=ke.sent,le.Gift.room_id=parseInt(we.data.room_id,10),le.Gift.ruid=Fe.target_id,le.Gift.remain_feed=Fe.day_limit-Fe.today_feed,!(0<le.Gift.remain_feed)){ke.next=25;break}return ke.delegateYield(regeneratorRuntime.mark(function Be(){var Pe,je,Ye;return regeneratorRuntime.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,le.Gift.getBagList();case 2:if(Pe=B(),le.CONFIG.SEND_ALL_GIFT){Ve.next=7;break}if(je=le.Gift.bag_list.filter(function(Ke){return le.Gift.sendGiftList.includes(Ke.gift_id)&&0<Ke.gift_num&&Ke.expire_at>Pe&&Ke.expire_at-Pe<ye}),0!=je.length){Ve.next=7;break}return Ve.abrupt('return','break');case 7:;if(!(0<le.Gift.remain_feed)){Ve.next=21;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Fe.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+Fe.today_feed+'/'+Fe.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+le.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Ve.next=12,le.Gift.sendGift(Fe);case 12:if(le.CONFIG.SEND_ALL_GIFT){Ve.next=19;break}if(Ye=le.Gift.bag_list.filter(function(Ke){return le.Gift.sendGiftList.includes(Ke.gift_id)&&0<Ke.gift_num&&Ke.expire_at>Pe&&Ke.expire_at-Pe<ye}),0!=Ye.length){Ve.next=18;break}return Ve.abrupt('return','break');case 18:le.Gift.bag_list=Ye;case 19:Ve.next=22;break;case 21:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Fe.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 22:case'end':return Ve.stop();}},Be,se)})(),'t0',22);case 22:if(Ue=ke.t0,'break'!==Ue){ke.next=25;break}return ke.abrupt('break',28);case 25:De=!0,ke.next=12;break;case 28:ke.next=34;break;case 30:ke.prev=30,ke.t1=ke['catch'](10),Me=!0,be=ke.t1;case 34:ke.prev=34,ke.prev=35,!De&&Le.return&&Le.return();case 37:if(ke.prev=37,!Me){ke.next=40;break}throw be;case 40:return ke.finish(37);case 41:return ke.finish(34);case 42:case'end':return ke.stop();}},Ne,se,[[10,30,34,42],[35,,37,41]])})(),'t0',34);case 34:return Ae.next=36,le.Gift.getBagList();case 36:Oe=0,Oe=0;case 38:if(!(Oe<=le.Gift.bag_list.length-1)){Ae.next=44;break}if(1!=le.Gift.bag_list[Oe].gift_id){Ae.next=41;break}return Ae.abrupt('break',44);case 41:Oe++,Ae.next=38;break;case 44:if(ve=le.Gift.bag_list[Oe],void 0!=ve){Ae.next=49;break}return F=!1,ce(),Ae.abrupt('return',$.Deferred().resolve());case 49:if(xe=le.Gift.getFeedByGiftID(ve.gift_id),Re=86400,Ge=B(),!(0!=le.Gift.bag_list.filter(function(Ne){return le.Gift.sendGiftList.includes(Ne.gift_id)&&0<Ne.gift_num&&Ne.expire_at>Ge&&Ne.expire_at-Ge<Re}).length&&ve.expire_at>le.Gift.time&&ve.expire_at-le.Gift.time<Re&&'0'!=le.CONFIG.SPARE_GIFT_ROOM&&'0'!=le.CONFIG.SPARE_GIFT_UID&&0<xe)){Ae.next=55;break}return Ce=ve.gift_num,Ae.abrupt('return',D.gift.bag_send(P.uid,ve.gift_id,le.CONFIG.SPARE_GIFT_UID,Ce,ve.bag_id,le.CONFIG.SPARE_GIFT_ROOM,P.rnd).then(function(Ne){V('Gift.sendGift(\u5269\u4F59\u793C\u7269): API.gift.bag_send',Ne),0===Ne.code?window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+le.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ce+'\u4E2A'+ve.gift_name,'success'):window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+le.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u5F02\u5E38:'+Ne.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.Gift.sendGift(medal)})}));case 55:Ae.next=63;break;case 57:return Ae.prev=57,Ae.t1=Ae['catch'](2),ue(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+N+']',Ae.t1),Ae.abrupt('return',$.Deferred().reject());case 63:return F=!1,ce(),Ae.abrupt('return',$.Deferred().resolve());case 66:case'end':return Ae.stop();}},ge,se,[[2,57]])}));return function run(){return _e.apply(this,arguments)}}()),_defineProperty(de,'sendGift',function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(ue){var ce,Ie,pe,Te,fe,Ee,me,Oe,ve;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:return Re.next=2,le.Gift.getBagList();case 2:if(!(0>=le.Gift.remain_feed)){Re.next=5;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ue.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+ue.today_feed+'/'+ue.day_limit+']','info'),Re.abrupt('return',$.Deferred().resolve());case 5:if(0>=le.Gift.time&&(le.Gift.time=B()),le.CONFIG.SEND_ALL_GIFT){Re.next=16;break}if(ce=le.Gift.bag_list.filter(function(Ge){return le.Gift.sendGiftList.includes(Ge.gift_id)&&0<Ge.gift_num&&Ge.expire_at>le.Gift.time&&Ge.expire_at-le.Gift.time<86400*le.CONFIG.GIFT_LIMIT&&'\u6C38\u4E45'!=Ge.corner_mark}),0!=ce.length){Re.next=13;break}return le.Gift.over=!0,Re.abrupt('return');case 13:le.bag_list=ce;case 14:Re.next=23;break;case 16:if(Ie=le.Gift.bag_list.filter(function(Ge){return 0<Ge.gift_num&&'\u6C38\u4E45'!=Ge.corner_mark}),0!=Ie.length){Re.next=22;break}return le.Gift.over=!0,Re.abrupt('return');case 22:le.bag_list=Ie;case 23:pe=!0,Te=!1,fe=void 0,Re.prev=26,Ee=function _loop3(){var Ge=Oe.value;if(0>=ue.day_limit-ue.today_feed)return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ue.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+ue.today_feed+'/'+ue.day_limit+']','info'),{v:void 0};var Ce=le.Gift.getFeedByGiftID(Ge.gift_id);if(0<Ce){var he=_Mathfloor(le.Gift.remain_feed/Ce);if(he>Ge.gift_num&&(he=Ge.gift_num),0<he)return{v:D.gift.bag_send(P.uid,Ge.gift_id,le.Gift.ruid,he,Ge.bag_id,le.Gift.room_id,P.rnd).then(function(Ae){V('Gift.sendGift: API.gift.bag_send',Ae),0===Ae.code?(Ge.gift_num-=he,ue.today_feed+=he*Ce,le.Gift.remain_feed-=he*Ce,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ue.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+he+'\u4E2A'+Ge.gift_name+'\uFF0C['+ue.today_feed+'/'+ue.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+le.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ue.medalName+'] \u9001\u793C\u5F02\u5E38:'+Ae.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.Gift.sendGift(ue)})})}}},me=le.Gift.bag_list[Symbol.iterator]();case 29:if(pe=(Oe=me.next()).done){Re.next=36;break}if(ve=Ee(),'object'!==('undefined'==typeof ve?'undefined':_typeof(ve))){Re.next=33;break}return Re.abrupt('return',ve.v);case 33:pe=!0,Re.next=29;break;case 36:Re.next=42;break;case 38:Re.prev=38,Re.t0=Re['catch'](26),Te=!0,fe=Re.t0;case 42:Re.prev=42,Re.prev=43,!pe&&me.return&&me.return();case 45:if(Re.prev=45,!Te){Re.next=48;break}throw fe;case 48:return Re.finish(45);case 49:return Re.finish(42);case 50:case'end':return Re.stop();}},ge,se,[[26,38,42,50],[43,,45,49]])}));return function sendGift(){return _e.apply(this,arguments)}}()),de),MobileHeartBeat:{run:function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(){var ue,ce,Ie,pe;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(!1!=le.CONFIG.MOBILE_HEARTBEAT){fe.next=2;break}return fe.abrupt('return',$.Deferred().resolve());case 2:if(ne(le.CACHE.MobileHeartBeat_TS)){fe.next=5;break}return K(le.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),fe.abrupt('return',$.Deferred().resolve());case 5:if(!1!==P.mobile_verify){fe.next=9;break}return window.toast('[\u79FB\u52A8\u7AEF\u5FC3\u8DF3]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','warning'),V('MobileHeartBeat','\u672A\u7ED1\u5B9A\u624B\u673A mobile_verify = '+P.mobile_verify),fe.abrupt('return',$.Deferred().resolve());case 9:return ue=function mobileOnline(){R({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+te.access_token+'&'+J),data:'room_id='+P.room_id+'&scale=xxhdpi',responseType:'json',headers:Z.headers})},ce=function EndFunc(Ee){V('MobileHeartBeat GetAward',Ee),clearInterval(pe),le.CACHE.MobileHeartBeat_TS=k(),le.saveCache(),K(le.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3')},Ie=function getWatchingAward(){D.activity.receive_award('double_watch_task').then(function(Ee){return 0===Ee.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u6210\u529F','success'),ce(Ee),$.Deferred().resolve()):-400===Ee.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u5DF2\u9886\u53D6','info'),ce(Ee),$.Deferred().resolve()):(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]'+Ee,'warning'),ce(Ee),$.Deferred().resolve())},function(Ee){return window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('MobileHeartBeat GetAward',Ee),clearInterval(pe),X(function(){return le.MobileHeartBeat.run()})})},fe.next=14,ie();case 14:if(fe.t1=fe.sent,fe.t2=void 0,fe.t0=fe.t1===fe.t2,!fe.t0){fe.next=19;break}fe.t0=void 0===te.access_token;case 19:if(!fe.t0){fe.next=22;break}return V('MobileHeartBeat','token\u8BBE\u7F6E\u5931\u8D25'),fe.abrupt('return');case 22:V('MobileHeartBeat','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),ue(),pe=void 0,pe=setInterval(function(){return ue()},300000),setTimeout(function(){return Ie()},360000);case 27:case'end':return fe.stop();}},ge,se)}));return function run(){return _e.apply(this,arguments)}}()},stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(_e){var ge=[];try{var ue=JSON.parse(localStorage.getItem(N+'stormIdSet'));ge=[].concat(ue.list),ge.push(_e),50<ge.length&&ge.splice(0,10),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:ge})),V(N+'storm_Id_list_add',ge)}catch(ue){ge.push(_e),localStorage.setItem(N+'stormIdSet',JSON.stringify({list:ge}))}},isIn:function isIn(_e){var ge=[];try{var ue=JSON.parse(localStorage.getItem(N+'stormIdSet'));return ge=null===ue?[]:[].concat(ue.list),V(N+'storm_Id_list_read',ue),-1<ge.indexOf(_e)}catch(ue){return localStorage.setItem(N+'stormIdSet',JSON.stringify({list:ge})),V('\u8BFB\u53D6'+(N+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ge.indexOf(_e)}}},Storm:{check:function check(_e){return-1<le.stormQueue.indexOf(_e)},append:function append(_e){le.stormQueue.push(_e),le.stormQueue.length>le.CONFIG.STORM_QUEUE_SIZE&&le.stormQueue.shift()},over:function over(_e){var ge=le.stormQueue.indexOf(_e);-1<ge&&le.stormQueue.splice(_e,1)},run:function run(_e){try{return le.CONFIG.STORM?le.stormBlack?$.Deferred().resolve():f(le.CONFIG.TIME_AREA_START_H0UR,le.CONFIG.TIME_AREA_END_H0UR,le.CONFIG.TIME_AREA_START_MINUTE,le.CONFIG.TIME_AREA_END_MINUTE)&&le.CONFIG.TIME_AREA_DISABLE?(V('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+_e),$.Deferred().resolve()):D.Storm.check(_e).then(function(ge){if(V('MY_API.Storm.run: MY_API.API.Storm.check',ge),0===ge.code){var ue=ge.data;return le.Storm.join(ue.id,ue.roomid,_Mathround(new Date().getTime()/1e3)+ue.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+_e+')'+ge.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+_e+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(ge){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+N+']',ge),$.Deferred().reject()}},join:function join(_e,ge,ue){var ce=function(){var fe=_asyncToGenerator(regeneratorRuntime.mark(function Ee(){var me,Oe;return regeneratorRuntime.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(xe.prev=0,le.Storm.check(_e)){xe.next=4;break}return clearInterval(pe),xe.abrupt('return');case 4:if(me=_Mathround(new Date().getTime()/1e3),!(me>ue&&0<ue)){xe.next=9;break}return le.Storm.over(_e),clearInterval(pe),xe.abrupt('return');case 9:if(Te++,!(Te>le.CONFIG.STORM_MAX_COUNT&&0<le.CONFIG.STORM_MAX_COUNT)){xe.next=15;break}return le.Storm.over(_e),clearInterval(pe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ge+',id='+_e+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+Te+',\u8DDD\u79BB\u5230\u671F:'+(ue-me)+'s','caution'),xe.abrupt('return');case 15:if(Oe=void 0,xe.prev=16,!(ee&&Z&&te.access_token)){xe.next=23;break}return xe.next=20,D.Storm.join_ex(_e,ge,te.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:Oe=xe.sent,xe.next=26;break;case 23:return xe.next=25,D.Storm.join(_e,captcha_token='',captcha_phrase='',ge);case 25:Oe=xe.sent;case 26:if(V('MY_API.Storm.join: MY_API.API.Storm.join',Oe),!Oe.code){xe.next=51;break}if(-1==Oe.msg.indexOf('\u9886\u53D6')){xe.next=33;break}return le.Storm.over(_e),clearInterval(pe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+ge+',id='+_e+')\u6210\u529F,'+Oe.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+Te,'success'),xe.abrupt('return');case 33:if(-1==Oe.msg.indexOf('\u9A8C\u8BC1\u7801')){xe.next=39;break}return le.Storm.over(_e),clearInterval(pe),le.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ge+',id='+_e+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+Oe.msg,'caution'),xe.abrupt('return');case 39:if(!(Oe.data&&0==Oe.data.length&&-1!=Oe.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){xe.next=46;break}return le.Storm.over(_e),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ge+',id='+_e+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(pe),le.stormBlack=!0,setTimeout(function(){le.stormBlack=!1},3600000),xe.abrupt('return');case 46:if(-1!=Oe.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){xe.next=49;break}return clearInterval(pe),xe.abrupt('return');case 49:xe.next=56;break;case 51:return le.Storm.over(_e),Statistics.appendGift(Oe.data.gift_name,Oe.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+ge+',id='+_e+')\u6210\u529F,'+(Oe.data.gift_name+'x'+Oe.data.gift_num)+'\r\n'+Oe.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+Te,'success'),clearInterval(pe),xe.abrupt('return');case 56:xe.next=65;break;case 58:return xe.prev=58,xe.t0=xe['catch'](16),le.Storm.over(_e),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ge+',id='+_e+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+Te,'error'),console.error(xe.t0),clearInterval(pe),xe.abrupt('return');case 65:xe.next=74;break;case 67:return xe.prev=67,xe.t1=xe['catch'](0),le.Storm.over(_e),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ge+',id='+_e+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(xe.t1),clearInterval(pe),xe.abrupt('return');case 74:case'end':return xe.stop();}},Ee,this,[[0,67],[16,58]])}));return function(){return fe.apply(this,arguments)}}();if(ge=parseInt(ge,10),_e=parseInt(_e,10),isNaN(ge)||isNaN(_e))return $.Deferred().reject();var Ie=_Mathround(_e/1e6);if(le.stormIdSet.isIn(Ie))return $.Deferred().resolve();if(le.stormIdSet.add(Ie),!le.Storm.check(_e)){le.Storm.append(_e);var pe=0;0>=ue&&(ue=_Mathround(new Date().getTime()/1e3)+90);var Te=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+ge+',id='+_e+')','success'),pe=setInterval(function(){return ce()},le.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{medalRoom_list:[],liveRoom_list:[],getMedalRoomList:function getMedalRoomList(){var _e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 1===_e&&(le.LITTLE_HEART.medalRoom_list=[]),D.i.medal(_e,25).then(function(ge){V('LITTLE_HEART.getMedalRoomList: API.i.medal',ge);var ue=!0,ce=!1,Ie=void 0;try{for(var Te,fe,pe=ge.data.fansMedalList[Symbol.iterator]();!(ue=(Te=pe.next()).done);ue=!0)fe=Te.value,le.LITTLE_HEART.medalRoom_list=le.LITTLE_HEART.medalRoom_list.concat(fe.roomid)}catch(fe){ce=!0,Ie=fe}finally{try{!ue&&pe.return&&pe.return()}finally{if(ce)throw Ie}}V('MY_API.LITTLE_HEART.medalRoom_list',le.LITTLE_HEART.medalRoom_list),ge.data.pageinfo.curPage<ge.data.pageinfo.totalpages&&le.LITTLE_HEART.getMedalRoomList(_e+1)},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.LITTLE_HEART.getMedalRoomList(_e)})})},checkRoomList:function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(ue){var ce,Ie,pe,Te,fe,Ee,me;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:ce=[],Ie=!0,pe=!1,Te=void 0,ve.prev=4,fe=ue[Symbol.iterator]();case 6:if(Ie=(Ee=fe.next()).done){ve.next=13;break}return me=Ee.value,ve.next=10,D.room.get_info(me).then(function(xe){if(1===xe.data.live_status)return void(ce=ce.concat(xe.data.room_id))},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.LITTLE_HEART.checkRoomList(ue)})});case 10:Ie=!0,ve.next=6;break;case 13:ve.next=19;break;case 15:ve.prev=15,ve.t0=ve['catch'](4),pe=!0,Te=ve.t0;case 19:ve.prev=19,ve.prev=20,!Ie&&fe.return&&fe.return();case 22:if(ve.prev=22,!pe){ve.next=25;break}throw Te;case 25:return ve.finish(22);case 26:return ve.finish(19);case 27:;if(V('MY_API.LITTLE_HEART.checkRoomList returnRoom',ce),void 0==ce){ve.next=33;break}return ve.abrupt('return',ce);case 33:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5F53\u524D\u7C89\u4E1D\u52CB\u7AE0\u5217\u8868\u4E2D\u65E0\u6B63\u5728\u76F4\u64AD\u623F\u95F4\uFF0C5\u5206\u949F\u540E\u91CD\u8BD5'),ve.abrupt('return',X(function(){return le.LITTLE_HEART.getMedalRoomList(page)},3e5));case 35:case'end':return ve.stop();}},ge,se,[[4,15,19,27],[20,,22,26]])}));return function checkRoomList(){return _e.apply(this,arguments)}}(),checkRoom:function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(ue){var ce;return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return ce=void 0,pe.next=3,D.room.get_info(ue).then(function(Te){ce=1===Te.data.live_status},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),X(function(){return le.LITTLE_HEART.checkRoomList(roomList)})});case 3:return pe.abrupt('return',ce);case 4:case'end':return pe.stop();}},ge,se)}));return function checkRoom(){return _e.apply(this,arguments)}}(),doHeartBeat:function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(ue){var ce,Ie;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(-1!=le.LITTLE_HEART.liveRoom_list.indexOf(ue)){Te.next=2;break}return Te.abrupt('return');case 2:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00\u623F\u95F4'+ue+'\u3010\u8BF7\u52FF\u70B9\u51FB\u3011','info'),V('[\u5C0F\u5FC3\u5FC3]\u6253\u5F00\u6807\u7B7E\u9875\u623F\u95F4',le.LITTLE_HEART.liveRoom_list),Te.next=6,GM_openInTab('https://live.bilibili.com/'+(ue+''),'loadInBackground');case 6:return ce=Te.sent,w.push(ce),Ie=setInterval(_asyncToGenerator(regeneratorRuntime.mark(function fe(){return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:;if(void 0!=ce&&ce.close(),ne(le.CACHE.LittleHeart_TS)){me.next=6;break}return clearInterval(Ie),V('[\u5C0F\u5FC3\u5FC3]','\u4ECA\u65E5\u4EFB\u52A1\u5B8C\u6210\uFF0C\u623F\u95F4'+ue+'\u4E0D\u518D\u6253\u5F00'),me.abrupt('return');case 6:if(!le.LITTLE_HEART.checkRoom(ue)){me.next=12;break}return me.next=9,GM_openInTab('https://live.bilibili.com/'+(ue+''),'loadInBackground');case 9:ce=me.sent,me.next=17;break;case 12:return window.toast('[\u5C0F\u5FC3\u5FC3]\u623F\u95F4'+ue+'\u4E0B\u64AD\uFF0C\u5373\u5C06\u518D\u6B21\u5BFB\u627E\u5F00\u64AD\u623F\u95F4','info'),clearInterval(Ie),I(ue,le.LITTLE_HEART.liveRoom_list),I(ce,w),me.abrupt('return',le.LITTLE_HEART.run());case 17:case'end':return me.stop();}},fe,se)})),310e3),Te.abrupt('return');case 10:case'end':return Te.stop();}},ge,se)}));return function doHeartBeat(){return _e.apply(this,arguments)}}(),run:function(){var _e=_asyncToGenerator(regeneratorRuntime.mark(function ge(){var ue,ce,Ie,pe,Te,fe,Ee,me;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(le.CONFIG.LITTLE_HEART){ve.next=2;break}return ve.abrupt('return',$.Deferred().resolve());case 2:if(ne(le.CACHE.LittleHeart_TS)){ve.next=5;break}return window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6','success'),ve.abrupt('return',$.Deferred().resolve());case 5:return ve.next=7,le.LITTLE_HEART.getMedalRoomList();case 7:return ve.next=9,le.LITTLE_HEART.checkRoomList(le.LITTLE_HEART.medalRoom_list);case 9:le.LITTLE_HEART.liveRoom_list=ve.sent,ue=0,ce=!0,Ie=!1,pe=void 0,ve.prev=14,Te=le.LITTLE_HEART.liveRoom_list[Symbol.iterator]();case 16:if(ce=(fe=Te.next()).done){ve.next=28;break}if(Ee=fe.value,!(ue<le.CONFIG.MAX_TAB)){ve.next=24;break}return ve.next=21,le.LITTLE_HEART.doHeartBeat(Ee);case 21:ue++,ve.next=25;break;case 24:return ve.abrupt('break',28);case 25:ce=!0,ve.next=16;break;case 28:ve.next=34;break;case 30:ve.prev=30,ve.t0=ve['catch'](14),Ie=!0,pe=ve.t0;case 34:ve.prev=34,ve.prev=35,!ce&&Te.return&&Te.return();case 37:if(ve.prev=37,!Ie){ve.next=40;break}throw pe;case 40:return ve.finish(37);case 41:return ve.finish(34);case 42:;return me=setInterval(function(){D.gift.bag_list().then(function(xe){V('[\u5C0F\u5FC3\u5FC3]\u68C0\u67E5\u5305\u88F9',xe);var Re=xe.data.list.filter(function(ye){return 30607==ye.gift_id&&24==ye.gift_num&&'7\u5929'==ye.corner_mark});if(V('[\u5C0F\u5FC3\u5FC3]\u5305\u88F9\u51857\u592924\u4E2A\u5C0F\u5FC3\u5FC3',Re),0<Re.length){clearInterval(me),window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u83B7\u53D6\u5C0F\u5FC3\u5FC3\u5DF2\u5230\u4E0A\u9650','success'),le.CACHE.LittleHeart_TS=k(),le.saveCache(),V('[\u5C0F\u5FC3\u5FC3]',w);var Ge=!0,Ce=!1,he=void 0;try{for(var Ne,ye,Ae=w[Symbol.iterator]();!(Ge=(Ne=Ae.next()).done);Ge=!0)ye=Ne.value,ye.close()}catch(ye){Ce=!0,he=ye}finally{try{!Ge&&Ae.return&&Ae.return()}finally{if(Ce)throw he}}return}})},3e5),ve.abrupt('return');case 45:case'end':return ve.stop();}},ge,se,[[14,30,34,42],[35,,37,41]])}));return function run(){return _e.apply(this,arguments)}}()}};le.init().then(function(){try{var _e=$.Deferred();(function uniqueCheck(){var ue=Date.now();return 0<=ue-le.CACHE.UNIQUE_CHECK&&15e3>=ue-le.CACHE.UNIQUE_CHECK?($('.link-toast').hide(),$('.igiftMsg').hide(),le.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),_e.reject()):_e.resolve()})().then(function(){var ue,ce=function uniqueMark(){ue=setTimeout(ce,1e4),le.CACHE.UNIQUE_CHECK=Date.now(),le.saveCache(!1)};return(window.addEventListener('unload',function(){ue&&(clearTimeout(ue),le.CACHE.UNIQUE_CHECK=0,le.saveCache())}),ce(),0===parseInt(P.uid)||isNaN(parseInt(P.uid)))?void le.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(le.newMessage(GM_info.script.version),V('MY_API.CONFIG',le.CONFIG),_(le))})}catch(_e){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',_e)}})}function _(se){'use strict';var de=function clearStat(){se.GIFT_COUNT.COUNT=0,se.GIFT_COUNT.CLEAR_TS=oe(),se.saveGiftCount(),V('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};ne(se.GIFT_COUNT.CLEAR_TS)&&de(),Q(de,'\u91CD\u7F6E\u7EDF\u8BA1'),se.LITTLE_HEART.run(),se.removeUnnecessary(),setTimeout(function(){se.GroupSign.run(),se.DailyReward.run(),se.LiveReward.run(),se.Exchange.runS2C(),se.TreasureBox.run(),se.Gift.run(),se.MobileHeartBeat.run()},6e3),se.creatSetBox(),D.room.getList().then(function(ue){V('\u76F4\u64AD\u95F4\u5217\u8868',ue);var ce=!0,Ie=!1,pe=void 0;try{for(var Ee,Te=function _loop4(){var me=Ee.value;D.room.getRoomList(me.id,0,0,1,1).then(function(Oe){V('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',Oe);for(var ve=0;ve<Oe.data.length;++ve)se.listen(Oe.data[ve].roomid,P.uid,me.name+'\u533A')})},fe=ue.data[Symbol.iterator]();!(ce=(Ee=fe.next()).done);ce=!0)Te()}catch(me){Ie=!0,pe=me}finally{try{!ce&&fe.return&&fe.return()}finally{if(Ie)throw pe}}});var le=function check_top_room(){if(se.GIFT_COUNT.COUNT>=se.CONFIG.MAX_GIFT&&(V('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),se.max_blocked=!0),se.blocked||se.max_blocked)return se.blocked?(se.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(_e)):void se.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(f(se.CONFIG.TIME_AREA_START_H0UR,se.CONFIG.TIME_AREA_END_H0UR,se.CONFIG.TIME_AREA_START_MINUTE,se.CONFIG.TIME_AREA_END_MINUTE)&&se.CONFIG.TIME_AREA_DISABLE)return void se.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var ue=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],ce=1,Ie=function checkHourRank(Te){D.rankdb.getTopRealTimeHour(Te).then(function(fe){var Ee=fe.data.list;se.chatLog('\u68C0\u67E5'+ue[Te]+'\u623F\u95F4\u7684\u793C\u7269','warning'),V(ue[Te]+'\u623F\u95F4\u5217\u8868',Ee);var me=!0,Oe=!1,ve=void 0;try{for(var Re,Ge,xe=Ee[Symbol.iterator]();!(me=(Re=xe.next()).done);me=!0)Ge=Re.value,se.checkRoom(Ge.roomid,'\u5C0F\u65F6\u699C-'+Ge.area_v2_parent_name+'\u533A')}catch(Ge){Oe=!0,ve=Ge}finally{try{!me&&xe.return&&xe.return()}finally{if(Oe)throw ve}}})},pe=setInterval(function(){ce<=ue.length-1?(Ie(ce),ce++):clearInterval(pe)},1e3)};setTimeout(le,6e3);var _e=setInterval(le,parseInt(1e3*se.CONFIG.CHECK_HOUR_ROOM_INTERVAL)),ge=function reset(ue){var ce=setTimeout(function(){if(0<se.raffleId_list.length||0<se.guardId_list.length||0<se.pkId_list.length)return V('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void ge(15000);if(ne(se.CACHE.LittleHeart_TS))return V('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u53D1\u9001pc\u5FC3\u8DF3\u5305\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(ce),void ge(6e5);if(f(se.CONFIG.TIME_AREA_START_H0UR,se.CONFIG.TIME_AREA_END_H0UR,se.CONFIG.TIME_AREA_START_MINUTE,se.CONFIG.TIME_AREA_END_MINUTE)&&se.CONFIG.IN_TIME_RELOAD_DISABLE){var Ie=u(se.CONFIG.TIME_AREA_START_MINUTE,se.CONFIG.TIME_AREA_END_MINUTE)+6e4;return ge(Ie),void V('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+Ie+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},ue)};ge(6e4*se.CONFIG.TIME_RELOAD)}function u(se,de){var le=new Date,_e=le.getHours(),ge=le.getMinutes(),ue=le.getSeconds(),pe=1e3*(3600*se)+1e3*(60*de)-(1e3*(3600*_e)+1e3*(60*ge)+1e3*ue);return V('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',pe+'\u6BEB\u79D2'),0>pe?86400000+pe:pe}function I(se,de){de.splice(de.indexOf(se),1)}function T(se,de){var le=new Date,_e=le.getHours(),ge=le.getMinutes();return _e==se&&ge==de||(V('\u9519\u8BEF\u65F6\u95F4'),!1)}function f(se,de,le,_e){if(23<se||24<de||0>se||1>de||59<le||0>le||59<_e||0>_e)return!1;var ge=new Date,ue=ge.getHours(),ce=ge.getMinutes();if(se<de)return ue>=se&&ue<de||ue==de&&ce>=le&&ce<_e;return se>de?ue>=se||ue<de||ue==de&&ce>=le&&ce<_e:se==de?ue==se&&le<=_e&&ce>=le&&ce<_e||ue==se&&le>_e&&ce<=_e&&ce>le:void 0}function O(se){if(0>=se)return!1;var de=Math.random();return se/100>=de}function R(se){return new Promise(function(de){var le=function onerror(_e){console.error('XHR',_e),de(void 0)};if(se.GM)'POST'===se.method&&(void 0===se.headers&&(se.headers={}),void 0===se.headers['Content-Type']&&(se.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),se.timeout=30000,se.onload=function(_e){de(_e.response)},se.onerror=le,se.ontimeout=le,GM_xmlhttpRequest(se);else{var _e=new XMLHttpRequest;_e.open(se.method,se.url),'POST'===se.method&&null===_e.getResponseHeader('Content-Type')&&_e.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),se.cookie&&(_e.withCredentials=!0),se.responseType!==void 0&&(_e.responseType=se.responseType),_e.timeout=30000,_e.onload=function(ge){var ue=ge.target;de({response:ue,body:ue.response})},_e.onerror=le,_e.ontimeout=le,_e.send(se.data)}})}ae.init(),$(function(){var se=function loadInfo(de){setTimeout(function(){var le='undefined'==typeof unsafeWindow?window:unsafeWindow;le.BilibiliLive===void 0||0===parseInt(le.BilibiliLive.UID)||isNaN(parseInt(le.BilibiliLive.UID))?(se(1e3),window.toast('['+GM_info.script.name+']\u65E0\u914D\u7F6E\u4FE1\u606F','warning'),V('\u65E0\u914D\u7F6E\u4FE1\u606F')):(P.room_id=le.BilibiliLive.ROOMID,P.uid=le.BilibiliLive.UID,D.live_user.get_info_in_room(P.room_id).then(function(_e){V('InitData: API.live_user.get_info_in_room',_e),P.mobile_verify=_e.data.info.mobile_verify,P.identification=_e.data.info.identification}),D.gift.gift_config().then(function(_e){V('InitData: API.gift.gift_config',_e),!!_e.data&&$.isArray(_e.data)?P.gift_list=_e.data:!!_e.data.list&&$.isArray(_e.data.list)?P.gift_list=_e.data.list:(P.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))}),P.bili_jct=D.getCookie('bili_jct'),P.ruid=le.BilibiliLive.ANCHOR_UID,P.rnd=le.BilibiliLive.RND,P.visit_id=le.__statisObserver?le.__statisObserver.__visitId:'',V('Live_info',P),l())},de)};se(1e3),o()}),Array.prototype.remove=function(se){var de=this.indexOf(se);-1<de&&this.splice(de,1)};var oe=function dateNow(){return Date.now()},ne=function checkNewDay(se){if(0===se)return!0;var de=new Date(se),le=new Date,_e=de.getDate(),ge=le.getDate();return ge!==_e}})();
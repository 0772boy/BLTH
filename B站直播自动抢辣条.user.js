// ==UserScript==
// @namespace     https://github.com/andywang425
// @name          B站直播自动抢辣条
// @name:en       B站直播自动抢辣条
// @author        andywang425
// @description   自动参与Bilibili直播区广播礼物，小时榜房间礼物，广播节奏风暴抽奖;完成每日任务
// @description:en 自动参与Bilibili直播区广播礼物，小时榜房间礼物，广播节奏风暴抽奖;完成每日任务
// @updateURL     https://github.com.cnpmjs.org/andywang425/Bilibili-SGTH/raw/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @downloadURL    https://github.com.cnpmjs.org/andywang425/Bilibili-SGTH/raw/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @homepageURL   https://github.com/andywang425/Bilibili-SGTH/
// @supportURL    https://github.com/andywang425/Bilibili-SGTH/issues
// @icon          https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright     2020, andywang425 (https://github.com/andywang425)
// @license       MIT
// @version       3.5.2
// @include      /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at       document-end
// @connect     passport.bilibili.com
// @connect     api.live.bilibili.com
// @require      https://cdn.jsdelivr.net/gh/jquery/jquery@3.2.1/dist/jquery.min.js
// @require      https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@1.3.3/BilibiliAPI_Mod.min.js
// @require      https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.2/OCRAD.min.js
// @require      https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.2/libBilibiliToken.user.js
// @grant       GM_xmlhttpRequest
// ==/UserScript==
/*
B站直播自动抢辣条.user.js的几个其它源(若想给库换源请按格式修改):
[jsdelivr]（大约要一天时间才能同步）
https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
[gitcdn]
https://gitcdn.xyz/repo/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
[cnpmjs]
https://github.com.cnpmjs.org/andywang425/Bilibili-SGTH/raw/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
[fastgit]
https://hub.fastgit.org/andywang425/Bilibili-SGTH/raw/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
*/
'use strict';var _Mathfloor=Math.floor,_Mathround=Math.round;function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,g){function u(I,f){try{var T=l[I](f),O=T.value}catch(E){return void g(E)}return T.done?void _(O):Promise.resolve(O).then(function(E){u('next',E)},function(E){u('throw',E)})}return u('next')})}}(function(){var E=this,A=!1,C='IGIFTMSG',R=BilibiliAPI,N=void 0,M=0,D=0,S=0,F=!1,L=new Date().getTimezoneOffset()+480,U=function ts_ms(){return Date.now()},w=function ts_s(){return _Mathround(U()/1e3)},B={room_id:void 0,uid:void 0,ruid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0},k=function runUntilSucceed(ie){var ae=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,oe=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){ie()||k(ie,oe,oe)},ae)},H=function delayCall(ie){var ae=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,oe=$.Deferred();return setTimeout(function(){var se=ie();se&&se.then?se.then(function(ne,de,le,_e,ge,ce){return oe.resolve(ne,de,le,_e,ge,ce)}):oe.resolve()},ae),oe},P=function MYDEBUG(ie){for(var ae=arguments.length,oe=Array(1<ae?ae-1:0),se=1;se<ae;se++)oe[se-1]=arguments[se];var ne=new Date;return ne='['+C+']['+ne.getHours()+':'+ne.getMinutes()+':'+ne.getSeconds()+':'+ne.getMilliseconds()+']',1===oe.length?void console.log(ne,ie+':',oe[0]):void console.log(ne,ie+':',oe)},Y=function runMidnight(ie,ae){var oe=new Date;oe.setMinutes(oe.getMinutes()+L),oe.setDate(oe.getDate()+1),oe.setHours(0,1,0,0),oe.setMinutes(oe.getMinutes()-L),setTimeout(ie,oe-U()),P('runMidnight',(ae||' ')+' '+oe.toString())},X=function runExactMidnight(ie,ae){var oe=new Date;oe.setMinutes(oe.getMinutes()+L),oe.setDate(oe.getDate()+1),oe.setHours(0,0,0,0),oe.setMinutes(oe.getMinutes()-L),setTimeout(ie,oe-U()),P('runExactMidnight',(ae||' ')+' '+oe.toString())},K=new BilibiliToken,V='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',Q=JSON.parse(localStorage.getItem(C+'_userToken')),z=void 0,Z=function(){var ie=_asyncToGenerator(regeneratorRuntime.mark(function ae(){return regeneratorRuntime.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,K.getToken();case 2:if(z=se.sent,void 0!==z){se.next=5;break}return se.abrupt('return',console.error(GM_info.script.name,'\u672A\u83B7\u53D6\u5230token'));case 5:return Q=z,localStorage.setItem(C+'_userToken',JSON.stringify(Q)),P(C+'_userToken',Q),se.abrupt('return','OK');case 9:case'end':return se.stop();}},ae,E)}));return function setToken(){return ie.apply(this,arguments)}}(),J={init:function init(){return J.Toast.init().then(function(){})},Toast:{init:function init(){try{var ie=[];return window.toast=function(ae){var oe=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',se=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(oe){case'success':case'info':break;case'caution':break;case'error':break;default:oe='info';}var ne=$('<div class="link-toast '+oe+' fixed"><span class="toast-text">'+ae+'</span></div>')[0];document.body.appendChild(ne),ne.style.top=document.body.scrollTop+40*ie.length+10+'px',ne.style.left=document.body.offsetWidth+document.body.scrollLeft-ne.offsetWidth-5+'px',ie.push(ne),setTimeout(function(){ne.className+=' out',setTimeout(function(){ie.shift(),ie.forEach(function(de){de.style.top=parseInt(de.style.top,10)-40+'px'}),$(ne).remove()},200)},se)},$.Deferred().resolve()}catch(ie){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',ie),$.Deferred().reject()}}}};function o(){$('head').append('\n        <style>\n            .igiftMsg_input{\n                outline: none;\n                border: 1px solid #e9eaec;\n                background-color: #fff;\n                border-radius: 4px;\n                padding: 1px 0 0;\n                overflow: hidden;\n                font-size: 12px;\n                line-height: 19px;\n                width: 30px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_btn{\n                background-color: #23ade5;\n                color: #fff;\n                border-radius: 4px;\n                border: none;\n                padding: 5px;\n                cursor: pointer;\n                box-shadow: 0 0 2px #00000075;\n                line-height: 10px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_fs{\n                border: 2px solid #d4d4d4;\n                \'z-index\': \'10001\';\n            }\n        </style>\n            ')}function l(){var ie=this,ae={CONFIG_DEFAULT:{TIME_RELOAD:60,RANDOM_DELAY:!0,RND_DELAY_START:2,RND_DELAY_END:5,TIME_AREA_DISABLE:!0,TIME_AREA_START_H0UR:2,TIME_AREA_END_H0UR:8,TIME_AREA_START_MINUTE:0,TIME_AREA_END_MINUTE:0,RANDOM_SKIP:0,MAX_GIFT:99999,IN_TIME_RELOAD_DISABLE:!1,RANDOM_SEND_DANMU:0,CHECK_HOUR_ROOM_INTERVAL:120,AUTO_GROUP_SIGN:!0,LIVE_SIGN:!0,FORCE_LOTTERY:!1,LOGIN:!0,WATCH:!0,COIN:!1,COIN_NUMBER:0,SHARE:!0,AUTO_TREASUREBOX:!0,SILVER2COIN:!1,AUTO_GIFT:!1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_SORT:!1,AUTO_GIFT_ROOMID:'0',GIFT_LIMIT:86400,SEND_ALL_GIFT:!1,SPARE_GIFT_ROOM:'0',SPARE_GIFT_UID:'0',MOBILE_HEARTBEAT:!0,STORM:!1,STORM_QUEUE_SIZE:3,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,MobileHeartBeat_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{R.setCommonArgs(R.getCookie('bili_jct'))}catch(se){return void console.error('['+C+']',se)}var oe=$.Deferred();try{ae.loadConfig().then(function(){ae.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),oe.resolve()})}catch(se){console.error('API\u521D\u59CB\u5316\u51FA\u9519',se),ae.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),oe.reject()}try{ae.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),oe.resolve()})}catch(se){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',se),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),oe.reject()}return Z().then(function(se){'OK'==se?(window.toast('APPtoken\u8F7D\u5165\u6210\u529F','success'),oe.resolve()):(console.error('APPtoken\u521D\u59CB\u5316\u51FA\u9519',e),window.toast('APPtoken\u521D\u59CB\u5316\u51FA\u9519','error'),oe.reject())}),setTimeout(function(){ae.TreasureBox.init()},5750),oe},loadConfig:function loadConfig(){var oe=$.Deferred();try{var se=JSON.parse(localStorage.getItem(C+'_CONFIG'));for(var ne in $.extend(!0,ae.CONFIG,ae.CONFIG_DEFAULT),ae.CONFIG)ae.CONFIG.hasOwnProperty(ne)&&void 0!==se[ne]&&null!==se[ne]&&(ae.CONFIG[ne]=se[ne]);ae.loadGiftCount(),oe.resolve()}catch(se){P('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',se),ae.setDefaults(),oe.reject()}return oe},loadCache:function loadCache(){var oe=$.Deferred();try{var se=JSON.parse(localStorage.getItem(C+'_CACHE'));for(var ne in $.extend(!0,ae.CACHE,ae.CACHE_DEFAULT),ae.CACHE)ae.CACHE.hasOwnProperty(ne)&&void 0!==se[ne]&&null!==se[ne]&&(ae.CACHE[ne]=se[ne]);oe.resolve()}catch(se){P('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',se),ae.setDefaults(),oe.reject()}return oe},saveConfig:function saveConfig(){try{return localStorage.setItem(C+'_CONFIG',JSON.stringify(ae.CONFIG)),ae.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),P('MY_API.CONFIG',ae.CONFIG),!0}catch(oe){return P('API\u4FDD\u5B58\u51FA\u9519',oe),!1}},saveCache:function saveCache(oe){try{return localStorage.setItem(C+'_CACHE',JSON.stringify(ae.CACHE)),!1!=oe&&P('CACHE\u5DF2\u4FDD\u5B58',ae.CACHE),!0}catch(se){return P('CACHE\u4FDD\u5B58\u51FA\u9519',se),!1}},setDefaults:function setDefaults(){ae.CONFIG=ae.CONFIG_DEFAULT,ae.CACHE=ae.CACHE_DEFAULT,ae.saveConfig(),ae.saveCache(),ae.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6BCF\u65E5\u4EFB\u52A1','info'),setTimeout(function(){ae.CACHE=ae.CACHE_DEFAULT,ae.GroupSign.run(),ae.DailyReward.run(),ae.LiveReward.run(),ae.Exchange.runS2C(),ae.TreasureBox.run(),ae.Gift.run(),ae.MobileHeartBeat.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var oe=JSON.parse(localStorage.getItem(C+'_GIFT_COUNT'));for(var se in ae.GIFT_COUNT)ae.GIFT_COUNT.hasOwnProperty(se)&&void 0!==oe[se]&&null!==oe[se]&&(ae.GIFT_COUNT[se]=oe[se]);P('MY_API.GIFT_COUNT',ae.GIFT_COUNT)}catch(oe){P('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',oe)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(C+'_GIFT_COUNT',JSON.stringify(ae.GIFT_COUNT)),P('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',ae.GIFT_COUNT),!0}catch(oe){return P('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',oe),!1}},addGift:function addGift(oe){ae.GIFT_COUNT.COUNT+=oe,$('#giftCount span:eq(0)').text(ae.GIFT_COUNT.COUNT),ae.saveGiftCount()},addSilver:function addSilver(oe){ae.GIFT_COUNT.SILVER_COUNT+=10*oe,$('#giftCount span:eq(2)').text(ae.GIFT_COUNT.SILVER_COUNT),ae.saveGiftCount()},checkUpdate:function checkUpdate(){window.open('https://github.com/andywang425/Bilibili-SGTH/raw/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js','_blank').location},removeUnnecessary:function removeUnnecessary(){var oe=['#my-dear-haruna-vm','.june-activity-entry'],se=!0,ne=!1,de=void 0;try{for(var _e,ge,le=oe[Symbol.iterator]();!(se=(_e=le.next()).done);se=!0)ge=_e.value,$(ge).remove()}catch(ge){ne=!0,de=ge}finally{try{!se&&le.return&&le.return()}finally{if(ne)throw de}}},creatSetBox:function creatSetBox(){var oe=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F<br></button>');oe.click(function(){if(!1==A){A=!0,$('.igiftMsg').hide(),se.hide();var pe=$('.chat-history-list');pe.animate({scrollTop:0},0),setTimeout(function(){pe.animate({scrollTop:pe.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}else{A=!1,$('.igiftMsg').show(),se.show();var pe=$('.chat-history-list');pe.animate({scrollTop:pe.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}}),$('.attention-btn-ctnr').append(oe);var se=$('<div>'),ne=$('.live-player-mounter').height();se.css({width:'auto',height:ne,position:'absolute',top:'-2px',right:'0px',background:'#F0F0F0',padding:'10px',"z-index":'10001',"border-radius":'4px',overflow:'scroll',"line-height":'15px'}),se.append('\n                <div id=\'allsettings\'>\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n                    <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n                        \u8FA3\u6761&nbsp;<span>'+ae.GIFT_COUNT.COUNT+'</span>\n                        \u94F6\u74DC\u5B50&nbsp;<span>'+ae.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n                    </div>\n                </fieldset>\n                <div id="left_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u4F4E\u8C03\u8BBE\u7F6E</legend>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u542F\u7528\n                                <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                                <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_GIFT">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM_INTERVAL">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\n                            </label>\n                        </div>\n            \n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u767B\u9646\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u89C2\u770B\u89C6\u9891\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="cursor: pointer; vertical-align: text-top;" type="checkbox">\n                                \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A\n                            </label>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5206\u4EAB\u89C6\u9891\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u76F4\u64AD\u533A\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5E94\u63F4\u56E2\u7B7E\u5230\n                        </div>\n                        <div data-toggle="MOBILE_HEARTBEAT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u6A21\u62DF\u79FB\u52A8\u7AEF\u5FC3\u8DF3 + \u9886\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD\u5956\u52B1\n                        </div>\n                        <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9001\u793C\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            \u4F18\u5148\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            \u9001\u793C\u65F6\u95F4\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n                        </div>\n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            \u793C\u7269\u5230\u671F\u65F6\u95F4\n                            <input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            \u79D2\n                        </div>\n                        <div data-toggle="GIFT_SORT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u793C\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                        <div data-toggle="SPARE_GIFT_UID" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\u62E5\u6709\u8005UID\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            \u6BEB\u79D2\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8BF4\u660E</legend>\n                        \u81EA\u52A8\u9001\u793C\u76EE\u524D\u53EA\u4F1A\u9001\u51FA\u8FA3\u6761\u548C\u4EBF\u5706\u3002<br>\n                        \u793C\u7269\u5230\u671F\u65F6\u95F4: \u5C06\u8981\u5728\u8FD9\u4E2A\u65F6\u95F4\u6BB5\u91CC\u8FC7\u671F\u7684\u793C\u7269\u4F1A\u88AB\u9001\u51FA<br>\n                        \u52FE\u9009\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u65F6\u65E0\u8BBA\u662F\u5426\u5C06\u8981\u8FC7\u671F\u90FD\u4F1A\u88AB\u9001\u51FA<br>\n                        \u5982\u679C\u8981\u586B\u5199\u591A\u4E2A\u4F18\u5148\u9001\u793C\u623F\u95F4\uFF0C<br>\n                        \u6BCF\u4E2A\u623F\u95F4\u53F7\u4E4B\u95F4\u9700\u7528\u534A\u89D2\u9017\u53F7,\u9694\u5F00\u3002<br>\n                        \u5982 666,777,888\u3002\u4E3A0\u5219\u4E0D\u9001\u3002<br>\n                        \u5982\u679C\u6CA1\u6709\u8FD9\u4E9B\u623F\u95F4\u7684\u7C89\u4E1D\u724C\u4E5F\u4E0D\u9001\u3002<br>\n                        \u65E0\u8BBA\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u5982\u4F55\u8BBE\u7F6E\uFF0C\u4F1A\u6839\u636E\u3010\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u3011<br>\n                        \uFF08\u52FE\u9009\u5219\u8865\u6EE1\uFF0C\u5426\u5219\u53EA\u9001\u5230\u671F\u7684\uFF09\u6761\u4EF6\u53BB\u6309\u4F18\u5148\u9001\u793C\u623F\u95F4\u5148\u540E\u987A\u5E8F\u9001\u793C\u3002<br>\n                        \u4E4B\u540E\u6839\u636E\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u51B3\u5B9A\u5148\u9001\u9AD8\u7EA7\u8FD8\u662F\u4F4E\u7EA7\uFF08\u52FE\u9009\u5148\u9AD8\u7EA7\uFF0C\u4E0D\u52FE\u9009\u5148\u4F4E\u7EA7\uFF09\u3002<br>\n                        \u5269\u4F59\u793C\u7269:\u6307\u9001\u5B8C\u4E86\u6240\u6709\u7C89\u4E1D\u724C\uFF0C\u4F46\u4ECD\u6709\u5269\u4F59\u7684\u5C06\u57281\u5929\u5185\u8FC7\u671F\u7684\u793C\u7269\u3002<br>\n                        \u5269\u4F59\u793C\u7269\u4E5F\u4F1A\u5728\u6307\u5B9A\u9001\u793C\u65F6\u95F4\u88AB\u9001\u51FA\u3002<br>\n                        \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\u98CE\u9669\u8F83\u5927\uFF0C\u5982\u679C\u6CA1\u6709\u5B9E\u540D\u53EF\u80FD\u65E0\u6CD5\u53C2\u52A0\u3002<br>\n                        \u811A\u672C\u4EC5\u80FD\u53C2\u52A0\u5E7F\u64AD\u4E2D\u7684\u8282\u594F\u98CE\u66B4\u3002\n            \n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 15px">\n                        <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n                        <div data-toggle="TIME_RELOAD" style="color: black">\n                            \u672C\u76F4\u64AD\u95F4\u5237\u65B0\u65F6\u95F4\uFF1A\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\u5206\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u91CD\u8F7D\u76F4\u64AD\u95F4\n                            </label>\n                        </div>\n                        <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: red;">\n                                <input style="vertical-align: text-top;" type="checkbox">\u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n                            </label>\n                        </div>\n                        <div id="resetArea">\n                            <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                            <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6BCF\u65E5\u4EFB\u52A1</button>\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n                            <button style="font-size: small; color: green;" class="igiftMsg_btn"\n                                data-action="checkUpdate">\u68C0\u67E5\u66F4\u65B0</button>\n                        </div>\n            \n                    </fieldset>\n                    <label style="color: darkblue; font-size:large;">\n                        v3.5.2 <a href="https://github.com/andywang425/Bilibili-SGTH/" target="_blank">\u66F4\u591A\u8BF4\u660E\u548C\u66F4\u65B0\u65E5\u5FD7\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n                    </label>\n                </div>\n            </div>\n    '),$('.live-player-mounter').append(se),se.find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(ae.CONFIG.STORM_MAX_COUNT).toString()),se.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(ae.CONFIG.STORM_ONE_LIMIT).toString()),se.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(ae.CONFIG.STORM_QUEUE_SIZE).toString()),se.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(ae.CONFIG.SPARE_GIFT_UID.toString()),se.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(ae.CONFIG.SPARE_GIFT_ROOM.toString()),se.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(ae.CONFIG.TIME_RELOAD).toString()),se.find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(ae.CONFIG.RANDOM_SKIP).toString()),se.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(ae.CONFIG.RANDOM_SEND_DANMU).toString()),se.find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(ae.CONFIG.MAX_GIFT).toString()),se.find('div[data-toggle="COIN"] .coin_number').val(parseInt(ae.CONFIG.COIN_NUMBER).toString()),se.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(ae.CONFIG.RND_DELAY_START).toString()),se.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(ae.CONFIG.RND_DELAY_END).toString()),se.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(ae.CONFIG.TIME_AREA_START_H0UR).toString()),se.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(ae.CONFIG.TIME_AREA_END_H0UR).toString()),se.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(ae.CONFIG.TIME_AREA_START_MINUTE).toString()),se.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(ae.CONFIG.TIME_AREA_END_MINUTE).toString()),se.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val(parseInt(ae.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),se.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(ae.CONFIG.AUTO_GIFT_ROOMID.toString()),se.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(ae.CONFIG.GIFT_SEND_HOUR.toString()),se.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(ae.CONFIG.GIFT_SEND_MINUTE.toString()),se.find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(ae.CONFIG.GIFT_LIMIT).toString()),se.find('div[id="giftCount"] [data-action="save"]').click(function(){var pe,fe,Te=ae.CONFIG.TIME_AREA_START_H0UR=parseInt(se.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),me=ae.CONFIG.TIME_AREA_END_H0UR=parseInt(se.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Oe=ae.CONFIG.TIME_AREA_START_MINUTE=parseInt(se.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),Ee=ae.CONFIG.TIME_AREA_END_MINUTE=parseInt(se.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(0>Te||0>me||0>Oe||0>Ee)return void ae.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=Te||24<=me||60<=Oe||60<=Ee)return void ae.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(ae.CONFIG.TIME_AREA_START_H0UR=Te,ae.CONFIG.TIME_AREA_END_H0UR=me,ae.CONFIG.TIME_AREA_START_MINUTE=Oe,ae.CONFIG.TIME_AREA_END_MINUTE=Ee,pe=parseFloat(se.find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>pe||100<pe)return void ae.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(ae.CONFIG.RANDOM_SKIP=pe,pe=parseFloat(se.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<pe)return void ae.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>pe)return void ae.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(ae.CONFIG.RANDOM_SEND_DANMU=pe,pe=parseInt(se.find('div[data-toggle="MAX_GIFT"] .num').val()),ae.CONFIG.MAX_GIFT=pe,pe=parseInt(se.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=pe||1e4<pe)return void ae.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(ae.CONFIG.TIME_RELOAD=pe,pe=parseFloat(se.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),me=parseFloat(se.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>pe||100<me)return void ae.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(me<=pe)return void ae.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(ae.CONFIG.RND_DELAY_START=pe,ae.CONFIG.RND_DELAY_END=me,pe=parseInt(se.find('div[data-toggle="COIN"] .coin_number').val()),0>pe)return void ae.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0','warning');if(ae.CONFIG.COIN_NUMBER=pe,pe=parseInt(se.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=pe)return void ae.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');ae.CONFIG.CHECK_HOUR_ROOM_INTERVAL=pe,pe=se.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),fe=pe.split(',');for(var ve=0;ve<fe.length;ve++)''===fe[ve]&&(fe[ve]=0);return(pe=fe.join(','),ae.CONFIG.AUTO_GIFT_ROOMID=pe,pe=parseInt(se.find('div[data-toggle="GIFT_INTERVAL"] .num').val()),0>=pe)?void ae.chatLog('[\u68C0\u67E5\u9001\u793C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning'):(ae.CONFIG.GIFT_INTERVAL=pe,pe=parseInt(se.find('div[data-toggle="GIFT_LIMIT"] .num').val()),ae.CONFIG.GIFT_LIMIT=pe,Te=parseInt(se.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),me=parseInt(se.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>Te||0>me)?void ae.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning'):24<=Te||60<=me?void ae.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning'):void(ae.CONFIG.GIFT_SEND_HOUR=Te,ae.CONFIG.GIFT_SEND_MINUTE=me,pe=se.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),ae.CONFIG.SPARE_GIFT_ROOM=pe,pe=se.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(),ae.CONFIG.SPARE_GIFT_UID=pe,pe=parseInt(se.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),ae.CONFIG.STORM_QUEUE_SIZE=pe,pe=parseInt(se.find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),ae.CONFIG.STORM_MAX_COUNT=pe,pe=parseInt(se.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),ae.CONFIG.STORM_ONE_LIMIT=pe,ae.saveConfig())}),se.find('button[data-action="reset"]').click(function(){ae.setDefaults()}),se.find('button[data-action="checkUpdate"]').click(function(){ae.checkUpdate()}),se.find('button[data-action="redo_dailyTasks"]').click(function(){ae.ReDoDailyTasks()}),se.find('#resetArea [data-action="countReset"]').click(function(){ae.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},ae.saveGiftCount(),$('#giftCount span:eq(0)').text(ae.GIFT_COUNT.COUNT),$('#giftCount span:eq(2)').text(ae.GIFT_COUNT.SILVER_COUNT),ae.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),se.find('button[data-action="sendGiftNow"]').click(function(){F=!0,ae.Gift.run()});var de=['RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','GIFT_SORT','SEND_ALL_GIFT','MOBILE_HEARTBEAT','STORM'],le=!0,_e=!1,ge=void 0;try{for(var Ie,ce=function _loop(){var pe=Ie.value,fe=se.find('div[data-toggle="'+pe+'"] input:checkbox');ae.CONFIG[pe]&&fe.attr('checked',''),fe.change(function(){ae.CONFIG[pe]=$(this).prop('checked'),ae.saveConfig()})},ue=de[Symbol.iterator]();!(le=(Ie=ue.next()).done);le=!0)ce()}catch(pe){_e=!0,ge=pe}finally{try{!le&&ue.return&&ue.return()}finally{if(_e)throw ge}}},chatLog:function chatLog(oe){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',ne=$('<div class=\'igiftMsg\'>'),de=$('<div>'),le=$('#chat-history-list'),_e=new Date;de.text(oe),ne.text(_e.toLocaleString()),ne.append(de),ne.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),de.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===se?ne.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===se?ne.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===se?ne.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):ne.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});!1==A&&(le.find('#chat-items').append(ne),le.scrollTop(le.prop('scrollHeight')))},blocked:!1,max_blocked:!1,listen:function listen(oe,se){var ne=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';R.room.getConf(oe).then(function(de){N=de.data.host,P('\u670D\u52A1\u5668\u5730\u5740',de);var le=new R.DanmuWebSocket(se,oe,de.data.host_server_list,de.data.token);le.bind(function(_e){le=_e,ae.chatLog(ne+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){ae.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+oe+' \u5206\u533A: '+ne,'success')},function(){(ae.blocked||ae.stormBlack)&&(le.close(),ae.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ne,'warning')),ae.max_blocked&&!ae.CONFIG.STORM&&(le.close(),ae.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ne,'warning'))},function(_e){if(!(f(ae.CONFIG.TIME_AREA_START_H0UR,ae.CONFIG.TIME_AREA_END_H0UR,ae.CONFIG.TIME_AREA_START_MINUTE,ae.CONFIG.TIME_AREA_END_MINUTE)&&ae.CONFIG.TIME_AREA_DISABLE))switch(P('\u5F39\u5E55\u516C\u544A'+ne,_e),_e.cmd){case'GUARD_MSG':_e.roomid===_e.real_roomid?ae.checkRoom(_e.roomid,ne):(ae.checkRoom(_e.roomid,ne),ae.checkRoom(_e.real_roomid,ne));break;case'PK_BATTLE_SETTLE_USER':_e.data.winner?ae.checkRoom(_e.data.winner.room_id,ne):ae.checkRoom(_e.data.my_info.room_id,ne),ae.checkRoom(_e.data.winner.room_id,ne);break;case'NOTICE_MSG':switch(_e.msg_type){case 1:break;case 2:case 3:case 4:case 8:_e.roomid===_e.real_roomid?ae.checkRoom(_e.roomid,ne):(ae.checkRoom(_e.roomid,ne),ae.checkRoom(_e.real_roomid,ne));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+_e.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),ae.Storm.run(_e.roomid);}break;case'SPECIAL_GIFT':if(_e.data[39])switch(_e.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+_e.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),ae.Storm.run(_e.roomid);case'end':};break;default:}})},function(){ae.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(oe){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';ae.blocked||ae.max_blocked||0<=ae.RoomId_list.indexOf(oe)||(ae.RoomId_list.push(oe),R.room.room_entry_action(oe),T(ae.CONFIG.RANDOM_SEND_DANMU)&&R.sendLiveDanmu(ae.auto_danmu_list[_Mathfloor(12*Math.random())],oe).then(function(ne){P('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',ne)}),R.xlive.lottery.check(oe).then(function(ne){ae.RoomId_list.remove(oe),P('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',ne);var de=ne.data;if(0===ne.code){var le;if(de.gift)for(var _e in le=de.gift,le)le.hasOwnProperty(_e)&&ae.creat_join(oe,le[_e],'gift',se);if(de.guard)for(var _e in le=de.guard,le)le.hasOwnProperty(_e)&&ae.creat_join(oe,le[_e],'guard',se);if(de.pk)for(var _e in le=de.pk,le)le.hasOwnProperty(_e)&&ae.creat_join(oe,le[_e],'pk',se)}else ae.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<ae.err_roomId.indexOf(oe)?P('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+oe+ne.message):(ae.err_roomId.push(oe),ae.checkRoom(oe,se),P('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+oe+ne.message))}))},Id_list_history:{add:function add(oe,se){var ne=[];try{var de=JSON.parse(localStorage.getItem(C+'_'+se+'Id_list'));ne=[].concat(de.list),ne.push(oe),150<ne.length&&ne.splice(0,50),localStorage.setItem(C+'_'+se+'Id_list',JSON.stringify({list:ne})),P(C+'_'+se+'Id_list_add',ne)}catch(de){ne.push(oe),localStorage.setItem(C+'_'+se+'Id_list',JSON.stringify({list:ne}))}},isIn:function isIn(oe,se){var ne=[];try{var de=JSON.parse(localStorage.getItem(C+'_'+se+'Id_list'));return ne=null===de?[]:[].concat(de.list),P(C+'_'+se+'Id_list_read',de),-1<ne.indexOf(oe)}catch(de){return localStorage.setItem(C+'_'+se+'Id_list',JSON.stringify({list:ne})),P('\u8BFB\u53D6'+(C+'_'+se+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ne.indexOf(oe)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(oe,se,ne){var de=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(P('\u793C\u7269\u4FE1\u606F',se),ae.GIFT_COUNT.COUNT>=ae.CONFIG.MAX_GIFT)return P('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(ae.max_blocked=!0);switch(ne){case'gift':if(ae.Id_list_history.isIn(se.raffleId,'raffle'))return void P('\u793C\u7269\u91CD\u590D','raffleId '+se.raffleId);ae.raffleId_list.push(se.raffleId),ae.Id_list_history.add(se.raffleId,'raffle');break;case'guard':if(ae.Id_list_history.isIn(se.id,'guard'))return void P('\u8230\u957F\u91CD\u590D','id '+se.id);ae.guardId_list.push(se.id),ae.Id_list_history.add(se.id,'guard');break;case'pk':if(ae.Id_list_history.isIn(se.id,'pk'))return void P('pk\u91CD\u590D','id '+se.id);ae.pkId_list.push(se.id),ae.Id_list_history.add(se.id,'pk');}var le=se.time_wait||0;ae.CONFIG.RANDOM_DELAY&&(le+=_Mathfloor(Math.random()*(ae.CONFIG.RND_DELAY_END-ae.CONFIG.RND_DELAY_START+1))+ae.CONFIG.RND_DELAY_START);var _e=$('<div class=\'igiftMsg\'>'),ge=$('<div>'),ce=$('<div>'),ue=$('#chat-history-list'),Ie=new Date;ge.text('['+de+']'+se.thank_text.split('<%')[1].split('%>')[0]+se.thank_text.split('%>')[1]),_e.text(Ie.toLocaleString()),_e.append(ge),ce.css('color','red'),ce.text('\u7B49\u5F85\u62BD\u5956'),ge.append(ce),_e.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),ge.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),_e.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),!1==A&&(ue.find('#chat-items').append(_e),ue.scrollTop(ue.prop('scrollHeight')));var pe=setInterval(function(){ce.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+le+'\u79D2'),0>=le&&(T(ae.CONFIG.RANDOM_SKIP)?ce.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(ce.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===ne?ae.gift_join(oe,se.raffleId,se.type).then(function(fe,Te){ce.text(fe),Te&&(-1<fe.indexOf('\u8FA3\u6761')?ae.addGift(Te):-1<fe.indexOf('\u94F6\u74DC\u5B50')&&ae.addSilver(Te)),ae.raffleId_list.remove(se.raffleId)}):'guard'===ne?ae.guard_join(oe,se.id).then(function(fe,Te){ce.text(fe),Te&&(-1<fe.indexOf('\u8FA3\u6761')?ae.addGift(Te):-1<fe.indexOf('\u94F6\u74DC\u5B50')&&ae.addSilver(Te)),ae.guardId_list.remove(se.id)}):'pk'===ne?ae.pk_join(oe,se.id).then(function(fe,Te){ce.text(fe),Te&&(-1<fe.indexOf('\u8FA3\u6761')?ae.addGift(Te):-1<fe.indexOf('\u94F6\u74DC\u5B50')&&ae.addSilver(Te)),ae.pkId_list.remove(se.id)}):void 0),ce.css('color','green'),clearInterval(pe)),le--},1e3)},gift_join:function gift_join(oe,se,ne){var de=$.Deferred();return R.Lottery.Gift.join(oe,se,ne).then(function(le){switch(P('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',le),le.code){case 0:le.data.award_text?de.resolve(le.data.award_text,le.data.award_num):de.resolve(le.data.award_name+'X'+le.data.award_num.toString(),le.data.award_num);break;default:-1<le.msg.indexOf('\u62D2\u7EDD')?!1==ae.CONFIG.FORCE_LOTTERY?(ae.blocked=!0,de.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++M?ae.gift_join(oe,se,ne):(M=0,de.resolve('[\u793C\u7269\u62BD\u5956](roomid='+oe+',id='+se+',type='+ne+')'+le.msg)):de.resolve('[\u793C\u7269\u62BD\u5956](roomid='+oe+',id='+se+',type='+ne+')'+le.msg);}}),de},guard_join:function guard_join(oe,se){var ne=$.Deferred();return R.Lottery.Guard.join(oe,se).then(function(de){switch(P('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',de),de.code){case 0:de.data.award_text?ne.resolve(de.data.award_text,de.data.award_num):ne.resolve(de.data.award_name+'X'+de.data.award_num.toString(),de.data.award_num);break;default:-1<de.msg.indexOf('\u62D2\u7EDD')?!1==ae.CONFIG.FORCE_LOTTERY?(ae.blocked=!0,ne.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++D?ae.guard_join(oe,id):(D=0,ne.resolve('[\u793C\u7269\u62BD\u5956](roomid='+oe+',id='+raffleId+',type='+type+')'+de.msg)):ne.resolve('[\u4E0A\u8239](roomid='+oe+',id='+se+')'+de.msg);}}),ne},pk_join:function pk_join(oe,se){var ne=$.Deferred();return R.Lottery.Pk.join(oe,se).then(function(de){switch(P('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',de),de.code){case 0:de.data.award_text?ne.resolve(de.data.award_text,de.data.award_num):ne.resolve(de.data.award_name+'X'+de.data.award_num.toString(),de.data.award_num);break;default:-1<de.msg.indexOf('\u62D2\u7EDD')?!1==ae.CONFIG.FORCE_LOTTERY?(ae.blocked=!0,ne.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++S?ae.pk_join(oe,id):(S=0,ne.resolve('[\u793C\u7269\u62BD\u5956](roomid='+oe+',id='+raffleId+',type='+type+')'+de.msg)):ne.resolve('[PK](roomid='+oe+',id='+se+')'+de.msg);}}),ne},GroupSign:{getGroups:function getGroups(){return R.Group.my_groups().then(function(oe){return(P('GroupSign.getGroups: API.Group.my_groups',oe),0===oe.code)?$.Deferred().resolve(oe.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+oe.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.GroupSign.getGroups()})})},signInList:function signInList(oe){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(se>=oe.length)return $.Deferred().resolve();var ne=oe[se];return ne.owner_uid==B.uid?GroupSign.signInList(oe,se+1):R.Group.sign_in(ne.group_id,ne.owner_uid).then(function(de){P('GroupSign.signInList: API.Group.sign_in',de);var le=$.Deferred();if(0===de.code)0<de.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ne.group_id+',owner_uid='+ne.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+de.data.add_num,'success'),le.resolve()):0==de.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ne.group_id+',owner_uid='+ne.owner_uid+')\u5DF2\u7B7E\u5230','caution'),le.resolve()):le.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+de.msg,'caution'),ae.GroupSign.signInList(oe,se);return $.when(ae.GroupSign.signInList(oe,se+1),le)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ne.group_id+',owner_uid='+ne.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.GroupSign.signInList(oe,se)})})},run:function run(){try{if(!ae.CONFIG.AUTO_GROUP_SIGN)return $.Deferred().resolve();var oe=u(ae.CACHE.AUTO_GROUP_SIGH_TS);if(86400000>oe){setTimeout(ae.GroupSign.run,oe);var se=new Date(U()+oe).toLocaleString();return P('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]','\u5C06\u5728'+se+'\u8FDB\u884C\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()}return ae.GroupSign.getGroups().then(function(se){return ae.GroupSign.signInList(se).then(function(){ae.CACHE.AUTO_GROUP_SIGH_TS=U(),ae.saveCache(),oe=u(ae.CACHE.AUTO_GROUP_SIGH_TS),setTimeout(ae.GroupSign.run,oe);var ne=new Date(U()+oe).toLocaleString();P('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]','\u5C06\u5728'+ne+'\u8FDB\u884C\u5E94\u63F4\u56E2\u7B7E\u5230')},function(){return H(function(){return ae.GroupSign.run()})})},function(){return H(function(){return ae.GroupSign.run()})})}catch(oe){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+C+']',oe),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return R.DailyReward.login().then(function(){P('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.DailyReward.login()})})},watch:function watch(oe,se){return ae.CONFIG.WATCH?R.DailyReward.watch(oe,se,B.uid,w()).then(function(ne){P('DailyReward.watch: API.DailyReward.watch',ne),0===ne.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+oe+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+ne.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.DailyReward.watch(oe,se)})}):$.Deferred().resolve()},coin:function coin(oe,se){var ne=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,de=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!ae.CONFIG.COIN)return $.Deferred().resolve();if(ae.DailyReward.coin_exp>=10*ae.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(ne>=oe.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var le=JSON.parse(oe[ne].card),_e=Math.min(2,se);return de&&(_e=1),R.DailyReward.coin(le.aid,_e).then(function(ge){return(P('DailyReward.coin: API.DailyReward.coin',ge),0===ge.code)?(ae.DailyReward.coin_exp+=10*_e,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+le.aid+',num='+_e+')','success'),ae.DailyReward.coin(oe,se-_e,ne+1)):-110===ge.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===ge.code?de?ae.DailyReward.coin(oe,se,ne+1):ae.DailyReward.coin(oe,se,ne,!0):34005===ge.code?ae.DailyReward.coin(oe,se,ne+1):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+ge.msg,'caution'),ae.DailyReward.coin(oe,se,ne+1))},function(){return H(function(){return ae.DailyReward.coin(oe,se,ne)})})},share:function share(oe){return ae.CONFIG.SHARE?R.DailyReward.share(oe).then(function(se){P('DailyReward.share: API.DailyReward.share',se),0===se.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+oe+')','success'):71000===se.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+se.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.DailyReward.share(oe)})}):$.Deferred().resolve()},dynamic:function dynamic(){return R.dynamic_svr.dynamic_new(B.uid,8).then(function(oe){if(P('DailyReward.dynamic: API.dynamic_svr.dynamic_new',oe),0===oe.code){if(!!oe.data.cards){var se=JSON.parse(oe.data.cards[0].card),ne=ae.DailyReward.watch(se.aid,se.cid),de=ae.DailyReward.coin(oe.data.cards,Math.max(ae.CONFIG.COIN_NUMBER-ae.DailyReward.coin_exp/10,0)),le=ae.DailyReward.share(se.aid);return $.when(ne,de,le)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+oe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.DailyReward.dynamic()})})},run:function run(){try{return te(ae.CACHE.DailyReward_TS)?R.DailyReward.exp().then(function(oe){return P('DailyReward.run: API.DailyReward.exp',oe),0===oe.code?(ae.DailyReward.coin_exp=oe.number,ae.DailyReward.login(),ae.DailyReward.dynamic().then(function(){ae.CACHE.DailyReward_TS=U(),ae.saveCache(),Y(ae.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+oe.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.DailyReward.run()})}):(Y(ae.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(oe){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+C+']',oe),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return R.xlive.dosign().then(function(oe){P('LiveReward.dailySignIn: API.xlive.dosign',oe),0===oe.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===oe.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+oe.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.LiveReward.dailySignIn()})})},run:function run(){try{if(!ae.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!te(ae.CACHE.LiveReward_TS))return Y(ae.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();ae.LiveReward.dailySignIn(),ae.CACHE.LiveReward_TS=U(),ae.saveCache(),Y(ae.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(oe){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+C+']',oe),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return R.Exchange.silver2coin().then(function(oe){P('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',oe),0===oe.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+oe.msg,'success'):403===oe.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+oe.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+oe.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return ae.CONFIG.SILVER2COIN?te(ae.CACHE.Silver2Coin_TS)?ae.Exchange.silver2coin().then(function(){ae.CACHE.Silver2Coin_TS=U(),ae.saveCache(),Y(ae.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return H(function(){return ae.Exchange.runS2C()})}):(Y(ae.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(oe){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+C+']',oe),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!ae.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var oe=$.Deferred();return k(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),oe.resolve(),!0;var se=$('#gift-control-vm div.treasure-box.p-relative');if(!se.length)return!1;se=se.first(),se.attr('id','old_treasure_box'),se.hide();var ne=$('<div id="'+C+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');ae.TreasureBox.DOM.div_tip=$('<div id="'+C+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),ae.TreasureBox.DOM.div_timer=$('<div id="'+C+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),ae.TreasureBox.DOM.image=$('<img id="'+C+'_treasure_image" style="display:none">'),ae.TreasureBox.DOM.canvas=$('<canvas id="'+C+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var de='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';if(ae.TreasureBox.DOM.div_tip[0].style=de,ae.TreasureBox.DOM.div_timer[0].style=de,ne.append(ae.TreasureBox.DOM.div_tip),ne.append(ae.TreasureBox.DOM.image),ne.append(ae.TreasureBox.DOM.canvas),ae.TreasureBox.DOM.div_tip.after(ae.TreasureBox.DOM.div_timer),se.after(ne),!B.mobile_verify)return ae.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),oe.resolve(),!0;try{if(OCRAD);}catch(le){return ae.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+C+']',le),oe.resolve(),!0}return ae.TreasureBox.timer=setInterval(function(){var le=parseInt(ae.TreasureBox.DOM.div_timer.text(),10);isNaN(le)&&(le=0),0<le?ae.TreasureBox.DOM.div_timer.text(le-1+'s'):ae.TreasureBox.DOM.div_timer.hide()},1e3),ae.TreasureBox.DOM.image[0].onload=function(){var le=ae.TreasureBox.DOM.canvas[0].getContext('2d');le.font='40px agencyfbbold',le.textBaseline='top',le.clearRect(0,0,ae.TreasureBox.DOM.canvas[0].width,ae.TreasureBox.DOM.canvas[0].height),le.drawImage(ae.TreasureBox.DOM.image[0],0,0);var _e=ae.TreasureBox.captcha.OCR.getGrayscaleMap(le),ge=ae.TreasureBox.captcha.OCR.orderFilter2In3x3(_e);le.clearRect(0,0,120,40);for(var ue,ce=0;ce<ge.length;++ce)ue=ge[ce],le.fillStyle='rgb('+ue+', '+ue+', '+ue+')',le.fillRect(ce%120,_Mathround(ce/120),1,1);try{var ce=ae.TreasureBox.captcha.correctQuestion(OCRAD(le.getImageData(0,0,120,40)));P('TreasureBox.DOM.image.load','question =',ce);var ue=ae.TreasureBox.captcha.eval(ce);P('TreasureBox.DOM.image.load','answer =',ue),void 0!==ue&&(console.info('['+C+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+ce+' = '+ue),ae.TreasureBox.promise.calc.resolve(ue))}catch(ce){ae.TreasureBox.promise.calc.reject()}},oe.resolve(),!0}catch(se){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+C+']',se),oe.reject(),!0}}),oe},run:function run(){try{if(!ae.CONFIG.AUTO_TREASUREBOX||!ae.TreasureBox.timer)return;if(B.blocked)return ae.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!te(ae.CACHE.TreasureBox_TS))return ae.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void Y(ae.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');ae.TreasureBox.getCurrentTask().then(function(oe){if(P('TreasureBox.run: TreasureBox.getCurrentTask().then',oe),0===oe.code){ae.TreasureBox.promise.timer=$.Deferred(),ae.TreasureBox.promise.timer.then(function(){ae.TreasureBox.captcha.calc().then(function(ne){ae.TreasureBox.getAward(ne).then(function(){return ae.TreasureBox.run()},function(){return ae.TreasureBox.run()})},function(){return TreasureBox.run()})}),ae.TreasureBox.time_end=oe.data.time_end,ae.TreasureBox.time_start=oe.data.time_start;var se=ae.TreasureBox.time_end-w()+1;0>se&&(se=0),setTimeout(function(){ae.TreasureBox.promise.timer&&ae.TreasureBox.promise.timer.resolve()},1e3*se),ae.TreasureBox.DOM.div_timer.text(se+'s'),ae.TreasureBox.DOM.div_timer.show(),ae.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+oe.data.times+'/'+oe.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+oe.data.silver)}else if(-10017===oe.code)ae.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),ae.CACHE.TreasureBox_TS=U(),ae.saveCache(),Y(ae.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===oe.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+oe.msg,'caution'),ae.TreasureBox.run()})}catch(oe){ae.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+C+']',oe)}},setMsg:function setMsg(oe){ae.CONFIG.AUTO_TREASUREBOX&&(ae.TreasureBox.promise.timer&&(ae.TreasureBox.promise.timer.reject(),ae.TreasureBox.promise.timer=void 0),ae.TreasureBox.DOM.div_timer&&ae.TreasureBox.DOM.div_timer.hide(),ae.TreasureBox.DOM.div_tip&&ae.TreasureBox.DOM.div_tip.html(oe))},getAward:function getAward(oe){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return ae.CONFIG.AUTO_TREASUREBOX?3<se?$.Deferred().resolve():R.TreasureBox.getAward(ae.TreasureBox.time_start,ae.TreasureBox.time_end,oe).then(function(ne){switch(P('TreasureBox.getAward: getAward',ne),ne.code){case 0:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+ne.data.awardSilver+' \u94F6\u74DC\u5B50','success');case-903:return $.Deferred().resolve();case-902:case-901:case-10017:return ae.TreasureBox.captcha.calc().then(function(le){return ae.TreasureBox.getAward(le,se)});case-800:return ae.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),$.Deferred().reject();case-500:var de=$.Deferred();return setTimeout(function(){ae.TreasureBox.captcha.calc().then(function(le){ae.TreasureBox.getAward(le,se+1).then(function(){return de.resolve()},function(){return de.reject()})},function(){return de.reject()})},3e3),de;case 400:return-1<ne.msg.indexOf('\u62D2\u7EDD')?(B.blocked=!0,ae.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ne.msg,'caution'),$.Deferred().resolve());default:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ne.msg,'caution');}},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.TreasureBox.getAward(oe,se)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return ae.CONFIG.AUTO_TREASUREBOX?R.TreasureBox.getCurrentTask().then(function(oe){return P('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',oe),$.Deferred().resolve(oe)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return ae.CONFIG.AUTO_TREASUREBOX?20<ae.TreasureBox.captcha.cnt?(ae.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):R.TreasureBox.getCaptcha(U()).then(function(oe){if(P('TreasureBox.captcha.calc: getCaptcha',oe),0===oe.code){ae.TreasureBox.captcha.cnt++;var se=$.Deferred();return ae.TreasureBox.promise.calc=$.Deferred(),ae.TreasureBox.promise.calc.then(function(ne){ae.TreasureBox.captcha.cnt=0,se.resolve(ne)},function(){ae.TreasureBox.captcha.calc().then(function(ne){se.resolve(ne)},function(){se.reject()})}),ae.TreasureBox.DOM.image.attr('src',oe.data.img),se}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+oe.msg,'caution'),H(function(){return ae.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.TreasureBox.captcha.calc()})}):(ae.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(oe){for(var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,ne=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,de=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,le=oe.getImageData(0,0,ne,de).data,_e=[],ge=0;ge<de;ge++)for(var ce=0;ce<ne;ce++){var ue=4*(ge*ne+ce),Ie=le.slice(ue,ue+4),pe=Ie?77*Ie[0]+150*Ie[1]+29*Ie[2]+128>>8:0;_e.push(pe>se?pe:0)}return _e},orderFilter2In3x3:function orderFilter2In3x3(oe){for(var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,ne=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,de=function gray(pe,fe){return 0<=pe+fe*ne?oe[pe+fe*ne]:255},le=[],_e=oe.length,pe=0;pe<_e;++pe){var ce=[pe%ne,_Mathfloor(pe/ne)],ue=ce[0],Ie=ce[1],fe=Array(9);fe[0]=de(ue-1,Ie-1),fe[1]=de(ue+0,Ie-1),fe[2]=de(ue+1,Ie-1),fe[3]=de(ue-1,Ie+0),fe[4]=de(ue+0,Ie+0),fe[5]=de(ue+1,Ie+0),fe[6]=de(ue-1,Ie+1),fe[7]=de(ue+0,Ie+1),fe[8]=de(ue+1,Ie+1),fe.sort(function(Te,me){return Te-me}),le.push(fe[se-1])}return le}},eval:function _eval(oe){var se=Function;return new se('return '+oe)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(oe){var se='';for(var ne in oe=oe.trim(),oe){var de=ae.TreasureBox.captcha.correctStr[oe[ne]];se+=void 0===de?oe[ne]:de}'4'===se[2]&&(se[2]='+');for(var ne=0;ne<=parseInt(se.length-2);ne++)'\''===se[ne]&&'1'===se[ne+1]&&(se[ne]='7',se.splice(ne+1,1));return se}}},Gift:{run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,notSendGiftList:[3,4,9,10,39,30588,30587,30586,30585],getMedalList:function getMedalList(){var oe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 1===oe&&(ae.Gift.medal_list=[]),R.i.medal(oe,25).then(function(se){if(P('Gift.getMedalList: API.i.medal',se),ae.Gift.medal_list=ae.Gift.medal_list.concat(se.data.fansMedalList),se.data.pageinfo.curPage<se.data.pageinfo.totalpages)return ae.Gift.getMedalList(oe+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.Gift.getMedalList(oe)})})},getBagList:function getBagList(){return R.gift.bag_list().then(function(oe){P('Gift.getBagList: API.gift.bag_list',oe),ae.Gift.bag_list=oe.data.list,ae.Gift.time=oe.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.Gift.getBagList()})})},getFeedByGiftID:function getFeedByGiftID(oe){for(var se=B.gift_list.length-1;0<=se;--se)if(B.gift_list[se].id===oe)return Math.ceil(B.gift_list[se].price/100);return 0},run:function(){var oe=_asyncToGenerator(regeneratorRuntime.mark(function se(){var ne,de,le,_e,ge,ce,ue,Ie,pe,fe;return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(ne=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.Gift.run()})},de=function nextTimeDebug(){var Oe=g(ae.CONFIG.GIFT_SEND_HOUR,ae.CONFIG.GIFT_SEND_MINUTE);setTimeout(ae.Gift.run,Oe);var Ee=new Date(U()+Oe).toLocaleString();P('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ee+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C')},me.prev=2,ae.CONFIG.AUTO_GIFT){me.next=5;break}return me.abrupt('return',$.Deferred().resolve());case 5:if(I(ae.CONFIG.GIFT_SEND_HOUR,ae.CONFIG.GIFT_SEND_MINUTE)||!1!=F){me.next=11;break}return le=g(ae.CONFIG.GIFT_SEND_HOUR,ae.CONFIG.GIFT_SEND_MINUTE),setTimeout(ae.Gift.run,le),_e=new Date(U()+le).toLocaleString(),P('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+_e+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),me.abrupt('return',$.Deferred().resolve());case 11:;return me.next=14,ae.Gift.getMedalList();case 14:if(P('Gift.run: Gift.getMedalList().then: Gift.medal_list',ae.Gift.medal_list),!(ae.Gift.medal_list&&0<ae.Gift.medal_list.length)){me.next=17;break}return me.delegateYield(regeneratorRuntime.mark(function Oe(){var Ee,ve,xe,Ae,he,Ge,Ce,Re,Ne,Me,De,Se,ye,be,Fe,Le;return regeneratorRuntime.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(ae.Gift.medal_list=ae.Gift.medal_list.filter(function(Be){return 0<Be.dayLimit-Be.today_feed&&20>Be.level}),ae.CONFIG.GIFT_SORT?ae.Gift.medal_list.sort(function(Be,ke){return 0==ke.level-Be.level?ke.intimacy-Be.intimacy:ke.level-Be.level}):ae.Gift.medal_list.sort(function(Be,ke){return 0==Be.level-ke.level?Be.intimacy-ke.intimacy:Be.level-ke.level}),!(ae.CONFIG.AUTO_GIFT_ROOMID&&0<ae.CONFIG.AUTO_GIFT_ROOMID.length)){we.next=25;break}for(Ee=ae.CONFIG.AUTO_GIFT_ROOMID.split(','),Ee.reverse(),ve=!0,xe=!1,Ae=void 0,we.prev=8,he=function _loop2(){var Be=Ce.value,ke=ae.Gift.medal_list.findIndex(function(He){return He.roomid==Be});if(-1!=ke){var He=ae.Gift.medal_list[ke];ae.Gift.medal_list.splice(ke,1),ae.Gift.medal_list.unshift(He)}},Ge=Ee[Symbol.iterator]();!(ve=(Ce=Ge.next()).done);ve=!0)he();we.next=17;break;case 13:we.prev=13,we.t0=we['catch'](8),xe=!0,Ae=we.t0;case 17:we.prev=17,we.prev=18,!ve&&Ge.return&&Ge.return();case 20:if(we.prev=20,!xe){we.next=23;break}throw Ae;case 23:return we.finish(20);case 24:return we.finish(17);case 25:Re=ae.CONFIG.GIFT_LIMIT,Ne=!0,Me=!1,De=void 0,we.prev=29,Se=ae.Gift.medal_list[Symbol.iterator]();case 31:if(Ne=(ye=Se.next()).done){we.next=47;break}return be=ye.value,we.next=35,R.room.room_init(parseInt(be.roomid,10));case 35:if(Fe=we.sent,ae.Gift.room_id=parseInt(Fe.data.room_id,10),ae.Gift.ruid=be.target_id,ae.Gift.remain_feed=be.day_limit-be.today_feed,!(0<ae.Gift.remain_feed)){we.next=44;break}return we.delegateYield(regeneratorRuntime.mark(function Be(){var ke,He,Pe;return regeneratorRuntime.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return Ye.next=2,ae.Gift.getBagList();case 2:if(ke=w(),ae.CONFIG.SEND_ALL_GIFT){Ye.next=7;break}if(He=ae.Gift.bag_list.filter(function(Xe){return!ae.Gift.notSendGiftList.includes(Xe.gift_id)&&0<Xe.gift_num&&Xe.expire_at>ke&&Xe.expire_at-ke<Re}),0!=He.length){Ye.next=7;break}return Ye.abrupt('return','break');case 7:;if(ae.CACHE.Gift_TS=U(),ae.saveCache(),!(0<ae.Gift.remain_feed)){Ye.next=20;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+be.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+be.today_feed+'/'+be.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+ae.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Ye.next=14,ae.Gift.sendGift(be);case 14:if(ae.CONFIG.SEND_ALL_GIFT){Ye.next=18;break}if(Pe=ae.Gift.bag_list.filter(function(Xe){return!ae.Gift.notSendGiftList.includes(Xe.gift_id)&&0<Xe.gift_num&&Xe.expire_at>ke&&Xe.expire_at-ke<Re}),0!=Pe.length){Ye.next=18;break}return Ye.abrupt('return','break');case 18:Ye.next=21;break;case 20:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+be.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 21:case'end':return Ye.stop();}},Be,ie)})(),'t1',41);case 41:if(Le=we.t1,'break'!==Le){we.next=44;break}return we.abrupt('break',47);case 44:Ne=!0,we.next=31;break;case 47:we.next=53;break;case 49:we.prev=49,we.t2=we['catch'](29),Me=!0,De=we.t2;case 53:we.prev=53,we.prev=54,!Ne&&Se.return&&Se.return();case 56:if(we.prev=56,!Me){we.next=59;break}throw De;case 59:return we.finish(56);case 60:return we.finish(53);case 61:case'end':return we.stop();}},Oe,ie,[[8,13,17,25],[18,,20,24],[29,49,53,61],[54,,56,60]])})(),'t0',17);case 17:return me.next=19,ae.Gift.getBagList();case 19:ge=0,ge=0;case 21:if(!(ge<=ae.Gift.bag_list.length-1)){me.next=27;break}if(1!=ae.Gift.bag_list[ge].gift_id){me.next=24;break}return me.abrupt('break',27);case 24:ge++,me.next=21;break;case 27:if(ce=ae.Gift.bag_list[ge],void 0!=ce){me.next=32;break}return F=!1,de(),me.abrupt('return',$.Deferred().resolve());case 32:if(ue=ae.Gift.getFeedByGiftID(ce.gift_id),Ie=86400,pe=w(),!(0!=ae.Gift.bag_list.filter(function(Oe){return!ae.Gift.notSendGiftList.includes(Oe.gift_id)&&0<Oe.gift_num&&Oe.expire_at>pe&&Oe.expire_at-pe<Ie}).length&&ce.expire_at>ae.Gift.time&&86400>ce.expire_at-ae.Gift.time&&'0'!=ae.CONFIG.SPARE_GIFT_ROOM&&'0'!=ae.CONFIG.SPARE_GIFT_UID&&0<ue)){me.next=38;break}return fe=ce.gift_num,me.abrupt('return',R.gift.bag_send(B.uid,ce.gift_id,ae.CONFIG.SPARE_GIFT_UID,fe,ce.bag_id,ae.CONFIG.SPARE_GIFT_ROOM,B.rnd).then(function(Oe){P('Gift.sendGift(\u5269\u4F59\u793C\u7269): API.gift.bag_send',Oe),0===Oe.code?window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+ae.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+fe+'\u4E2A'+ce.gift_name,'success'):window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+ae.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u5F02\u5E38:'+Oe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.Gift.sendGift(medal,ge)})}));case 38:me.next=46;break;case 40:return me.prev=40,me.t1=me['catch'](2),ne(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+C+']',me.t1),me.abrupt('return',$.Deferred().reject());case 46:F=!1,de();case 48:case'end':return me.stop();}},se,ie,[[2,40]])}));return function run(){return oe.apply(this,arguments)}}(),sendGift:function sendGift(oe){var se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(se>=ae.Gift.bag_list.length)return $.Deferred().resolve();if(0>=ae.Gift.remain_feed)return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+oe.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+oe.today_feed+'/'+oe.day_limit+']','info'),$.Deferred().resolve();0>=ae.Gift.time&&(ae.Gift.time=w());var ne=ae.Gift.bag_list[se];if(!ae.Gift.notSendGiftList.includes(ne.gift_id)&&ne.expire_at>ae.Gift.time&&ne.expire_at-ae.Gift.time<ae.CONFIG.GIFT_LIMIT||ae.CONFIG.SEND_ALL_GIFT){if(ne.gift_id==void 0)return $.Deferred().resolve();if(void 0==ne)return $.Deferred().resolve();var de=ae.Gift.getFeedByGiftID(ne.gift_id);if(0<de){var le=_Mathfloor(ae.Gift.remain_feed/de);if(le>ne.gift_num&&(le=ne.gift_num),0<le)return R.gift.bag_send(B.uid,ne.gift_id,ae.Gift.ruid,le,ne.bag_id,ae.Gift.room_id,B.rnd).then(function(_e){return P('Gift.sendGift: API.gift.bag_send',_e),0===_e.code?(ne.gift_num-=le,oe.today_feed+=le*de,ae.Gift.remain_feed-=le*de,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+oe.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+le+'\u4E2A'+ne.gift_name+'\uFF0C['+oe.today_feed+'/'+oe.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+ae.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+oe.medalName+'] \u9001\u793C\u5F02\u5E38:'+_e.msg,'caution'),ae.Gift.sendGift(oe,se+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),H(function(){return ae.Gift.sendGift(oe,se)})})}}return ae.Gift.sendGift(oe,se+1)}},MobileHeartBeat:{run:function(){var oe=_asyncToGenerator(regeneratorRuntime.mark(function se(){var ne,de,le;return regeneratorRuntime.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!1!=ae.CONFIG.MOBILE_HEARTBEAT){ge.next=2;break}return ge.abrupt('return',$.Deferred().resolve());case 2:if(te(ae.CACHE.MobileHeartBeat_TS)){ge.next=5;break}return Y(ae.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),ge.abrupt('return',$.Deferred().resolve());case 5:if(ne=function mobileOnline(){O({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+Q.access_token+'&'+V),data:'room_id='+B.room_id+'&scale=xxhdpi',responseType:'json',headers:K.headers})},de=function getWatchingAward(){return te(ae.CACHE.MobileHeartBeat_TS)?void R.activity.receive_award('double_watch_task').then(function(ce){return 0===ce.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u6210\u529F','success'),P('MobileHeartBeat GetAward',ce),clearInterval(le),ae.CACHE.MobileHeartBeat_TS=U(),ae.saveCache(),Y(ae.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),$.Deferred().resolve()):-400===ce.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u5DF2\u9886\u53D6','info'),P('MobileHeartBeat GetAward',ce),clearInterval(le),Y(ae.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),$.Deferred().resolve()):(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]'+ce,'warning'),P('MobileHeartBeat GetAward',ce),clearInterval(le),Y(ae.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),$.Deferred().resolve())},function(ce){return window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('MobileHeartBeat GetAward',ce),clearInterval(le),H(function(){return ae.MobileHeartBeat.run()})}):(P('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]','\u540C\u4E00\u5929\u4E0D\u9886\u53D6'),clearInterval(le),Y(ae.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),$.Deferred().resolve())},ge.t0=void 0===Q.access_token,!ge.t0){ge.next=14;break}return ge.next=11,Z();case 11:ge.t1=ge.sent,ge.t2=void 0,ge.t0=ge.t1===ge.t2;case 14:if(!ge.t0){ge.next=17;break}return P('MobileHeartBeat','token\u8BBE\u7F6E\u5931\u8D25'),ge.abrupt('return');case 17:P('MobileHeartBeat','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),ne(),le=void 0,le=setInterval(function(){return ne()},300000),setTimeout(function(){return de()},360000);case 22:case'end':return ge.stop();}},se,ie)}));return function run(){return oe.apply(this,arguments)}}()},stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(oe){var se=[];try{var ne=JSON.parse(localStorage.getItem(C+'stormIdSet'));se=[].concat(ne.list),se.push(oe),50<se.length&&se.splice(0,10),localStorage.setItem(C+'stormIdSet',JSON.stringify({list:se})),P(C+'storm_Id_list_add',se)}catch(ne){se.push(oe),localStorage.setItem(C+'stormIdSet',JSON.stringify({list:se}))}},isIn:function isIn(oe){var se=[];try{var ne=JSON.parse(localStorage.getItem(C+'stormIdSet'));return se=null===ne?[]:[].concat(ne.list),P(C+'storm_Id_list_read',ne),-1<se.indexOf(oe)}catch(ne){return localStorage.setItem(C+'stormIdSet',JSON.stringify({list:se})),P('\u8BFB\u53D6'+(C+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<se.indexOf(oe)}}},Storm:{check:function check(oe){return-1<ae.stormQueue.indexOf(oe)},append:function append(oe){ae.stormQueue.push(oe),ae.stormQueue.length>ae.CONFIG.STORM_QUEUE_SIZE&&ae.stormQueue.shift()},over:function over(oe){var se=ae.stormQueue.indexOf(oe);-1<se&&ae.stormQueue.splice(oe,1)},run:function run(oe){try{return ae.CONFIG.STORM?ae.stormBlack?$.Deferred().resolve():f(ae.CONFIG.TIME_AREA_START_H0UR,ae.CONFIG.TIME_AREA_END_H0UR,ae.CONFIG.TIME_AREA_START_MINUTE,ae.CONFIG.TIME_AREA_END_MINUTE)&&ae.CONFIG.TIME_AREA_DISABLE?(P('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+oe),$.Deferred().resolve()):R.Storm.check(oe).then(function(se){if(DEBUG('MY_API.Storm.run: MY_API.API.Storm.check',se),0===se.code){var ne=se.data;return ae.Storm.join(ne.id,ne.roomid,_Mathround(new Date().getTime()/1e3)+ne.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+oe+')'+se.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+oe+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(se){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+C+']',se),$.Deferred().reject()}},join:function join(oe,se,ne){var de=function(){var ce=_asyncToGenerator(regeneratorRuntime.mark(function ue(){var Ie,pe;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(Te.prev=0,ae.Storm.check(oe)){Te.next=4;break}return clearInterval(_e),Te.abrupt('return');case 4:if(Ie=_Mathround(new Date().getTime()/1e3),!(Ie>ne&&0<ne)){Te.next=9;break}return ae.Storm.over(oe),clearInterval(_e),Te.abrupt('return');case 9:if(ge++,!(ge>ae.CONFIG.STORM_MAX_COUNT&&0<ae.CONFIG.STORM_MAX_COUNT)){Te.next=15;break}return ae.Storm.over(oe),clearInterval(_e),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+oe+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+ge+',\u8DDD\u79BB\u5230\u671F:'+(ne-Ie)+'s','caution'),Te.abrupt('return');case 15:if(pe=void 0,Te.prev=16,!(z&&K&&Q.access_token)){Te.next=23;break}return Te.next=20,R.Storm.join_ex(oe,se,Q.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:pe=Te.sent,Te.next=26;break;case 23:return Te.next=25,R.Storm.join(oe,captcha_token='',captcha_phrase='',se);case 25:pe=Te.sent;case 26:if(DEBUG('MY_API.Storm.join: MY_API.API.Storm.join',pe),!pe.code){Te.next=51;break}if(-1==pe.msg.indexOf('\u9886\u53D6')){Te.next=33;break}return ae.Storm.over(oe),clearInterval(_e),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+se+',id='+oe+')\u6210\u529F,'+pe.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+ge,'success'),Te.abrupt('return');case 33:if(-1==pe.msg.indexOf('\u9A8C\u8BC1\u7801')){Te.next=39;break}return ae.Storm.over(oe),clearInterval(_e),ae.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+oe+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+pe.msg,'caution'),Te.abrupt('return');case 39:if(!(pe.data&&0==pe.data.length&&-1!=pe.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){Te.next=46;break}return ae.Storm.over(oe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+oe+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(_e),ae.stormBlack=!0,setTimeout(function(){ae.stormBlack=!1},3600000),Te.abrupt('return');case 46:if(-1!=pe.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){Te.next=49;break}return clearInterval(_e),Te.abrupt('return');case 49:Te.next=56;break;case 51:return ae.Storm.over(oe),Statistics.appendGift(pe.data.gift_name,pe.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+se+',id='+oe+')\u6210\u529F,'+(pe.data.gift_name+'x'+pe.data.gift_num)+'\r\n'+pe.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+ge,'success'),clearInterval(_e),Te.abrupt('return');case 56:Te.next=65;break;case 58:return Te.prev=58,Te.t0=Te['catch'](16),ae.Storm.over(oe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+oe+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+ge,'error'),console.error(Te.t0),clearInterval(_e),Te.abrupt('return');case 65:Te.next=74;break;case 67:return Te.prev=67,Te.t1=Te['catch'](0),ae.Storm.over(oe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+se+',id='+oe+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(Te.t1),clearInterval(_e),Te.abrupt('return');case 74:case'end':return Te.stop();}},ue,this,[[0,67],[16,58]])}));return function(){return ce.apply(this,arguments)}}();if(se=parseInt(se,10),oe=parseInt(oe,10),isNaN(se)||isNaN(oe))return $.Deferred().reject();var le=_Mathround(oe/1e6);if(ae.stormIdSet.isIn(le))return $.Deferred().resolve();if(ae.stormIdSet.add(le),!ae.Storm.check(oe)){ae.Storm.append(oe);var _e=0;0>=ne&&(ne=_Mathround(new Date().getTime()/1e3)+90);var ge=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+se+',id='+oe+')','success'),_e=setInterval(function(){return de()},ae.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}}};ae.init().then(function(){try{var oe=$.Deferred();(function uniqueCheck(){var ne=Date.now();return 0<=ne-ae.CACHE.UNIQUE_CHECK&&15e3>=ne-ae.CACHE.UNIQUE_CHECK?($('.link-toast').hide(),$('.igiftMsg').hide(),ae.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),oe.reject()):oe.resolve()})().then(function(){var ne,de=function uniqueMark(){ne=setTimeout(de,1e4),ae.CACHE.UNIQUE_CHECK=Date.now(),ae.saveCache(!1)};return window.addEventListener('unload',function(){ne&&(clearTimeout(ne),ae.CACHE.UNIQUE_CHECK=0,ae.saveCache())}),de(),0===parseInt(B.uid)||isNaN(parseInt(B.uid))?void ae.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(P('MY_API.CONFIG',ae.CONFIG),_(ae))})}catch(oe){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',oe)}})}function _(ie){'use strict';var ae=function clearStat(){ie.GIFT_COUNT.COUNT=0,ie.GIFT_COUNT.CLEAR_TS=ee(),ie.saveGiftCount(),P('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};te(ie.GIFT_COUNT.CLEAR_TS)&&ae(),X(ae,'\u91CD\u7F6E\u7EDF\u8BA1'),setTimeout(function(){ie.removeUnnecessary(),ie.GroupSign.run(),ie.DailyReward.run(),ie.LiveReward.run(),ie.Exchange.runS2C(),ie.TreasureBox.run(),ie.Gift.run(),ie.MobileHeartBeat.run()},6e3),ie.creatSetBox(),R.room.getList().then(function(de){P('\u76F4\u64AD\u95F4\u5217\u8868',de);var le=!0,_e=!1,ge=void 0;try{for(var Ie,ce=function _loop3(){var pe=Ie.value;R.room.getRoomList(pe.id,0,0,1,1).then(function(fe){P('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',fe);for(var Te=0;Te<fe.data.length;++Te)ie.listen(fe.data[Te].roomid,B.uid,pe.name+'\u533A')})},ue=de.data[Symbol.iterator]();!(le=(Ie=ue.next()).done);le=!0)ce()}catch(pe){_e=!0,ge=pe}finally{try{!le&&ue.return&&ue.return()}finally{if(_e)throw ge}}});var oe=function check_top_room(){if(ie.GIFT_COUNT.COUNT>=ie.CONFIG.MAX_GIFT&&(P('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),ie.max_blocked=!0),ie.blocked||ie.max_blocked)return ie.blocked?(ie.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(se)):void ie.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(f(ie.CONFIG.TIME_AREA_START_H0UR,ie.CONFIG.TIME_AREA_END_H0UR,ie.CONFIG.TIME_AREA_START_MINUTE,ie.CONFIG.TIME_AREA_END_MINUTE)&&ie.CONFIG.TIME_AREA_DISABLE)return void ie.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var de=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],le=0,_e=function checkHourRank(ce){R.rankdb.getTopRealTimeHour(ce).then(function(ue){var Ie=ue.data.list;ie.chatLog('\u68C0\u67E5'+de[ce]+'\u623F\u95F4\u7684\u793C\u7269','warning'),P(de[ce]+'\u623F\u95F4\u5217\u8868',Ie);var pe=!0,fe=!1,Te=void 0;try{for(var Oe,Ee,me=Ie[Symbol.iterator]();!(pe=(Oe=me.next()).done);pe=!0)Ee=Oe.value,ie.checkRoom(Ee.roomid,'\u5C0F\u65F6\u699C-'+Ee.area_v2_parent_name+'\u533A')}catch(Ee){fe=!0,Te=Ee}finally{try{!pe&&me.return&&me.return()}finally{if(fe)throw Te}}})},ge=setInterval(function(){le<=de.length-1?(_e(le),le++):clearInterval(ge)},1e3)};setTimeout(oe,6e3);var se=setInterval(oe,parseInt(1e3*ie.CONFIG.CHECK_HOUR_ROOM_INTERVAL)),ne=function reset(de){setTimeout(function(){if(0<ie.raffleId_list.length||0<ie.guardId_list.length||0<ie.pkId_list.length)return P('\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void ne(15000);if(f(ie.CONFIG.TIME_AREA_START_H0UR,ie.CONFIG.TIME_AREA_END_H0UR,ie.CONFIG.TIME_AREA_START_MINUTE,ie.CONFIG.TIME_AREA_END_MINUTE)&&ie.CONFIG.IN_TIME_RELOAD_DISABLE){var le=g(ie.CONFIG.TIME_AREA_START_MINUTE,ie.CONFIG.TIME_AREA_END_MINUTE);return ne(le),void P('\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+le+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},de)};ne(6e4*ie.CONFIG.TIME_RELOAD)}function g(ie,ae){var oe=new Date,se=oe.getHours(),ne=oe.getMinutes(),de=oe.getSeconds(),ge=1e3*(3600*ie)+1e3*(60*ae)-(1e3*(3600*se)+1e3*(60*ne)+1e3*de);return P('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',ge+'\u6BEB\u79D2'),0>ge?86400000+ge:ge}function u(ie){var ae=U()-ie;return P('[GetTomorrowIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',ae+'\u6BEB\u79D2'),86400000<ae?ae:86400000-ae}function I(ie,ae){var oe=new Date,se=oe.getHours(),ne=oe.getMinutes();return se==ie&&ne==ae||(P('\u9519\u8BEF\u65F6\u95F4'),!1)}function f(ie,ae,oe,se){if(23<ie||24<ae||0>ie||1>ae||59<oe||0>oe||59<se||0>se)return P('\u9519\u8BEF\u65F6\u95F4\u6BB5'),!1;var ne=new Date,de=ne.getHours(),le=ne.getMinutes();if(ie<ae)return de>=ie&&de<ae||de==ae&&le>=oe&&le<se;return ie>ae?de>=ie||de<ae||de==ae&&le>=oe&&le<se:ie==ae?le>=oe&&le<se:void 0}function T(ie){if(0>=ie)return!1;var ae=Math.random();return ie/100>=ae}function O(ie){return new Promise(function(ae){var oe=function onerror(se){console.error(GM_info.script.name,se),ae(void 0)};if(ie.GM)'POST'===ie.method&&(void 0===ie.headers&&(ie.headers={}),void 0===ie.headers['Content-Type']&&(ie.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),ie.timeout=30000,ie.onload=function(se){return ae({response:se,body:se.response})},ie.onerror=oe,ie.ontimeout=oe,GM_xmlhttpRequest(ie);else{var se=new XMLHttpRequest;se.open(ie.method,ie.url),'POST'===ie.method&&null===se.getResponseHeader('Content-Type')&&se.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),ie.cookie&&(se.withCredentials=!0),ie.responseType!==void 0&&(se.responseType=ie.responseType),se.timeout=30000,se.onload=function(ne){var de=ne.target;ae({response:de,body:de.response})},se.onerror=oe,se.ontimeout=oe,se.send(ie.data)}})}J.init(),$(function(){var ie=function loadInfo(ae){setTimeout(function(){var oe='undefined'==typeof unsafeWindow?window:unsafeWindow;oe.BilibiliLive===void 0||0===parseInt(oe.BilibiliLive.UID)||isNaN(parseInt(oe.BilibiliLive.UID))?(ie(1e3),P('\u65E0\u914D\u7F6E\u4FE1\u606F')):(B.room_id=oe.BilibiliLive.ROOMID,B.uid=oe.BilibiliLive.UID,R.live_user.get_info_in_room(B.room_id).then(function(se){P('InitData: API.live_user.get_info_in_room',se),B.mobile_verify=se.data.info.mobile_verify}),R.gift.gift_config().then(function(se){P('InitData: API.gift.gift_config',se),B.gift_list=se.data,B.gift_list.forEach(function(ne,de){0==de%3&&(B.gift_list_str+='<br>'),B.gift_list_str+=ne.id+'\uFF1A'+ne.name,de<B.gift_list.length-1&&(B.gift_list_str+='\uFF0C')})}),B.ruid=oe.BilibiliLive.ANCHOR_UID,B.rnd=oe.BilibiliLive.RND,B.visit_id=oe.__statisObserver?oe.__statisObserver.__visitId:'',P('Live_info',B),l())},ae)};ie(1e3),o()}),Array.prototype.remove=function(ie){var ae=this.indexOf(ie);-1<ae&&this.splice(ae,1)};var ee=function dateNow(){return Date.now()},te=function checkNewDay(ie){if(0===ie)return!0;var ae=new Date(ie),oe=new Date,se=ae.getDate(),ne=oe.getDate();return ne!==se}})();
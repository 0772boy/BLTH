// ==UserScript==
// @namespace     https://github.com/andywang425
// @name          B站直播自动抢辣条
// @name:en       B站直播自动抢辣条
// @author        andywang425
// @description   自动参与Bilibili直播区抽奖(虽然几乎没了);完成每日任务，领银瓜子宝箱，自动送礼，获取小心心，批量点亮勋章
// @description:en 自动参与Bilibili直播区抽奖(虽然几乎没了);完成每日任务，领银瓜子宝箱，自动送礼，获取小心心，批量点亮勋章
// @updateURL     https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @homepageURL   https://github.com/andywang425/Bilibili-SGTH/
// @supportURL    https://github.com/andywang425/Bilibili-SGTH/issues
// @icon          https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright     2020, andywang425 (https://github.com/andywang425)
// @license       MIT
// @version       3.9
// @include      /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at       document-end
// @connect      passport.bilibili.com
// @connect      api.live.bilibili.com
// @connect      live-trace.bilibili.com
//@require https://cdn.jsdelivr.net/gh/jquery/jquery@3.2.1/dist/jquery.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.4/BilibiliAPI_Mod.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.2/OCRAD.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.4/libBilibiliToken.user.js
// @grant       unsafeWindow
// @grant       GM_xmlhttpRequest
// @grant       GM_openInTab
// ==/UserScript==
'use strict';var _Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function I(T,f){try{var E=l[T](f),O=E.value}catch(R){return void u(R)}return E.done?void _(O):Promise.resolve(O).then(function(R){I('next',R)},function(R){I('throw',R)})}return I('next')})}}(function(){var G=this,C=!1,A='IGIFTMSG',D=BilibiliAPI,M=0,L=0,S=0,F=!1,w=window&&window.navigator?window.navigator.userAgent:'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36',U=new Date().getTimezoneOffset()+480,H=function ts_ms(){return Date.now()},k=function ts_s(){return _Mathround(H()/1e3)},B={room_id:void 0,uid:void 0,ruid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},P=function runUntilSucceed(ne){var de=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,se=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){ne()||P(ne,se,se)},de)},Y=function delayCall(ne){var de=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,se=$.Deferred();return setTimeout(function(){var le=ne();le&&le.then?le.then(function(_e,ge,ce,ue,Ie,pe){return se.resolve(_e,ge,ce,ue,Ie,pe)}):se.resolve()},de),se},V=function MYDEBUG(ne){for(var de=arguments.length,se=Array(1<de?de-1:0),le=1;le<de;le++)se[le-1]=arguments[le];var _e=new Date;return _e='['+A+']['+_e.getHours()+':'+_e.getMinutes()+':'+_e.getSeconds()+':'+_e.getMilliseconds()+']',1===se.length?void console.log(_e,ne+':',se[0]):void console.log(_e,ne+':',se)},X=function runMidnight(ne,de){var se=new Date;se.setMinutes(se.getMinutes()+U),se.setDate(se.getDate()+1),se.setHours(0,1,0,0),se.setMinutes(se.getMinutes()-U),setTimeout(ne,se-H()),V('runMidnight',(de||' ')+' '+se.toString())},K=function runExactMidnight(ne,de){var se=new Date;se.setMinutes(se.getMinutes()+U),se.setDate(se.getDate()+1),se.setHours(0,0,0,0),se.setMinutes(se.getMinutes()-U),setTimeout(ne,se-H()),V('runExactMidnight',(de||' ')+' '+se.toString())},Q=function runTomorrow(ne,de,se,le){var _e=new Date;_e.setMinutes(_e.getMinutes()+U),_e.setDate(_e.getDate()+1),_e.setHours(de,se,0,0),_e.setMinutes(_e.getMinutes()-U),setTimeout(ne,_e-H()),V('runTomorrow',(le||' ')+' '+_e.toString())},z=new BilibiliToken,Z='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',J=void 0,ee=JSON.parse(localStorage.getItem(A+'_userToken'))||{},te=function(){var ne=_asyncToGenerator(regeneratorRuntime.mark(function de(){return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(!(ee.time>k())){le.next=4;break}J=J,le.next=10;break;case 4:return le.next=6,z.getToken();case 6:ee=le.sent,ee.time=k()+ee.expires_in,localStorage.setItem(A+'_Token',JSON.stringify(ee)),J=ee;case 10:;return V(A+'_userToken',ee),le.abrupt('return','OK');case 13:case'end':return le.stop();}},de,G)}));return function setToken(){return ne.apply(this,arguments)}}(),ie={init:function init(){return ie.Toast.init().then(function(){})},Toast:{init:function init(){try{var ne=[];return window.toast=function(de){var se=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',le=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(se){case'success':case'info':break;case'caution':break;case'error':break;default:se='info';}var _e=$('<div class="link-toast '+se+' fixed"><span class="toast-text">'+de+'</span></div>')[0];document.body.appendChild(_e),_e.style.top=document.body.scrollTop+40*ne.length+10+'px',_e.style.left=document.body.offsetWidth+document.body.scrollLeft-_e.offsetWidth-5+'px',ne.push(_e),setTimeout(function(){_e.className+=' out',setTimeout(function(){ne.shift(),ne.forEach(function(ge){ge.style.top=parseInt(ge.style.top,10)-40+'px'}),$(_e).remove()},200)},le)},$.Deferred().resolve()}catch(ne){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',ne),$.Deferred().reject()}}}};function o(){$('head').append('\n        <style>\n            .igiftMsg_input{\n                outline: none;\n                border: 1px solid #e9eaec;\n                background-color: #fff;\n                border-radius: 4px;\n                padding: 1px 0 0;\n                overflow: hidden;\n                font-size: 12px;\n                line-height: 19px;\n                width: 30px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_btn{\n                background-color: #23ade5;\n                color: #fff;\n                border-radius: 4px;\n                border: none;\n                padding: 5px;\n                cursor: pointer;\n                box-shadow: 0 0 2px #00000075;\n                line-height: 10px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_fs{\n                border: 2px solid #d4d4d4;\n                \'z-index\': \'10001\';\n            }\n        </style>\n            ')}function l(){var de,ne=this,se={CONFIG_DEFAULT:{AUTO_GIFT:!1,AUTO_GIFT_ROOMID:'0',AUTO_GROUP_SIGN:!0,AUTO_TREASUREBOX:!0,CHECK_HOUR_ROOM_INTERVAL:120,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,EXCLUDE_ROOMID:'0',FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_TIME',GIFT_SORT:!1,IN_TIME_RELOAD_DISABLE:!1,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!1,LIGHT_MEDALS:'0',LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,MOBILE_HEARTBEAT:!0,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_july:!1,REMOVE_ELEMENT_player:!1,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',SPARE_GIFT_UID:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:60,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,MobileHeartBeat_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{D.setCommonArgs(B.bili_jct)}catch(_e){return void console.error('['+A+']',_e)}var le=$.Deferred();try{se.loadConfig().then(function(){se.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),le.resolve()})}catch(_e){console.error('API\u521D\u59CB\u5316\u51FA\u9519',_e),se.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),le.reject()}try{se.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),le.resolve()})}catch(_e){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',_e),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),le.reject()}return setTimeout(function(){se.TreasureBox.init()},5750),le},loadConfig:function loadConfig(){var le=$.Deferred();try{var _e=JSON.parse(localStorage.getItem(A+'_CONFIG'));for(var ge in $.extend(!0,se.CONFIG,se.CONFIG_DEFAULT),se.CONFIG)se.CONFIG.hasOwnProperty(ge)&&void 0!==_e[ge]&&null!==_e[ge]&&(se.CONFIG[ge]=_e[ge]);se.loadGiftCount(),le.resolve()}catch(_e){V('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',_e),se.setDefaults(),le.reject()}return le},loadCache:function loadCache(){var le=$.Deferred();try{var _e=JSON.parse(localStorage.getItem(A+'_CACHE'));for(var ge in $.extend(!0,se.CACHE,se.CACHE_DEFAULT),se.CACHE)se.CACHE.hasOwnProperty(ge)&&void 0!==_e[ge]&&null!==_e[ge]&&(se.CACHE[ge]=_e[ge]);le.resolve()}catch(_e){V('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',_e),se.setDefaults(),le.reject()}return le},newMessage:function newMessage(le){try{var ge=localStorage.getItem(A+'_NEWMSG_CACHE');(ge==void 0||null==ge||'3.9'!=ge)&&'3.9'==le&&(alert(le+'\u66F4\u65B0\u63D0\u793A\uFF1A\n\n                \u8BF7\u9605\u8BFB\u4E00\u4E0B\u811A\u672C\u8BF4\u660E\u4E2D\u7684\u5C0F\u5FC3\u5FC3\u90E8\u5206\uFF0C\u83B7\u53D6\u65B9\u5F0F\u6709\u53D8\u52A8\u3002\n\n                \u7B49b\u7AD9\u5220\u9664\u8FA3\u6761\u540E\u811A\u672C\u4F1A\u6539\u540D(\u76EE\u524D\u597D\u50CF\u5C31\u5269\u4E2A\u6D41\u661F\u96E8\u6709\u62BD\u5956\u4E86)\uFF0C\n                \uFF08greasyfork\u7528\u6237\u53EF\u5FFD\u7565\u4EE5\u4E0B\u90E8\u5206\uFF09\u6240\u4EE5\u66F4\u65B0\u94FE\u63A5\u4E5F\u4F1A\u53D8\u5316\u3002\n                \u6539\u540D\u540E\uFF0C\u6211\u4F1A\u53D1\u5E03B\u7AD9\u76F4\u64AD\u81EA\u52A8\u62A2\u8FA3\u6761\u7684\u6700\u7EC8\u7248\u672C\u3002\n                \u5B89\u88C5\u8FD9\u4E2A\u7248\u672C\u540E\u811A\u672C\u4F1A\u63D0\u793A\u4F60\u5B89\u88C5\u6539\u540D\u540E\u7684\u65B0\u811A\u672C\u3002\n\n                \u672C\u63D0\u793A\u5728\u6BCF\u4E2A\u7248\u672C\u4EC5\u4F1A\u51FA\u73B0\u4E00\u6B21\u3002'),localStorage.setItem(A+'_NEWMSG_CACHE',le))}catch(ge){V('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25',ge)}},saveConfig:function saveConfig(){try{return localStorage.setItem(A+'_CONFIG',JSON.stringify(se.CONFIG)),se.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),V('MY_API.CONFIG',se.CONFIG),!0}catch(le){return V('API\u4FDD\u5B58\u51FA\u9519',le),!1}},saveCache:function saveCache(le){try{return localStorage.setItem(A+'_CACHE',JSON.stringify(se.CACHE)),!1!=le&&V('CACHE\u5DF2\u4FDD\u5B58',se.CACHE),!0}catch(_e){return V('CACHE\u4FDD\u5B58\u51FA\u9519',_e),!1}},setDefaults:function setDefaults(){se.CONFIG=se.CONFIG_DEFAULT,se.CACHE=se.CACHE_DEFAULT,se.saveConfig(),se.saveCache(),se.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6BCF\u65E5\u4EFB\u52A1','info'),setTimeout(function(){se.CACHE=se.CACHE_DEFAULT,se.GroupSign.run(),se.DailyReward.run(),se.LiveReward.run(),se.Exchange.runS2C(),se.TreasureBox.run(),se.Gift.run(),se.MobileHeartBeat.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var le=JSON.parse(localStorage.getItem(A+'_GIFT_COUNT'));for(var _e in se.GIFT_COUNT)se.GIFT_COUNT.hasOwnProperty(_e)&&void 0!==le[_e]&&null!==le[_e]&&(se.GIFT_COUNT[_e]=le[_e]);V('MY_API.GIFT_COUNT',se.GIFT_COUNT)}catch(le){V('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',le)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(A+'_GIFT_COUNT',JSON.stringify(se.GIFT_COUNT)),V('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',se.GIFT_COUNT),!0}catch(le){return V('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',le),!1}},addGift:function addGift(le){se.GIFT_COUNT.COUNT+=le,$('#giftCount span:eq(0)').text(se.GIFT_COUNT.COUNT),se.saveGiftCount()},addSilver:function addSilver(le){se.GIFT_COUNT.SILVER_COUNT+=10*le,$('#giftCount span:eq(1)').text(se.GIFT_COUNT.SILVER_COUNT),se.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){var le=['#my-dear-haruna-vm','.july-activity-entry','.bilibili-live-player'],_e=function removeUntiSucceed(ge,ce){!0===se.CONFIG[ge]&&setInterval(function(){0<$(le[ce]).length&&$(le[ce]).remove()},200)};_e('REMOVE_ELEMENT_2233',0),_e('REMOVE_ELEMENT_july',1),_e('REMOVE_ELEMENT_player',2)},creatSetBox:function creatSetBox(){function le(){var Oe,ve,xe=se.CONFIG.TIME_AREA_START_H0UR=parseInt(ge.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),Re=se.CONFIG.TIME_AREA_END_H0UR=parseInt(ge.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Ge=se.CONFIG.TIME_AREA_START_MINUTE=parseInt(ge.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),Ce=se.CONFIG.TIME_AREA_END_MINUTE=parseInt(ge.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(0>xe||0>Re||0>Ge||0>Ce)return void se.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=xe||24<=Re||60<=Ge||60<=Ce)return void se.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(se.CONFIG.TIME_AREA_START_H0UR=xe,se.CONFIG.TIME_AREA_END_H0UR=Re,se.CONFIG.TIME_AREA_START_MINUTE=Ge,se.CONFIG.TIME_AREA_END_MINUTE=Ce,Oe=parseFloat(ge.find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>Oe||100<Oe)return void se.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(se.CONFIG.RANDOM_SKIP=Oe,Oe=parseFloat(ge.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<Oe)return void se.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>Oe)return void se.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(se.CONFIG.RANDOM_SEND_DANMU=Oe,Oe=parseInt(ge.find('div[data-toggle="MAX_GIFT"] .num').val()),se.CONFIG.MAX_GIFT=Oe,Oe=parseInt(ge.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=Oe||1e4<Oe)return void se.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(se.CONFIG.TIME_RELOAD=Oe,Oe=parseFloat(ge.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),Re=parseFloat(ge.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>Oe||100<Re)return void se.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(Re<=Oe)return void se.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(se.CONFIG.RND_DELAY_START=Oe,se.CONFIG.RND_DELAY_END=Re,Oe=parseInt(ge.find('div[data-toggle="COIN"] .coin_number').val()),0>Oe||5<Oe)return void se.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(se.CONFIG.COIN_NUMBER=Oe,Oe=parseInt(ge.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=Oe)return void se.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');se.CONFIG.CHECK_HOUR_ROOM_INTERVAL=Oe,Oe=ge.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),ve=Oe.split(',');for(var he=0;he<ve.length;he++)''===ve[he]&&(ve[he]=0);Oe=ve.join(','),se.CONFIG.AUTO_GIFT_ROOMID=Oe,Oe=ge.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),ve=Oe.split(',');for(var he=0;he<ve.length;he++)''===ve[he]&&(ve[he]=0);return(Oe=ve.join(','),se.CONFIG.EXCLUDE_ROOMID=Oe,Oe=parseInt(ge.find('div[data-toggle="GIFT_LIMIT"] .num').val()),se.CONFIG.GIFT_LIMIT=Oe,xe=parseInt(ge.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),Re=parseInt(ge.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>xe||0>Re)?void se.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning'):24<=xe||60<=Re?void se.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning'):void(se.CONFIG.GIFT_SEND_HOUR=xe,se.CONFIG.GIFT_SEND_MINUTE=Re,Oe=ge.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),se.CONFIG.SPARE_GIFT_ROOM=Oe,Oe=ge.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(),se.CONFIG.SPARE_GIFT_UID=Oe,Oe=parseInt(ge.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),se.CONFIG.STORM_QUEUE_SIZE=Oe,Oe=parseInt(ge.find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),se.CONFIG.STORM_MAX_COUNT=Oe,Oe=parseInt(ge.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),se.CONFIG.STORM_ONE_LIMIT=Oe,Oe=parseInt(ge.find('div[data-toggle="COIN_UID"] .num').val()),se.CONFIG.COIN_UID=Oe,Oe=ge.find('div[data-toggle="LIGHT_MEDALS"] .num').val(),se.CONFIG.LIGHT_MEDALS=Oe,se.saveConfig())}var _e=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F<br></button>');_e.click(function(){if(!1==C){C=!0,$('.igiftMsg').hide(),ge.hide();var Oe=$('.chat-history-list');Oe.animate({scrollTop:0},0),setTimeout(function(){Oe.animate({scrollTop:Oe.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}else{C=!1,$('.igiftMsg').show(),ge.show();var Oe=$('.chat-history-list');Oe.animate({scrollTop:Oe.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}}),$('.attention-btn-ctnr').append(_e);var ge=$('<div>'),ce=$('.live-player-mounter').height();ge.css({width:'auto',height:ce,position:'absolute',top:'-2px',right:'0px',background:'#F0F0F0',padding:'10px',"z-index":'10001',"border-radius":'4px',overflow:'scroll',"line-height":'15px'}),ge.append('\n                <div id=\'allsettings\'>\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n                    <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n                        \u8FA3\u6761&nbsp;<span>'+se.GIFT_COUNT.COUNT+'</span>\n                        \u94F6\u74DC\u5B50&nbsp;<span>'+se.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n                    </div>\n                </fieldset>\n                <div id="left_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u4F4E\u8C03\u8BBE\u7F6E</legend>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u542F\u7528\n                                <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                                <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_GIFT">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM_INTERVAL">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\n                            </label>\n                        </div>\n            \n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u767B\u9646\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u89C2\u770B\u89C6\u9891\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="cursor: pointer; vertical-align: text-top;" type="checkbox">\n                                \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                            </label>\n                        </div>\n                        <div data-toggle="COIN_TYPE" style=" color: black">\n                            <div data-toggle="COIN_UID">\n                            <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                            \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                            \u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                            <div data-toggle="COIN_DYN">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5206\u4EAB\u89C6\u9891\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u76F4\u64AD\u533A\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5E94\u63F4\u56E2\u7B7E\u5230\n                        </div>\n                        <div data-toggle="MOBILE_HEARTBEAT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u6A21\u62DF\u79FB\u52A8\u7AEF\u5FC3\u8DF3 + \u9886\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD\u5956\u52B1\n                        </div>\n                        <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9001\u793C\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            \u4F18\u5148\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                            \u4E0D\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n                        <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u95F4\u9694\n                            <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                            \u5206\u949F\u9001\u793C\n                        </div>\n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u5B9A\u65F6\u9001\u793C<br>\n                            \u9001\u793C\u65F6\u95F4\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n                        </div>\n                        \n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            \u793C\u7269\u5230\u671F\u65F6\u95F4\n                            <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                            \u5929\n                        </div>\n                        <div data-toggle="GIFT_SORT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u793C\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                        <div data-toggle="SPARE_GIFT_UID" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\u62E5\u6709\u8005UID\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            \u6BEB\u79D2\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8BF4\u660E</legend>\n                        \u81EA\u52A8\u9001\u793C\u76EE\u524D\u53EA\u4F1A\u9001\u51FA\u8FA3\u6761\uFF0C\u4EBF\u5706\u548C\u5C0F\u5FC3\u5FC3\u3002<br>\n                        \u793C\u7269\u5230\u671F\u65F6\u95F4: \u5C06\u8981\u5728\u8FD9\u4E2A\u65F6\u95F4\u6BB5\u91CC\u8FC7\u671F\u7684\u793C\u7269\u4F1A\u88AB\u9001\u51FA<br>\n                        \u52FE\u9009\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u65F6\u65E0\u8BBA\u662F\u5426\u5C06\u8981\u8FC7\u671F\u90FD\u4F1A\u88AB\u9001\u51FA<br>\n                        \u5982\u679C\u8981\u586B\u5199\u591A\u4E2A\u4F18\u5148\u9001\u793C\u623F\u95F4\uFF0C<br>\n                        \u6BCF\u4E2A\u623F\u95F4\u53F7\u4E4B\u95F4\u9700\u7528\u534A\u89D2\u9017\u53F7,\u9694\u5F00\u3002(\u4E0D\u9001\u793C\u623F\u95F4\uFF0C\u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\u540C\u7406)<br>\n                        \u5982 666,777,888\u3002\u4E3A0\u5219\u4E0D\u9001\u3002<br>\n                        \u5982\u679C\u6CA1\u6709\u8FD9\u4E9B\u623F\u95F4\u7684\u7C89\u4E1D\u724C\u4E5F\u4E0D\u9001\u3002<br>\n                        \u65E0\u8BBA\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u5982\u4F55\u8BBE\u7F6E\uFF0C\u4F1A\u6839\u636E\u3010\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u3011<br>\n                        \uFF08\u52FE\u9009\u5219\u8865\u6EE1\uFF0C\u5426\u5219\u53EA\u9001\u5230\u671F\u7684\uFF09\u6761\u4EF6\u53BB\u6309\u4F18\u5148\u9001\u793C\u623F\u95F4\u5148\u540E\u987A\u5E8F\u9001\u793C\u3002<br>\n                        \u4E4B\u540E\u6839\u636E\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u51B3\u5B9A\u5148\u9001\u9AD8\u7EA7\u8FD8\u662F\u4F4E\u7EA7\uFF08\u52FE\u9009\u5148\u9AD8\u7EA7\uFF0C\u4E0D\u52FE\u9009\u5148\u4F4E\u7EA7\uFF09\u3002<br>\n                        \u5269\u4F59\u793C\u7269:\u6307\u9001\u5B8C\u4E86\u6240\u6709\u7C89\u4E1D\u724C\uFF0C\u4F46\u4ECD\u6709\u5269\u4F59\u7684\u5C06\u57281\u5929\u5185\u8FC7\u671F\u7684\u793C\u7269\u3002<br>\n                        \u5269\u4F59\u793C\u7269\u4E5F\u4F1A\u5728\u6307\u5B9A\u9001\u793C\u65F6\u95F4\u88AB\u9001\u51FA\u3002<br>\n                        \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\u98CE\u9669\u8F83\u5927\uFF0C\u5982\u679C\u6CA1\u6709\u5B9E\u540D\u53EF\u80FD\u65E0\u6CD5\u53C2\u52A0\u3002<br>\n                        \u811A\u672C\u4EC5\u80FD\u53C2\u52A0\u5E7F\u64AD\u4E2D\u7684\u8282\u594F\u98CE\u66B4\u3002<br>\n                        \u3010\u7ED9\u7528\u6237(UID:___)\u7684\u89C6\u9891\u6295\u5E01\u3011\u82E5\u586B0\u5219\u7ED9\u52A8\u6001\u4E2D\u7684\u89C6\u9891\u4F9D\u6B21\u6295\u5E01(\u56E0\u4E3A\u65E0UID\u4E3A0\u7684\u7528\u6237)\n            \n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n                        <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u540E\u53F0\u5FAA\u73AF\u5F00\u5173\u6807\u7B7E\u9875\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                            </label>\n                        </div>\n                        <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                            \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n                        <input class="num igiftMsg_input" style="width: 300px;" type="text">\n                    </div>\n                    <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n                        \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n                        <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u767D\u540D\u5355\n                        </div>\n                        <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                            &nbsp;\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u9ED1\u540D\u5355\n                        </div>\n                    </div>\n                    <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n                    <label style="margin: 5px auto; color: black">\n                        <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n                    </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n                        <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u96642233\u6A21\u578B\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_july" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u590F\u65E5\u6D3B\u52A8\u5165\u53E3\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_player" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u76F4\u64AD\u753B\u9762\n                        </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 15px">\n                        <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n                        <div data-toggle="TIME_RELOAD" style="color: black">\n                            \u672C\u76F4\u64AD\u95F4\u5237\u65B0\u65F6\u95F4\uFF1A\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\u5206\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u91CD\u8F7D\u76F4\u64AD\u95F4\n                            </label>\n                        </div>\n                        <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: red;">\n                                <input style="vertical-align: text-top;" type="checkbox">\u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n                            </label>\n                        </div>\n                        <div id="resetArea">\n                            <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                            <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6BCF\u65E5\u4EFB\u52A1</button>\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n                        </div>\n            \n                    </fieldset>\n                    <label style="color: darkblue; font-size:large;">\n                        v'+GM_info.script.version+' <a href="https://github.com/andywang425/Bilibili-SGTH/"\n                            target="_blank">\u66F4\u591A\u8BF4\u660E\u548C\u66F4\u65B0\u65E5\u5FD7\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n                    </label>\n                </div>\n            </div>\n    '),$('.live-player-mounter').append(ge),ge.find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(se.CONFIG.GIFT_INTERVAL).toString()),ge.find('div[data-toggle="LIGHT_MEDALS"] .num').val(se.CONFIG.LIGHT_MEDALS.toString()),ge.find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(se.CONFIG.STORM_MAX_COUNT).toString()),ge.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(se.CONFIG.STORM_ONE_LIMIT).toString()),ge.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(se.CONFIG.STORM_QUEUE_SIZE).toString()),ge.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(se.CONFIG.SPARE_GIFT_UID.toString()),ge.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(se.CONFIG.SPARE_GIFT_ROOM.toString()),ge.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(se.CONFIG.TIME_RELOAD).toString()),ge.find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(se.CONFIG.RANDOM_SKIP).toString()),ge.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(se.CONFIG.RANDOM_SEND_DANMU).toString()),ge.find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(se.CONFIG.MAX_GIFT).toString()),ge.find('div[data-toggle="COIN"] .coin_number').val(parseInt(se.CONFIG.COIN_NUMBER).toString()),ge.find('div[data-toggle="COIN_UID"] .num').val(parseInt(se.CONFIG.COIN_UID).toString()),ge.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(se.CONFIG.RND_DELAY_START).toString()),ge.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(se.CONFIG.RND_DELAY_END).toString()),ge.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(se.CONFIG.TIME_AREA_START_H0UR).toString()),ge.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(se.CONFIG.TIME_AREA_END_H0UR).toString()),ge.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(se.CONFIG.TIME_AREA_START_MINUTE).toString()),ge.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(se.CONFIG.TIME_AREA_END_MINUTE).toString()),ge.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val(parseInt(se.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),ge.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(se.CONFIG.AUTO_GIFT_ROOMID.toString()),ge.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(se.CONFIG.EXCLUDE_ROOMID.toString()),ge.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(se.CONFIG.GIFT_SEND_HOUR.toString()),ge.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(se.CONFIG.GIFT_SEND_MINUTE.toString()),ge.find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(se.CONFIG.GIFT_LIMIT).toString());ge.find('div[id="giftCount"] [data-action="save"]').click(function(){le()}),ge.find('button[data-action="reset"]').click(function(){se.setDefaults()}),ge.find('button[data-action="checkUpdate"]').click(function(){se.checkUpdate()}),ge.find('button[data-action="redo_dailyTasks"]').click(function(){se.ReDoDailyTasks()}),ge.find('#resetArea [data-action="countReset"]').click(function(){se.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},se.saveGiftCount(),$('#giftCount span:eq(0)').text(se.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(se.GIFT_COUNT.SILVER_COUNT),se.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),ge.find('button[data-action="sendGiftNow"]').click(function(){F=!0,se.Gift.run()});var ue=['RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','GIFT_SORT','SEND_ALL_GIFT','MOBILE_HEARTBEAT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_july','REMOVE_ELEMENT_player','FORCE_LIGHT'],Ie=!0,pe=!1,Te=void 0;try{for(var me,fe=function _loop(){var Oe=me.value,ve=ge.find('div[data-toggle="'+Oe+'"] input:checkbox');se.CONFIG[Oe]&&ve.attr('checked',''),ve.change(function(){se.CONFIG[Oe]=$(this).prop('checked'),se.saveConfig()})},Ee=ue[Symbol.iterator]();!(Ie=(me=Ee.next()).done);Ie=!0)fe()}catch(Oe){pe=!0,Te=Oe}finally{try{!Ie&&Ee.return&&Ee.return()}finally{if(pe)throw Te}}$('input:text').bind('keydown',function(Oe){'13'==Oe.keyCode&&le()}),'COIN_DYN'==se.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==se.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==se.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');$('input:radio[name=\'COIN_TYPE\']').change(function(){var Oe=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked');se.CONFIG.COIN_TYPE=!0==Oe?'COIN_DYN':'COIN_UID',se.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){var Oe=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked');se.CONFIG.LIGHT_METHOD=!0==Oe?'LIGHT_WHITE':'LIGHT_BLACK',se.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){var Oe=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked');se.CONFIG.GIFT_METHOD=!0==Oe?'GIFT_INTERVAL':'GIFT_SEND_TIME',se.saveConfig()})},chatLog:function chatLog(le){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',ge=$('<div class=\'igiftMsg\'>'),ce=$('<div>'),ue=$('#chat-history-list'),Ie=new Date;ce.text(le),ge.text(Ie.toLocaleString()),ge.append(ce),ge.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),ce.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===_e?ge.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===_e?ge.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===_e?ge.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):ge.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});!1==C?ue.find('#chat-items').append(ge):ue.find('#chat-items').append(ge.hide()),ue.scrollTop(ue.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(le,_e){var ge=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';D.room.getConf(le).then(function(ce){V('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+ge,ce);var ue=new D.DanmuWebSocket(_e,le,ce.data.host_server_list,ce.data.token);ue.bind(function(Ie){ue=Ie,se.chatLog(ge+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){se.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+le+' \u5206\u533A: '+ge,'success')},function(){(se.blocked||se.stormBlack)&&(ue.close(),se.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ge,'warning')),se.max_blocked&&!se.CONFIG.STORM&&(ue.close(),se.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+ge,'warning'))},function(Ie){if(!(f(se.CONFIG.TIME_AREA_START_H0UR,se.CONFIG.TIME_AREA_END_H0UR,se.CONFIG.TIME_AREA_START_MINUTE,se.CONFIG.TIME_AREA_END_MINUTE)&&se.CONFIG.TIME_AREA_DISABLE))switch(V('\u5F39\u5E55\u516C\u544A'+ge,Ie),Ie.cmd){case'GUARD_MSG':Ie.roomid===Ie.real_roomid?se.checkRoom(Ie.roomid,ge):(se.checkRoom(Ie.roomid,ge),se.checkRoom(Ie.real_roomid,ge));break;case'PK_BATTLE_SETTLE_USER':Ie.data.winner?se.checkRoom(Ie.data.winner.room_id,ge):se.checkRoom(Ie.data.my_info.room_id,ge),se.checkRoom(Ie.data.winner.room_id,ge);break;case'NOTICE_MSG':switch(Ie.msg_type){case 1:break;case 2:case 3:case 4:case 8:Ie.roomid===Ie.real_roomid?se.checkRoom(Ie.roomid,ge):(se.checkRoom(Ie.roomid,ge),se.checkRoom(Ie.real_roomid,ge));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+Ie.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),se.Storm.run(Ie.roomid);}break;case'SPECIAL_GIFT':if(Ie.data[39])switch(Ie.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+Ie.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),se.Storm.run(Ie.roomid);case'end':};break;default:}})},function(){se.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(le){var _e=[];try{var ge=JSON.parse(localStorage.getItem(A+'_EntryRoom_list'));_e=[].concat(ge.list),_e.push(le),100<_e.length&&_e.splice(0,50),localStorage.setItem(A+'_EntryRoom_list',JSON.stringify({list:_e})),V(A+'_EntryRoom_list_add',_e)}catch(ge){_e.push(le),localStorage.setItem(A+'_EntryRoom_list',JSON.stringify({list:_e}))}},isIn:function isIn(le){var _e=[];try{var ge=JSON.parse(localStorage.getItem(A+'_EntryRoom_list'));return _e=null===ge?[]:[].concat(ge.list),V(A+'_EntryRoom_list_read',ge),-1<_e.indexOf(le)}catch(ge){return localStorage.setItem(A+'_EntryRoom_list',JSON.stringify({list:_e})),V('\u8BFB\u53D6'+(A+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<_e.indexOf(le)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(le){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';se.blocked||se.max_blocked||0<=se.RoomId_list.indexOf(le)||(se.RoomId_list.push(le),se.EntryRoom_list_history.isIn(le)||(D.room.room_entry_action(le),se.EntryRoom_list_history.add(le)),O(se.CONFIG.RANDOM_SEND_DANMU)&&D.sendLiveDanmu(se.auto_danmu_list[_Mathfloor(12*Math.random())],le).then(function(ge){V('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',ge)}),D.xlive.lottery.check(le).then(function(ge){se.RoomId_list.remove(le),V('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',ge);var ce=ge.data;if(0===ge.code){var ue;if(ce.gift)for(var Ie in ue=ce.gift,ue)ue.hasOwnProperty(Ie)&&se.creat_join(le,ue[Ie],'gift',_e);if(ce.guard)for(var Ie in ue=ce.guard,ue)ue.hasOwnProperty(Ie)&&se.creat_join(le,ue[Ie],'guard',_e);if(ce.pk)for(var Ie in ue=ce.pk,ue)ue.hasOwnProperty(Ie)&&se.creat_join(le,ue[Ie],'pk',_e)}else se.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<se.err_roomId.indexOf(le)?V('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+le+ge.message):(se.err_roomId.push(le),se.checkRoom(le,_e),V('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+le+ge.message))}))},Id_list_history:{add:function add(le,_e){var ge=[];try{var ce=JSON.parse(localStorage.getItem(A+'_'+_e+'Id_list'));ge=[].concat(ce.list),ge.push(le),200<ge.length&&ge.splice(0,50),localStorage.setItem(A+'_'+_e+'Id_list',JSON.stringify({list:ge})),V(A+'_'+_e+'Id_list_add',ge)}catch(ce){ge.push(le),localStorage.setItem(A+'_'+_e+'Id_list',JSON.stringify({list:ge}))}},isIn:function isIn(le,_e){var ge=[];try{var ce=JSON.parse(localStorage.getItem(A+'_'+_e+'Id_list'));return ge=null===ce?[]:[].concat(ce.list),V(A+'_'+_e+'Id_list_read',ce),-1<ge.indexOf(le)}catch(ce){return localStorage.setItem(A+'_'+_e+'Id_list',JSON.stringify({list:ge})),V('\u8BFB\u53D6'+(A+'_'+_e+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ge.indexOf(le)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(le,_e,ge){var ce=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(V('\u793C\u7269\u4FE1\u606F',_e),se.GIFT_COUNT.COUNT>=se.CONFIG.MAX_GIFT)return V('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(se.max_blocked=!0);switch(ge){case'gift':if(se.Id_list_history.isIn(_e.raffleId,'raffle'))return void V('\u793C\u7269\u91CD\u590D','raffleId '+_e.raffleId);se.raffleId_list.push(_e.raffleId),se.Id_list_history.add(_e.raffleId,'raffle');break;case'guard':if(se.Id_list_history.isIn(_e.id,'guard'))return void V('\u8230\u957F\u91CD\u590D','id '+_e.id);se.guardId_list.push(_e.id),se.Id_list_history.add(_e.id,'guard');break;case'pk':if(se.Id_list_history.isIn(_e.id,'pk'))return void V('pk\u91CD\u590D','id '+_e.id);se.pkId_list.push(_e.id),se.Id_list_history.add(_e.id,'pk');}var ue=_e.time_wait||0;se.CONFIG.RANDOM_DELAY&&(ue+=_Mathfloor(Math.random()*(se.CONFIG.RND_DELAY_END-se.CONFIG.RND_DELAY_START+1))+se.CONFIG.RND_DELAY_START);var Ie=$('<div class=\'igiftMsg\'>'),pe=$('<div>'),Te=$('<div>'),fe=$('#chat-history-list'),Ee=new Date;pe.text('['+ce+']'+_e.thank_text.split('<%')[1].split('%>')[0]+_e.thank_text.split('%>')[1]),Ie.text(Ee.toLocaleString()),Ie.append(pe),Te.css('color','red'),Te.text('\u7B49\u5F85\u62BD\u5956'),pe.append(Te),Ie.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),pe.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),Ie.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),!1==C?fe.find('#chat-items').append(Ie):fe.find('#chat-items').append(Ie.hide()),fe.scrollTop(fe.prop('scrollHeight'));var me=setInterval(function(){Te.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+ue+'\u79D2'),0>=ue&&(O(se.CONFIG.RANDOM_SKIP)?Te.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(Te.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===ge?se.gift_join(le,_e.raffleId,_e.type).then(function(Oe,ve){Te.text(Oe),ve&&(-1<Oe.indexOf('\u8FA3\u6761')?se.addGift(ve):-1<Oe.indexOf('\u94F6\u74DC\u5B50')&&se.addSilver(ve)),se.raffleId_list.remove(_e.raffleId)}):'guard'===ge?se.guard_join(le,_e.id).then(function(Oe,ve){Te.text(Oe),ve&&(-1<Oe.indexOf('\u8FA3\u6761')?se.addGift(ve):-1<Oe.indexOf('\u94F6\u74DC\u5B50')&&se.addSilver(ve)),se.guardId_list.remove(_e.id)}):'pk'===ge?se.pk_join(le,_e.id).then(function(Oe,ve){Te.text(Oe),ve&&(-1<Oe.indexOf('\u8FA3\u6761')?se.addGift(ve):-1<Oe.indexOf('\u94F6\u74DC\u5B50')&&se.addSilver(ve)),se.pkId_list.remove(_e.id)}):void 0),Te.css('color','green'),clearInterval(me)),ue--},1e3)},gift_join:function gift_join(le,_e,ge){var ce=$.Deferred();return D.Lottery.Gift.join(le,_e,ge).then(function(ue){switch(V('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',ue),ue.code){case 0:ue.data.award_text?ce.resolve(ue.data.award_text,ue.data.award_num):ce.resolve(ue.data.award_name+'X'+ue.data.award_num.toString(),ue.data.award_num);break;default:-1<ue.msg.indexOf('\u62D2\u7EDD')?!1==se.CONFIG.FORCE_LOTTERY?(se.blocked=!0,ce.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++M?se.gift_join(le,_e,ge):(M=0,ce.resolve('[\u793C\u7269\u62BD\u5956](roomid='+le+',id='+_e+',type='+ge+')'+ue.msg)):ce.resolve('[\u793C\u7269\u62BD\u5956](roomid='+le+',id='+_e+',type='+ge+')'+ue.msg);}}),ce},guard_join:function guard_join(le,_e){var ge=$.Deferred();return D.Lottery.Guard.join(le,_e).then(function(ce){switch(V('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',ce),ce.code){case 0:ce.data.award_text?ge.resolve(ce.data.award_text,ce.data.award_num):ge.resolve(ce.data.award_name+'X'+ce.data.award_num.toString(),ce.data.award_num);break;default:-1<ce.msg.indexOf('\u62D2\u7EDD')?!1==se.CONFIG.FORCE_LOTTERY?(se.blocked=!0,ge.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++L?se.guard_join(le,id):(L=0,ge.resolve('[\u793C\u7269\u62BD\u5956](roomid='+le+',id='+raffleId+',type='+type+')'+ce.msg)):ge.resolve('[\u4E0A\u8239](roomid='+le+',id='+_e+')'+ce.msg);}}),ge},pk_join:function pk_join(le,_e){var ge=$.Deferred();return D.Lottery.Pk.join(le,_e).then(function(ce){switch(V('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',ce),ce.code){case 0:ce.data.award_text?ge.resolve(ce.data.award_text,ce.data.award_num):ge.resolve(ce.data.award_name+'X'+ce.data.award_num.toString(),ce.data.award_num);break;default:-1<ce.msg.indexOf('\u62D2\u7EDD')?!1==se.CONFIG.FORCE_LOTTERY?(se.blocked=!0,ge.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++S?se.pk_join(le,id):(S=0,ge.resolve('[\u793C\u7269\u62BD\u5956](roomid='+le+',id='+raffleId+',type='+type+')'+ce.msg)):ge.resolve('[PK](roomid='+le+',id='+_e+')'+ce.msg);}}),ge},GroupSign:{getGroups:function getGroups(){return D.Group.my_groups().then(function(le){return(V('GroupSign.getGroups: API.Group.my_groups',le),0===le.code)?$.Deferred().resolve(le.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+le.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.GroupSign.getGroups()})})},signInList:function signInList(le){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(_e>=le.length)return $.Deferred().resolve();var ge=le[_e];return ge.owner_uid==B.uid?GroupSign.signInList(le,_e+1):D.Group.sign_in(ge.group_id,ge.owner_uid).then(function(ce){V('GroupSign.signInList: API.Group.sign_in',ce);var ue=$.Deferred();if(0===ce.code)0<ce.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ge.group_id+',owner_uid='+ge.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+ce.data.add_num,'success'),ue.resolve()):0==ce.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ge.group_id+',owner_uid='+ge.owner_uid+')\u5DF2\u7B7E\u5230','caution'),ue.resolve()):ue.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+ce.msg,'caution'),$.Deferred().reject();return $.when(se.GroupSign.signInList(le,_e+1),ue)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+ge.group_id+',owner_uid='+ge.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.GroupSign.signInList(le,_e)})})},run:function run(){try{return se.CONFIG.AUTO_GROUP_SIGN?oe(se.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=se.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(se.GroupSign.run,u(8,0)),$.Deferred().resolve()):se.GroupSign.getGroups().then(function(le){return se.GroupSign.signInList(le).then(function(){return se.CACHE.AUTO_GROUP_SIGH_TS=H(),se.saveCache(),Q(se.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return Y(function(){return se.GroupSign.run()})})},function(){return Y(function(){return se.GroupSign.run()})}):(Q(se.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(le){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+A+']',le),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return D.DailyReward.login().then(function(){V('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.DailyReward.login()})})},watch:function watch(le,_e){return se.CONFIG.WATCH?D.DailyReward.watch(le,_e,B.uid,k()).then(function(ge){V('DailyReward.watch: API.DailyReward.watch',ge),0===ge.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+le+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+ge.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.DailyReward.watch(le,_e)})}):$.Deferred().resolve()},coin:function coin(le,_e){var ge=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,ce=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!se.CONFIG.COIN)return $.Deferred().resolve();if(se.DailyReward.coin_exp>=10*se.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(ge>=le.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var ue=JSON.parse(le[ge].card),Ie=_Mathmin(2,_e);ce&&(Ie=1),D.x.getCoinInfo('','jsonp',ue.aid,H()).then(function(pe){return 2===pe.data.multiply?(V('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+ue.aid),se.DailyReward.coin(vlist,_e,ge+1)):D.DailyReward.coin(ue.aid,Ie).then(function(Te){return(V('DailyReward.coin: API.DailyReward.coin',Te),0===Te.code)?(se.DailyReward.coin_exp+=10*Ie,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+ue.aid+',num='+Ie+')','success'),se.DailyReward.coin(le,_e-Ie,ge+1)):-110===Te.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===Te.code?ce?se.DailyReward.coin(le,_e,ge+1):se.DailyReward.coin(le,_e,ge,!0):34005===Te.code?se.DailyReward.coin(le,_e,ge+1):-104===Te.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+Te.msg,'caution'),se.DailyReward.coin(le,_e,ge+1))},function(){return Y(function(){return se.DailyReward.coin(le,_e,ge)})})})},coin_uid:function coin_uid(le,_e,ge,ce){var ue=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,Ie=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!se.CONFIG.COIN)return $.Deferred().resolve();if(se.DailyReward.coin_exp>=10*se.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();ue>=le.length&&se.DailyReward.UserSpace(se.CONFIG.COIN_UID,30,0,ge++,'','pubdate','jsonp');var pe=le[ue];if(1===pe.is_union_video||pe.mid!=ce)return V('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+pe.aid),se.DailyReward.coin_uid(le,_e,ge,ce,ue+1);var Te=_Mathmin(2,_e);Ie&&(Te=1),D.x.getCoinInfo('','jsonp',pe.aid,H()).then(function(fe){return 2===fe.data.multiply?(V('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+pe.aid),se.DailyReward.coin_uid(le,_e,ge,ce,ue+1)):D.DailyReward.coin(pe.aid,Te).then(function(Ee){return(V('DailyReward.coin_uid: API.DailyReward.coin_uid',Ee),0===Ee.code)?(se.DailyReward.coin_exp+=10*Te,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+pe.aid+',num='+Te+')','success'),se.DailyReward.coin_uid(le,_e-Te,ge,ce,ue+1)):-110===Ee.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===Ee.code?Ie?se.DailyReward.coin_uid(le,_e,ge,ce,ue+1):se.DailyReward.coin_uid(le,_e,ue,ge,ce,!0):34005===Ee.code?se.DailyReward.coin_uid(le,_e,ge,ce,ue+1):-104===Ee.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+Ee.msg,'caution'),se.DailyReward.coin_uid(le,_e,ge,ce,ue+1))},function(){return Y(function(){return se.DailyReward.coin_uid(le,_e,ge,ce,ue)})})})},share:function share(le){return se.CONFIG.SHARE?D.DailyReward.share(le).then(function(_e){V('DailyReward.share: API.DailyReward.share',_e),0===_e.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+le+')','success'):71000===_e.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+_e.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.DailyReward.share(le)})}):$.Deferred().resolve()},dynamic:function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){var ge,ce;return regeneratorRuntime.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return ge=void 0,ce=se.CONFIG.COIN_NUMBER-se.DailyReward.coin_exp/10,Ie.next=4,D.getuserinfo().then(function(pe){return V('DailyReward.dynamic: API.getuserinfo',pe),pe.data.biliCoin<ce?pe.data.biliCoin:ce});case 4:if(ge=Ie.sent,0!==ge){Ie.next=9;break}return Ie.abrupt('return',$.Deferred().resolve());case 9:ge<ce&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+ge+'\u4E2A\u5E01','warning');case 10:;return Ie.abrupt('return',D.dynamic_svr.dynamic_new(B.uid,8).then(function(pe){if(V('DailyReward.dynamic: API.dynamic_svr.dynamic_new',pe),0===pe.code){if(!!pe.data.cards){var Ee,Te=JSON.parse(pe.data.cards[0].card),fe=se.DailyReward.watch(Te.aid,Te.cid);Ee=0==se.CONFIG.COIN_UID||'COIN_DYN'==se.CONFIG.COIN_TYPE?se.DailyReward.coin(pe.data.cards,_Mathmax(ge,0)):se.DailyReward.UserSpace(se.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var me=se.DailyReward.share(Te.aid);return $.when(fe,Ee,me)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+pe.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.DailyReward.dynamic()})}));case 12:case'end':return Ie.stop();}},_e,ne)}));return function dynamic(){return le.apply(this,arguments)}}(),UserSpace:function UserSpace(le,_e,ge,ce,ue,Ie,pe){return D.x.getUserSpace(le,_e,ge,ce,ue,Ie,pe).then(function(Te){if(V('DailyReward.UserSpace: API.dynamic_svr.UserSpace',Te),0===Te.code){if(!!Te.data.list.vlist){var fe=se.CONFIG.COIN_NUMBER-se.DailyReward.coin_exp/10,Ee=se.DailyReward.coin_uid(Te.data.list.vlist,_Mathmax(fe,0),ce,le);return Ee}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+Te.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.DailyReward.UserSpace(le,_e,ge,ce,ue,Ie,pe)})})},run:function run(){try{return oe(se.CACHE.DailyReward_TS)?D.DailyReward.exp().then(function(le){return V('DailyReward.run: API.DailyReward.exp',le),0===le.code?(se.DailyReward.coin_exp=le.number,se.DailyReward.login(),se.DailyReward.dynamic().then(function(){se.CACHE.DailyReward_TS=H(),se.saveCache(),X(se.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+le.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.DailyReward.run()})}):(X(se.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(le){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+A+']',le),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return D.xlive.dosign().then(function(le){V('LiveReward.dailySignIn: API.xlive.dosign',le),0===le.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===le.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+le.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.LiveReward.dailySignIn()})})},run:function run(){try{if(!se.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!oe(se.CACHE.LiveReward_TS))return X(se.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();se.LiveReward.dailySignIn(),se.CACHE.LiveReward_TS=H(),se.saveCache(),X(se.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(le){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+A+']',le),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return D.Exchange.silver2coin().then(function(le){V('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',le),0===le.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+le.msg,'success'):403===le.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+le.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+le.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return se.CONFIG.SILVER2COIN?oe(se.CACHE.Silver2Coin_TS)?se.Exchange.silver2coin().then(function(){se.CACHE.Silver2Coin_TS=H(),se.saveCache(),X(se.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return Y(function(){return se.Exchange.runS2C()})}):(X(se.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(le){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+A+']',le),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!se.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var le=$.Deferred();return P(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),le.resolve(),!0;var _e=$('#gift-control-vm div.treasure-box.p-relative');if(!_e.length)return!1;_e=_e.first(),_e.attr('id','old_treasure_box'),_e.hide();var ge=$('<div id="'+A+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');se.TreasureBox.DOM.div_tip=$('<div id="'+A+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),se.TreasureBox.DOM.div_timer=$('<div id="'+A+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),se.TreasureBox.DOM.image=$('<img id="'+A+'_treasure_image" style="display:none">'),se.TreasureBox.DOM.canvas=$('<canvas id="'+A+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var ce='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';se.TreasureBox.DOM.div_tip[0].style=ce,se.TreasureBox.DOM.div_timer[0].style=ce,ge.append(se.TreasureBox.DOM.div_tip),ge.append(se.TreasureBox.DOM.image),ge.append(se.TreasureBox.DOM.canvas),se.TreasureBox.DOM.div_tip.after(se.TreasureBox.DOM.div_timer),_e.after(ge);try{if(OCRAD);}catch(ue){return se.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+A+']',ue),le.resolve(),!0}return se.TreasureBox.timer=setInterval(function(){var ue=parseInt(se.TreasureBox.DOM.div_timer.text(),10);isNaN(ue)&&(ue=0),0<ue?se.TreasureBox.DOM.div_timer.text(ue-1+'s'):se.TreasureBox.DOM.div_timer.hide()},1e3),se.TreasureBox.DOM.image[0].onload=function(){var ue=se.TreasureBox.DOM.canvas[0].getContext('2d');ue.font='40px agencyfbbold',ue.textBaseline='top',ue.clearRect(0,0,se.TreasureBox.DOM.canvas[0].width,se.TreasureBox.DOM.canvas[0].height),ue.drawImage(se.TreasureBox.DOM.image[0],0,0);var Ie=se.TreasureBox.captcha.OCR.getGrayscaleMap(ue),pe=se.TreasureBox.captcha.OCR.orderFilter2In3x3(Ie);ue.clearRect(0,0,120,40);for(var fe,Te=0;Te<pe.length;++Te)fe=pe[Te],ue.fillStyle='rgb('+fe+', '+fe+', '+fe+')',ue.fillRect(Te%120,_Mathround(Te/120),1,1);try{var Te=se.TreasureBox.captcha.correctQuestion(OCRAD(ue.getImageData(0,0,120,40)));V('TreasureBox.DOM.image.load','question =',Te);var fe=se.TreasureBox.captcha.eval(Te);V('TreasureBox.DOM.image.load','answer =',fe),void 0!==fe&&(console.info('['+A+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+Te+' = '+fe),se.TreasureBox.promise.calc.resolve(fe))}catch(Te){se.TreasureBox.promise.calc.reject()}},le.resolve(),!0}catch(_e){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+A+']',_e),le.reject(),!0}}),le},run:function run(){try{if(!se.CONFIG.AUTO_TREASUREBOX||!se.TreasureBox.timer)return;if(B.blocked)return se.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!oe(se.CACHE.TreasureBox_TS))return se.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void X(se.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');se.TreasureBox.getCurrentTask().then(function(le){if(V('TreasureBox.run: TreasureBox.getCurrentTask().then',le),0===le.code){se.TreasureBox.promise.timer=$.Deferred(),se.TreasureBox.promise.timer.then(function(){se.TreasureBox.captcha.calc().then(function(ge){se.TreasureBox.getAward(ge).then(function(){return se.TreasureBox.run()},function(){return se.TreasureBox.run()})},function(){return TreasureBox.run()})}),se.TreasureBox.time_end=le.data.time_end,se.TreasureBox.time_start=le.data.time_start;var _e=se.TreasureBox.time_end-k()+1;0>_e&&(_e=0),setTimeout(function(){se.TreasureBox.promise.timer&&se.TreasureBox.promise.timer.resolve()},1e3*_e),se.TreasureBox.DOM.div_timer.text(_e+'s'),se.TreasureBox.DOM.div_timer.show(),se.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+le.data.times+'/'+le.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+le.data.silver)}else if(-10017===le.code)se.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),se.CACHE.TreasureBox_TS=H(),se.saveCache(),X(se.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===le.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+le.msg,'caution'),se.TreasureBox.run()})}catch(le){se.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+A+']',le)}},setMsg:function setMsg(le){se.CONFIG.AUTO_TREASUREBOX&&(se.TreasureBox.promise.timer&&(se.TreasureBox.promise.timer.reject(),se.TreasureBox.promise.timer=void 0),se.TreasureBox.DOM.div_timer&&se.TreasureBox.DOM.div_timer.hide(),se.TreasureBox.DOM.div_tip&&se.TreasureBox.DOM.div_tip.html(le))},getAward:function getAward(le){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return se.CONFIG.AUTO_TREASUREBOX?3<_e?$.Deferred().resolve():D.TreasureBox.getAward(se.TreasureBox.time_start,se.TreasureBox.time_end,le).then(function(ge){switch(V('TreasureBox.getAward: getAward',ge),ge.code){case 0:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+ge.data.awardSilver+' \u94F6\u74DC\u5B50','success');case-903:return $.Deferred().resolve();case-902:case-901:case-10017:return se.TreasureBox.captcha.calc().then(function(ue){return se.TreasureBox.getAward(ue,_e)});case-800:return se.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),$.Deferred().reject();case-500:var ce=$.Deferred();return setTimeout(function(){se.TreasureBox.captcha.calc().then(function(ue){se.TreasureBox.getAward(ue,_e+1).then(function(){return ce.resolve()},function(){return ce.reject()})},function(){return ce.reject()})},3e3),ce;case 400:return-1<ge.msg.indexOf('\u62D2\u7EDD')?(B.blocked=!0,se.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ge.msg,'caution'),$.Deferred().resolve());default:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ge.msg,'caution');}},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.TreasureBox.getAward(le,_e)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return se.CONFIG.AUTO_TREASUREBOX?D.TreasureBox.getCurrentTask().then(function(le){return V('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',le),$.Deferred().resolve(le)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return se.CONFIG.AUTO_TREASUREBOX?20<se.TreasureBox.captcha.cnt?(se.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):D.TreasureBox.getCaptcha(H()).then(function(le){if(V('TreasureBox.captcha.calc: getCaptcha',le),0===le.code){se.TreasureBox.captcha.cnt++;var _e=$.Deferred();return se.TreasureBox.promise.calc=$.Deferred(),se.TreasureBox.promise.calc.then(function(ge){se.TreasureBox.captcha.cnt=0,_e.resolve(ge)},function(){se.TreasureBox.captcha.calc().then(function(ge){_e.resolve(ge)},function(){_e.reject()})}),se.TreasureBox.DOM.image.attr('src',le.data.img),_e}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+le.msg,'caution'),Y(function(){return se.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.TreasureBox.captcha.calc()})}):(se.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(le){for(var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,ge=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,ce=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,ue=le.getImageData(0,0,ge,ce).data,Ie=[],pe=0;pe<ce;pe++)for(var Te=0;Te<ge;Te++){var fe=4*(pe*ge+Te),Ee=ue.slice(fe,fe+4),me=Ee?77*Ee[0]+150*Ee[1]+29*Ee[2]+128>>8:0;Ie.push(me>_e?me:0)}return Ie},orderFilter2In3x3:function orderFilter2In3x3(le){for(var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,ge=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,ce=function gray(me,Oe){return 0<=me+Oe*ge?le[me+Oe*ge]:255},ue=[],Ie=le.length,me=0;me<Ie;++me){var Te=[me%ge,_Mathfloor(me/ge)],fe=Te[0],Ee=Te[1],Oe=Array(9);Oe[0]=ce(fe-1,Ee-1),Oe[1]=ce(fe+0,Ee-1),Oe[2]=ce(fe+1,Ee-1),Oe[3]=ce(fe-1,Ee+0),Oe[4]=ce(fe+0,Ee+0),Oe[5]=ce(fe+1,Ee+0),Oe[6]=ce(fe-1,Ee+1),Oe[7]=ce(fe+0,Ee+1),Oe[8]=ce(fe+1,Ee+1),Oe.sort(function(ve,xe){return ve-xe}),ue.push(Oe[_e-1])}return ue}},eval:function _eval(le){var _e=Function;return new _e('return '+le)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(le){var _e='';for(var ge in le=le.trim(),le){var ce=se.TreasureBox.captcha.correctStr[le[ge]];_e+=void 0===ce?le[ge]:ce}'4'===_e[2]&&(_e[2]='+');for(var ge=0;ge<=parseInt(_e.length-2);ge++)'\''===_e[ge]&&'1'===_e[ge+1]&&(_e[ge]='7',_e.splice(ge+1,1));return _e}}},Gift:(de={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(de,'run_timer',void 0),_defineProperty(de,'sendGiftList',[1,6,30607]),_defineProperty(de,'getMedalList',function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){var ge=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return 1===ge&&(se.Gift.medal_list=[]),ue.next=3,D.i.medal(ge,25).then(function(Ie){if(V('Gift.getMedalList: API.i.medal',Ie),se.Gift.medal_list=se.Gift.medal_list.concat(Ie.data.fansMedalList),Ie.data.pageinfo.curPage<Ie.data.pageinfo.totalpages)return se.Gift.getMedalList(ge+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.Gift.getMedalList()})});case 3:return ue.abrupt('return',ue.sent);case 4:case'end':return ue.stop();}},_e,ne)}));return function getMedalList(){return le.apply(this,arguments)}}()),_defineProperty(de,'getBagList',function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){return regeneratorRuntime.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,D.gift.bag_list().then(function(ue){V('Gift.getBagList: API.gift.bag_list',ue),se.Gift.bag_list=ue.data.list,se.Gift.time=ue.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.Gift.getBagList()})});case 2:return ce.abrupt('return',ce.sent);case 3:case'end':return ce.stop();}},_e,ne)}));return function getBagList(){return le.apply(this,arguments)}}()),_defineProperty(de,'getFeedByGiftID',function getFeedByGiftID(le){for(var _e=B.gift_list.length-1;0<=_e;--_e)if(B.gift_list[_e].id===le)return Math.ceil(B.gift_list[_e].price/100);return 0}),_defineProperty(de,'sort_medals',function sort_medals(le){if(se.CONFIG.GIFT_SORT?le.sort(function(Te,fe){return 0==fe.level-Te.level?fe.intimacy-Te.intimacy:fe.level-Te.level}):le.sort(function(Te,fe){return 0==Te.level-fe.level?Te.intimacy-fe.intimacy:Te.level-fe.level}),se.CONFIG.AUTO_GIFT_ROOMID&&0<se.CONFIG.AUTO_GIFT_ROOMID.length){var Te=se.CONFIG.AUTO_GIFT_ROOMID.split(',');Te.reverse();var _e=!0,ge=!1,ce=void 0;try{for(var pe,ue=function _loop2(){var fe=pe.value,Ee=le.findIndex(function(me){return me.roomid==fe});if(-1!=Ee){var me=le[Ee];le.splice(Ee,1),le.unshift(me)}},Ie=Te[Symbol.iterator]();!(_e=(pe=Ie.next()).done);_e=!0)ue()}catch(fe){ge=!0,ce=fe}finally{try{!_e&&Ie.return&&Ie.return()}finally{if(ge)throw ce}}}return le}),_defineProperty(de,'auto_light',function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(ge){var ce,ue,Ie,pe,Te,fe,Ee,me,Oe,ve,xe,Re,Ge,Ce,he,Ne;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:ye.prev=0,ce=se.Gift.getFeedByGiftID(30607),ue=se.CONFIG.LIGHT_MEDALS.split(','),Ie=void 0,Ie='LIGHT_WHITE'==se.CONFIG.LIGHT_METHOD?ge.filter(function(De){return 0==De.is_lighted&&De.day_limit-De.today_feed>=ce&&0<=ue.findIndex(function(Me){return Me==De.roomid})}):ge.filter(function(De){return 0==De.is_lighted&&De.day_limit-De.today_feed>=ce&&-1==ue.findIndex(function(Me){return Me==De.roomid})});;if(V('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',Ie),!(Ie&&0<Ie.length)){ye.next=52;break}return Ie=se.Gift.sort_medals(Ie),ye.next=11,se.Gift.getBagList();case 11:if(pe=se.Gift.bag_list.filter(function(De){return 30607==De.gift_id}),!(pe&&0<pe.length)){ye.next=52;break}Te=!0,fe=!1,Ee=void 0,ye.prev=16,me=Ie[Symbol.iterator]();case 18:if(Te=(Oe=me.next()).done){ye.next=38;break}if(ve=Oe.value,xe=pe.find(function(De){return 30607==De.gift_id&&0<De.gift_num}),!xe){ye.next=34;break}if(Re=ve.day_limit-ve.today_feed,!(0<=Re-ce||se.CONFIG.FORCE_LIGHT)){ye.next=33;break}return ye.next=26,D.room.room_init(parseInt(ve.roomid,10));case 26:return Ge=ye.sent,Ce=parseInt(Ge.data.room_id,10),he=1,ye.next=31,D.gift.bag_send(B.uid,30607,ve.target_id,he,xe.bag_id,Ce,B.rnd);case 31:Ne=ye.sent,0===Ne.code?(xe.gift_num-=he,ve.today_feed+=he*ce,Re-=he*ce,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ve.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+he+'\u4E2A'+xe.gift_name+'\uFF0C['+ve.today_feed+'/'+ve.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+Re+']','success'),V('Gift.auto_light','\u52CB\u7AE0['+ve.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+he+'\u4E2A'+xe.gift_name+'\uFF0C['+ve.today_feed+'/'+ve.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ve.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+Ge.msg+'\u3011','caution');case 33:return ye.abrupt('continue',35);case 34:return ye.abrupt('break',38);case 35:Te=!0,ye.next=18;break;case 38:ye.next=44;break;case 40:ye.prev=40,ye.t0=ye['catch'](16),fe=!0,Ee=ye.t0;case 44:ye.prev=44,ye.prev=45,!Te&&me.return&&me.return();case 47:if(ye.prev=47,!fe){ye.next=50;break}throw Ee;case 50:return ye.finish(47);case 51:return ye.finish(44);case 52:ye.next=58;break;case 54:ye.prev=54,ye.t1=ye['catch'](0),console.error(ye.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+ye.t1,'error');case 58:case'end':return ye.stop();}},_e,ne,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return le.apply(this,arguments)}}()),_defineProperty(de,'run',function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){var ge,ce,ue,Ie,pe,Te,fe,Ee,me,Oe,ve,xe,Re,Ge;return regeneratorRuntime.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:if(ge=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.Gift.run()})},ce=function nextTimeDebug(){if('GIFT_SEND_TIME'==se.CONFIG.GIFT_METHOD){var Ne=u(se.CONFIG.GIFT_SEND_HOUR,se.CONFIG.GIFT_SEND_MINUTE);se.Gift.run_timer=setTimeout(se.Gift.run,Ne);var Ae=new Date(H()+Ne).toLocaleString();V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ae+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),se.CACHE.Gift_TS=H(),se.saveCache()}else V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+se.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),se.CACHE.GiftInterval_TS=H(),se.saveCache()},he.prev=2,se.CONFIG.AUTO_GIFT){he.next=5;break}return he.abrupt('return',$.Deferred().resolve());case 5:if(se.Gift.run_timer&&clearTimeout(se.Gift.run_timer),'GIFT_SEND_TIME'!=se.CONFIG.GIFT_METHOD||T(se.CONFIG.GIFT_SEND_HOUR,se.CONFIG.GIFT_SEND_MINUTE)||!1!=F){he.next=14;break}return ue=u(se.CONFIG.GIFT_SEND_HOUR,se.CONFIG.GIFT_SEND_MINUTE),se.Gift.run_timer=setTimeout(se.Gift.run,ue),Ie=new Date(H()+ue).toLocaleString(),V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Ie+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),he.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=se.CONFIG.GIFT_METHOD||!1!=F){he.next=27;break}if(pe=6e4*se.CONFIG.GIFT_INTERVAL,!se.CACHE.GiftInterval_TS){he.next=25;break}if(Te=H()-se.CACHE.GiftInterval_TS,!(Te<pe)){he.next=23;break}return fe=pe-Te,se.Gift.run_timer=setTimeout(function(){return se.Gift.run()},fe),V('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+fe+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),he.abrupt('return');case 23:he.next=27;break;case 25:se.CACHE.GiftInterval_TS=H(),se.saveCache();case 27:return se.Gift.over=!1,he.next=30,se.Gift.getMedalList();case 30:if(Ee=se.Gift.medal_list,V('Gift.run: Gift.getMedalList().then: Gift.medal_list',Ee),!(Ee&&0<Ee.length)){he.next=34;break}return he.delegateYield(regeneratorRuntime.mark(function Ne(){var Ae,ye,De,Me,be,Le,Se,Fe,we;return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:Ee=Ee.filter(function(ke){return 0<ke.day_limit-ke.today_feed&&20>ke.level}),Ee=se.Gift.sort_medals(Ee),se.CONFIG.EXCLUDE_ROOMID&&0<se.CONFIG.EXCLUDE_ROOMID.length&&(ArrayEXCLUDE_ROOMID=se.CONFIG.EXCLUDE_ROOMID.split(','),Ee=Ee.filter(function(ke){return-1==ArrayEXCLUDE_ROOMID.findIndex(function(Be){return Be==ke.roomid})}));;return He.next=6,se.Gift.auto_light(Ee);case 6:Ae=86400*se.CONFIG.GIFT_LIMIT,ye=!0,De=!1,Me=void 0,He.prev=10,be=Ee[Symbol.iterator]();case 12:if(ye=(Le=be.next()).done){He.next=28;break}return Se=Le.value,He.next=16,D.room.room_init(parseInt(Se.roomid,10));case 16:if(Fe=He.sent,se.Gift.room_id=parseInt(Fe.data.room_id,10),se.Gift.ruid=Se.target_id,se.Gift.remain_feed=Se.day_limit-Se.today_feed,!(0<se.Gift.remain_feed)){He.next=25;break}return He.delegateYield(regeneratorRuntime.mark(function ke(){var Be,Pe,je;return regeneratorRuntime.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,se.Gift.getBagList();case 2:if(Be=k(),se.CONFIG.SEND_ALL_GIFT){Ve.next=7;break}if(Pe=se.Gift.bag_list.filter(function(Xe){return se.Gift.sendGiftList.includes(Xe.gift_id)&&0<Xe.gift_num&&Xe.expire_at>Be&&Xe.expire_at-Be<Ae}),0!=Pe.length){Ve.next=7;break}return Ve.abrupt('return','break');case 7:;if(!(0<se.Gift.remain_feed)){Ve.next=21;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Se.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+Se.today_feed+'/'+Se.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+se.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Ve.next=12,se.Gift.sendGift(Se);case 12:if(se.CONFIG.SEND_ALL_GIFT){Ve.next=19;break}if(je=se.Gift.bag_list.filter(function(Xe){return se.Gift.sendGiftList.includes(Xe.gift_id)&&0<Xe.gift_num&&Xe.expire_at>Be&&Xe.expire_at-Be<Ae}),0!=je.length){Ve.next=18;break}return Ve.abrupt('return','break');case 18:se.Gift.bag_list=je;case 19:Ve.next=22;break;case 21:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Se.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 22:case'end':return Ve.stop();}},ke,ne)})(),'t0',22);case 22:if(we=He.t0,'break'!==we){He.next=25;break}return He.abrupt('break',28);case 25:ye=!0,He.next=12;break;case 28:He.next=34;break;case 30:He.prev=30,He.t1=He['catch'](10),De=!0,Me=He.t1;case 34:He.prev=34,He.prev=35,!ye&&be.return&&be.return();case 37:if(He.prev=37,!De){He.next=40;break}throw Me;case 40:return He.finish(37);case 41:return He.finish(34);case 42:case'end':return He.stop();}},Ne,ne,[[10,30,34,42],[35,,37,41]])})(),'t0',34);case 34:return he.next=36,se.Gift.getBagList();case 36:me=0,me=0;case 38:if(!(me<=se.Gift.bag_list.length-1)){he.next=44;break}if(1!=se.Gift.bag_list[me].gift_id){he.next=41;break}return he.abrupt('break',44);case 41:me++,he.next=38;break;case 44:if(Oe=se.Gift.bag_list[me],void 0!=Oe){he.next=49;break}return F=!1,ce(),he.abrupt('return',$.Deferred().resolve());case 49:if(ve=se.Gift.getFeedByGiftID(Oe.gift_id),xe=86400,Re=k(),!(0!=se.Gift.bag_list.filter(function(Ne){return se.Gift.sendGiftList.includes(Ne.gift_id)&&0<Ne.gift_num&&Ne.expire_at>Re&&Ne.expire_at-Re<xe}).length&&Oe.expire_at>se.Gift.time&&Oe.expire_at-se.Gift.time<xe&&'0'!=se.CONFIG.SPARE_GIFT_ROOM&&'0'!=se.CONFIG.SPARE_GIFT_UID&&0<ve)){he.next=55;break}return Ge=Oe.gift_num,he.abrupt('return',D.gift.bag_send(B.uid,Oe.gift_id,se.CONFIG.SPARE_GIFT_UID,Ge,Oe.bag_id,se.CONFIG.SPARE_GIFT_ROOM,B.rnd).then(function(Ne){V('Gift.sendGift(\u5269\u4F59\u793C\u7269): API.gift.bag_send',Ne),0===Ne.code?window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+se.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ge+'\u4E2A'+Oe.gift_name,'success'):window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+se.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u5F02\u5E38:'+Ne.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.Gift.sendGift(medal)})}));case 55:he.next=63;break;case 57:return he.prev=57,he.t1=he['catch'](2),ge(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+A+']',he.t1),he.abrupt('return',$.Deferred().reject());case 63:return F=!1,ce(),he.abrupt('return',$.Deferred().resolve());case 66:case'end':return he.stop();}},_e,ne,[[2,57]])}));return function run(){return le.apply(this,arguments)}}()),_defineProperty(de,'sendGift',function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(ge){var ce,ue,Ie,pe,Te,fe,Ee,me,Oe;return regeneratorRuntime.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,se.Gift.getBagList();case 2:if(!(0>=se.Gift.remain_feed)){xe.next=5;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ge.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+ge.today_feed+'/'+ge.day_limit+']','info'),xe.abrupt('return',$.Deferred().resolve());case 5:if(0>=se.Gift.time&&(se.Gift.time=k()),se.CONFIG.SEND_ALL_GIFT){xe.next=16;break}if(ce=se.Gift.bag_list.filter(function(Re){return se.Gift.sendGiftList.includes(Re.gift_id)&&0<Re.gift_num&&Re.expire_at>se.Gift.time&&Re.expire_at-se.Gift.time<86400*se.CONFIG.GIFT_LIMIT&&'\u6C38\u4E45'!=Re.corner_mark}),0!=ce.length){xe.next=13;break}return se.Gift.over=!0,xe.abrupt('return');case 13:se.bag_list=ce;case 14:xe.next=23;break;case 16:if(ue=se.Gift.bag_list.filter(function(Re){return 0<Re.gift_num&&'\u6C38\u4E45'!=Re.corner_mark}),0!=ue.length){xe.next=22;break}return se.Gift.over=!0,xe.abrupt('return');case 22:se.bag_list=ue;case 23:Ie=!0,pe=!1,Te=void 0,xe.prev=26,fe=function _loop3(){var Re=me.value;if(0>=ge.day_limit-ge.today_feed)return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ge.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+ge.today_feed+'/'+ge.day_limit+']','info'),{v:void 0};var Ge=se.Gift.getFeedByGiftID(Re.gift_id);if(0<Ge){var Ce=_Mathfloor(se.Gift.remain_feed/Ge);if(Ce>Re.gift_num&&(Ce=Re.gift_num),0<Ce)return{v:D.gift.bag_send(B.uid,Re.gift_id,se.Gift.ruid,Ce,Re.bag_id,se.Gift.room_id,B.rnd).then(function(he){V('Gift.sendGift: API.gift.bag_send',he),0===he.code?(Re.gift_num-=Ce,ge.today_feed+=Ce*Ge,se.Gift.remain_feed-=Ce*Ge,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ge.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ce+'\u4E2A'+Re.gift_name+'\uFF0C['+ge.today_feed+'/'+ge.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+se.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+ge.medalName+'] \u9001\u793C\u5F02\u5E38:'+he.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.Gift.sendGift(ge)})})}}},Ee=se.Gift.bag_list[Symbol.iterator]();case 29:if(Ie=(me=Ee.next()).done){xe.next=36;break}if(Oe=fe(),'object'!==('undefined'==typeof Oe?'undefined':_typeof(Oe))){xe.next=33;break}return xe.abrupt('return',Oe.v);case 33:Ie=!0,xe.next=29;break;case 36:xe.next=42;break;case 38:xe.prev=38,xe.t0=xe['catch'](26),pe=!0,Te=xe.t0;case 42:xe.prev=42,xe.prev=43,!Ie&&Ee.return&&Ee.return();case 45:if(xe.prev=45,!pe){xe.next=48;break}throw Te;case 48:return xe.finish(45);case 49:return xe.finish(42);case 50:case'end':return xe.stop();}},_e,ne,[[26,38,42,50],[43,,45,49]])}));return function sendGift(){return le.apply(this,arguments)}}()),de),MobileHeartBeat:{run:function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){var ge,ce,ue,Ie;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(!1!=se.CONFIG.MOBILE_HEARTBEAT){Te.next=2;break}return Te.abrupt('return',$.Deferred().resolve());case 2:if(oe(se.CACHE.MobileHeartBeat_TS)){Te.next=5;break}return X(se.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),Te.abrupt('return',$.Deferred().resolve());case 5:if(!1!==B.mobile_verify){Te.next=9;break}return window.toast('[\u79FB\u52A8\u7AEF\u5FC3\u8DF3]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','warning'),V('MobileHeartBeat','\u672A\u7ED1\u5B9A\u624B\u673A mobile_verify = '+B.mobile_verify),Te.abrupt('return',$.Deferred().resolve());case 9:return ge=function mobileOnline(){R({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+ee.access_token+'&'+Z),data:'room_id='+B.room_id+'&scale=xxhdpi',responseType:'json',headers:z.headers})},ce=function EndFunc(fe){V('MobileHeartBeat GetAward',fe),clearInterval(Ie),se.CACHE.MobileHeartBeat_TS=H(),se.saveCache(),X(se.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3')},ue=function getWatchingAward(){D.activity.receive_award('double_watch_task').then(function(fe){return 0===fe.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u6210\u529F','success'),ce(fe),$.Deferred().resolve()):-400===fe.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u5DF2\u9886\u53D6','info'),ce(fe),$.Deferred().resolve()):(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]'+fe,'warning'),ce(fe),$.Deferred().resolve())},function(fe){return window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('MobileHeartBeat GetAward',fe),clearInterval(Ie),Y(function(){return se.MobileHeartBeat.run()})})},Te.next=14,te();case 14:if(Te.t1=Te.sent,Te.t2=void 0,Te.t0=Te.t1===Te.t2,!Te.t0){Te.next=19;break}Te.t0=void 0===ee.access_token;case 19:if(!Te.t0){Te.next=22;break}return V('MobileHeartBeat','token\u8BBE\u7F6E\u5931\u8D25'),Te.abrupt('return');case 22:V('MobileHeartBeat','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),ge(),Ie=void 0,Ie=setInterval(function(){return ge()},300000),setTimeout(function(){return ue()},360000);case 27:case'end':return Te.stop();}},_e,ne)}));return function run(){return le.apply(this,arguments)}}()},stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(le){var _e=[];try{var ge=JSON.parse(localStorage.getItem(A+'stormIdSet'));_e=[].concat(ge.list),_e.push(le),50<_e.length&&_e.splice(0,10),localStorage.setItem(A+'stormIdSet',JSON.stringify({list:_e})),V(A+'storm_Id_list_add',_e)}catch(ge){_e.push(le),localStorage.setItem(A+'stormIdSet',JSON.stringify({list:_e}))}},isIn:function isIn(le){var _e=[];try{var ge=JSON.parse(localStorage.getItem(A+'stormIdSet'));return _e=null===ge?[]:[].concat(ge.list),V(A+'storm_Id_list_read',ge),-1<_e.indexOf(le)}catch(ge){return localStorage.setItem(A+'stormIdSet',JSON.stringify({list:_e})),V('\u8BFB\u53D6'+(A+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<_e.indexOf(le)}}},Storm:{check:function check(le){return-1<se.stormQueue.indexOf(le)},append:function append(le){se.stormQueue.push(le),se.stormQueue.length>se.CONFIG.STORM_QUEUE_SIZE&&se.stormQueue.shift()},over:function over(le){var _e=se.stormQueue.indexOf(le);-1<_e&&se.stormQueue.splice(le,1)},run:function run(le){try{return se.CONFIG.STORM?se.stormBlack?$.Deferred().resolve():f(se.CONFIG.TIME_AREA_START_H0UR,se.CONFIG.TIME_AREA_END_H0UR,se.CONFIG.TIME_AREA_START_MINUTE,se.CONFIG.TIME_AREA_END_MINUTE)&&se.CONFIG.TIME_AREA_DISABLE?(V('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+le),$.Deferred().resolve()):D.Storm.check(le).then(function(_e){if(V('MY_API.Storm.run: MY_API.API.Storm.check',_e),0===_e.code){var ge=_e.data;return se.Storm.join(ge.id,ge.roomid,_Mathround(new Date().getTime()/1e3)+ge.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+le+')'+_e.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+le+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(_e){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+A+']',_e),$.Deferred().reject()}},join:function join(le,_e,ge){var ce=function(){var Te=_asyncToGenerator(regeneratorRuntime.mark(function fe(){var Ee,me;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(ve.prev=0,se.Storm.check(le)){ve.next=4;break}return clearInterval(Ie),ve.abrupt('return');case 4:if(Ee=_Mathround(new Date().getTime()/1e3),!(Ee>ge&&0<ge)){ve.next=9;break}return se.Storm.over(le),clearInterval(Ie),ve.abrupt('return');case 9:if(pe++,!(pe>se.CONFIG.STORM_MAX_COUNT&&0<se.CONFIG.STORM_MAX_COUNT)){ve.next=15;break}return se.Storm.over(le),clearInterval(Ie),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+_e+',id='+le+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+pe+',\u8DDD\u79BB\u5230\u671F:'+(ge-Ee)+'s','caution'),ve.abrupt('return');case 15:if(me=void 0,ve.prev=16,!(J&&z&&ee.access_token)){ve.next=23;break}return ve.next=20,D.Storm.join_ex(le,_e,ee.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:me=ve.sent,ve.next=26;break;case 23:return ve.next=25,D.Storm.join(le,captcha_token='',captcha_phrase='',_e);case 25:me=ve.sent;case 26:if(V('MY_API.Storm.join: MY_API.API.Storm.join',me),!me.code){ve.next=51;break}if(-1==me.msg.indexOf('\u9886\u53D6')){ve.next=33;break}return se.Storm.over(le),clearInterval(Ie),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+_e+',id='+le+')\u6210\u529F,'+me.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+pe,'success'),ve.abrupt('return');case 33:if(-1==me.msg.indexOf('\u9A8C\u8BC1\u7801')){ve.next=39;break}return se.Storm.over(le),clearInterval(Ie),se.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+_e+',id='+le+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+me.msg,'caution'),ve.abrupt('return');case 39:if(!(me.data&&0==me.data.length&&-1!=me.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){ve.next=46;break}return se.Storm.over(le),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+_e+',id='+le+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(Ie),se.stormBlack=!0,setTimeout(function(){se.stormBlack=!1},3600000),ve.abrupt('return');case 46:if(-1!=me.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){ve.next=49;break}return clearInterval(Ie),ve.abrupt('return');case 49:ve.next=56;break;case 51:return se.Storm.over(le),Statistics.appendGift(me.data.gift_name,me.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+_e+',id='+le+')\u6210\u529F,'+(me.data.gift_name+'x'+me.data.gift_num)+'\r\n'+me.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+pe,'success'),clearInterval(Ie),ve.abrupt('return');case 56:ve.next=65;break;case 58:return ve.prev=58,ve.t0=ve['catch'](16),se.Storm.over(le),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+_e+',id='+le+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+pe,'error'),console.error(ve.t0),clearInterval(Ie),ve.abrupt('return');case 65:ve.next=74;break;case 67:return ve.prev=67,ve.t1=ve['catch'](0),se.Storm.over(le),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+_e+',id='+le+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(ve.t1),clearInterval(Ie),ve.abrupt('return');case 74:case'end':return ve.stop();}},fe,this,[[0,67],[16,58]])}));return function(){return Te.apply(this,arguments)}}();if(_e=parseInt(_e,10),le=parseInt(le,10),isNaN(_e)||isNaN(le))return $.Deferred().reject();var ue=_Mathround(le/1e6);if(se.stormIdSet.isIn(ue))return $.Deferred().resolve();if(se.stormIdSet.add(ue),!se.Storm.check(le)){se.Storm.append(le);var Ie=0;0>=ge&&(ge=_Mathround(new Date().getTime()/1e3)+90);var pe=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+_e+',id='+le+')','success'),Ie=setInterval(function(){return ce()},se.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{medalRoom_list:[],liveRoom_list:[],getMedalRoomList:function getMedalRoomList(){var le=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 1===le&&(se.LITTLE_HEART.medalRoom_list=[]),D.i.medal(le,25).then(function(_e){V('LITTLE_HEART.getMedalRoomList: API.i.medal',_e);var ge=!0,ce=!1,ue=void 0;try{for(var pe,Te,Ie=_e.data.fansMedalList[Symbol.iterator]();!(ge=(pe=Ie.next()).done);ge=!0)Te=pe.value,se.LITTLE_HEART.medalRoom_list=se.LITTLE_HEART.medalRoom_list.concat(Te.roomid)}catch(Te){ce=!0,ue=Te}finally{try{!ge&&Ie.return&&Ie.return()}finally{if(ce)throw ue}}V('MY_API.LITTLE_HEART.medalRoom_list',se.LITTLE_HEART.medalRoom_list),_e.data.pageinfo.curPage<_e.data.pageinfo.totalpages&&se.LITTLE_HEART.getMedalRoomList(le+1)},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.LITTLE_HEART.getMedalRoomList(le)})})},checkRoomList:function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(ge){var ce,ue,Ie,pe,Te,fe,Ee;return regeneratorRuntime.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:ce=[],ue=!0,Ie=!1,pe=void 0,Oe.prev=4,Te=ge[Symbol.iterator]();case 6:if(ue=(fe=Te.next()).done){Oe.next=13;break}return Ee=fe.value,Oe.next=10,D.room.get_info(Ee).then(function(ve){if(1===ve.data.live_status)return void(ce=ce.concat(ve.data.room_id))},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.LITTLE_HEART.checkRoomList(ge)})});case 10:ue=!0,Oe.next=6;break;case 13:Oe.next=19;break;case 15:Oe.prev=15,Oe.t0=Oe['catch'](4),Ie=!0,pe=Oe.t0;case 19:Oe.prev=19,Oe.prev=20,!ue&&Te.return&&Te.return();case 22:if(Oe.prev=22,!Ie){Oe.next=25;break}throw pe;case 25:return Oe.finish(22);case 26:return Oe.finish(19);case 27:;if(V('MY_API.LITTLE_HEART.checkRoomList returnRoom',ce),void 0==ce){Oe.next=33;break}return Oe.abrupt('return',ce);case 33:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5F53\u524D\u7C89\u4E1D\u52CB\u7AE0\u5217\u8868\u4E2D\u65E0\u6B63\u5728\u76F4\u64AD\u623F\u95F4\uFF0C5\u5206\u949F\u540E\u91CD\u8BD5'),Oe.abrupt('return',Y(function(){return se.LITTLE_HEART.getMedalRoomList(page)},3e5));case 35:case'end':return Oe.stop();}},_e,ne,[[4,15,19,27],[20,,22,26]])}));return function checkRoomList(){return le.apply(this,arguments)}}(),checkRoom:function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(ge){var ce;return regeneratorRuntime.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return ce=void 0,Ie.next=3,D.room.get_info(ge).then(function(pe){ce=1===pe.data.live_status},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),Y(function(){return se.LITTLE_HEART.checkRoomList(roomList)})});case 3:return Ie.abrupt('return',ce);case 4:case'end':return Ie.stop();}},_e,ne)}));return function checkRoom(){return le.apply(this,arguments)}}(),doHeartBeat:function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(ge){var ce,ue;return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(-1!=se.LITTLE_HEART.liveRoom_list.indexOf(ge)){pe.next=2;break}return pe.abrupt('return');case 2:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00\u623F\u95F4'+ge+'\u3010\u8BF7\u52FF\u70B9\u51FB\u3011','info'),V('[\u5C0F\u5FC3\u5FC3]\u6253\u5F00\u6807\u7B7E\u9875\u623F\u95F4',se.LITTLE_HEART.liveRoom_list),pe.next=6,GM_openInTab('https://live.bilibili.com/'+(ge+''),'loadInBackground');case 6:return ce=pe.sent,ue=setInterval(_asyncToGenerator(regeneratorRuntime.mark(function Te(){return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(!ce||ce.close(),!se.LITTLE_HEART.checkRoom(ge)){Ee.next=7;break}return Ee.next=4,GM_openInTab('https://live.bilibili.com/'+(ge+''),'loadInBackground');case 4:ce=Ee.sent,Ee.next=11;break;case 7:return window.toast('[\u5C0F\u5FC3\u5FC3]\u623F\u95F4'+ge+'\u4E0B\u64AD\uFF0C\u5373\u5C06\u518D\u6B21\u5BFB\u627E\u5F00\u64AD\u623F\u95F4','info'),clearInterval(ue),I(ge,se.LITTLE_HEART.liveRoom_list),Ee.abrupt('return',se.LITTLE_HEART.run());case 11:case'end':return Ee.stop();}},Te,ne)})),310e3),pe.abrupt('return');case 9:case'end':return pe.stop();}},_e,ne)}));return function doHeartBeat(){return le.apply(this,arguments)}}(),run:function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){var ge,ce,ue,Ie,pe,Te;return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(se.CONFIG.LITTLE_HEART){Ee.next=2;break}return Ee.abrupt('return',$.Deferred().resolve());case 2:return oe(se.CACHE.LittleHeart_TS)||window.toast('[\u5C0F\u5FC3\u5FC3]','\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6'),Ee.next=5,se.LITTLE_HEART.getMedalRoomList();case 5:return Ee.next=7,se.LITTLE_HEART.checkRoomList(se.LITTLE_HEART.medalRoom_list);case 7:se.LITTLE_HEART.liveRoom_list=Ee.sent,ge=!0,ce=!1,ue=void 0,Ee.prev=11,Ie=se.LITTLE_HEART.liveRoom_list[Symbol.iterator]();case 13:if(ge=(pe=Ie.next()).done){Ee.next=20;break}return Te=pe.value,Ee.next=17,se.LITTLE_HEART.doHeartBeat(Te);case 17:ge=!0,Ee.next=13;break;case 20:Ee.next=26;break;case 22:Ee.prev=22,Ee.t0=Ee['catch'](11),ce=!0,ue=Ee.t0;case 26:Ee.prev=26,Ee.prev=27,!ge&&Ie.return&&Ie.return();case 29:if(Ee.prev=29,!ce){Ee.next=32;break}throw ue;case 32:return Ee.finish(29);case 33:return Ee.finish(26);case 34:case'end':return Ee.stop();}},_e,ne,[[11,22,26,34],[27,,29,33]])}));return function run(){return le.apply(this,arguments)}}()}};se.init().then(function(){try{var le=$.Deferred();(function uniqueCheck(){var ge=Date.now();return 0<=ge-se.CACHE.UNIQUE_CHECK&&15e3>=ge-se.CACHE.UNIQUE_CHECK?($('.link-toast').hide(),$('.igiftMsg').hide(),se.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),le.reject()):le.resolve()})().then(function(){var ge,ce=function uniqueMark(){ge=setTimeout(ce,1e4),se.CACHE.UNIQUE_CHECK=Date.now(),se.saveCache(!1)};return(window.addEventListener('unload',function(){ge&&(clearTimeout(ge),se.CACHE.UNIQUE_CHECK=0,se.saveCache())}),ce(),0===parseInt(B.uid)||isNaN(parseInt(B.uid)))?void se.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(se.newMessage(GM_info.script.version),V('MY_API.CONFIG',se.CONFIG),_(se))})}catch(le){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',le)}})}function _(ne){'use strict';var de=function clearStat(){ne.GIFT_COUNT.COUNT=0,ne.GIFT_COUNT.CLEAR_TS=ae(),ne.saveGiftCount(),V('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};oe(ne.GIFT_COUNT.CLEAR_TS)&&de(),K(de,'\u91CD\u7F6E\u7EDF\u8BA1'),ne.LITTLE_HEART.run(),ne.removeUnnecessary(),setTimeout(function(){ne.GroupSign.run(),ne.DailyReward.run(),ne.LiveReward.run(),ne.Exchange.runS2C(),ne.TreasureBox.run(),ne.Gift.run(),ne.MobileHeartBeat.run()},6e3),ne.creatSetBox(),D.room.getList().then(function(ge){V('\u76F4\u64AD\u95F4\u5217\u8868',ge);var ce=!0,ue=!1,Ie=void 0;try{for(var fe,pe=function _loop4(){var Ee=fe.value;D.room.getRoomList(Ee.id,0,0,1,1).then(function(me){V('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',me);for(var Oe=0;Oe<me.data.length;++Oe)ne.listen(me.data[Oe].roomid,B.uid,Ee.name+'\u533A')})},Te=ge.data[Symbol.iterator]();!(ce=(fe=Te.next()).done);ce=!0)pe()}catch(Ee){ue=!0,Ie=Ee}finally{try{!ce&&Te.return&&Te.return()}finally{if(ue)throw Ie}}});var se=function check_top_room(){if(ne.GIFT_COUNT.COUNT>=ne.CONFIG.MAX_GIFT&&(V('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),ne.max_blocked=!0),ne.blocked||ne.max_blocked)return ne.blocked?(ne.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(le)):void ne.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(f(ne.CONFIG.TIME_AREA_START_H0UR,ne.CONFIG.TIME_AREA_END_H0UR,ne.CONFIG.TIME_AREA_START_MINUTE,ne.CONFIG.TIME_AREA_END_MINUTE)&&ne.CONFIG.TIME_AREA_DISABLE)return void ne.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var ge=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],ce=1,ue=function checkHourRank(pe){D.rankdb.getTopRealTimeHour(pe).then(function(Te){var fe=Te.data.list;ne.chatLog('\u68C0\u67E5'+ge[pe]+'\u623F\u95F4\u7684\u793C\u7269','warning'),V(ge[pe]+'\u623F\u95F4\u5217\u8868',fe);var Ee=!0,me=!1,Oe=void 0;try{for(var xe,Re,ve=fe[Symbol.iterator]();!(Ee=(xe=ve.next()).done);Ee=!0)Re=xe.value,ne.checkRoom(Re.roomid,'\u5C0F\u65F6\u699C-'+Re.area_v2_parent_name+'\u533A')}catch(Re){me=!0,Oe=Re}finally{try{!Ee&&ve.return&&ve.return()}finally{if(me)throw Oe}}})},Ie=setInterval(function(){ce<=ge.length-1?(ue(ce),ce++):clearInterval(Ie)},1e3)};setTimeout(se,6e3);var le=setInterval(se,parseInt(1e3*ne.CONFIG.CHECK_HOUR_ROOM_INTERVAL)),_e=function reset(ge){var ce=setTimeout(function(){if(0<ne.raffleId_list.length||0<ne.guardId_list.length||0<ne.pkId_list.length)return V('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void _e(15000);if(oe(ne.CACHE.LittleHeart_TS))return V('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u53D1\u9001pc\u5FC3\u8DF3\u5305\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(ce),void _e(6e5);if(f(ne.CONFIG.TIME_AREA_START_H0UR,ne.CONFIG.TIME_AREA_END_H0UR,ne.CONFIG.TIME_AREA_START_MINUTE,ne.CONFIG.TIME_AREA_END_MINUTE)&&ne.CONFIG.IN_TIME_RELOAD_DISABLE){var ue=u(ne.CONFIG.TIME_AREA_START_MINUTE,ne.CONFIG.TIME_AREA_END_MINUTE)+6e4;return _e(ue),void V('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+ue+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},ge)};_e(6e4*ne.CONFIG.TIME_RELOAD)}function u(ne,de){var se=new Date,le=se.getHours(),_e=se.getMinutes(),ge=se.getSeconds(),Ie=1e3*(3600*ne)+1e3*(60*de)-(1e3*(3600*le)+1e3*(60*_e)+1e3*ge);return V('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',Ie+'\u6BEB\u79D2'),0>Ie?86400000+Ie:Ie}function I(ne,de){de.splice(de.indexOf(ne),1)}function T(ne,de){var se=new Date,le=se.getHours(),_e=se.getMinutes();return le==ne&&_e==de||(V('\u9519\u8BEF\u65F6\u95F4'),!1)}function f(ne,de,se,le){if(23<ne||24<de||0>ne||1>de||59<se||0>se||59<le||0>le)return!1;var _e=new Date,ge=_e.getHours(),ce=_e.getMinutes();if(ne<de)return ge>=ne&&ge<de||ge==de&&ce>=se&&ce<le;return ne>de?ge>=ne||ge<de||ge==de&&ce>=se&&ce<le:ne==de?ge==ne&&se<=le&&ce>=se&&ce<le||ge==ne&&se>le&&ce<=le&&ce>se:void 0}function O(ne){if(0>=ne)return!1;var de=Math.random();return ne/100>=de}function R(ne){return new Promise(function(de){var se=function onerror(le){console.error('XHR',le),de(void 0)};if(ne.GM)'POST'===ne.method&&(void 0===ne.headers&&(ne.headers={}),void 0===ne.headers['Content-Type']&&(ne.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),ne.timeout=30000,ne.onload=function(le){de(le.response)},ne.onerror=se,ne.ontimeout=se,GM_xmlhttpRequest(ne);else{var le=new XMLHttpRequest;le.open(ne.method,ne.url),'POST'===ne.method&&null===le.getResponseHeader('Content-Type')&&le.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),ne.cookie&&(le.withCredentials=!0),ne.responseType!==void 0&&(le.responseType=ne.responseType),le.timeout=30000,le.onload=function(_e){var ge=_e.target;de({response:ge,body:ge.response})},le.onerror=se,le.ontimeout=se,le.send(ne.data)}})}ie.init(),$(function(){var ne=function loadInfo(de){setTimeout(function(){var se='undefined'==typeof unsafeWindow?window:unsafeWindow;se.BilibiliLive===void 0||0===parseInt(se.BilibiliLive.UID)||isNaN(parseInt(se.BilibiliLive.UID))?(ne(1e3),window.toast('['+GM_info.script.name+']\u65E0\u914D\u7F6E\u4FE1\u606F','warning'),V('\u65E0\u914D\u7F6E\u4FE1\u606F')):(B.room_id=se.BilibiliLive.ROOMID,B.uid=se.BilibiliLive.UID,D.live_user.get_info_in_room(B.room_id).then(function(le){V('InitData: API.live_user.get_info_in_room',le),B.mobile_verify=le.data.info.mobile_verify,B.identification=le.data.info.identification}),D.gift.gift_config().then(function(le){V('InitData: API.gift.gift_config',le),!!le.data&&$.isArray(le.data)?B.gift_list=le.data:!!le.data.list&&$.isArray(le.data.list)?B.gift_list=le.data.list:(B.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))}),B.bili_jct=D.getCookie('bili_jct'),B.ruid=se.BilibiliLive.ANCHOR_UID,B.rnd=se.BilibiliLive.RND,B.visit_id=se.__statisObserver?se.__statisObserver.__visitId:'',V('Live_info',B),l())},de)};ne(1e3),o()}),Array.prototype.remove=function(ne){var de=this.indexOf(ne);-1<de&&this.splice(de,1)};var ae=function dateNow(){return Date.now()},oe=function checkNewDay(ne){if(0===ne)return!0;var de=new Date(ne),se=new Date,le=de.getDate(),_e=se.getDate();return _e!==le}})();
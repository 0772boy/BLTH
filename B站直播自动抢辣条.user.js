// ==UserScript==
// @namespace     https://github.com/andywang425
// @name          B站直播自动抢辣条
// @name:en       B站直播自动抢辣条
// @author        andywang425
// @description   自动参与Bilibili直播区抽奖(现在极少)，完成每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章
// @description:en 自动参与Bilibili直播区抽奖(现在极少)，完成每日任务，领银瓜子宝箱，自动送礼，自动获取小心心，批量点亮勋章
// @updateURL     https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @downloadURL    https://raw.githubusercontent.com/andywang425/Bilibili-SGTH/master/B%E7%AB%99%E7%9B%B4%E6%92%AD%E8%87%AA%E5%8A%A8%E6%8A%A2%E8%BE%A3%E6%9D%A1.user.js
// @homepageURL   https://github.com/andywang425/Bilibili-SGTH/
// @supportURL    https://github.com/andywang425/Bilibili-SGTH/issues
// @icon          https://s1.hdslb.com/bfs/live/d57afb7c5596359970eb430655c6aef501a268ab.png
// @copyright     2020, andywang425 (https://github.com/andywang425)
// @license       MIT
// @version       3.9.1.2
// @include      /https?:\/\/live\.bilibili\.com\/[blanc\/]?[^?]*?\d+\??.*/
// @run-at       document-end
// @connect      passport.bilibili.com
// @connect      api.live.bilibili.com
// @connect      live-trace.bilibili.com
//@require https://cdn.jsdelivr.net/gh/jquery/jquery@3.2.1/dist/jquery.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.4/BilibiliAPI_Mod.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.2/OCRAD.min.js
//@require https://cdn.jsdelivr.net/gh/andywang425/Bilibili-SGTH@v1.3.4/libBilibiliToken.user.js
// @grant       unsafeWindow
// @grant       GM_xmlhttpRequest
// @grant       GM_openInTab
// ==/UserScript==
'use strict';var _Mathmax=Math.max,_Mathmin=Math.min,_Mathfloor=Math.floor,_Mathround=Math.round,_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&'function'==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?'symbol':typeof o};function _defineProperty(o,l,_){return l in o?Object.defineProperty(o,l,{value:_,enumerable:!0,configurable:!0,writable:!0}):o[l]=_,o}function _asyncToGenerator(o){return function(){var l=o.apply(this,arguments);return new Promise(function(_,u){function I(T,f){try{var E=l[T](f),O=E.value}catch(G){return void u(G)}return E.done?void _(O):Promise.resolve(O).then(function(G){I('next',G)},function(G){I('throw',G)})}return I('next')})}}(function(){var R=this,A=!1,D='IGIFTMSG',M=BilibiliAPI,L=0,S=0,F=0,w=!1,U=[],k=[],H=window&&window.navigator?window.navigator.userAgent:'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36',B=new Date().getTimezoneOffset()+480,P=function ts_ms(){return Date.now()},Y=function ts_s(){return _Mathround(P()/1e3)},X={room_id:void 0,uid:void 0,ruid:void 0,mobile_verify:void 0,gift_list:void 0,rnd:void 0,visit_id:void 0,identification:void 0,bili_jct:void 0},V=function runUntilSucceed(le){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,ge=2<arguments.length&&arguments[2]!==void 0?arguments[2]:100;setTimeout(function(){le()||V(le,ge,ge)},_e)},K=function delayCall(le){var _e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e4,ge=$.Deferred();return setTimeout(function(){var ue=le();ue&&ue.then?ue.then(function(ce,Ie,pe,Te,fe,Ee){return ge.resolve(ce,Ie,pe,Te,fe,Ee)}):ge.resolve()},_e),ge},Q=function MYDEBUG(le){for(var _e=arguments.length,ge=Array(1<_e?_e-1:0),ue=1;ue<_e;ue++)ge[ue-1]=arguments[ue];var ce=new Date;return ce='['+D+']['+ce.getHours()+':'+ce.getMinutes()+':'+ce.getSeconds()+':'+ce.getMilliseconds()+']',1===ge.length?void console.log(ce,le+':',ge[0]):void console.log(ce,le+':',ge)},z=function runMidnight(le,_e){var ge=new Date;ge.setMinutes(ge.getMinutes()+B),ge.setDate(ge.getDate()+1),ge.setHours(0,1,0,0),ge.setMinutes(ge.getMinutes()-B),setTimeout(le,ge-P()),Q('runMidnight',(_e||' ')+' '+ge.toString())},Z=function runExactMidnight(le,_e){var ge=new Date;ge.setMinutes(ge.getMinutes()+B),ge.setDate(ge.getDate()+1),ge.setHours(0,0,0,0),ge.setMinutes(ge.getMinutes()-B),setTimeout(le,ge-P()),Q('runExactMidnight',(_e||' ')+' '+ge.toString())},J=function runTomorrow(le,_e,ge,ue){var ce=new Date;ce.setMinutes(ce.getMinutes()+B),ce.setDate(ce.getDate()+1),ce.setHours(_e,ge,0,0),ce.setMinutes(ce.getMinutes()-B),setTimeout(le,ce-P()),Q('runTomorrow',(ue||' ')+' '+ce.toString())},ee=new BilibiliToken,te='actionKey=appkey&appkey='+BilibiliToken.appKey+'&build=5561000&channel=bili&device=android&mobi_app=android&platform=android&statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%225.57.0%22%2C%22abtest%22%3A%22%22%7D',ie=void 0,ae=JSON.parse(localStorage.getItem(D+'_userToken'))||{},oe=function(){var le=_asyncToGenerator(regeneratorRuntime.mark(function _e(){return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(!(ae.time>Y())){ue.next=4;break}ie=ie,ue.next=10;break;case 4:return ue.next=6,ee.getToken();case 6:ae=ue.sent,ae.time=Y()+ae.expires_in,localStorage.setItem(D+'_Token',JSON.stringify(ae)),ie=ae;case 10:;return Q(D+'_userToken',ae),ue.abrupt('return','OK');case 13:case'end':return ue.stop();}},_e,R)}));return function setToken(){return le.apply(this,arguments)}}(),ne={init:function init(){return ne.Toast.init().then(function(){})},Toast:{init:function init(){try{var le=[];return window.toast=function(_e){var ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'info',ue=2<arguments.length&&void 0!==arguments[2]?arguments[2]:5e3;switch(ge){case'success':case'info':break;case'caution':break;case'error':break;default:ge='info';}var ce=$('<div class="link-toast '+ge+' fixed"><span class="toast-text">'+_e+'</span></div>')[0];document.body.appendChild(ce),ce.style.top=document.body.scrollTop+40*le.length+10+'px',ce.style.left=document.body.offsetWidth+document.body.scrollLeft-ce.offsetWidth-5+'px',le.push(ce),setTimeout(function(){ce.className+=' out',setTimeout(function(){le.shift(),le.forEach(function(Ie){Ie.style.top=parseInt(Ie.style.top,10)-40+'px'}),$(ce).remove()},200)},ue)},$.Deferred().resolve()}catch(le){return console.error('\u521D\u59CB\u5316\u6D6E\u52A8\u63D0\u793A\u65F6\u51FA\u73B0\u5F02\u5E38',le),$.Deferred().reject()}}}};function o(){$('head').append('\n        <style>\n            .igiftMsg_input{\n                outline: none;\n                border: 1px solid #e9eaec;\n                background-color: #fff;\n                border-radius: 4px;\n                padding: 1px 0 0;\n                overflow: hidden;\n                font-size: 12px;\n                line-height: 19px;\n                width: 30px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_btn{\n                background-color: #23ade5;\n                color: #fff;\n                border-radius: 4px;\n                border: none;\n                padding: 5px;\n                cursor: pointer;\n                box-shadow: 0 0 2px #00000075;\n                line-height: 10px;\n                \'z-index\': \'10001\';\n            }\n            .igiftMsg_fs{\n                border: 2px solid #d4d4d4;\n                \'z-index\': \'10001\';\n            }\n        </style>\n            ')}function l(){var _e,le=this,ge={CONFIG_DEFAULT:{AUTO_GIFT:!1,AUTO_GIFT_ROOMID:'0',AUTO_GROUP_SIGN:!0,AUTO_TREASUREBOX:!0,CHECK_HOUR_ROOM_INTERVAL:120,COIN:!1,COIN_NUMBER:0,COIN_TYPE:'COIN_DYN',COIN_UID:0,EXCLUDE_ROOMID:'0',FORCE_LOTTERY:!1,FORCE_LIGHT:!1,GIFT_LIMIT:1,GIFT_SEND_HOUR:23,GIFT_SEND_MINUTE:59,GIFT_INTERVAL:5,GIFT_METHOD:'GIFT_SEND_TIME',GIFT_SORT:!1,IN_TIME_RELOAD_DISABLE:!1,LIVE_SIGN:!0,LOGIN:!0,LITTLE_HEART:!1,LIGHT_MEDALS:'0',LIGHT_METHOD:'LIGHT_WHITE',MAX_GIFT:99999,MAX_TAB:5,MOBILE_HEARTBEAT:!0,RANDOM_DELAY:!0,RANDOM_SEND_DANMU:0,RANDOM_SKIP:0,REMOVE_ELEMENT_2233:!1,REMOVE_ELEMENT_july:!1,REMOVE_ELEMENT_player:!1,RND_DELAY_END:5,RND_DELAY_START:2,SEND_ALL_GIFT:!1,SHARE:!0,SILVER2COIN:!1,SPARE_GIFT_ROOM:'0',SPARE_GIFT_UID:'0',STORM:!1,STORM_MAX_COUNT:100,STORM_ONE_LIMIT:200,STORM_QUEUE_SIZE:3,TIME_AREA_DISABLE:!0,TIME_AREA_END_H0UR:8,TIME_AREA_END_MINUTE:0,TIME_AREA_START_H0UR:2,TIME_AREA_START_MINUTE:0,TIME_RELOAD:60,WATCH:!0},CACHE_DEFAULT:{UNIQUE_CHECK:0,AUTO_GROUP_SIGH_TS:0,DailyReward_TS:0,LiveReward_TS:0,TreasureBox_TS:0,Silver2Coin_TS:0,Gift_TS:0,GiftInterval_TS:0,MobileHeartBeat_TS:0,LittleHeart_TS:0},CONFIG:{},CACHE:{},GIFT_COUNT:{COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},init:function init(){try{M.setCommonArgs(X.bili_jct)}catch(ce){return void console.error('['+D+']',ce)}var ue=$.Deferred();try{ge.loadConfig().then(function(){ge.chatLog('\u811A\u672C\u8F7D\u5165\u914D\u7F6E\u6210\u529F','success'),ue.resolve()})}catch(ce){console.error('API\u521D\u59CB\u5316\u51FA\u9519',ce),ge.chatLog('API\u521D\u59CB\u5316\u51FA\u9519','error'),ue.reject()}try{ge.loadCache().then(function(){window.toast('CACHE\u8F7D\u5165\u6210\u529F','success'),ue.resolve()})}catch(ce){console.error('CACHE\u521D\u59CB\u5316\u51FA\u9519',ce),window.toast('CACHE\u521D\u59CB\u5316\u51FA\u9519','error'),ue.reject()}return setTimeout(function(){ge.TreasureBox.init()},5750),ue},loadConfig:function loadConfig(){var ue=$.Deferred();try{var ce=JSON.parse(localStorage.getItem(D+'_CONFIG'));for(var Ie in $.extend(!0,ge.CONFIG,ge.CONFIG_DEFAULT),ge.CONFIG)ge.CONFIG.hasOwnProperty(Ie)&&void 0!==ce[Ie]&&null!==ce[Ie]&&(ge.CONFIG[Ie]=ce[Ie]);ge.loadGiftCount(),ue.resolve()}catch(ce){Q('API\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',ce),ge.setDefaults(),ue.reject()}return ue},loadCache:function loadCache(){var ue=$.Deferred();try{var ce=JSON.parse(localStorage.getItem(D+'_CACHE'));for(var Ie in $.extend(!0,ge.CACHE,ge.CACHE_DEFAULT),ge.CACHE)ge.CACHE.hasOwnProperty(Ie)&&void 0!==ce[Ie]&&null!==ce[Ie]&&(ge.CACHE[Ie]=ce[Ie]);ue.resolve()}catch(ce){Q('CACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25\uFF0C\u52A0\u8F7D\u9ED8\u8BA4\u914D\u7F6E',ce),ge.setDefaults(),ue.reject()}return ue},newMessage:function newMessage(ue){try{var Ie=localStorage.getItem(D+'_NEWMSG_CACHE');(Ie==void 0||null==Ie||'3.9'!=Ie)&&'3.9'==ue&&(alert(ue+'\u66F4\u65B0\u63D0\u793A\uFF1A\n\n                \u8BF7\u9605\u8BFB\u4E00\u4E0B\u811A\u672C\u8BF4\u660E\u4E2D\u7684\u5C0F\u5FC3\u5FC3\u90E8\u5206\uFF0C\u83B7\u53D6\u65B9\u5F0F\u6709\u53D8\u52A8\u3002\n\n                \u7B49b\u7AD9\u5220\u9664\u8FA3\u6761\u540E\u811A\u672C\u4F1A\u6539\u540D(\u76EE\u524D\u597D\u50CF\u5C31\u5269\u4E2A\u6D41\u661F\u96E8\u6709\u62BD\u5956\u4E86)\uFF0C\n                \uFF08greasyfork\u7528\u6237\u53EF\u5FFD\u7565\u4EE5\u4E0B\u90E8\u5206\uFF09\u6240\u4EE5\u66F4\u65B0\u94FE\u63A5\u4E5F\u4F1A\u53D8\u5316\u3002\n                \u6539\u540D\u540E\uFF0C\u6211\u4F1A\u53D1\u5E03B\u7AD9\u76F4\u64AD\u81EA\u52A8\u62A2\u8FA3\u6761\u7684\u6700\u7EC8\u7248\u672C\u3002\n                \u5B89\u88C5\u8FD9\u4E2A\u7248\u672C\u540E\u811A\u672C\u4F1A\u63D0\u793A\u4F60\u5B89\u88C5\u6539\u540D\u540E\u7684\u65B0\u811A\u672C\u3002\n\n                \u672C\u63D0\u793A\u5728\u6BCF\u4E2A\u7248\u672C\u4EC5\u4F1A\u51FA\u73B0\u4E00\u6B21\u3002'),localStorage.setItem(D+'_NEWMSG_CACHE',ue))}catch(Ie){Q('\u63D0\u793A\u4FE1\u606FCACHE\u8F7D\u5165\u914D\u7F6E\u5931\u8D25',Ie)}},saveConfig:function saveConfig(){try{return localStorage.setItem(D+'_CONFIG',JSON.stringify(ge.CONFIG)),ge.chatLog('\u914D\u7F6E\u5DF2\u4FDD\u5B58'),Q('MY_API.CONFIG',ge.CONFIG),!0}catch(ue){return Q('API\u4FDD\u5B58\u51FA\u9519',ue),!1}},saveCache:function saveCache(ue){try{return localStorage.setItem(D+'_CACHE',JSON.stringify(ge.CACHE)),!1!=ue&&Q('CACHE\u5DF2\u4FDD\u5B58',ge.CACHE),!0}catch(ce){return Q('CACHE\u4FDD\u5B58\u51FA\u9519',ce),!1}},setDefaults:function setDefaults(){ge.CONFIG=ge.CONFIG_DEFAULT,ge.CACHE=ge.CACHE_DEFAULT,ge.saveConfig(),ge.saveCache(),ge.chatLog('\u914D\u7F6E\u548CCACHE\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u30023\u79D2\u540E\u5237\u65B0\u9875\u9762'),setTimeout(function(){window.location.reload()},3e3)},ReDoDailyTasks:function ReDoDailyTasks(){window.toast('3\u79D2\u540E\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1','info'),setTimeout(function(){ge.CACHE=ge.CACHE_DEFAULT,ge.GroupSign.run(),ge.DailyReward.run(),ge.LiveReward.run(),ge.Exchange.runS2C(),ge.TreasureBox.run(),ge.Gift.run(),ge.LITTLE_HEART.run(),ge.MobileHeartBeat.run()},3e3)},loadGiftCount:function loadGiftCount(){try{var ue=JSON.parse(localStorage.getItem(D+'_GIFT_COUNT'));for(var ce in ge.GIFT_COUNT)ge.GIFT_COUNT.hasOwnProperty(ce)&&void 0!==ue[ce]&&null!==ue[ce]&&(ge.GIFT_COUNT[ce]=ue[ce]);Q('MY_API.GIFT_COUNT',ge.GIFT_COUNT)}catch(ue){Q('\u8BFB\u53D6\u7EDF\u8BA1\u5931\u8D25',ue)}},saveGiftCount:function saveGiftCount(){try{return localStorage.setItem(D+'_GIFT_COUNT',JSON.stringify(ge.GIFT_COUNT)),Q('\u7EDF\u8BA1\u4FDD\u5B58\u6210\u529F',ge.GIFT_COUNT),!0}catch(ue){return Q('\u7EDF\u8BA1\u4FDD\u5B58\u51FA\u9519',ue),!1}},addGift:function addGift(ue){ge.GIFT_COUNT.COUNT+=ue,$('#giftCount span:eq(0)').text(ge.GIFT_COUNT.COUNT),ge.saveGiftCount()},addSilver:function addSilver(ue){ge.GIFT_COUNT.SILVER_COUNT+=10*ue,$('#giftCount span:eq(1)').text(ge.GIFT_COUNT.SILVER_COUNT),ge.saveGiftCount()},removeUnnecessary:function removeUnnecessary(){var ue=['#my-dear-haruna-vm','.july-activity-entry','.bilibili-live-player'],ce=function removeUntiSucceed(Ie,pe){!0===ge.CONFIG[Ie]&&setInterval(function(){0<$(ue[pe]).length&&$(ue[pe]).remove()},200)};ce('REMOVE_ELEMENT_2233',0),ce('REMOVE_ELEMENT_july',1),ce('REMOVE_ELEMENT_player',2)},creatSetBox:function creatSetBox(){function ue(){var Ge,Ce,Re=ge.CONFIG.TIME_AREA_START_H0UR=parseInt(Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val()),he=ge.CONFIG.TIME_AREA_END_H0UR=parseInt(Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val()),Ae=ge.CONFIG.TIME_AREA_START_MINUTE=parseInt(Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val()),Ne=ge.CONFIG.TIME_AREA_END_MINUTE=parseInt(Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val());if(0>Re||0>he||0>Ae||0>Ne)return void ge.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u6570\u636E\u5C0F\u4E8E0','warning');if(24<=Re||24<=he||60<=Ae||60<=Ne)return void ge.chatLog('[\u5B9A\u65F6\u4F11\u7720]\u65F6\u95F4\u9519\u8BEF','warning');if(ge.CONFIG.TIME_AREA_START_H0UR=Re,ge.CONFIG.TIME_AREA_END_H0UR=he,ge.CONFIG.TIME_AREA_START_MINUTE=Ae,ge.CONFIG.TIME_AREA_END_MINUTE=Ne,Ge=parseFloat(Ie.find('div[data-toggle="RANDOM_SKIP"] .per').val()),0>Ge||100<Ge)return void ge.chatLog('[\u968F\u673A\u8DF3\u8FC7\u793C\u7269]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(ge.CONFIG.RANDOM_SKIP=Ge,Ge=parseFloat(Ie.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val()),5<Ge)return void ge.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u4E3A\u7EF4\u62A4\u76F4\u64AD\u95F4\u5F39\u5E55\u6C1B\u56F4,\u5F39\u5E55\u53D1\u9001\u6982\u7387\u4E0D\u5F97\u5927\u4E8E5%','warning');if(0>Ge)return void ge.chatLog('[\u6D3B\u8DC3\u5F39\u5E55]\u6570\u636E\u5C0F\u4E8E0','warning');if(ge.CONFIG.RANDOM_SEND_DANMU=Ge,Ge=parseInt(Ie.find('div[data-toggle="MAX_GIFT"] .num').val()),ge.CONFIG.MAX_GIFT=Ge,Ge=parseInt(Ie.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val()),0>=Ge||1e4<Ge)return void ge.chatLog('[\u76F4\u64AD\u95F4\u91CD\u8F7D\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0\u6216\u5927\u4E8E10000','warning');if(ge.CONFIG.TIME_RELOAD=Ge,Ge=parseFloat(Ie.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val()),he=parseFloat(Ie.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val()),0>Ge||100<he)return void ge.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E100','warning');if(he<=Ge)return void ge.chatLog('[\u62BD\u5956\u5EF6\u65F6]\u6570\u636E\u5927\u5C0F\u5173\u7CFB\u4E0D\u6B63\u786E','warning');if(ge.CONFIG.RND_DELAY_START=Ge,ge.CONFIG.RND_DELAY_END=he,Ge=parseInt(Ie.find('div[data-toggle="COIN"] .coin_number').val()),0>Ge||5<Ge)return void ge.chatLog('[\u81EA\u52A8\u6295\u5E01]\u6570\u636E\u5C0F\u4E8E0\u6216\u5927\u4E8E5','warning');if(ge.CONFIG.COIN_NUMBER=Ge,Ge=parseInt(Ie.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val()),0>=Ge)return void ge.chatLog('[\u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694]\u6570\u636E\u5C0F\u4E8E\u7B49\u4E8E0','warning');ge.CONFIG.CHECK_HOUR_ROOM_INTERVAL=Ge,Ge=Ie.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(),Ce=Ge.split(',');for(var ye=0;ye<Ce.length;ye++)''===Ce[ye]&&(Ce[ye]=0);Ge=Ce.join(','),ge.CONFIG.AUTO_GIFT_ROOMID=Ge,Ge=Ie.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(),Ce=Ge.split(',');for(var ye=0;ye<Ce.length;ye++)''===Ce[ye]&&(Ce[ye]=0);return(Ge=Ce.join(','),ge.CONFIG.EXCLUDE_ROOMID=Ge,Ge=parseInt(Ie.find('div[data-toggle="GIFT_LIMIT"] .num').val()),ge.CONFIG.GIFT_LIMIT=Ge,Re=parseInt(Ie.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val()),he=parseInt(Ie.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val()),0>Re||0>he)?void ge.chatLog('[\u9001\u793C\u65F6\u95F4]\u6570\u636E\u5C0F\u4E8E0','warning'):24<=Re||60<=he?void ge.chatLog('[\u9001\u793C\u65F6\u95F4]\u65F6\u95F4\u9519\u8BEF','warning'):void(ge.CONFIG.GIFT_SEND_HOUR=Re,ge.CONFIG.GIFT_SEND_MINUTE=he,Ge=Ie.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(),ge.CONFIG.SPARE_GIFT_ROOM=Ge,Ge=Ie.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(),ge.CONFIG.SPARE_GIFT_UID=Ge,Ge=parseInt(Ie.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val()),ge.CONFIG.STORM_QUEUE_SIZE=Ge,Ge=parseInt(Ie.find('div[data-toggle="STORM_MAX_COUNT"] .num').val()),ge.CONFIG.STORM_MAX_COUNT=Ge,Ge=parseInt(Ie.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val()),ge.CONFIG.STORM_ONE_LIMIT=Ge,Ge=parseInt(Ie.find('div[data-toggle="COIN_UID"] .num').val()),ge.CONFIG.COIN_UID=Ge,Ge=Ie.find('div[data-toggle="LIGHT_MEDALS"] .num').val(),ge.CONFIG.LIGHT_MEDALS=Ge,Ge=parseInt(Ie.find('div[data-toggle="MAX_TAB"] .num').val()),ge.CONFIG.MAX_TAB=Ge,ge.saveConfig())}var ce=$('<button style="display: inline-block; float: left; margin-right: 7px;background-color: #23ade5;color: #fff;border-radius: 4px;border: none; padding:4px; cursor: pointer;box-shadow: 1px 1px 2px #00000075;" id="hiderbtn">\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F<br></button>');ce.click(function(){if(!1==A){A=!0,$('.igiftMsg').hide(),Ie.hide();var Ge=$('.chat-history-list');Ge.animate({scrollTop:0},0),setTimeout(function(){Ge.animate({scrollTop:Ge.prop('scrollHeight')},10)},100),document.getElementById('hiderbtn').innerHTML='\u663E\u793A\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}else{A=!1,$('.igiftMsg').show(),Ie.show();var Ge=$('.chat-history-list');Ge.animate({scrollTop:Ge.prop('scrollHeight')},0),document.getElementById('hiderbtn').innerHTML='\u9690\u85CF\u7A97\u53E3\u548C\u62BD\u5956\u4FE1\u606F'}}),$('.attention-btn-ctnr').append(ce);var Ie=$('<div>'),pe=$('.live-player-mounter').height();Ie.css({width:'auto',height:pe,position:'absolute',top:'-2px',right:'0px',background:'#F0F0F0',padding:'10px',"z-index":'10001',"border-radius":'4px',overflow:'scroll',"line-height":'15px'}),Ie.append('\n                <div id=\'allsettings\'>\n                <fieldset class="igiftMsg_fs">\n                    <legend style="color: black">\u4ECA\u65E5\u7EDF\u8BA1</legend>\n                    <div id="giftCount" style="font-size: large; text-shadow: 1px 1px #00000066; color: blueviolet;">\n                        \u8FA3\u6761&nbsp;<span>'+ge.GIFT_COUNT.COUNT+'</span>\n                        \u94F6\u74DC\u5B50&nbsp;<span>'+ge.GIFT_COUNT.SILVER_COUNT+'\u4E07</span>\n                        <button style="font-size: small" class="igiftMsg_btn" data-action="save">\u4FDD\u5B58\u6240\u6709\u8BBE\u7F6E</button>\n                    </div>\n                </fieldset>\n                <div id="left_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u4F4E\u8C03\u8BBE\u7F6E</legend>\n                        <div data-toggle="RANDOM_DELAY">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u62BD\u5956\u9644\u52A0\u968F\u673A\u5EF6\u8FDF\n                                <input class="RND_DELAY_START igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">~\n                                <input class="RND_DELAY_END igiftMsg_input" style="width: 30px;vertical-align: top;" type="text">s\n                            </label>\n                        </div>\n                        <div data-toggle="TIME_AREA_DISABLE">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u542F\u7528\n                                <input class="startHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="startMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u81F3\n                                <input class="endHour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                                <input class="endMinute igiftMsg_input" style="width: 20px;" type="text">\u5206\u4E0D\u62BD\u5956(24\u5C0F\u65F6\u5236)\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SKIP">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u968F\u673A\u8DF3\u8FC7\u793C\u7269(0\u5230100,\u4E3A0\u5219\u4E0D\u8DF3\u8FC7)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_GIFT">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u5F53\u5929\u6700\u591A\u62A2\u8FA3\u6761\u6570\u91CF<input class="num igiftMsg_input" style="width: 100px;" type="text">\n                            </label>\n                        </div>\n                        <div data-toggle="RANDOM_SEND_DANMU">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u62BD\u5956\u65F6\u6D3B\u8DC3\u5F39\u5E55\u53D1\u9001\u6982\u7387(0\u52305,\u4E3A0\u5219\u4E0D\u53D1\u9001)<input class="per igiftMsg_input" style="width: 30px;" type="text">%\n                            </label>\n                        </div>\n                        <div data-toggle="CHECK_HOUR_ROOM_INTERVAL">\n                            <label style="cursor: pointer; margin: 5px auto; color: darkgreen">\n                                \u68C0\u67E5\u5C0F\u65F6\u699C\u95F4\u9694\u65F6\u95F4<input class="num igiftMsg_input" style="width: 25px;" type="text">\u79D2\n                            </label>\n                        </div>\n            \n                    </fieldset>\n            \n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u6BCF\u65E5\u4EFB\u52A1\u8BBE\u7F6E</legend>\n                        <div data-toggle="LOGIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u767B\u9646\n                        </div>\n                        <div data-toggle="WATCH" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u89C2\u770B\u89C6\u9891\n                        </div>\n                        <div data-toggle="COIN" style=" color: black">\n                            <label style="cursor: pointer">\n                                <input style="cursor: pointer; vertical-align: text-top;" type="checkbox">\n                                \u81EA\u52A8\u6295\u5E01<input class="coin_number igiftMsg_input" style="width: 40px;" type="text">\u4E2A(0-5)\n                            </label>\n                        </div>\n                        <div data-toggle="COIN_TYPE" style=" color: black">\n                            <div data-toggle="COIN_UID">\n                            <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                            \u7ED9\u7528\u6237(UID:<input class="num igiftMsg_input" style="width: 80px;" type="text">)\n                            \u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                            <div data-toggle="COIN_DYN">\n                                <input style="vertical-align: text-top;" type="radio" name="COIN_TYPE">\n                                \u7ED9\u52A8\u6001\u4E2D\u7684\u7684\u89C6\u9891\u6295\u5E01\n                            </div>\n                        </div>\n                        <div data-toggle="SHARE" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5206\u4EAB\u89C6\u9891\n                        </div>\n                        <div data-toggle="SILVER2COIN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u94F6\u74DC\u5B50\u6362\u786C\u5E01\n                        </div>\n                        <div data-toggle="LIVE_SIGN" style=" color: black">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u76F4\u64AD\u533A\u7B7E\u5230\n                        </div>\n                        <div data-toggle="AUTO_GROUP_SIGN" style=" color: darkgreen">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u5E94\u63F4\u56E2\u7B7E\u5230\n                        </div>\n                        <div data-toggle="MOBILE_HEARTBEAT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u6A21\u62DF\u79FB\u52A8\u7AEF\u5FC3\u8DF3 + \u9886\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD\u5956\u52B1\n                        </div>\n                        <div data-toggle="AUTO_TREASUREBOX" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u81EA\u52A8\u9001\u793C\u8BBE\u7F6E</legend>\n                        <div data-toggle="AUTO_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u81EA\u52A8\u9001\u793C\n                        </div>\n            \n                        <div data-toggle="AUTO_GIFT_ROOMID" style=" color: purple">\n                            \u4F18\u5148\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n            \n                        <div data-toggle="EXCLUDE_ROOMID" style=" color: purple">\n                            \u4E0D\u9001\u793C\u623F\u95F4\n                            <input class="num igiftMsg_input" style="width: 150px;" type="text">\n                        </div>\n                        <div data-toggle="GIFT_INTERVAL" style=" color: black">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u95F4\u9694\n                            <input class="num igiftMsg_input" style="width: 30px;" type="text">\n                            \u5206\u949F\u9001\u793C\n                        </div>\n                        <div data-toggle="GIFT_SEND_TIME" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="radio" name="GIFT_TYPE">\n                            \u5B9A\u65F6\u9001\u793C<br>\n                            \u9001\u793C\u65F6\u95F4\n                            <input class="Hour igiftMsg_input" style="width: 20px;" type="text">\u70B9\n                            <input class="Minute igiftMsg_input" style="width: 20px;" type="text">\u5206\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="sendGiftNow">\u7ACB\u523B\u5F00\u59CB\u9001\u793C</button>\n                        </div>\n                        \n                        <div data-toggle="GIFT_LIMIT" style=" color: purple">\n                            \u793C\u7269\u5230\u671F\u65F6\u95F4\n                            <input class="num igiftMsg_input" style="width: 20px;" type="text">\n                            \u5929\n                        </div>\n                        <div data-toggle="GIFT_SORT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u793C\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\n                        </div>\n                        <div data-toggle="SEND_ALL_GIFT" style=" color: purple">\n                            <input style="vertical-align: text-top;" type="checkbox">\n                            \u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\n                        </div>\n                        <div data-toggle="SPARE_GIFT_ROOM" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                        <div data-toggle="SPARE_GIFT_UID" style=" color: black">\n                            \u5269\u4F59\u793C\u7269\u9001\u793C\u76F4\u64AD\u95F4\u62E5\u6709\u8005UID\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 100px;">\n                        </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8282\u594F\u98CE\u66B4\u8BBE\u7F6E</legend>\n                        <div data-toggle="STORM" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: #ff5200">\n                                <input style="vertical-align: text-top;" type="checkbox">\u53C2\u4E0E\u8282\u594F\u98CE\u66B4\n                            </label>\n                        </div>\n                        <div data-toggle="STORM_QUEUE_SIZE" style="color: black">\n                            \u5141\u8BB8\u540C\u65F6\u53C2\u4E0E\u7684\u8282\u594F\u98CE\u66B4\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_MAX_COUNT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u6700\u5927\u5C1D\u8BD5\u6B21\u6570\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </div>\n                        <div data-toggle="STORM_ONE_LIMIT" style="color: black">\n                            \u5355\u4E2A\u98CE\u66B4\u53C2\u4E0E\u6B21\u6570\u95F4\u9694\uFF1A\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                            \u6BEB\u79D2\n                        </div>\n                    </fieldset>\n                </div>\n            \n            \n            \n                <div id="right_fieldset" style="float:left;">\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u8BF4\u660E</legend>\n                        \u81EA\u52A8\u9001\u793C\u76EE\u524D\u53EA\u4F1A\u9001\u51FA\u8FA3\u6761\uFF0C\u4EBF\u5706\u548C\u5C0F\u5FC3\u5FC3\u3002<br>\n                        \u793C\u7269\u5230\u671F\u65F6\u95F4: \u5C06\u8981\u5728\u8FD9\u4E2A\u65F6\u95F4\u6BB5\u91CC\u8FC7\u671F\u7684\u793C\u7269\u4F1A\u88AB\u9001\u51FA<br>\n                        \u52FE\u9009\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u65F6\u65E0\u8BBA\u662F\u5426\u5C06\u8981\u8FC7\u671F\u90FD\u4F1A\u88AB\u9001\u51FA<br>\n                        \u5982\u679C\u8981\u586B\u5199\u591A\u4E2A\u4F18\u5148\u9001\u793C\u623F\u95F4\uFF0C<br>\n                        \u6BCF\u4E2A\u623F\u95F4\u53F7\u4E4B\u95F4\u9700\u7528\u534A\u89D2\u9017\u53F7,\u9694\u5F00\u3002(\u4E0D\u9001\u793C\u623F\u95F4\uFF0C\u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\u540C\u7406)<br>\n                        \u5982 666,777,888\u3002\u4E3A0\u5219\u4E0D\u9001\u3002<br>\n                        \u5982\u679C\u6CA1\u6709\u8FD9\u4E9B\u623F\u95F4\u7684\u7C89\u4E1D\u724C\u4E5F\u4E0D\u9001\u3002<br>\n                        \u65E0\u8BBA\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u5982\u4F55\u8BBE\u7F6E\uFF0C\u4F1A\u6839\u636E\u3010\u9001\u6EE1\u5168\u90E8\u52CB\u7AE0\u3011<br>\n                        \uFF08\u52FE\u9009\u5219\u8865\u6EE1\uFF0C\u5426\u5219\u53EA\u9001\u5230\u671F\u7684\uFF09\u6761\u4EF6\u53BB\u6309\u4F18\u5148\u9001\u793C\u623F\u95F4\u5148\u540E\u987A\u5E8F\u9001\u793C\u3002<br>\n                        \u4E4B\u540E\u6839\u636E\u3010\u4F18\u5148\u9AD8\u7B49\u7EA7\u7C89\u4E1D\u724C\u3011\u51B3\u5B9A\u5148\u9001\u9AD8\u7EA7\u8FD8\u662F\u4F4E\u7EA7\uFF08\u52FE\u9009\u5148\u9AD8\u7EA7\uFF0C\u4E0D\u52FE\u9009\u5148\u4F4E\u7EA7\uFF09\u3002<br>\n                        \u5269\u4F59\u793C\u7269:\u6307\u9001\u5B8C\u4E86\u6240\u6709\u7C89\u4E1D\u724C\uFF0C\u4F46\u4ECD\u6709\u5269\u4F59\u7684\u5C06\u57281\u5929\u5185\u8FC7\u671F\u7684\u793C\u7269\u3002<br>\n                        \u5269\u4F59\u793C\u7269\u4E5F\u4F1A\u5728\u6307\u5B9A\u9001\u793C\u65F6\u95F4\u88AB\u9001\u51FA\u3002<br>\n                        \u53C2\u4E0E\u8282\u594F\u98CE\u66B4\u98CE\u9669\u8F83\u5927\uFF0C\u5982\u679C\u6CA1\u6709\u5B9E\u540D\u53EF\u80FD\u65E0\u6CD5\u53C2\u52A0\u3002<br>\n                        \u811A\u672C\u4EC5\u80FD\u53C2\u52A0\u5E7F\u64AD\u4E2D\u7684\u8282\u594F\u98CE\u66B4\u3002<br>\n                        \u3010\u7ED9\u7528\u6237(UID:___)\u7684\u89C6\u9891\u6295\u5E01\u3011\u82E5\u586B0\u5219\u7ED9\u52A8\u6001\u4E2D\u7684\u89C6\u9891\u4F9D\u6B21\u6295\u5E01(\u56E0\u4E3A\u65E0UID\u4E3A0\u7684\u7528\u6237)\n            \n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5C0F\u5FC3\u5FC3</legend>\n                        <div data-toggle="LITTLE_HEART" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u81EA\u52A8\u540E\u53F0\u5FAA\u73AF\u5F00\u5173\u6807\u7B7E\u9875\u83B7\u53D6\u5C0F\u5FC3\u5FC3\n                            </label>\n                        </div>\n                        <div data-toggle="MAX_TAB" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            \u6253\u5F00\u6807\u7B7E\u9875\u6570\u91CF\u4E0A\u9650\n                            <input class="num igiftMsg_input" type="text" style="width: 30px;">\n                        </label>\n                    </div>\n                        <div data-toggle="LIGHT_MEDALS" style=" color: purple">\n                            \u81EA\u52A8\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u53F7\n                        <input class="num igiftMsg_input" style="width: 300px;" type="text">\n                    </div>\n                    <div data-toggle="LIGHT_METHOD" style="line-height: 15px; color: black; display:inline">\n                        \u52CB\u7AE0\u70B9\u4EAE\u6A21\u5F0F\uFF1A&nbsp;&nbsp;\n                        <div data-toggle="LIGHT_WHITE" style="color: black; display:inline">\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u767D\u540D\u5355\n                        </div>\n                        <div data-toggle="LIGHT_BLACK" style="color: black; display:inline">\n                            &nbsp;\n                            <input style="vertical-align: text-top;" type="radio" name="LIGHT_TYPE">\n                            \u9ED1\u540D\u5355\n                        </div>\n                    </div>\n                    <div data-toggle="FORCE_LIGHT" style="line-height: 15px">\n                    <label style="margin: 5px auto; color: black">\n                        <input style="vertical-align: text-top;" type="checkbox"> \u70B9\u4EAE\u52CB\u7AE0\u65F6\u5FFD\u7565\u4EB2\u5BC6\u5EA6\u4E0A\u9650\n                    </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs">\n                        <legend style="color: black">\u5185\u5BB9\u5C4F\u853D</legend>\n                        <div data-toggle="REMOVE_ELEMENT_2233" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u96642233\u6A21\u578B\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_july" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: black">\n                                <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u590F\u65E5\u6D3B\u52A8\u5165\u53E3\n                            </label>\n                        </div>\n                        <div data-toggle="REMOVE_ELEMENT_player" style="line-height: 15px">\n                        <label style="margin: 5px auto; color: black">\n                            <input style="vertical-align: text-top;" type="checkbox"> \u79FB\u9664\u76F4\u64AD\u753B\u9762\n                        </label>\n                    </div>\n                    </fieldset>\n                    <fieldset class="igiftMsg_fs" style="line-height: 15px">\n                        <legend style="color: black">\u5176\u4ED6\u8BBE\u7F6E</legend>\n                        <div data-toggle="TIME_RELOAD" style="color: black">\n                            \u672C\u76F4\u64AD\u95F4\u5237\u65B0\u65F6\u95F4\uFF1A\n                            <input class="delay-seconds igiftMsg_input" type="text" style="width: 30px;">\u5206\n                        </div>\n                        <div data-toggle="IN_TIME_RELOAD_DISABLE" style="line-height: 15px">\n                            <label style="margin: 5px auto; color: darkgreen">\n                                <input style="vertical-align: text-top;" type="checkbox">\u4E0D\u62BD\u5956\u65F6\u6BB5\u4E0D\u91CD\u8F7D\u76F4\u64AD\u95F4\n                            </label>\n                        </div>\n                        <div data-toggle="FORCE_LOTTERY" style="line-height: 20px">\n                            <label style="margin: 5px auto; color: red;">\n                                <input style="vertical-align: text-top;" type="checkbox">\u8BBF\u95EE\u88AB\u62D2\u7EDD\u540E\u5F3A\u5236\u91CD\u590D\u62BD\u5956(\u6700\u591A5\u6B21)\n                            </label>\n                        </div>\n                        <div id="resetArea">\n                            <button data-action="reset" style="color: red;" class="igiftMsg_btn">\u91CD\u7F6E\u6240\u6709\u4E3A\u9ED8\u8BA4</button>\n                            <button data-action="redo_dailyTasks" style="color: red;" class="igiftMsg_btn">\u518D\u6B21\u6267\u884C\u6240\u6709\u4EFB\u52A1</button>\n                            <button style="font-size: small" class="igiftMsg_btn" data-action="countReset">\u91CD\u7F6E\u7EDF\u8BA1</button>\n                        </div>\n            \n                    </fieldset>\n                    <label style="color: darkblue; font-size:large;">\n                        v'+GM_info.script.version+' <a href="https://github.com/andywang425/Bilibili-SGTH/"\n                            target="_blank">\u66F4\u591A\u8BF4\u660E\u548C\u66F4\u65B0\u65E5\u5FD7\u89C1github\u4E0A\u7684\u9879\u76EE\u8BF4\u660E(\u70B9\u6211)</a>\n                    </label>\n                </div>\n            </div>\n    '),$('.live-player-mounter').append(Ie),Ie.find('div[data-toggle="MAX_TAB"] .num').val(parseInt(ge.CONFIG.MAX_TAB).toString()),Ie.find('div[data-toggle="GIFT_INTERVAL"] .num').val(parseInt(ge.CONFIG.GIFT_INTERVAL).toString()),Ie.find('div[data-toggle="LIGHT_MEDALS"] .num').val(ge.CONFIG.LIGHT_MEDALS.toString()),Ie.find('div[data-toggle="STORM_MAX_COUNT"] .num').val(parseInt(ge.CONFIG.STORM_MAX_COUNT).toString()),Ie.find('div[data-toggle="STORM_ONE_LIMIT"] .num').val(parseInt(ge.CONFIG.STORM_ONE_LIMIT).toString()),Ie.find('div[data-toggle="STORM_QUEUE_SIZE"] .num').val(parseInt(ge.CONFIG.STORM_QUEUE_SIZE).toString()),Ie.find('div[data-toggle="SPARE_GIFT_UID"] .num').val(ge.CONFIG.SPARE_GIFT_UID.toString()),Ie.find('div[data-toggle="SPARE_GIFT_ROOM"] .num').val(ge.CONFIG.SPARE_GIFT_ROOM.toString()),Ie.find('div[data-toggle="TIME_RELOAD"] .delay-seconds').val(parseInt(ge.CONFIG.TIME_RELOAD).toString()),Ie.find('div[data-toggle="RANDOM_SKIP"] .per').val(parseFloat(ge.CONFIG.RANDOM_SKIP).toString()),Ie.find('div[data-toggle="RANDOM_SEND_DANMU"] .per').val(parseFloat(ge.CONFIG.RANDOM_SEND_DANMU).toString()),Ie.find('div[data-toggle="MAX_GIFT"] .num').val(parseInt(ge.CONFIG.MAX_GIFT).toString()),Ie.find('div[data-toggle="COIN"] .coin_number').val(parseInt(ge.CONFIG.COIN_NUMBER).toString()),Ie.find('div[data-toggle="COIN_UID"] .num').val(parseInt(ge.CONFIG.COIN_UID).toString()),Ie.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_START').val(parseFloat(ge.CONFIG.RND_DELAY_START).toString()),Ie.find('div[data-toggle="RANDOM_DELAY"] .RND_DELAY_END').val(parseFloat(ge.CONFIG.RND_DELAY_END).toString()),Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .startHour').val(parseInt(ge.CONFIG.TIME_AREA_START_H0UR).toString()),Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .endHour').val(parseInt(ge.CONFIG.TIME_AREA_END_H0UR).toString()),Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .startMinute').val(parseInt(ge.CONFIG.TIME_AREA_START_MINUTE).toString()),Ie.find('div[data-toggle="TIME_AREA_DISABLE"] .endMinute').val(parseInt(ge.CONFIG.TIME_AREA_END_MINUTE).toString()),Ie.find('div[data-toggle="CHECK_HOUR_ROOM_INTERVAL"] .num').val(parseInt(ge.CONFIG.CHECK_HOUR_ROOM_INTERVAL).toString()),Ie.find('div[data-toggle="AUTO_GIFT_ROOMID"] .num').val(ge.CONFIG.AUTO_GIFT_ROOMID.toString()),Ie.find('div[data-toggle="EXCLUDE_ROOMID"] .num').val(ge.CONFIG.EXCLUDE_ROOMID.toString()),Ie.find('div[data-toggle="GIFT_SEND_TIME"] .Hour').val(ge.CONFIG.GIFT_SEND_HOUR.toString()),Ie.find('div[data-toggle="GIFT_SEND_TIME"] .Minute').val(ge.CONFIG.GIFT_SEND_MINUTE.toString()),Ie.find('div[data-toggle="GIFT_LIMIT"] .num').val(parseInt(ge.CONFIG.GIFT_LIMIT).toString());Ie.find('div[id="giftCount"] [data-action="save"]').click(function(){ue()}),Ie.find('button[data-action="reset"]').click(function(){ge.setDefaults()}),Ie.find('button[data-action="checkUpdate"]').click(function(){ge.checkUpdate()}),Ie.find('button[data-action="redo_dailyTasks"]').click(function(){ge.ReDoDailyTasks()}),Ie.find('#resetArea [data-action="countReset"]').click(function(){ge.GIFT_COUNT={COUNT:0,SILVER_COUNT:0,CLEAR_TS:0},ge.saveGiftCount(),$('#giftCount span:eq(0)').text(ge.GIFT_COUNT.COUNT),$('#giftCount span:eq(1)').text(ge.GIFT_COUNT.SILVER_COUNT),ge.chatLog('\u5DF2\u91CD\u7F6E\u7EDF\u8BA1\u6570\u636E')}),Ie.find('button[data-action="sendGiftNow"]').click(function(){w=!0,ge.Gift.run()});var Te=['RANDOM_DELAY','TIME_AREA_DISABLE','AUTO_GROUP_SIGN','FORCE_LOTTERY','LOGIN','WATCH','COIN','SHARE','SILVER2COIN','LIVE_SIGN','IN_TIME_RELOAD_DISABLE','AUTO_TREASUREBOX','IN_TIME_RELOAD_DISABLE','AUTO_GIFT','GIFT_SORT','SEND_ALL_GIFT','MOBILE_HEARTBEAT','STORM','LITTLE_HEART','REMOVE_ELEMENT_2233','REMOVE_ELEMENT_july','REMOVE_ELEMENT_player','FORCE_LIGHT'],fe=!0,Ee=!1,me=void 0;try{for(var xe,Oe=function _loop(){var Ge=xe.value,Ce=Ie.find('div[data-toggle="'+Ge+'"] input:checkbox');ge.CONFIG[Ge]&&Ce.attr('checked',''),Ce.change(function(){ge.CONFIG[Ge]=$(this).prop('checked'),ge.saveConfig()})},ve=Te[Symbol.iterator]();!(fe=(xe=ve.next()).done);fe=!0)Oe()}catch(Ge){Ee=!0,me=Ge}finally{try{!fe&&ve.return&&ve.return()}finally{if(Ee)throw me}}$('input:text').bind('keydown',function(Ge){'13'==Ge.keyCode&&ue()}),'COIN_DYN'==ge.CONFIG.COIN_TYPE?$('div[data-toggle=\'COIN_DYN\'] input:radio').attr('checked',''):$('div[data-toggle=\'COIN_UID\'] input:radio').attr('checked','');'LIGHT_WHITE'==ge.CONFIG.LIGHT_METHOD?$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').attr('checked',''):$('div[data-toggle=\'LIGHT_BLACK\'] input:radio').attr('checked','');'GIFT_INTERVAL'==ge.CONFIG.GIFT_METHOD?$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').attr('checked',''):$('div[data-toggle=\'GIFT_SEND_TIME\'] input:radio').attr('checked','');$('input:radio[name=\'COIN_TYPE\']').change(function(){var Ge=$('div[data-toggle=\'COIN_DYN\'] input:radio').is(':checked');ge.CONFIG.COIN_TYPE=!0==Ge?'COIN_DYN':'COIN_UID',ge.saveConfig()}),$('input:radio[name=\'LIGHT_TYPE\']').change(function(){var Ge=$('div[data-toggle=\'LIGHT_WHITE\'] input:radio').is(':checked');ge.CONFIG.LIGHT_METHOD=!0==Ge?'LIGHT_WHITE':'LIGHT_BLACK',ge.saveConfig()}),$('input:radio[name=\'GIFT_TYPE\']').change(function(){var Ge=$('div[data-toggle=\'GIFT_INTERVAL\'] input:radio').is(':checked');ge.CONFIG.GIFT_METHOD=!0==Ge?'GIFT_INTERVAL':'GIFT_SEND_TIME',ge.saveConfig()})},chatLog:function chatLog(ue){var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'info',Ie=$('<div class=\'igiftMsg\'>'),pe=$('<div>'),Te=$('#chat-history-list'),fe=new Date;pe.text(ue),Ie.text(fe.toLocaleString()),Ie.append(pe),Ie.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),pe.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'});'warning'===ce?Ie.css({border:'1px solid rgb(236, 221, 192)',color:'rgb(218, 142, 36)',background:'rgb(245, 235, 221) none repeat scroll 0% 0%'}):'success'===ce?Ie.css({border:'1px solid rgba(22, 140, 0, 0.28)',color:'rgb(69, 171, 69)',background:'none 0% 0% repeat scroll rgba(16, 255, 0, 0.18)'}):'error'===ce?Ie.css({border:'1px solid rgb(255, 46, 0)',color:'white',background:'none 0% 0% repeat scroll #ff4c4c'}):Ie.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'});!1==A?Te.find('#chat-items').append(Ie):Te.find('#chat-items').append(Ie.hide()),Te.scrollTop(Te.prop('scrollHeight'))},blocked:!1,max_blocked:!1,listen:function listen(ue,ce){var Ie=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'\u672C\u76F4\u64AD\u95F4';M.room.getConf(ue).then(function(pe){Q('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u4FE1\u606F '+Ie,pe);var Te=new M.DanmuWebSocket(ce,ue,pe.data.host_server_list,pe.data.token);Te.bind(function(fe){Te=fe,ge.chatLog(Ie+'\u5F39\u5E55\u670D\u52A1\u5668\u8FDE\u63A5\u65AD\u5F00\uFF0C\u5C1D\u8BD5\u91CD\u8FDE','warning')},function(){ge.chatLog('\u2014\u2014\u2014\u2014\u2014\u2014\u8FDE\u63A5\u5F39\u5E55\u670D\u52A1\u5668\u6210\u529F\u2014\u2014\u2014\u2014\u2014\u2014\n\u623F\u95F4\u53F7: '+ue+' \u5206\u533A: '+Ie,'success')},function(){(ge.blocked||ge.stormBlack)&&(Te.close(),ge.chatLog('\u8FDB\u4E86\u5C0F\u9ED1\u5C4B\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+Ie,'warning')),ge.max_blocked&&!ge.CONFIG.STORM&&(Te.close(),ge.chatLog('\u8FA3\u6761\u6700\u5927\u503C\u4E3B\u52A8\u4E0E\u5F39\u5E55\u670D\u52A1\u5668\u65AD\u5F00\u8FDE\u63A5-'+Ie,'warning'))},function(fe){if(!(E(ge.CONFIG.TIME_AREA_START_H0UR,ge.CONFIG.TIME_AREA_END_H0UR,ge.CONFIG.TIME_AREA_START_MINUTE,ge.CONFIG.TIME_AREA_END_MINUTE)&&ge.CONFIG.TIME_AREA_DISABLE))switch(Q('\u5F39\u5E55\u516C\u544A'+Ie,fe),fe.cmd){case'GUARD_MSG':fe.roomid===fe.real_roomid?ge.checkRoom(fe.roomid,Ie):(ge.checkRoom(fe.roomid,Ie),ge.checkRoom(fe.real_roomid,Ie));break;case'PK_BATTLE_SETTLE_USER':fe.data.winner?ge.checkRoom(fe.data.winner.room_id,Ie):ge.checkRoom(fe.data.my_info.room_id,Ie),ge.checkRoom(fe.data.winner.room_id,Ie);break;case'NOTICE_MSG':switch(fe.msg_type){case 1:break;case 2:case 3:case 4:case 8:fe.roomid===fe.real_roomid?ge.checkRoom(fe.roomid,Ie):(ge.checkRoom(fe.roomid,Ie),ge.checkRoom(fe.real_roomid,Ie));break;case 5:break;case 6:window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+fe.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),ge.Storm.run(fe.roomid);}break;case'SPECIAL_GIFT':if(fe.data[39])switch(fe.data[39].action){case'start':window.toast('\u76D1\u63A7\u5230\u623F\u95F4 '+fe.roomid+' \u7684\u8282\u594F\u98CE\u66B4','info'),ge.Storm.run(fe.roomid);case'end':};break;default:}})},function(){ge.chatLog('\u83B7\u53D6\u5F39\u5E55\u670D\u52A1\u5668\u5730\u5740\u9519\u8BEF','error')})},EntryRoom_list_history:{add:function add(ue){var ce=[];try{var Ie=JSON.parse(localStorage.getItem(D+'_EntryRoom_list'));ce=[].concat(Ie.list),ce.push(ue),100<ce.length&&ce.splice(0,50),localStorage.setItem(D+'_EntryRoom_list',JSON.stringify({list:ce})),Q(D+'_EntryRoom_list_add',ce)}catch(Ie){ce.push(ue),localStorage.setItem(D+'_EntryRoom_list',JSON.stringify({list:ce}))}},isIn:function isIn(ue){var ce=[];try{var Ie=JSON.parse(localStorage.getItem(D+'_EntryRoom_list'));return ce=null===Ie?[]:[].concat(Ie.list),Q(D+'_EntryRoom_list_read',Ie),-1<ce.indexOf(ue)}catch(Ie){return localStorage.setItem(D+'_EntryRoom_list',JSON.stringify({list:ce})),Q('\u8BFB\u53D6'+(D+'_EntryRoom_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ce.indexOf(ue)}}},RoomId_list:[],err_roomId:[],auto_danmu_list:['(=\u30FB\u03C9\u30FB=)','\uFF08\uFFE3\u25BD\uFFE3\uFF09','nice','666','kksk','(\u2312\u25BD\u2312)','(\uFF40\u30FB\u03C9\u30FB\xB4)','\u256E(\uFFE3\u25BD\uFFE3)\u256D','(\uFFE33\uFFE3)','\u03A3( \uFFE3\u25A1\uFFE3||)','(^\u30FB\u03C9\u30FB^ )','_(:3\u300D\u2220)_'],checkRoom:function checkRoom(ue){var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'\u672C\u76F4\u64AD\u95F4';ge.blocked||ge.max_blocked||0<=ge.RoomId_list.indexOf(ue)||(ge.RoomId_list.push(ue),ge.EntryRoom_list_history.isIn(ue)||(M.room.room_entry_action(ue),ge.EntryRoom_list_history.add(ue)),G(ge.CONFIG.RANDOM_SEND_DANMU)&&M.sendLiveDanmu(ge.auto_danmu_list[_Mathfloor(12*Math.random())],ue).then(function(Ie){Q('\u5F39\u5E55\u53D1\u9001\u8FD4\u56DE\u4FE1\u606F',Ie)}),M.xlive.lottery.check(ue).then(function(Ie){ge.RoomId_list.remove(ue),Q('\u68C0\u67E5\u623F\u95F4\u8FD4\u56DE\u4FE1\u606F',Ie);var pe=Ie.data;if(0===Ie.code){var Te;if(pe.gift)for(var fe in Te=pe.gift,Te)Te.hasOwnProperty(fe)&&ge.creat_join(ue,Te[fe],'gift',ce);if(pe.guard)for(var fe in Te=pe.guard,Te)Te.hasOwnProperty(fe)&&ge.creat_join(ue,Te[fe],'guard',ce);if(pe.pk)for(var fe in Te=pe.pk,Te)Te.hasOwnProperty(fe)&&ge.creat_join(ue,Te[fe],'pk',ce)}else ge.chatLog('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519]'+response.msg,'error'),-1<ge.err_roomId.indexOf(ue)?Q('[\u68C0\u67E5\u6B64\u623F\u95F4\u51FA\u9519\u591A\u6B21]'+ue+Ie.message):(ge.err_roomId.push(ue),ge.checkRoom(ue,ce),Q('[\u68C0\u67E5\u623F\u95F4\u51FA\u9519_\u91CD\u8BD5\u4E00\u6B21]'+ue+Ie.message))}))},Id_list_history:{add:function add(ue,ce){var Ie=[];try{var pe=JSON.parse(localStorage.getItem(D+'_'+ce+'Id_list'));Ie=[].concat(pe.list),Ie.push(ue),200<Ie.length&&Ie.splice(0,50),localStorage.setItem(D+'_'+ce+'Id_list',JSON.stringify({list:Ie})),Q(D+'_'+ce+'Id_list_add',Ie)}catch(pe){Ie.push(ue),localStorage.setItem(D+'_'+ce+'Id_list',JSON.stringify({list:Ie}))}},isIn:function isIn(ue,ce){var Ie=[];try{var pe=JSON.parse(localStorage.getItem(D+'_'+ce+'Id_list'));return Ie=null===pe?[]:[].concat(pe.list),Q(D+'_'+ce+'Id_list_read',pe),-1<Ie.indexOf(ue)}catch(pe){return localStorage.setItem(D+'_'+ce+'Id_list',JSON.stringify({list:Ie})),Q('\u8BFB\u53D6'+(D+'_'+ce+'Id_list\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<Ie.indexOf(ue)}}},raffleId_list:[],guardId_list:[],pkId_list:[],creat_join:function creat_join(ue,ce,Ie){var pe=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'\u672C\u76F4\u64AD\u95F4';if(Q('\u793C\u7269\u4FE1\u606F',ce),ge.GIFT_COUNT.COUNT>=ge.CONFIG.MAX_GIFT)return Q('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),void(ge.max_blocked=!0);switch(Ie){case'gift':if(ge.Id_list_history.isIn(ce.raffleId,'raffle'))return void Q('\u793C\u7269\u91CD\u590D','raffleId '+ce.raffleId);ge.raffleId_list.push(ce.raffleId),ge.Id_list_history.add(ce.raffleId,'raffle');break;case'guard':if(ge.Id_list_history.isIn(ce.id,'guard'))return void Q('\u8230\u957F\u91CD\u590D','id '+ce.id);ge.guardId_list.push(ce.id),ge.Id_list_history.add(ce.id,'guard');break;case'pk':if(ge.Id_list_history.isIn(ce.id,'pk'))return void Q('pk\u91CD\u590D','id '+ce.id);ge.pkId_list.push(ce.id),ge.Id_list_history.add(ce.id,'pk');}var Te=ce.time_wait||0;ge.CONFIG.RANDOM_DELAY&&(Te+=_Mathfloor(Math.random()*(ge.CONFIG.RND_DELAY_END-ge.CONFIG.RND_DELAY_START+1))+ge.CONFIG.RND_DELAY_START);var fe=$('<div class=\'igiftMsg\'>'),Ee=$('<div>'),me=$('<div>'),Oe=$('#chat-history-list'),ve=new Date;Ee.text('['+pe+']'+ce.thank_text.split('<%')[1].split('%>')[0]+ce.thank_text.split('%>')[1]),fe.text(ve.toLocaleString()),fe.append(Ee),me.css('color','red'),me.text('\u7B49\u5F85\u62BD\u5956'),Ee.append(me),fe.css({"text-align":'center',"border-radius":'4px',"min-height":'30px',width:'256px',color:'#9585FF',"line-height":'30px',padding:'0 10px',margin:'10px auto'}),Ee.css({"word-wrap":'break-word',width:'100%',"line-height":'1em',"margin-bottom":'10px'}),fe.css({border:'1px solid rgb(203, 195, 255)',background:'rgb(233, 230, 255) none repeat scroll 0% 0%'}),!1==A?Oe.find('#chat-items').append(fe):Oe.find('#chat-items').append(fe.hide()),Oe.scrollTop(Oe.prop('scrollHeight'));var xe=setInterval(function(){me.text('\u7B49\u5F85\u62BD\u5956\u5012\u8BA1\u65F6'+Te+'\u79D2'),0>=Te&&(G(ge.CONFIG.RANDOM_SKIP)?me.text('\u8DF3\u8FC7\u6B64\u793C\u7269\u62BD\u5956'):(me.text('\u8FDB\u884C\u62BD\u5956...'),'gift'===Ie?ge.gift_join(ue,ce.raffleId,ce.type).then(function(Ge,Ce){me.text(Ge),Ce&&(-1<Ge.indexOf('\u8FA3\u6761')?ge.addGift(Ce):-1<Ge.indexOf('\u94F6\u74DC\u5B50')&&ge.addSilver(Ce)),ge.raffleId_list.remove(ce.raffleId)}):'guard'===Ie?ge.guard_join(ue,ce.id).then(function(Ge,Ce){me.text(Ge),Ce&&(-1<Ge.indexOf('\u8FA3\u6761')?ge.addGift(Ce):-1<Ge.indexOf('\u94F6\u74DC\u5B50')&&ge.addSilver(Ce)),ge.guardId_list.remove(ce.id)}):'pk'===Ie?ge.pk_join(ue,ce.id).then(function(Ge,Ce){me.text(Ge),Ce&&(-1<Ge.indexOf('\u8FA3\u6761')?ge.addGift(Ce):-1<Ge.indexOf('\u94F6\u74DC\u5B50')&&ge.addSilver(Ce)),ge.pkId_list.remove(ce.id)}):void 0),me.css('color','green'),clearInterval(xe)),Te--},1e3)},gift_join:function gift_join(ue,ce,Ie){var pe=$.Deferred();return M.Lottery.Gift.join(ue,ce,Ie).then(function(Te){switch(Q('\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',Te),Te.code){case 0:Te.data.award_text?pe.resolve(Te.data.award_text,Te.data.award_num):pe.resolve(Te.data.award_name+'X'+Te.data.award_num.toString(),Te.data.award_num);break;default:-1<Te.msg.indexOf('\u62D2\u7EDD')?!1==ge.CONFIG.FORCE_LOTTERY?(ge.blocked=!0,pe.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++L?ge.gift_join(ue,ce,Ie):(L=0,pe.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ue+',id='+ce+',type='+Ie+')'+Te.msg)):pe.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ue+',id='+ce+',type='+Ie+')'+Te.msg);}}),pe},guard_join:function guard_join(ue,ce){var Ie=$.Deferred();return M.Lottery.Guard.join(ue,ce).then(function(pe){switch(Q('\u4E0A\u8239\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',pe),pe.code){case 0:pe.data.award_text?Ie.resolve(pe.data.award_text,pe.data.award_num):Ie.resolve(pe.data.award_name+'X'+pe.data.award_num.toString(),pe.data.award_num);break;default:-1<pe.msg.indexOf('\u62D2\u7EDD')?!1==ge.CONFIG.FORCE_LOTTERY?(ge.blocked=!0,Ie.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++S?ge.guard_join(ue,id):(S=0,Ie.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ue+',id='+raffleId+',type='+type+')'+pe.msg)):Ie.resolve('[\u4E0A\u8239](roomid='+ue+',id='+ce+')'+pe.msg);}}),Ie},pk_join:function pk_join(ue,ce){var Ie=$.Deferred();return M.Lottery.Pk.join(ue,ce).then(function(pe){switch(Q('PK\u62BD\u5956\u8FD4\u56DE\u4FE1\u606F',pe),pe.code){case 0:pe.data.award_text?Ie.resolve(pe.data.award_text,pe.data.award_num):Ie.resolve(pe.data.award_name+'X'+pe.data.award_num.toString(),pe.data.award_num);break;default:-1<pe.msg.indexOf('\u62D2\u7EDD')?!1==ge.CONFIG.FORCE_LOTTERY?(ge.blocked=!0,Ie.resolve('\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62')):5>=++F?ge.pk_join(ue,id):(F=0,Ie.resolve('[\u793C\u7269\u62BD\u5956](roomid='+ue+',id='+raffleId+',type='+type+')'+pe.msg)):Ie.resolve('[PK](roomid='+ue+',id='+ce+')'+pe.msg);}}),Ie},GroupSign:{getGroups:function getGroups(){return M.Group.my_groups().then(function(ue){return(Q('GroupSign.getGroups: API.Group.my_groups',ue),0===ue.code)?$.Deferred().resolve(ue.data.list):(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+ue.msg,'caution'),$.Deferred().reject())},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u83B7\u53D6\u5E94\u63F4\u56E2\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.GroupSign.getGroups()})})},signInList:function signInList(ue){var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;if(ce>=ue.length)return $.Deferred().resolve();var Ie=ue[ce];return Ie.owner_uid==X.uid?GroupSign.signInList(ue,ce+1):M.Group.sign_in(Ie.group_id,Ie.owner_uid).then(function(pe){Q('GroupSign.signInList: API.Group.sign_in',pe);var Te=$.Deferred();if(0===pe.code)0<pe.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+Ie.group_id+',owner_uid='+Ie.owner_uid+')\u7B7E\u5230\u6210\u529F\uFF0C\u5F53\u524D\u52CB\u7AE0\u4EB2\u5BC6\u5EA6+'+pe.data.add_num,'success'),Te.resolve()):0==pe.data.add_num?(window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+Ie.group_id+',owner_uid='+Ie.owner_uid+')\u5DF2\u7B7E\u5230','caution'),Te.resolve()):Te.reject();else return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\''+pe.msg,'caution'),$.Deferred().reject();return $.when(ge.GroupSign.signInList(ue,ce+1),Te)},function(){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u5E94\u63F4\u56E2(group_id='+Ie.group_id+',owner_uid='+Ie.owner_uid+')\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.GroupSign.signInList(ue,ce)})})},run:function run(){try{return ge.CONFIG.AUTO_GROUP_SIGN?se(ge.CACHE.AUTO_GROUP_SIGH_TS)?8>new Date().getHours()&&0!=ge.CACHE.AUTO_GROUP_SIGH_TS?(setTimeout(ge.GroupSign.run,u(8,0)),$.Deferred().resolve()):ge.GroupSign.getGroups().then(function(ue){return ge.GroupSign.signInList(ue).then(function(){return ge.CACHE.AUTO_GROUP_SIGH_TS=P(),ge.saveCache(),J(ge.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()},function(){return K(function(){return ge.GroupSign.run()})})},function(){return K(function(){return ge.GroupSign.run()})}):(J(ge.GroupSign.run,8,0,'\u5E94\u63F4\u56E2\u7B7E\u5230'),$.Deferred().resolve()):$.Deferred().resolve()}catch(ue){return window.toast('[\u81EA\u52A8\u5E94\u63F4\u56E2\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+D+']',ue),$.Deferred().reject()}}},DailyReward:{coin_exp:0,login:function login(){return M.DailyReward.login().then(function(){Q('DailyReward.login: API.DailyReward.login'),window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210','success')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u767B\u5F55]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.DailyReward.login()})})},watch:function watch(ue,ce){return ge.CONFIG.WATCH?M.DailyReward.watch(ue,ce,X.uid,Y()).then(function(Ie){Q('DailyReward.watch: API.DailyReward.watch',Ie),0===Ie.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210(av='+ue+')','success'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\''+Ie.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u89C2\u770B]\u5B8C\u6210\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.DailyReward.watch(ue,ce)})}):$.Deferred().resolve()},coin:function coin(ue,ce){var Ie=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,pe=3<arguments.length&&arguments[3]!==void 0&&arguments[3];if(!ge.CONFIG.COIN)return $.Deferred().resolve();if(ge.DailyReward.coin_exp>=10*ge.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();if(Ie>=ue.length)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u52A8\u6001\u91CC\u53EF\u6295\u5E01\u7684\u89C6\u9891\u4E0D\u8DB3','caution'),$.Deferred().resolve();var Te=JSON.parse(ue[Ie].card),fe=_Mathmin(2,ce);pe&&(fe=1),M.x.getCoinInfo('','jsonp',Te.aid,P()).then(function(Ee){return 2===Ee.data.multiply?(Q('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+Te.aid),ge.DailyReward.coin(vlist,ce,Ie+1)):M.DailyReward.coin(Te.aid,fe).then(function(me){return(Q('DailyReward.coin: API.DailyReward.coin',me),0===me.code)?(ge.DailyReward.coin_exp+=10*fe,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+Te.aid+',num='+fe+')','success'),ge.DailyReward.coin(ue,ce-fe,Ie+1)):-110===me.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===me.code?pe?ge.DailyReward.coin(ue,ce,Ie+1):ge.DailyReward.coin(ue,ce,Ie,!0):34005===me.code?ge.DailyReward.coin(ue,ce,Ie+1):-104===me.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+me.msg,'caution'),ge.DailyReward.coin(ue,ce,Ie+1))},function(){return K(function(){return ge.DailyReward.coin(ue,ce,Ie)})})})},coin_uid:function coin_uid(ue,ce,Ie,pe){var Te=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,fe=5<arguments.length&&arguments[5]!==void 0&&arguments[5];if(!ge.CONFIG.COIN)return $.Deferred().resolve();if(ge.DailyReward.coin_exp>=10*ge.CONFIG.COIN_NUMBER)return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u4ECA\u65E5\u6295\u5E01\u5DF2\u5B8C\u6210','info'),$.Deferred().resolve();Te>=ue.length&&ge.DailyReward.UserSpace(ge.CONFIG.COIN_UID,30,0,Ie++,'','pubdate','jsonp');var Ee=ue[Te];if(1===Ee.is_union_video||Ee.mid!=pe)return Q('DailyReward.coin_uid','\u8054\u5408\u6295\u7A3F\u4E14UP\u4E0D\u662F\u6307\u5B9AUID\u7528\u6237 aid = '+Ee.aid),ge.DailyReward.coin_uid(ue,ce,Ie,pe,Te+1);var me=_Mathmin(2,ce);fe&&(me=1),M.x.getCoinInfo('','jsonp',Ee.aid,P()).then(function(Oe){return 2===Oe.data.multiply?(Q('API.x.getCoinInfo','\u5DF2\u6295\u5E01\u4E24\u4E2A aid = '+Ee.aid),ge.DailyReward.coin_uid(ue,ce,Ie,pe,Te+1)):M.DailyReward.coin(Ee.aid,me).then(function(ve){return(Q('DailyReward.coin_uid: API.DailyReward.coin_uid',ve),0===ve.code)?(ge.DailyReward.coin_exp+=10*me,window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u6295\u5E01\u6210\u529F(av='+Ee.aid+',num='+me+')','success'),ge.DailyReward.coin_uid(ue,ce-me,Ie,pe,Te+1)):-110===ve.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):34003===ve.code?fe?ge.DailyReward.coin_uid(ue,ce,Ie,pe,Te+1):ge.DailyReward.coin_uid(ue,ce,Te,Ie,pe,!0):34005===ve.code?ge.DailyReward.coin_uid(ue,ce,Ie,pe,Te+1):-104===ve.code?(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u5DF2\u505C\u6B62','warning'),$.Deferred().reject()):(window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\''+ve.msg,'caution'),ge.DailyReward.coin_uid(ue,ce,Ie,pe,Te+1))},function(){return K(function(){return ge.DailyReward.coin_uid(ue,ce,Ie,pe,Te)})})})},share:function share(ue){return ge.CONFIG.SHARE?M.DailyReward.share(ue).then(function(ce){Q('DailyReward.share: API.DailyReward.share',ce),0===ce.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u6210\u529F(av='+ue+')','success'):71000===ce.code?window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u4ECA\u65E5\u5206\u4EAB\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\''+ce.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u5206\u4EAB]\u5206\u4EAB\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.DailyReward.share(ue)})}):$.Deferred().resolve()},dynamic:function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(){var Ie,pe;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return Ie=void 0,pe=ge.CONFIG.COIN_NUMBER-ge.DailyReward.coin_exp/10,fe.next=4,M.getuserinfo().then(function(Ee){return Q('DailyReward.dynamic: API.getuserinfo',Ee),Ee.data.biliCoin<pe?Ee.data.biliCoin:pe});case 4:if(Ie=fe.sent,0!==Ie){fe.next=9;break}return fe.abrupt('return',$.Deferred().resolve());case 9:Ie<pe&&window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1][\u6BCF\u65E5\u6295\u5E01]\u5269\u4F59\u786C\u5E01\u4E0D\u8DB3\uFF0C\u4EC5\u80FD\u6295'+Ie+'\u4E2A\u5E01','warning');case 10:;return fe.abrupt('return',M.dynamic_svr.dynamic_new(X.uid,8).then(function(Ee){if(Q('DailyReward.dynamic: API.dynamic_svr.dynamic_new',Ee),0===Ee.code){if(!!Ee.data.cards){var ve,me=JSON.parse(Ee.data.cards[0].card),Oe=ge.DailyReward.watch(me.aid,me.cid);ve=0==ge.CONFIG.COIN_UID||'COIN_DYN'==ge.CONFIG.COIN_TYPE?ge.DailyReward.coin(Ee.data.cards,_Mathmax(Ie,0)):ge.DailyReward.UserSpace(ge.CONFIG.COIN_UID,30,0,1,'','pubdate','jsonp');var xe=ge.DailyReward.share(me.aid);return $.when(Oe,ve,xe)}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u52A8\u6001','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\''+Ee.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u52A8\u6001-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.DailyReward.dynamic()})}));case 12:case'end':return fe.stop();}},ce,le)}));return function dynamic(){return ue.apply(this,arguments)}}(),UserSpace:function UserSpace(ue,ce,Ie,pe,Te,fe,Ee){return M.x.getUserSpace(ue,ce,Ie,pe,Te,fe,Ee).then(function(me){if(Q('DailyReward.UserSpace: API.dynamic_svr.UserSpace',me),0===me.code){if(!!me.data.list.vlist){var Oe=ge.CONFIG.COIN_NUMBER-ge.DailyReward.coin_exp/10,ve=ge.DailyReward.coin_uid(me.data.list.vlist,_Mathmax(Oe,0),pe,ue);return ve}window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u4E2D\u6682\u65E0\u89C6\u9891','info')}else window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\''+me.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6"\u7A7A\u95F4-\u6295\u7A3F\u89C6\u9891"\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.DailyReward.UserSpace(ue,ce,Ie,pe,Te,fe,Ee)})})},run:function run(){try{return se(ge.CACHE.DailyReward_TS)?M.DailyReward.exp().then(function(ue){return Q('DailyReward.run: API.DailyReward.exp',ue),0===ue.code?(ge.DailyReward.coin_exp=ue.number,ge.DailyReward.login(),ge.DailyReward.dynamic().then(function(){ge.CACHE.DailyReward_TS=P(),ge.saveCache(),z(ge.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1')})):void window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]'+ue.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u83B7\u53D6\u6BCF\u65E5\u5956\u52B1\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.DailyReward.run()})}):(z(ge.DailyReward.run,'\u6BCF\u65E5\u4EFB\u52A1'),$.Deferred().resolve())}catch(ue){return window.toast('[\u81EA\u52A8\u6BCF\u65E5\u5956\u52B1]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+D+']',ue),$.Deferred().reject()}}},LiveReward:{dailySignIn:function dailySignIn(){return M.xlive.dosign().then(function(ue){Q('LiveReward.dailySignIn: API.xlive.dosign',ue),0===ue.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u5B8C\u6210','success'):1011040===ue.code?window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u4ECA\u65E5\u76F4\u64AD\u7B7E\u5230\u5DF2\u5B8C\u6210','info'):window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]'+ue.message,'caution')},function(){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u76F4\u64AD\u7B7E\u5230\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.LiveReward.dailySignIn()})})},run:function run(){try{if(!ge.CONFIG.LIVE_SIGN)return $.Deferred().resolve();if(!se(ge.CACHE.LiveReward_TS))return z(ge.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230'),$.Deferred().resolve();ge.LiveReward.dailySignIn(),ge.CACHE.LiveReward_TS=P(),ge.saveCache(),z(ge.LiveReward.run,'\u76F4\u64AD\u7B7E\u5230')}catch(ue){return window.toast('[\u81EA\u52A8\u76F4\u64AD\u7B7E\u5230]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+D+']',ue),$.Deferred().reject()}}},Exchange:{silver2coin:function silver2coin(){return M.Exchange.silver2coin().then(function(ue){Q('Exchange.silver2coin: API.SilverCoinExchange.silver2coin',ue),0===ue.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+ue.msg,'success'):403===ue.code?window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+ue.msg,'info'):window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]'+ue.msg,'caution')},function(){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u5151\u6362\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.Exchange.silver2coin()})})},runS2C:function runS2C(){try{return ge.CONFIG.SILVER2COIN?se(ge.CACHE.Silver2Coin_TS)?ge.Exchange.silver2coin().then(function(){ge.CACHE.Silver2Coin_TS=P(),ge.saveCache(),z(ge.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01')},function(){return K(function(){return ge.Exchange.runS2C()})}):(z(ge.Exchange.runS2C,'\u74DC\u5B50\u6362\u786C\u5E01'),$.Deferred().resolve()):$.Deferred().resolve()}catch(ue){return window.toast('[\u94F6\u74DC\u5B50\u6362\u786C\u5E01]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+D+']',ue),$.Deferred().reject()}}},TreasureBox:{timer:void 0,time_end:void 0,time_start:void 0,promise:{calc:void 0,timer:void 0},DOM:{image:void 0,canvas:void 0,div_tip:void 0,div_timer:void 0},init:function init(){if(!ge.CONFIG.AUTO_TREASUREBOX)return $.Deferred().resolve();var ue=$.Deferred();return V(function(){try{if($('.draw-box.gift-left-part').length)return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5F53\u524D\u76F4\u64AD\u95F4\u6709\u5B9E\u7269\u62BD\u5956\uFF0C\u6682\u505C\u9886\u74DC\u5B50\u529F\u80FD','caution'),ue.resolve(),!0;var ce=$('#gift-control-vm div.treasure-box.p-relative');if(!ce.length)return!1;ce=ce.first(),ce.attr('id','old_treasure_box'),ce.hide();var Ie=$('<div id="'+D+'_treasure_div" class="treasure-box p-relative" style="min-width: 46px;display: inline-block;float: left;padding: 22px 0 0 15px;"></div>');ge.TreasureBox.DOM.div_tip=$('<div id="'+D+'_treasure_div_tip" class="t-center b-box none-select">\u81EA\u52A8<br>\u9886\u53D6\u4E2D</div>'),ge.TreasureBox.DOM.div_timer=$('<div id="'+D+'_treasure_div_timer" class="t-center b-box none-select">0</div>'),ge.TreasureBox.DOM.image=$('<img id="'+D+'_treasure_image" style="display:none">'),ge.TreasureBox.DOM.canvas=$('<canvas id="'+D+'_treasure_canvas" style="display:none" height="40" width="120"></canvas>');var pe='min-width: 40px;padding: 2px 3px;margin-top: 3px;font-size: 12px;color: #fff;background-color: rgba(0,0,255,.5);border-radius: 10px;';ge.TreasureBox.DOM.div_tip[0].style=pe,ge.TreasureBox.DOM.div_timer[0].style=pe,Ie.append(ge.TreasureBox.DOM.div_tip),Ie.append(ge.TreasureBox.DOM.image),Ie.append(ge.TreasureBox.DOM.canvas),ge.TreasureBox.DOM.div_tip.after(ge.TreasureBox.DOM.div_timer),ce.after(Ie);try{if(OCRAD);}catch(Te){return ge.TreasureBox.setMsg('\u521D\u59CB\u5316<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]OCRAD\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('['+D+']',Te),ue.resolve(),!0}return ge.TreasureBox.timer=setInterval(function(){var Te=parseInt(ge.TreasureBox.DOM.div_timer.text(),10);isNaN(Te)&&(Te=0),0<Te?ge.TreasureBox.DOM.div_timer.text(Te-1+'s'):ge.TreasureBox.DOM.div_timer.hide()},1e3),ge.TreasureBox.DOM.image[0].onload=function(){var Te=ge.TreasureBox.DOM.canvas[0].getContext('2d');Te.font='40px agencyfbbold',Te.textBaseline='top',Te.clearRect(0,0,ge.TreasureBox.DOM.canvas[0].width,ge.TreasureBox.DOM.canvas[0].height),Te.drawImage(ge.TreasureBox.DOM.image[0],0,0);var fe=ge.TreasureBox.captcha.OCR.getGrayscaleMap(Te),Ee=ge.TreasureBox.captcha.OCR.orderFilter2In3x3(fe);Te.clearRect(0,0,120,40);for(var Oe,me=0;me<Ee.length;++me)Oe=Ee[me],Te.fillStyle='rgb('+Oe+', '+Oe+', '+Oe+')',Te.fillRect(me%120,_Mathround(me/120),1,1);try{var me=ge.TreasureBox.captcha.correctQuestion(OCRAD(Te.getImageData(0,0,120,40)));Q('TreasureBox.DOM.image.load','question =',me);var Oe=ge.TreasureBox.captcha.eval(me);Q('TreasureBox.DOM.image.load','answer =',Oe),void 0!==Oe&&(console.info('['+D+'][\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u7ED3\u679C: '+me+' = '+Oe),ge.TreasureBox.promise.calc.resolve(Oe))}catch(me){ge.TreasureBox.promise.calc.reject()}},ue.resolve(),!0}catch(ce){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u521D\u59CB\u5316\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+D+']',ce),ue.reject(),!0}}),ue},run:function run(){try{if(!ge.CONFIG.AUTO_TREASUREBOX||!ge.TreasureBox.timer)return;if(X.blocked)return ge.TreasureBox.setMsg('\u5C0F\u9ED1\u5C4B'),void window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u5E10\u53F7\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u505C\u6B62\u9886\u53D6\u74DC\u5B50','caution');if(!se(ge.CACHE.TreasureBox_TS))return ge.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),void z(ge.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');ge.TreasureBox.getCurrentTask().then(function(ue){if(Q('TreasureBox.run: TreasureBox.getCurrentTask().then',ue),0===ue.code){ge.TreasureBox.promise.timer=$.Deferred(),ge.TreasureBox.promise.timer.then(function(){ge.TreasureBox.captcha.calc().then(function(Ie){ge.TreasureBox.getAward(Ie).then(function(){return ge.TreasureBox.run()},function(){return ge.TreasureBox.run()})},function(){return TreasureBox.run()})}),ge.TreasureBox.time_end=ue.data.time_end,ge.TreasureBox.time_start=ue.data.time_start;var ce=ge.TreasureBox.time_end-Y()+1;0>ce&&(ce=0),setTimeout(function(){ge.TreasureBox.promise.timer&&ge.TreasureBox.promise.timer.resolve()},1e3*ce),ge.TreasureBox.DOM.div_timer.text(ce+'s'),ge.TreasureBox.DOM.div_timer.show(),ge.TreasureBox.DOM.div_tip.html('\u8F6E\u6570<br>'+ue.data.times+'/'+ue.data.max_times+'<br>\u94F6\u74DC\u5B50<br>'+ue.data.silver)}else if(-10017===ue.code)ge.TreasureBox.setMsg('\u4ECA\u65E5<br>\u5DF2\u9886\u5B8C'),ge.CACHE.TreasureBox_TS=P(),ge.saveCache(),z(ge.TreasureBox.run,'\u9886\u94F6\u74DC\u5B50\u5B9D\u7BB1');else if(-500===ue.code)location.reload();else return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ue.msg,'caution'),ge.TreasureBox.run()})}catch(ue){ge.TreasureBox.setMsg('\u8FD0\u884C<br>\u5F02\u5E38'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+D+']',ue)}},setMsg:function setMsg(ue){ge.CONFIG.AUTO_TREASUREBOX&&(ge.TreasureBox.promise.timer&&(ge.TreasureBox.promise.timer.reject(),ge.TreasureBox.promise.timer=void 0),ge.TreasureBox.DOM.div_timer&&ge.TreasureBox.DOM.div_timer.hide(),ge.TreasureBox.DOM.div_tip&&ge.TreasureBox.DOM.div_tip.html(ue))},getAward:function getAward(ue){var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return ge.CONFIG.AUTO_TREASUREBOX?3<ce?$.Deferred().resolve():M.TreasureBox.getAward(ge.TreasureBox.time_start,ge.TreasureBox.time_end,ue).then(function(){var Ie=_asyncToGenerator(regeneratorRuntime.mark(function pe(Te){var fe;return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:Q('TreasureBox.getAward: getAward',Te),me.t0=Te.code,me.next=0===me.t0?4:-903===me.t0?5:-902===me.t0?6:-901===me.t0?6:-10017===me.t0?6:-800===me.t0?9:-500===me.t0?12:400===me.t0?15:22;break;case 4:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9886\u53D6\u4E86 '+Te.data.awardSilver+' \u94F6\u74DC\u5B50','success');case 5:return me.abrupt('return',$.Deferred().resolve());case 6:return me.next=8,O(150);case 8:return me.abrupt('return',ge.TreasureBox.captcha.calc().then(function(Oe){return ge.TreasureBox.getAward(Oe,ce)}));case 9:return ge.TreasureBox.setMsg('\u672A\u7ED1\u5B9A<br>\u624B\u673A'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','caution'),me.abrupt('return',$.Deferred().reject());case 12:return fe=$.Deferred(),setTimeout(function(){ge.TreasureBox.captcha.calc().then(function(Oe){ge.TreasureBox.getAward(Oe,ce+1).then(function(){return fe.resolve()},function(){return fe.reject()})},function(){return fe.reject()})},3e3),me.abrupt('return',fe);case 15:if(!(-1<Te.msg.indexOf('\u62D2\u7EDD'))){me.next=20;break}return X.blocked=!0,ge.TreasureBox.setMsg('\u62D2\u7EDD<br>\u8BBF\u95EE'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u8BBF\u95EE\u88AB\u62D2\u7EDD\uFF0C\u60A8\u7684\u5E10\u53F7\u53EF\u80FD\u5DF2\u7ECF\u88AB\u5173\u5C0F\u9ED1\u5C4B\uFF0C\u5DF2\u505C\u6B62','error'),me.abrupt('return',$.Deferred().reject());case 20:return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Te.msg,'caution'),me.abrupt('return',$.Deferred().resolve());case 22:window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+Te.msg,'caution');case 23:case'end':return me.stop();}},pe,le)}));return function(){return Ie.apply(this,arguments)}}(),function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.TreasureBox.getAward(ue,ce)})}):$.Deferred().reject()},getCurrentTask:function getCurrentTask(){return ge.CONFIG.AUTO_TREASUREBOX?M.TreasureBox.getCurrentTask().then(function(ue){return Q('TreasureBox.getCurrentTask: API.TreasureBox.getCurrentTask',ue),$.Deferred().resolve(ue)},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u83B7\u53D6\u5F53\u524D\u4EFB\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.TreasureBox.getCurrentTask()})}):$.Deferred().reject()},captcha:{cnt:0,calc:function calc(){return ge.CONFIG.AUTO_TREASUREBOX?20<ge.TreasureBox.captcha.cnt?(ge.TreasureBox.setMsg('\u9A8C\u8BC1\u7801<br>\u8BC6\u522B<br>\u5931\u8D25'),window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u9A8C\u8BC1\u7801\u8BC6\u522B\u5931\u8D25\uFF0C\u5DF2\u505C\u6B62','error'),$.Deferred().reject()):M.TreasureBox.getCaptcha(P()).then(function(ue){if(Q('TreasureBox.captcha.calc: getCaptcha',ue),0===ue.code){ge.TreasureBox.captcha.cnt++;var ce=$.Deferred();return ge.TreasureBox.promise.calc=$.Deferred(),ge.TreasureBox.promise.calc.then(function(Ie){ge.TreasureBox.captcha.cnt=0,ce.resolve(Ie)},function(){ge.TreasureBox.captcha.calc().then(function(Ie){ce.resolve(Ie)},function(){ce.reject()})}),ge.TreasureBox.DOM.image.attr('src',ue.data.img),ce}return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]'+ue.msg,'caution'),K(function(){return ge.TreasureBox.captcha.calc()})},function(){return window.toast('[\u81EA\u52A8\u9886\u53D6\u74DC\u5B50]\u52A0\u8F7D\u9A8C\u8BC1\u7801\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.TreasureBox.captcha.calc()})}):(ge.TreasureBox.captcha.cnt=0,$.Deferred().reject())},OCR:{getGrayscaleMap:function getGrayscaleMap(ue){for(var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:235,Ie=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,pe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:40,Te=ue.getImageData(0,0,Ie,pe).data,fe=[],Ee=0;Ee<pe;Ee++)for(var me=0;me<Ie;me++){var Oe=4*(Ee*Ie+me),ve=Te.slice(Oe,Oe+4),xe=ve?77*ve[0]+150*ve[1]+29*ve[2]+128>>8:0;fe.push(xe>ce?xe:0)}return fe},orderFilter2In3x3:function orderFilter2In3x3(ue){for(var ce=1<arguments.length&&arguments[1]!==void 0?arguments[1]:9,Ie=2<arguments.length&&arguments[2]!==void 0?arguments[2]:120,pe=function gray(xe,Ge){return 0<=xe+Ge*Ie?ue[xe+Ge*Ie]:255},Te=[],fe=ue.length,xe=0;xe<fe;++xe){var me=[xe%Ie,_Mathfloor(xe/Ie)],Oe=me[0],ve=me[1],Ge=Array(9);Ge[0]=pe(Oe-1,ve-1),Ge[1]=pe(Oe+0,ve-1),Ge[2]=pe(Oe+1,ve-1),Ge[3]=pe(Oe-1,ve+0),Ge[4]=pe(Oe+0,ve+0),Ge[5]=pe(Oe+1,ve+0),Ge[6]=pe(Oe-1,ve+1),Ge[7]=pe(Oe+0,ve+1),Ge[8]=pe(Oe+1,ve+1),Ge.sort(function(Ce,Re){return Ce-Re}),Te.push(Ge[ce-1])}return Te}},eval:function _eval(ue){var ce=Function;return new ce('return '+ue)()},correctStr:{i:1,I:1,"|":1,l:1,o:0,O:0,D:0,S:6,s:6,b:6,R:8,B:8,z:2,Z:2,".":'-',_:4,g:9,">":3},correctQuestion:function correctQuestion(ue){var ce='';for(var Ie in ue=ue.trim(),ue){var pe=ge.TreasureBox.captcha.correctStr[ue[Ie]];ce+=void 0===pe?ue[Ie]:pe}'4'===ce[2]&&(ce[2]='+');for(var Ie=0;Ie<=parseInt(ce.length-2);Ie++)'\''===ce[Ie]&&'1'===ce[Ie+1]&&(ce[Ie]='7',ce.splice(Ie+1,1));return ce}}},Gift:(_e={run_timer:void 0,ruid:void 0,room_id:void 0,medal_list:void 0,bag_list:void 0,time:void 0,remain_feed:void 0,over:!1},_defineProperty(_e,'run_timer',void 0),_defineProperty(_e,'sendGiftList',[1,6,30607]),_defineProperty(_e,'getMedalList',function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(){var Ie=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return 1===Ie&&(ge.Gift.medal_list=[]),Te.next=3,M.i.medal(Ie,25).then(function(fe){if(Q('Gift.getMedalList: API.i.medal',fe),ge.Gift.medal_list=ge.Gift.medal_list.concat(fe.data.fansMedalList),fe.data.pageinfo.curPage<fe.data.pageinfo.totalpages)return ge.Gift.getMedalList(Ie+1)},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.Gift.getMedalList()})});case 3:return Te.abrupt('return',Te.sent);case 4:case'end':return Te.stop();}},ce,le)}));return function getMedalList(){return ue.apply(this,arguments)}}()),_defineProperty(_e,'getBagList',function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(){return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,M.gift.bag_list().then(function(Te){Q('Gift.getBagList: API.gift.bag_list',Te),ge.Gift.bag_list=Te.data.list,ge.Gift.time=Te.data.time},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u83B7\u53D6\u5305\u88F9\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.Gift.getBagList()})});case 2:return pe.abrupt('return',pe.sent);case 3:case'end':return pe.stop();}},ce,le)}));return function getBagList(){return ue.apply(this,arguments)}}()),_defineProperty(_e,'getFeedByGiftID',function getFeedByGiftID(ue){for(var ce=X.gift_list.length-1;0<=ce;--ce)if(X.gift_list[ce].id===ue)return Math.ceil(X.gift_list[ce].price/100);return 0}),_defineProperty(_e,'sort_medals',function sort_medals(ue){if(ge.CONFIG.GIFT_SORT?ue.sort(function(me,Oe){return 0==Oe.level-me.level?Oe.intimacy-me.intimacy:Oe.level-me.level}):ue.sort(function(me,Oe){return 0==me.level-Oe.level?me.intimacy-Oe.intimacy:me.level-Oe.level}),ge.CONFIG.AUTO_GIFT_ROOMID&&0<ge.CONFIG.AUTO_GIFT_ROOMID.length){var me=ge.CONFIG.AUTO_GIFT_ROOMID.split(',');me.reverse();var ce=!0,Ie=!1,pe=void 0;try{for(var Ee,Te=function _loop2(){var Oe=Ee.value,ve=ue.findIndex(function(xe){return xe.roomid==Oe});if(-1!=ve){var xe=ue[ve];ue.splice(ve,1),ue.unshift(xe)}},fe=me[Symbol.iterator]();!(ce=(Ee=fe.next()).done);ce=!0)Te()}catch(Oe){Ie=!0,pe=Oe}finally{try{!ce&&fe.return&&fe.return()}finally{if(Ie)throw pe}}}return ue}),_defineProperty(_e,'auto_light',function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(Ie){var pe,Te,fe,Ee,me,Oe,ve,xe,Ge,Ce,Re,he,Ae,Ne,ye,De;return regeneratorRuntime.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:be.prev=0,pe=ge.Gift.getFeedByGiftID(30607),Te=ge.CONFIG.LIGHT_MEDALS.split(','),fe=void 0,fe='LIGHT_WHITE'==ge.CONFIG.LIGHT_METHOD?Ie.filter(function(Le){return 0==Le.is_lighted&&Le.day_limit-Le.today_feed>=pe&&0<=Te.findIndex(function(Se){return Se==Le.roomid})}):Ie.filter(function(Le){return 0==Le.is_lighted&&Le.day_limit-Le.today_feed>=pe&&-1==Te.findIndex(function(Se){return Se==Le.roomid})});;if(Q('[auto_light]\u5373\u5C06\u70B9\u4EAE\u52CB\u7AE0\u623F\u95F4\u5217\u8868',fe),!(fe&&0<fe.length)){be.next=52;break}return fe=ge.Gift.sort_medals(fe),be.next=11,ge.Gift.getBagList();case 11:if(Ee=ge.Gift.bag_list.filter(function(Le){return 30607==Le.gift_id}),!(Ee&&0<Ee.length)){be.next=52;break}me=!0,Oe=!1,ve=void 0,be.prev=16,xe=fe[Symbol.iterator]();case 18:if(me=(Ge=xe.next()).done){be.next=38;break}if(Ce=Ge.value,Re=Ee.find(function(Le){return 30607==Le.gift_id&&0<Le.gift_num}),!Re){be.next=34;break}if(he=Ce.day_limit-Ce.today_feed,!(0<=he-pe||ge.CONFIG.FORCE_LIGHT)){be.next=33;break}return be.next=26,M.room.room_init(parseInt(Ce.roomid,10));case 26:return Ae=be.sent,Ne=parseInt(Ae.data.room_id,10),ye=1,be.next=31,M.gift.bag_send(X.uid,30607,Ce.target_id,ye,Re.bag_id,Ne,X.rnd);case 31:De=be.sent,0===De.code?(Re.gift_num-=ye,Ce.today_feed+=ye*pe,he-=ye*pe,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ce.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+ye+'\u4E2A'+Re.gift_name+'\uFF0C['+Ce.today_feed+'/'+Ce.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+he+']','success'),Q('Gift.auto_light','\u52CB\u7AE0['+Ce.medalName+']\u70B9\u4EAE\u6210\u529F\uFF0C\u9001\u51FA'+ye+'\u4E2A'+Re.gift_name+'\uFF0C['+Ce.today_feed+'/'+Ce.day_limit+']')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ce.medalName+']\u70B9\u4EAE\u5931\u8D25\u3010'+Ae.msg+'\u3011','caution');case 33:return be.abrupt('continue',35);case 34:return be.abrupt('break',38);case 35:me=!0,be.next=18;break;case 38:be.next=44;break;case 40:be.prev=40,be.t0=be['catch'](16),Oe=!0,ve=be.t0;case 44:be.prev=44,be.prev=45,!me&&xe.return&&xe.return();case 47:if(be.prev=47,!Oe){be.next=50;break}throw ve;case 50:return be.finish(47);case 51:return be.finish(44);case 52:be.next=58;break;case 54:be.prev=54,be.t1=be['catch'](0),console.error(be.t1),window.toast('[\u81EA\u52A8\u9001\u793C]\u70B9\u4EAE\u52CB\u7AE0\u51FA\u9519:'+be.t1,'error');case 58:case'end':return be.stop();}},ce,le,[[0,54],[16,40,44,52],[45,,47,51]])}));return function auto_light(){return ue.apply(this,arguments)}}()),_defineProperty(_e,'run',function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(){var Ie,pe,Te,fe,Ee,me,Oe,ve,xe,Ge,Ce,Re,he,Ae;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(Ie=function FailFunc(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.Gift.run()})},pe=function nextTimeDebug(){if('GIFT_SEND_TIME'==ge.CONFIG.GIFT_METHOD){var De=u(ge.CONFIG.GIFT_SEND_HOUR,ge.CONFIG.GIFT_SEND_MINUTE);ge.Gift.run_timer=setTimeout(ge.Gift.run,De);var Me=new Date(P()+De).toLocaleString();Q('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Me+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),ge.CACHE.Gift_TS=P(),ge.saveCache()}else Q('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+ge.CONFIG.GIFT_INTERVAL+'\u5206\u949F\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),ge.CACHE.GiftInterval_TS=P(),ge.saveCache()},ye.prev=2,ge.CONFIG.AUTO_GIFT){ye.next=5;break}return ye.abrupt('return',$.Deferred().resolve());case 5:if(ge.Gift.run_timer&&clearTimeout(ge.Gift.run_timer),'GIFT_SEND_TIME'!=ge.CONFIG.GIFT_METHOD||f(ge.CONFIG.GIFT_SEND_HOUR,ge.CONFIG.GIFT_SEND_MINUTE)||!1!=w){ye.next=14;break}return Te=u(ge.CONFIG.GIFT_SEND_HOUR,ge.CONFIG.GIFT_SEND_MINUTE),ge.Gift.run_timer=setTimeout(ge.Gift.run,Te),fe=new Date(P()+Te).toLocaleString(),Q('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+fe+'\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),ye.abrupt('return',$.Deferred().resolve());case 14:if('GIFT_INTERVAL'!=ge.CONFIG.GIFT_METHOD||!1!=w){ye.next=27;break}if(Ee=6e4*ge.CONFIG.GIFT_INTERVAL,!ge.CACHE.GiftInterval_TS){ye.next=25;break}if(me=P()-ge.CACHE.GiftInterval_TS,!(me<Ee)){ye.next=23;break}return Oe=Ee-me,ge.Gift.run_timer=setTimeout(function(){return ge.Gift.run()},Oe),Q('[\u81EA\u52A8\u9001\u793C]','\u5C06\u5728'+Oe+'\u6BEB\u79D2\u540E\u8FDB\u884C\u81EA\u52A8\u9001\u793C'),ye.abrupt('return');case 23:ye.next=27;break;case 25:ge.CACHE.GiftInterval_TS=P(),ge.saveCache();case 27:return ge.Gift.over=!1,ye.next=30,ge.Gift.getMedalList();case 30:if(ve=ge.Gift.medal_list,Q('Gift.run: Gift.getMedalList().then: Gift.medal_list',ve),!(ve&&0<ve.length)){ye.next=34;break}return ye.delegateYield(regeneratorRuntime.mark(function De(){var Me,be,Le,Se,Fe,we,Ue,ke,He;return regeneratorRuntime.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:ve=ve.filter(function(je){return 0<je.day_limit-je.today_feed&&20>je.level}),ve=ge.Gift.sort_medals(ve),ge.CONFIG.EXCLUDE_ROOMID&&0<ge.CONFIG.EXCLUDE_ROOMID.length&&(ArrayEXCLUDE_ROOMID=ge.CONFIG.EXCLUDE_ROOMID.split(','),ve=ve.filter(function(je){return-1==ArrayEXCLUDE_ROOMID.findIndex(function(Ye){return Ye==je.roomid})}));;return Pe.next=6,ge.Gift.auto_light(ve);case 6:Me=86400*ge.CONFIG.GIFT_LIMIT,be=!0,Le=!1,Se=void 0,Pe.prev=10,Fe=ve[Symbol.iterator]();case 12:if(be=(we=Fe.next()).done){Pe.next=28;break}return Ue=we.value,Pe.next=16,M.room.room_init(parseInt(Ue.roomid,10));case 16:if(ke=Pe.sent,ge.Gift.room_id=parseInt(ke.data.room_id,10),ge.Gift.ruid=Ue.target_id,ge.Gift.remain_feed=Ue.day_limit-Ue.today_feed,!(0<ge.Gift.remain_feed)){Pe.next=25;break}return Pe.delegateYield(regeneratorRuntime.mark(function je(){var Ye,Xe,Ve;return regeneratorRuntime.wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:return Qe.next=2,ge.Gift.getBagList();case 2:if(Ye=Y(),ge.CONFIG.SEND_ALL_GIFT){Qe.next=7;break}if(Xe=ge.Gift.bag_list.filter(function(We){return ge.Gift.sendGiftList.includes(We.gift_id)&&0<We.gift_num&&We.expire_at>Ye&&We.expire_at-Ye<Me}),0!=Xe.length){Qe.next=7;break}return Qe.abrupt('return','break');case 7:;if(!(0<ge.Gift.remain_feed)){Qe.next=21;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ue.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u672A\u6EE1['+Ue.today_feed+'/'+Ue.day_limit+']\uFF0C\u9884\u8BA1\u9700\u8981['+ge.Gift.remain_feed+']\u9001\u793C\u5F00\u59CB','info'),Qe.next=12,ge.Gift.sendGift(Ue);case 12:if(ge.CONFIG.SEND_ALL_GIFT){Qe.next=19;break}if(Ve=ge.Gift.bag_list.filter(function(We){return ge.Gift.sendGiftList.includes(We.gift_id)&&0<We.gift_num&&We.expire_at>Ye&&We.expire_at-Ye<Me}),0!=Ve.length){Qe.next=18;break}return Qe.abrupt('return','break');case 18:ge.Gift.bag_list=Ve;case 19:Qe.next=22;break;case 21:window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ue.medalName+'] \u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1','info');case 22:case'end':return Qe.stop();}},je,le)})(),'t0',22);case 22:if(He=Pe.t0,'break'!==He){Pe.next=25;break}return Pe.abrupt('break',28);case 25:be=!0,Pe.next=12;break;case 28:Pe.next=34;break;case 30:Pe.prev=30,Pe.t1=Pe['catch'](10),Le=!0,Se=Pe.t1;case 34:Pe.prev=34,Pe.prev=35,!be&&Fe.return&&Fe.return();case 37:if(Pe.prev=37,!Le){Pe.next=40;break}throw Se;case 40:return Pe.finish(37);case 41:return Pe.finish(34);case 42:case'end':return Pe.stop();}},De,le,[[10,30,34,42],[35,,37,41]])})(),'t0',34);case 34:return ye.next=36,ge.Gift.getBagList();case 36:xe=0,xe=0;case 38:if(!(xe<=ge.Gift.bag_list.length-1)){ye.next=44;break}if(1!=ge.Gift.bag_list[xe].gift_id){ye.next=41;break}return ye.abrupt('break',44);case 41:xe++,ye.next=38;break;case 44:if(Ge=ge.Gift.bag_list[xe],void 0!=Ge){ye.next=49;break}return w=!1,pe(),ye.abrupt('return',$.Deferred().resolve());case 49:if(Ce=ge.Gift.getFeedByGiftID(Ge.gift_id),Re=86400,he=Y(),!(0!=ge.Gift.bag_list.filter(function(De){return ge.Gift.sendGiftList.includes(De.gift_id)&&0<De.gift_num&&De.expire_at>he&&De.expire_at-he<Re}).length&&Ge.expire_at>ge.Gift.time&&Ge.expire_at-ge.Gift.time<Re&&'0'!=ge.CONFIG.SPARE_GIFT_ROOM&&'0'!=ge.CONFIG.SPARE_GIFT_UID&&0<Ce)){ye.next=55;break}return Ae=Ge.gift_num,ye.abrupt('return',M.gift.bag_send(X.uid,Ge.gift_id,ge.CONFIG.SPARE_GIFT_UID,Ae,Ge.bag_id,ge.CONFIG.SPARE_GIFT_ROOM,X.rnd).then(function(De){Q('Gift.sendGift(\u5269\u4F59\u793C\u7269): API.gift.bag_send',De),0===De.code?window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+ge.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ae+'\u4E2A'+Ge.gift_name,'success'):window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u623F\u95F4['+ge.CONFIG.SPARE_GIFT_ROOM+'] \u9001\u793C\u5F02\u5E38:'+De.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C](\u5269\u4F59\u793C\u7269)\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.Gift.sendGift(medal)})}));case 55:ye.next=63;break;case 57:return ye.prev=57,ye.t1=ye['catch'](2),Ie(),window.toast('[\u81EA\u52A8\u9001\u793C]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38\uFF0C\u5DF2\u505C\u6B62','error'),console.error('['+D+']',ye.t1),ye.abrupt('return',$.Deferred().reject());case 63:return w=!1,pe(),ye.abrupt('return',$.Deferred().resolve());case 66:case'end':return ye.stop();}},ce,le,[[2,57]])}));return function run(){return ue.apply(this,arguments)}}()),_defineProperty(_e,'sendGift',function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(Ie){var pe,Te,fe,Ee,me,Oe,ve,xe,Ge;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:return Re.next=2,ge.Gift.getBagList();case 2:if(!(0>=ge.Gift.remain_feed)){Re.next=5;break}return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ie.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+Ie.today_feed+'/'+Ie.day_limit+']','info'),Re.abrupt('return',$.Deferred().resolve());case 5:if(0>=ge.Gift.time&&(ge.Gift.time=Y()),ge.CONFIG.SEND_ALL_GIFT){Re.next=16;break}if(pe=ge.Gift.bag_list.filter(function(he){return ge.Gift.sendGiftList.includes(he.gift_id)&&0<he.gift_num&&he.expire_at>ge.Gift.time&&he.expire_at-ge.Gift.time<86400*ge.CONFIG.GIFT_LIMIT&&'\u6C38\u4E45'!=he.corner_mark}),0!=pe.length){Re.next=13;break}return ge.Gift.over=!0,Re.abrupt('return');case 13:ge.bag_list=pe;case 14:Re.next=23;break;case 16:if(Te=ge.Gift.bag_list.filter(function(he){return 0<he.gift_num&&'\u6C38\u4E45'!=he.corner_mark}),0!=Te.length){Re.next=22;break}return ge.Gift.over=!0,Re.abrupt('return');case 22:ge.bag_list=Te;case 23:fe=!0,Ee=!1,me=void 0,Re.prev=26,Oe=function _loop3(){var he=xe.value;if(0>=Ie.day_limit-Ie.today_feed)return window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ie.medalName+'] \u9001\u793C\u7ED3\u675F\uFF0C\u4ECA\u65E5\u4EB2\u5BC6\u5EA6\u5DF2\u6EE1['+Ie.today_feed+'/'+Ie.day_limit+']','info'),{v:void 0};var Ae=ge.Gift.getFeedByGiftID(he.gift_id);if(0<Ae){var Ne=_Mathfloor(ge.Gift.remain_feed/Ae);if(Ne>he.gift_num&&(Ne=he.gift_num),0<Ne)return{v:M.gift.bag_send(X.uid,he.gift_id,ge.Gift.ruid,Ne,he.bag_id,ge.Gift.room_id,X.rnd).then(function(ye){Q('Gift.sendGift: API.gift.bag_send',ye),0===ye.code?(he.gift_num-=Ne,Ie.today_feed+=Ne*Ae,ge.Gift.remain_feed-=Ne*Ae,window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ie.medalName+'] \u9001\u793C\u6210\u529F\uFF0C\u9001\u51FA'+Ne+'\u4E2A'+he.gift_name+'\uFF0C['+Ie.today_feed+'/'+Ie.day_limit+']\u8DDD\u79BB\u5347\u7EA7\u8FD8\u9700['+ge.Gift.remain_feed+']','success')):window.toast('[\u81EA\u52A8\u9001\u793C]\u52CB\u7AE0['+Ie.medalName+'] \u9001\u793C\u5F02\u5E38:'+ye.msg,'caution')},function(){return window.toast('[\u81EA\u52A8\u9001\u793C]\u5305\u88F9\u9001\u793C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.Gift.sendGift(Ie)})})}}},ve=ge.Gift.bag_list[Symbol.iterator]();case 29:if(fe=(xe=ve.next()).done){Re.next=36;break}if(Ge=Oe(),'object'!==('undefined'==typeof Ge?'undefined':_typeof(Ge))){Re.next=33;break}return Re.abrupt('return',Ge.v);case 33:fe=!0,Re.next=29;break;case 36:Re.next=42;break;case 38:Re.prev=38,Re.t0=Re['catch'](26),Ee=!0,me=Re.t0;case 42:Re.prev=42,Re.prev=43,!fe&&ve.return&&ve.return();case 45:if(Re.prev=45,!Ee){Re.next=48;break}throw me;case 48:return Re.finish(45);case 49:return Re.finish(42);case 50:case'end':return Re.stop();}},ce,le,[[26,38,42,50],[43,,45,49]])}));return function sendGift(){return ue.apply(this,arguments)}}()),_e),MobileHeartBeat:{run:function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(){var Ie,pe,Te,fe;return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(!1!=ge.CONFIG.MOBILE_HEARTBEAT){me.next=2;break}return me.abrupt('return',$.Deferred().resolve());case 2:if(se(ge.CACHE.MobileHeartBeat_TS)){me.next=5;break}return z(ge.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3'),me.abrupt('return',$.Deferred().resolve());case 5:if(!1!==X.mobile_verify){me.next=9;break}return window.toast('[\u79FB\u52A8\u7AEF\u5FC3\u8DF3]\u672A\u7ED1\u5B9A\u624B\u673A\uFF0C\u5DF2\u505C\u6B62','warning'),Q('MobileHeartBeat','\u672A\u7ED1\u5B9A\u624B\u673A mobile_verify = '+X.mobile_verify),me.abrupt('return',$.Deferred().resolve());case 9:return Ie=function mobileOnline(){C({GM:!0,anonymous:!0,method:'POST',url:'https://api.live.bilibili.com/heartbeat/v1/OnLine/mobileOnline?'+BilibiliToken.signQuery('access_key='+ae.access_token+'&'+te),data:'room_id='+X.room_id+'&scale=xxhdpi',responseType:'json',headers:ee.headers})},pe=function EndFunc(Oe){Q('MobileHeartBeat GetAward',Oe),clearInterval(fe),ge.CACHE.MobileHeartBeat_TS=P(),ge.saveCache(),z(ge.MobileHeartBeat.run,'\u79FB\u52A8\u7AEF\u5FC3\u8DF3')},Te=function getWatchingAward(){M.activity.receive_award('double_watch_task').then(function(Oe){return 0===Oe.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u6210\u529F','success'),pe(Oe),$.Deferred().resolve()):-400===Oe.code?(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u5DF2\u9886\u53D6','info'),pe(Oe),$.Deferred().resolve()):(window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]'+Oe,'warning'),pe(Oe),$.Deferred().resolve())},function(Oe){return window.toast('[\u53CC\u7AEF\u89C2\u770B\u76F4\u64AD]\u5956\u52B1\u9886\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),console.error('MobileHeartBeat GetAward',Oe),clearInterval(fe),K(function(){return ge.MobileHeartBeat.run()})})},me.next=14,oe();case 14:if(me.t1=me.sent,me.t2=void 0,me.t0=me.t1===me.t2,!me.t0){me.next=19;break}me.t0=void 0===ae.access_token;case 19:if(!me.t0){me.next=22;break}return Q('MobileHeartBeat','token\u8BBE\u7F6E\u5931\u8D25'),me.abrupt('return');case 22:Q('MobileHeartBeat','\u5F00\u59CB\u5BA2\u6237\u7AEF\u5FC3\u8DF3'),Ie(),fe=void 0,fe=setInterval(function(){return Ie()},300000),setTimeout(function(){return Te()},360000);case 27:case'end':return me.stop();}},ce,le)}));return function run(){return ue.apply(this,arguments)}}()},stormQueue:[],stormBlack:!1,stormIdSet:{add:function add(ue){var ce=[];try{var Ie=JSON.parse(localStorage.getItem(D+'stormIdSet'));ce=[].concat(Ie.list),ce.push(ue),50<ce.length&&ce.splice(0,10),localStorage.setItem(D+'stormIdSet',JSON.stringify({list:ce})),Q(D+'storm_Id_list_add',ce)}catch(Ie){ce.push(ue),localStorage.setItem(D+'stormIdSet',JSON.stringify({list:ce}))}},isIn:function isIn(ue){var ce=[];try{var Ie=JSON.parse(localStorage.getItem(D+'stormIdSet'));return ce=null===Ie?[]:[].concat(Ie.list),Q(D+'storm_Id_list_read',Ie),-1<ce.indexOf(ue)}catch(Ie){return localStorage.setItem(D+'stormIdSet',JSON.stringify({list:ce})),Q('\u8BFB\u53D6'+(D+'stormIdSet\u7F13\u5B58\u9519\u8BEF\u5DF2\u91CD\u7F6E')),-1<ce.indexOf(ue)}}},Storm:{check:function check(ue){return-1<ge.stormQueue.indexOf(ue)},append:function append(ue){ge.stormQueue.push(ue),ge.stormQueue.length>ge.CONFIG.STORM_QUEUE_SIZE&&ge.stormQueue.shift()},over:function over(ue){var ce=ge.stormQueue.indexOf(ue);-1<ce&&ge.stormQueue.splice(ue,1)},run:function run(ue){try{return ge.CONFIG.STORM?ge.stormBlack?$.Deferred().resolve():E(ge.CONFIG.TIME_AREA_START_H0UR,ge.CONFIG.TIME_AREA_END_H0UR,ge.CONFIG.TIME_AREA_START_MINUTE,ge.CONFIG.TIME_AREA_END_MINUTE)&&ge.CONFIG.TIME_AREA_DISABLE?(Q('\u8282\u594F\u98CE\u66B4','\u81EA\u52A8\u4F11\u7720\uFF0C\u8DF3\u8FC7\u68C0\u6D4Broomid='+ue),$.Deferred().resolve()):M.Storm.check(ue).then(function(ce){if(Q('MY_API.Storm.run: MY_API.API.Storm.check',ce),0===ce.code){var Ie=ce.data;return ge.Storm.join(Ie.id,Ie.roomid,_Mathround(new Date().getTime()/1e3)+Ie.time),$.Deferred().resolve()}window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4](roomid='+ue+')'+ce.msg,'caution')},function(){window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u68C0\u67E5\u76F4\u64AD\u95F4('+ue+')\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error')}):$.Deferred().resolve()}catch(ce){return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u8FD0\u884C\u65F6\u51FA\u73B0\u5F02\u5E38','error'),console.error('['+D+']',ce),$.Deferred().reject()}},join:function join(ue,ce,Ie){var pe=function(){var me=_asyncToGenerator(regeneratorRuntime.mark(function Oe(){var ve,xe;return regeneratorRuntime.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(Ce.prev=0,ge.Storm.check(ue)){Ce.next=4;break}return clearInterval(fe),Ce.abrupt('return');case 4:if(ve=_Mathround(new Date().getTime()/1e3),!(ve>Ie&&0<Ie)){Ce.next=9;break}return ge.Storm.over(ue),clearInterval(fe),Ce.abrupt('return');case 9:if(Ee++,!(Ee>ge.CONFIG.STORM_MAX_COUNT&&0<ge.CONFIG.STORM_MAX_COUNT)){Ce.next=15;break}return ge.Storm.over(ue),clearInterval(fe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ce+',id='+ue+')\u5230\u8FBE\u5C1D\u8BD5\u6B21\u6570\u3002\r\n\u5C1D\u8BD5\u6B21\u6570:'+Ee+',\u8DDD\u79BB\u5230\u671F:'+(Ie-ve)+'s','caution'),Ce.abrupt('return');case 15:if(xe=void 0,Ce.prev=16,!(ie&&ee&&ae.access_token)){Ce.next=23;break}return Ce.next=20,M.Storm.join_ex(ue,ce,ae.access_token,BilibiliToken.appKey,BilibiliToken.headers);case 20:xe=Ce.sent,Ce.next=26;break;case 23:return Ce.next=25,M.Storm.join(ue,captcha_token='',captcha_phrase='',ce);case 25:xe=Ce.sent;case 26:if(Q('MY_API.Storm.join: MY_API.API.Storm.join',xe),!xe.code){Ce.next=51;break}if(-1==xe.msg.indexOf('\u9886\u53D6')){Ce.next=33;break}return ge.Storm.over(ue),clearInterval(fe),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+ce+',id='+ue+')\u6210\u529F,'+xe.msg+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+Ee,'success'),Ce.abrupt('return');case 33:if(-1==xe.msg.indexOf('\u9A8C\u8BC1\u7801')){Ce.next=39;break}return ge.Storm.over(ue),clearInterval(fe),ge.stormBlack=!0,window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ce+',id='+ue+')\u5931\u8D25,\u7591\u4F3C\u8D26\u53F7\u4E0D\u652F\u6301,'+xe.msg,'caution'),Ce.abrupt('return');case 39:if(!(xe.data&&0==xe.data.length&&-1!=xe.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9'))){Ce.next=46;break}return ge.Storm.over(ue),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ce+',id='+ue+')\u7591\u4F3C\u98CE\u66B4\u9ED1\u5C4B,\u7EC8\u6B62\uFF01','error'),clearInterval(fe),ge.stormBlack=!0,setTimeout(function(){ge.stormBlack=!1},3600000),Ce.abrupt('return');case 46:if(-1!=xe.msg.indexOf('\u4E0B\u6B21\u8981\u66F4\u5FEB\u4E00\u70B9')){Ce.next=49;break}return clearInterval(fe),Ce.abrupt('return');case 49:Ce.next=56;break;case 51:return ge.Storm.over(ue),Statistics.appendGift(xe.data.gift_name,xe.data.gift_num),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u9886\u53D6(roomid='+ce+',id='+ue+')\u6210\u529F,'+(xe.data.gift_name+'x'+xe.data.gift_num)+'\r\n'+xe.data.mobile_content+'\r\n\u5C1D\u8BD5\u6B21\u6570:'+Ee,'success'),clearInterval(fe),Ce.abrupt('return');case 56:Ce.next=65;break;case 58:return Ce.prev=58,Ce.t0=Ce['catch'](16),ge.Storm.over(ue),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ce+',id='+ue+')\u7591\u4F3C\u89E6\u53D1\u98CE\u63A7,\u7EC8\u6B62\uFF01\r\n\u5C1D\u8BD5\u6B21\u6570:'+Ee,'error'),console.error(Ce.t0),clearInterval(fe),Ce.abrupt('return');case 65:Ce.next=74;break;case 67:return Ce.prev=67,Ce.t1=Ce['catch'](0),ge.Storm.over(ue),window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u62BD\u5956(roomid='+ce+',id='+ue+')\u62BD\u5956\u5F02\u5E38,\u7EC8\u6B62\uFF01','error'),console.error(Ce.t1),clearInterval(fe),Ce.abrupt('return');case 74:case'end':return Ce.stop();}},Oe,this,[[0,67],[16,58]])}));return function(){return me.apply(this,arguments)}}();if(ce=parseInt(ce,10),ue=parseInt(ue,10),isNaN(ce)||isNaN(ue))return $.Deferred().reject();var Te=_Mathround(ue/1e6);if(ge.stormIdSet.isIn(Te))return $.Deferred().resolve();if(ge.stormIdSet.add(Te),!ge.Storm.check(ue)){ge.Storm.append(ue);var fe=0;0>=Ie&&(Ie=_Mathround(new Date().getTime()/1e3)+90);var Ee=0;return window.toast('[\u81EA\u52A8\u62BD\u5956][\u8282\u594F\u98CE\u66B4]\u5C1D\u8BD5\u62BD\u5956(roomid='+ce+',id='+ue+')','success'),fe=setInterval(function(){return pe()},ge.CONFIG.STORM_ONE_LIMIT),$.Deferred().resolve()}}},LITTLE_HEART:{medalRoom_list:[],liveRoom_list:[],getMedalRoomList:function getMedalRoomList(){var ue=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return 1===ue&&(ge.LITTLE_HEART.medalRoom_list=[]),M.i.medal(ue,25).then(function(ce){Q('LITTLE_HEART.getMedalRoomList: API.i.medal',ce);var Ie=!0,pe=!1,Te=void 0;try{for(var Ee,me,fe=ce.data.fansMedalList[Symbol.iterator]();!(Ie=(Ee=fe.next()).done);Ie=!0)me=Ee.value,ge.LITTLE_HEART.medalRoom_list=ge.LITTLE_HEART.medalRoom_list.concat(me.roomid)}catch(me){pe=!0,Te=me}finally{try{!Ie&&fe.return&&fe.return()}finally{if(pe)throw Te}}Q('MY_API.LITTLE_HEART.medalRoom_list',ge.LITTLE_HEART.medalRoom_list),ce.data.pageinfo.curPage<ce.data.pageinfo.totalpages&&ge.LITTLE_HEART.getMedalRoomList(ue+1)},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u52CB\u7AE0\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.LITTLE_HEART.getMedalRoomList(ue)})})},checkRoomList:function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(Ie){var pe,Te,fe,Ee,me,Oe,ve;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:pe=[],Te=!0,fe=!1,Ee=void 0,Ge.prev=4,me=Ie[Symbol.iterator]();case 6:if(Te=(Oe=me.next()).done){Ge.next=13;break}return ve=Oe.value,Ge.next=10,M.room.get_info(ve).then(function(Ce){if(1===Ce.data.live_status)return void(pe=pe.concat(Ce.data.room_id))},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.LITTLE_HEART.checkRoomList(Ie)})});case 10:Te=!0,Ge.next=6;break;case 13:Ge.next=19;break;case 15:Ge.prev=15,Ge.t0=Ge['catch'](4),fe=!0,Ee=Ge.t0;case 19:Ge.prev=19,Ge.prev=20,!Te&&me.return&&me.return();case 22:if(Ge.prev=22,!fe){Ge.next=25;break}throw Ee;case 25:return Ge.finish(22);case 26:return Ge.finish(19);case 27:;if(Q('MY_API.LITTLE_HEART.checkRoomList returnRoom',pe),void 0==pe){Ge.next=33;break}return Ge.abrupt('return',pe);case 33:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5F53\u524D\u7C89\u4E1D\u52CB\u7AE0\u5217\u8868\u4E2D\u65E0\u6B63\u5728\u76F4\u64AD\u623F\u95F4\uFF0C5\u5206\u949F\u540E\u91CD\u8BD5'),Ge.abrupt('return',K(function(){return ge.LITTLE_HEART.getMedalRoomList(page)},3e5));case 35:case'end':return Ge.stop();}},ce,le,[[4,15,19,27],[20,,22,26]])}));return function checkRoomList(){return ue.apply(this,arguments)}}(),checkRoom:function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(Ie){var pe;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return pe=void 0,fe.next=3,M.room.get_info(Ie).then(function(Ee){pe=1===Ee.data.live_status},function(){return window.toast('[\u5C0F\u5FC3\u5FC3]\u83B7\u53D6\u623F\u95F4\u4FE1\u606F\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC','error'),K(function(){return ge.LITTLE_HEART.checkRoomList(roomList)})});case 3:return fe.abrupt('return',pe);case 4:case'end':return fe.stop();}},ce,le)}));return function checkRoom(){return ue.apply(this,arguments)}}(),doHeartBeat:function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(Ie){var pe,Te;return regeneratorRuntime.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(-1!=k.indexOf(Ie)){Ee.next=2;break}return Ee.abrupt('return');case 2:return window.toast('[\u5C0F\u5FC3\u5FC3]\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00\u623F\u95F4'+Ie+'\u3010\u8BF7\u52FF\u70B9\u51FB\u3011','info'),Q('[\u5C0F\u5FC3\u5FC3]\u6253\u5F00\u6807\u7B7E\u9875\u623F\u95F4',k),Ee.next=6,GM_openInTab('https://live.bilibili.com/'+(Ie+''),'loadInBackground');case 6:return pe=Ee.sent,U.push(pe),Te=setInterval(_asyncToGenerator(regeneratorRuntime.mark(function me(){return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:;if(void 0!=pe&&pe.close(),se(ge.CACHE.LittleHeart_TS)){ve.next=6;break}return clearInterval(Te),Q('[\u5C0F\u5FC3\u5FC3]','\u4ECA\u65E5\u4EFB\u52A1\u5B8C\u6210\uFF0C\u623F\u95F4'+Ie+'\u4E0D\u518D\u6253\u5F00'),ve.abrupt('return');case 6:if(!ge.LITTLE_HEART.checkRoom(Ie)){ve.next=12;break}return ve.next=9,GM_openInTab('https://live.bilibili.com/'+(Ie+''),'loadInBackground');case 9:pe=ve.sent,ve.next=17;break;case 12:return window.toast('[\u5C0F\u5FC3\u5FC3]\u623F\u95F4'+Ie+'\u4E0B\u64AD\uFF0C\u5373\u5C06\u518D\u6B21\u5BFB\u627E\u5F00\u64AD\u623F\u95F4','info'),clearInterval(Te),I(Ie,k),I(pe,U),ve.abrupt('return',ge.LITTLE_HEART.run());case 17:case'end':return ve.stop();}},me,le)})),310e3),Ee.abrupt('return');case 10:case'end':return Ee.stop();}},ce,le)}));return function doHeartBeat(){return ue.apply(this,arguments)}}(),checkHeart:function checkHeart(){var ue=function checkbag(){M.gift.bag_list().then(function(Ie){Q('[\u5C0F\u5FC3\u5FC3]\u68C0\u67E5\u5305\u88F9',Ie);var pe=Ie.data.list.filter(function(Te){return 30607==Te.gift_id&&24==Te.gift_num&&'7\u5929'==Te.corner_mark});if(Q('[\u5C0F\u5FC3\u5FC3]\u5305\u88F9\u51857\u592924\u4E2A\u5C0F\u5FC3\u5FC3',pe),0<pe.length)return clearInterval(ce),window.toast('[\u5C0F\u5FC3\u5FC3]\u4ECA\u65E5\u5C0F\u5FC3\u5FC3\u5DF2\u5168\u90E8\u83B7\u53D6','success'),ge.CACHE.LittleHeart_TS=P(),ge.saveCache(),Q('[\u5C0F\u5FC3\u5FC3]',U),void T(U)})};ue();var ce=setInterval(function(){ue()},3e5)},run:function(){var ue=_asyncToGenerator(regeneratorRuntime.mark(function ce(){var Ie,pe,Te,fe,Ee,me,Oe,ve;return regeneratorRuntime.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:if(ge.CONFIG.LITTLE_HEART){Ge.next=2;break}return Ge.abrupt('return',$.Deferred().resolve());case 2:if(se(ge.CACHE.LittleHeart_TS)){Ge.next=4;break}return Ge.abrupt('return',$.Deferred().resolve());case 4:return Ge.next=6,ge.LITTLE_HEART.getMedalRoomList();case 6:return Ge.next=8,ge.LITTLE_HEART.checkRoomList(ge.LITTLE_HEART.medalRoom_list);case 8:Ie=Ge.sent,k=Ie.filter(function(Ce){return!k.includes(Ce)}),pe=0,Te=!0,fe=!1,Ee=void 0,Ge.prev=14,me=k[Symbol.iterator]();case 16:if(Te=(Oe=me.next()).done){Ge.next=28;break}if(ve=Oe.value,!(pe<ge.CONFIG.MAX_TAB)){Ge.next=24;break}return Ge.next=21,ge.LITTLE_HEART.doHeartBeat(ve);case 21:pe++,Ge.next=25;break;case 24:return Ge.abrupt('break',28);case 25:Te=!0,Ge.next=16;break;case 28:Ge.next=34;break;case 30:Ge.prev=30,Ge.t0=Ge['catch'](14),fe=!0,Ee=Ge.t0;case 34:Ge.prev=34,Ge.prev=35,!Te&&me.return&&me.return();case 37:if(Ge.prev=37,!fe){Ge.next=40;break}throw Ee;case 40:return Ge.finish(37);case 41:return Ge.finish(34);case 42:;return ge.LITTLE_HEART.checkHeart(),Ge.abrupt('return');case 45:case'end':return Ge.stop();}},ce,le,[[14,30,34,42],[35,,37,41]])}));return function run(){return ue.apply(this,arguments)}}()}};ge.init().then(function(){try{var ue=$.Deferred();(function uniqueCheck(){var Ie=Date.now();return 0<=Ie-ge.CACHE.UNIQUE_CHECK&&15e3>=Ie-ge.CACHE.UNIQUE_CHECK?($('.link-toast').hide(),$('.igiftMsg').hide(),ge.CONFIG.AUTO_TREASUREBOX=!1,window.toast('\u6709\u5176\u4ED6\u76F4\u64AD\u95F4\u9875\u9762\u7684\u811A\u672C\u6B63\u5728\u8FD0\u884C\uFF0C\u672C\u9875\u9762\u811A\u672C\u505C\u6B62\u8FD0\u884C','caution'),ue.reject()):ue.resolve()})().then(function(){var Ie,pe=function uniqueMark(){Ie=setTimeout(pe,1e4),ge.CACHE.UNIQUE_CHECK=Date.now(),ge.saveCache(!1)};return(window.addEventListener('unload',function(){Ie&&(clearTimeout(Ie),ge.CACHE.UNIQUE_CHECK=0,ge.saveCache()),T(U)}),pe(),0===parseInt(X.uid)||isNaN(parseInt(X.uid)))?void ge.chatLog('\u672A\u767B\u5F55\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u4F7F\u7528\u811A\u672C','warning'):void(ge.newMessage(GM_info.script.version),Q('MY_API.CONFIG',ge.CONFIG),_(ge))})}catch(ue){console.error('\u91CD\u590D\u8FD0\u884C\u68C0\u6D4B\u9519\u8BEF',ue)}})}function _(le){'use strict';var _e=function clearStat(){le.GIFT_COUNT.COUNT=0,le.GIFT_COUNT.CLEAR_TS=de(),le.saveGiftCount(),Q('\u5DF2\u6E05\u7A7A\u8FA3\u6761\u6570\u91CF')};se(le.GIFT_COUNT.CLEAR_TS)&&_e(),Z(_e,'\u91CD\u7F6E\u7EDF\u8BA1'),le.LITTLE_HEART.run(),le.removeUnnecessary(),setTimeout(function(){le.GroupSign.run(),le.DailyReward.run(),le.LiveReward.run(),le.Exchange.runS2C(),le.TreasureBox.run(),le.Gift.run(),le.MobileHeartBeat.run()},6e3),le.creatSetBox(),M.room.getList().then(function(Ie){Q('\u76F4\u64AD\u95F4\u5217\u8868',Ie);var pe=!0,Te=!1,fe=void 0;try{for(var Oe,Ee=function _loop4(){var ve=Oe.value;M.room.getRoomList(ve.id,0,0,1,1).then(function(xe){Q('\u76F4\u64AD\u95F4\u53F7\u5217\u8868',xe);for(var Ge=0;Ge<xe.data.length;++Ge)le.listen(xe.data[Ge].roomid,X.uid,ve.name+'\u533A')})},me=Ie.data[Symbol.iterator]();!(pe=(Oe=me.next()).done);pe=!0)Ee()}catch(ve){Te=!0,fe=ve}finally{try{!pe&&me.return&&me.return()}finally{if(Te)throw fe}}});var ge=function check_top_room(){if(le.GIFT_COUNT.COUNT>=le.CONFIG.MAX_GIFT&&(Q('\u8D85\u8FC7\u4ECA\u65E5\u8FA3\u6761\u9650\u5236\uFF0C\u4E0D\u53C2\u4E0E\u62BD\u5956'),le.max_blocked=!0),le.blocked||le.max_blocked)return le.blocked?(le.chatLog('\u8FDB\u5165\u5C0F\u9ED1\u5C4B\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C'),void clearInterval(ue)):void le.chatLog('\u8FA3\u6761\u5DF2\u8FBE\u5230\u6700\u5927\u503C\u68C0\u67E5\u5C0F\u65F6\u699C\u5DF2\u505C\u6B62\u8FD0\u884C');if(E(le.CONFIG.TIME_AREA_START_H0UR,le.CONFIG.TIME_AREA_END_H0UR,le.CONFIG.TIME_AREA_START_MINUTE,le.CONFIG.TIME_AREA_END_MINUTE)&&le.CONFIG.TIME_AREA_DISABLE)return void le.chatLog('\u5F53\u524D\u65F6\u95F4\u6BB5\u4E0D\u68C0\u67E5\u5C0F\u65F6\u699C\u793C\u7269','warning');var Ie=['\u5C0F\u65F6\u603B\u699C','\u5A31\u4E50\u5C0F\u65F6\u699C','\u7F51\u6E38\u5C0F\u65F6\u699C','\u624B\u6E38\u5C0F\u65F6\u699C','\u7ED8\u753B\u5C0F\u65F6\u699C','\u7535\u53F0\u5C0F\u65F6\u699C','\u5355\u673A\u5C0F\u65F6\u699C'],pe=1,Te=function checkHourRank(Ee){M.rankdb.getTopRealTimeHour(Ee).then(function(me){var Oe=me.data.list;le.chatLog('\u68C0\u67E5'+Ie[Ee]+'\u623F\u95F4\u7684\u793C\u7269','warning'),Q(Ie[Ee]+'\u623F\u95F4\u5217\u8868',Oe);var ve=!0,xe=!1,Ge=void 0;try{for(var Re,he,Ce=Oe[Symbol.iterator]();!(ve=(Re=Ce.next()).done);ve=!0)he=Re.value,le.checkRoom(he.roomid,'\u5C0F\u65F6\u699C-'+he.area_v2_parent_name+'\u533A')}catch(he){xe=!0,Ge=he}finally{try{!ve&&Ce.return&&Ce.return()}finally{if(xe)throw Ge}}})},fe=setInterval(function(){pe<=Ie.length-1?(Te(pe),pe++):clearInterval(fe)},1e3)};setTimeout(ge,6e3);var ue=setInterval(ge,parseInt(1e3*le.CONFIG.CHECK_HOUR_ROOM_INTERVAL)),ce=function reset(Ie){var pe=setTimeout(function(){if(0<le.raffleId_list.length||0<le.guardId_list.length||0<le.pkId_list.length)return Q('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u8FD8\u6709\u793C\u7269\u6CA1\u62BD\uFF0C\u5EF6\u8FDF15s\u540E\u5237\u65B0\u76F4\u64AD\u95F4'),void ce(15000);if(se(le.CACHE.LittleHeart_TS))return Q('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u6B63\u5728\u53D1\u9001\u83B7\u53D6\u5C0F\u5FC3\u5FC3\uFF0C10\u5206\u949F\u540E\u518D\u6B21\u68C0\u67E5'),clearTimeout(pe),void ce(6e5);if(E(le.CONFIG.TIME_AREA_START_H0UR,le.CONFIG.TIME_AREA_END_H0UR,le.CONFIG.TIME_AREA_START_MINUTE,le.CONFIG.TIME_AREA_END_MINUTE)&&le.CONFIG.IN_TIME_RELOAD_DISABLE){var Te=u(le.CONFIG.TIME_AREA_START_MINUTE,le.CONFIG.TIME_AREA_END_MINUTE)+6e4;return ce(Te),void Q('[\u5237\u65B0\u76F4\u64AD\u95F4]','\u5904\u4E8E\u4F11\u7720\u65F6\u95F4\u6BB5\uFF0C\u5C06\u5728'+Te+'\u6BEB\u79D2\u540E\u5237\u65B0\u76F4\u64AD\u95F4')}window.location.reload()},Ie)};ce(6e4*le.CONFIG.TIME_RELOAD)}function u(le,_e){var ge=new Date,ue=ge.getHours(),ce=ge.getMinutes(),Ie=ge.getSeconds(),fe=1e3*(3600*le)+1e3*(60*_e)-(1e3*(3600*ue)+1e3*(60*ce)+1e3*Ie);return Q('[getIntervalTime]\u83B7\u53D6\u95F4\u9694\u65F6\u95F4',fe+'\u6BEB\u79D2'),0>fe?86400000+fe:fe}function I(le,_e){_e.splice(_e.indexOf(le),1)}function T(le){if(le!=void 0){var _e=!0,ge=!1,ue=void 0;try{for(var Ie,pe,ce=le[Symbol.iterator]();!(_e=(Ie=ce.next()).done);_e=!0)pe=Ie.value,pe.close()}catch(pe){ge=!0,ue=pe}finally{try{!_e&&ce.return&&ce.return()}finally{if(ge)throw ue}}}}function f(le,_e){var ge=new Date,ue=ge.getHours(),ce=ge.getMinutes();return ue==le&&ce==_e||(Q('\u9519\u8BEF\u65F6\u95F4'),!1)}function E(le,_e,ge,ue){if(23<le||24<_e||0>le||1>_e||59<ge||0>ge||59<ue||0>ue)return!1;var ce=new Date,Ie=ce.getHours(),pe=ce.getMinutes();if(le<_e)return Ie>=le&&Ie<_e||Ie==_e&&pe>=ge&&pe<ue;return le>_e?Ie>=le||Ie<_e||Ie==_e&&pe>=ge&&pe<ue:le==_e?Ie==le&&ge<=ue&&pe>=ge&&pe<ue||Ie==le&&ge>ue&&pe<=ue&&pe>ge:void 0}function O(le){return new Promise(function(_e){setTimeout(function(){_e()},le)})}function G(le){if(0>=le)return!1;var _e=Math.random();return le/100>=_e}function C(le){return new Promise(function(_e){var ge=function onerror(ue){console.error('XHR',ue),_e(void 0)};if(le.GM)'POST'===le.method&&(void 0===le.headers&&(le.headers={}),void 0===le.headers['Content-Type']&&(le.headers['Content-Type']='application/x-www-form-urlencoded; charset=utf-8')),le.timeout=30000,le.onload=function(ue){_e(ue.response)},le.onerror=ge,le.ontimeout=ge,GM_xmlhttpRequest(le);else{var ue=new XMLHttpRequest;ue.open(le.method,le.url),'POST'===le.method&&null===ue.getResponseHeader('Content-Type')&&ue.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=utf-8'),le.cookie&&(ue.withCredentials=!0),le.responseType!==void 0&&(ue.responseType=le.responseType),ue.timeout=30000,ue.onload=function(ce){var Ie=ce.target;_e({response:Ie,body:Ie.response})},ue.onerror=ge,ue.ontimeout=ge,ue.send(le.data)}})}ne.init(),$(function(){var le=function loadInfo(_e){setTimeout(function(){var ge='undefined'==typeof unsafeWindow?window:unsafeWindow;ge.BilibiliLive===void 0||0===parseInt(ge.BilibiliLive.UID)||isNaN(parseInt(ge.BilibiliLive.UID))?(le(1e3),window.toast('['+GM_info.script.name+']\u65E0\u914D\u7F6E\u4FE1\u606F','warning'),Q('\u65E0\u914D\u7F6E\u4FE1\u606F')):(X.room_id=ge.BilibiliLive.ROOMID,X.uid=ge.BilibiliLive.UID,M.live_user.get_info_in_room(X.room_id).then(function(ue){Q('InitData: API.live_user.get_info_in_room',ue),X.mobile_verify=ue.data.info.mobile_verify,X.identification=ue.data.info.identification}),M.gift.gift_config().then(function(ue){Q('InitData: API.gift.gift_config',ue),!!ue.data&&$.isArray(ue.data)?X.gift_list=ue.data:!!ue.data.list&&$.isArray(ue.data.list)?X.gift_list=ue.data.list:(X.gift_list=[{id:6,price:1000},{id:1,price:100},{id:30607,price:5000}],window.toast('\u76F4\u64AD\u95F4\u793C\u7269\u6570\u636E\u83B7\u53D6\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u6570\u636E','error'))}),X.bili_jct=M.getCookie('bili_jct'),X.ruid=ge.BilibiliLive.ANCHOR_UID,X.rnd=ge.BilibiliLive.RND,X.visit_id=ge.__statisObserver?ge.__statisObserver.__visitId:'',Q('Live_info',X),l())},_e)};le(1e3),o()}),Array.prototype.remove=function(le){var _e=this.indexOf(le);-1<_e&&this.splice(_e,1)};var de=function dateNow(){return Date.now()},se=function checkNewDay(le){if(0===le)return!0;var _e=new Date(le),ge=new Date,ue=_e.getDate(),ce=ge.getDate();return ce!==ue}})();